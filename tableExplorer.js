import{a as _l,b as rs,c as xl}from"./chunk-ZI34IKBE.js";import{a as yl,b as El,c as Sl,d as Tl}from"./chunk-EKO4BB2A.js";import"./chunk-2F3NDXUU.js";import{Ab as wl,C as cl,G as hl,I as ul,K as ml,L as pl,N as gl,Nb as Tn,a as _h,ac as kl,b as Co,bc as ss,bd as le,c as ye,d as Jt,f as al,j as bi,ja as fl,k as ll,p as ht,tb as vl,td as Cl,x as dl,yb as yt,zb as bl}from"./chunk-M3U674VW.js";var Ll=_h(($p,Rn)=>{"use strict";var On=function(s){"use strict";var e=Object.prototype,t=e.hasOwnProperty,i=Object.defineProperty||function(O,T,D){O[T]=D.value},o,r=typeof Symbol=="function"?Symbol:{},n=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function d(O,T,D){return Object.defineProperty(O,T,{value:D,enumerable:!0,configurable:!0,writable:!0}),O[T]}try{d({},"")}catch{d=function(T,D,P){return T[D]=P}}function c(O,T,D,P){var L=T&&T.prototype instanceof v?T:v,W=Object.create(L.prototype),ne=new xe(P||[]);return i(W,"_invoke",{value:Y(O,D,ne)}),W}s.wrap=c;function h(O,T,D){try{return{type:"normal",arg:O.call(T,D)}}catch(P){return{type:"throw",arg:P}}}var u="suspendedStart",m="suspendedYield",g="executing",f="completed",b={};function v(){}function k(){}function C(){}var E={};d(E,n,function(){return this});var y=Object.getPrototypeOf,S=y&&y(y(Qe([])));S&&S!==e&&t.call(S,n)&&(E=S);var F=C.prototype=v.prototype=Object.create(E);k.prototype=C,i(F,"constructor",{value:C,configurable:!0}),i(C,"constructor",{value:k,configurable:!0}),k.displayName=d(C,l,"GeneratorFunction");function V(O){["next","throw","return"].forEach(function(T){d(O,T,function(D){return this._invoke(T,D)})})}s.isGeneratorFunction=function(O){var T=typeof O=="function"&&O.constructor;return T?T===k||(T.displayName||T.name)==="GeneratorFunction":!1},s.mark=function(O){return Object.setPrototypeOf?Object.setPrototypeOf(O,C):(O.__proto__=C,d(O,l,"GeneratorFunction")),O.prototype=Object.create(F),O},s.awrap=function(O){return{__await:O}};function M(O,T){function D(W,ne,X,de){var we=h(O[W],O,ne);if(we.type==="throw")de(we.arg);else{var Me=we.arg,be=Me.value;return be&&typeof be=="object"&&t.call(be,"__await")?T.resolve(be.__await).then(function(He){D("next",He,X,de)},function(He){D("throw",He,X,de)}):T.resolve(be).then(function(He){Me.value=He,X(Me)},function(He){return D("throw",He,X,de)})}}var P;function L(W,ne){function X(){return new T(function(de,we){D(W,ne,de,we)})}return P=P?P.then(X,X):X()}i(this,"_invoke",{value:L})}V(M.prototype),d(M.prototype,a,function(){return this}),s.AsyncIterator=M,s.async=function(O,T,D,P,L){L===void 0&&(L=Promise);var W=new M(c(O,T,D,P),L);return s.isGeneratorFunction(T)?W:W.next().then(function(ne){return ne.done?ne.value:W.next()})};function Y(O,T,D){var P=u;return function(W,ne){if(P===g)throw new Error("Generator is already running");if(P===f){if(W==="throw")throw ne;return De()}for(D.method=W,D.arg=ne;;){var X=D.delegate;if(X){var de=me(X,D);if(de){if(de===b)continue;return de}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(P===u)throw P=f,D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);P=g;var we=h(O,T,D);if(we.type==="normal"){if(P=D.done?f:m,we.arg===b)continue;return{value:we.arg,done:D.done}}else we.type==="throw"&&(P=f,D.method="throw",D.arg=we.arg)}}}function me(O,T){var D=T.method,P=O.iterator[D];if(P===o)return T.delegate=null,D==="throw"&&O.iterator.return&&(T.method="return",T.arg=o,me(O,T),T.method==="throw")||D!=="return"&&(T.method="throw",T.arg=new TypeError("The iterator does not provide a '"+D+"' method")),b;var L=h(P,O.iterator,T.arg);if(L.type==="throw")return T.method="throw",T.arg=L.arg,T.delegate=null,b;var W=L.arg;if(!W)return T.method="throw",T.arg=new TypeError("iterator result is not an object"),T.delegate=null,b;if(W.done)T[O.resultName]=W.value,T.next=O.nextLoc,T.method!=="return"&&(T.method="next",T.arg=o);else return W;return T.delegate=null,b}V(F),d(F,l,"Generator"),d(F,n,function(){return this}),d(F,"toString",function(){return"[object Generator]"});function re(O){var T={tryLoc:O[0]};1 in O&&(T.catchLoc=O[1]),2 in O&&(T.finallyLoc=O[2],T.afterLoc=O[3]),this.tryEntries.push(T)}function pe(O){var T=O.completion||{};T.type="normal",delete T.arg,O.completion=T}function xe(O){this.tryEntries=[{tryLoc:"root"}],O.forEach(re,this),this.reset(!0)}s.keys=function(O){var T=Object(O),D=[];for(var P in T)D.push(P);return D.reverse(),function L(){for(;D.length;){var W=D.pop();if(W in T)return L.value=W,L.done=!1,L}return L.done=!0,L}};function Qe(O){if(O!=null){var T=O[n];if(T)return T.call(O);if(typeof O.next=="function")return O;if(!isNaN(O.length)){var D=-1,P=function L(){for(;++D<O.length;)if(t.call(O,D))return L.value=O[D],L.done=!1,L;return L.value=o,L.done=!0,L};return P.next=P}}throw new TypeError(typeof O+" is not iterable")}s.values=Qe;function De(){return{value:o,done:!0}}return xe.prototype={constructor:xe,reset:function(O){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(pe),!O)for(var T in this)T.charAt(0)==="t"&&t.call(this,T)&&!isNaN(+T.slice(1))&&(this[T]=o)},stop:function(){this.done=!0;var O=this.tryEntries[0],T=O.completion;if(T.type==="throw")throw T.arg;return this.rval},dispatchException:function(O){if(this.done)throw O;var T=this;function D(de,we){return W.type="throw",W.arg=O,T.next=de,we&&(T.method="next",T.arg=o),!!we}for(var P=this.tryEntries.length-1;P>=0;--P){var L=this.tryEntries[P],W=L.completion;if(L.tryLoc==="root")return D("end");if(L.tryLoc<=this.prev){var ne=t.call(L,"catchLoc"),X=t.call(L,"finallyLoc");if(ne&&X){if(this.prev<L.catchLoc)return D(L.catchLoc,!0);if(this.prev<L.finallyLoc)return D(L.finallyLoc)}else if(ne){if(this.prev<L.catchLoc)return D(L.catchLoc,!0)}else if(X){if(this.prev<L.finallyLoc)return D(L.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(O,T){for(var D=this.tryEntries.length-1;D>=0;--D){var P=this.tryEntries[D];if(P.tryLoc<=this.prev&&t.call(P,"finallyLoc")&&this.prev<P.finallyLoc){var L=P;break}}L&&(O==="break"||O==="continue")&&L.tryLoc<=T&&T<=L.finallyLoc&&(L=null);var W=L?L.completion:{};return W.type=O,W.arg=T,L?(this.method="next",this.next=L.finallyLoc,b):this.complete(W)},complete:function(O,T){if(O.type==="throw")throw O.arg;return O.type==="break"||O.type==="continue"?this.next=O.arg:O.type==="return"?(this.rval=this.arg=O.arg,this.method="return",this.next="end"):O.type==="normal"&&T&&(this.next=T),b},finish:function(O){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.finallyLoc===O)return this.complete(D.completion,D.afterLoc),pe(D),b}},catch:function(O){for(var T=this.tryEntries.length-1;T>=0;--T){var D=this.tryEntries[T];if(D.tryLoc===O){var P=D.completion;if(P.type==="throw"){var L=P.arg;pe(D)}return L}}throw new Error("illegal catch attempt")},delegateYield:function(O,T,D){return this.delegate={iterator:Qe(O),resultName:T,nextLoc:D},this.method==="next"&&(this.arg=o),b}},s}(typeof Rn=="object"?Rn.exports:{});try{regeneratorRuntime=On}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=On:Function("r","regeneratorRuntime = r")(On)}});var Ch=ye(al());var os=ye(Jt());var Ni=ye(Jt());var Al=ye(ht()),Ol=(0,Ni.createContext)({}),Rl=({children:s})=>{let{extensionRpc:e}=rs(),t=(0,Ni.useMemo)(()=>({...Cl(e),commitChanges:function(){e.action("commitChanges",{})},loadSubset:function(i){e.action("loadSubset",{rowCount:i})},createRow:function(){e.action("createRow",{})},deleteRow:function(i){e.action("deleteRow",{rowId:i})},updateCell:function(i,o,r){e.action("updateCell",{rowId:i,columnId:o,newValue:r})},revertCell:function(i,o){e.action("revertCell",{rowId:i,columnId:o})},revertRow:function(i){e.action("revertRow",{rowId:i})},generateScript:function(){e.action("generateScript",{})},openScriptInEditor:function(){e.action("openScriptInEditor",{})},copyScriptToClipboard:function(){e.action("copyScriptToClipboard",{})},toggleScriptPane:function(){e.action("toggleScriptPane",{})},setCurrentPage:function(i){e.action("setCurrentPage",{pageNumber:i})}}),[e]);return(0,Al.jsx)(Ol.Provider,{value:t,children:s})},ns=()=>(0,Ni.useContext)(Ol);var ke=ye(Jt());var II=ye(Ll(),1);var An={};Co(An,{BackendUtilityService:()=>_o});var _o=class{constructor(e){this.rxjs=e,this._infiniteScrollBottomHit=!1}addRxJsResource(e){this.rxjs=e}executeBackendProcessesCallback(e,t,i,o){let r=new Date;t&&(i.service.postProcess&&i.service.postProcess(t),i?.internalPostProcess&&i.internalPostProcess(t)),i.postProcess!==void 0&&(t instanceof Object&&(t.metrics={startTime:e,endTime:r,executionTime:r.valueOf()-e.valueOf(),itemCount:o,totalItemCount:o},i.service.options?.infiniteScroll&&(t.infiniteScrollBottomHit=this._infiniteScrollBottomHit,delete t.itemCount)),i.postProcess(t),this.setInfiniteScrollBottomHit(!1))}onBackendError(e,t){if(typeof t?.onError=="function")t.onError(e);else throw e}executeBackendCallback(e,t,i,o,r,n){if(e){i&&!i.clearFilterTriggered&&!i.clearSortTriggered&&n?.emitActionChangedCallback&&n.emitActionChangedCallback.call(this,"remote");let a=e.process(t);if(a instanceof Promise&&a.then)a.then(l=>{this.executeBackendProcessesCallback(o,l,e,r),n?.successCallback?.call(this,i)}).catch(l=>{n?.errorCallback?.call(this,i),this.onBackendError(l,e)});else if(this.rxjs?.isObservable(a)){let l=this.rxjs;l.isObservable(n?.httpCancelRequestSubject)&&n?.httpCancelRequestSubject.next(),a.pipe(l.takeUntil(l.iif(()=>l.isObservable(n?.httpCancelRequestSubject),n?.httpCancelRequestSubject,l.EMPTY))).subscribe(d=>{this.executeBackendProcessesCallback(o,d,e,r),n?.successCallback?.call(this,i)},d=>{n?.errorCallback?.call(this,i),this.onBackendError(d,e)})}}}refreshBackendDataset(e){let t="",i=e?.backendServiceApi;if(!i||!i.service||!i.process)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');if(i.service&&(t=i.service.buildQuery()),t&&t!==""){let o=new Date;i.preProcess?.();let r=e?.pagination?.totalItems??0;this.executeBackendCallback(i,t,null,o,r)}}setInfiniteScrollBottomHit(e){this._infiniteScrollBottomHit=e}};var Ln={};Co(Ln,{collectionObserver:()=>Bt,propertyObserver:()=>wi});function Bt(s,e){if(Array.isArray(s)){let t=["pop","push","reverse","shift","unshift","splice","sort"],i=[];return t.forEach(r=>{s[r]=(...n)=>{let a=Array.prototype[r].apply(s,n);return i.push({method:r,action:a}),e.apply(s,[s,n]),a}}),{disconnect:()=>t.forEach(r=>{s[r]=()=>i[r].action})}}return null}function wi(s,e,t){let i=s[e];Object.defineProperty(s,e,{configurable:!0,get(){return i},set(o){i=o,t.apply(s,[o,s[e]])}})}var Mn={};Co(Mn,{CancelledException:()=>as,addTreeLevelAndAggregatorsByMutation:()=>Bi,addTreeLevelByMutation:()=>ls,cancellablePromise:()=>yh,castObservableToPromise:()=>Hl,createDocumentFragmentOrElement:()=>St,decimalFormatted:()=>zi,fetchAsPromise:()=>xo,findItemInTreeStructure:()=>Ci,findOrDefault:()=>mt,flattenToParentChildArray:()=>In,formatNumber:()=>Ve,getAllDateFieldTypes:()=>$i,getCellValueFromQueryFieldGetter:()=>$t,getColumnFieldType:()=>Eh,getDescendantProperty:()=>ge,getTranslationPrefix:()=>$e,getTreeDataOptionPropName:()=>he,isColumnDateType:()=>ut,mapOperatorByFieldType:()=>ds,mapOperatorToShorthandDesignation:()=>Wt,mapOperatorType:()=>Sh,objectWithoutKey:()=>Vl,thousandSeparatorFormatted:()=>ki,unflattenParentChildArrayToTree:()=>Dn,unsubscribeAll:()=>Wi});var Wp=Array.prototype.map,Gp=Array.prototype.reduce;var xh=s=>s;function Il(s,e,t=xh,i=()=>{}){let o=s&&s.length?[{pointer:s,offset:0}]:[],r=[],n;for(;o.length;)for(n=o.pop();n.offset<n.pointer.length;){let a=n.pointer[n.offset],l=i(a),d=e(a);r.push(t(a,n.node,l,n.nodeId)),n.offset+=1,d&&(o.push(n),n={pointer:d,offset:0,node:a,nodeId:l})}return r}var x=class{};x.locales={TEXT_ALL_SELECTED:"All Selected",TEXT_ALL_X_RECORDS_SELECTED:"All {{x}} records selected",TEXT_APPLY_MASS_UPDATE:"Apply Mass Update",TEXT_APPLY_TO_SELECTION:"Update Selection",TEXT_CANCEL:"Cancel",TEXT_CLEAR_ALL_FILTERS:"Clear all Filters",TEXT_CLEAR_ALL_GROUPING:"Clear all Grouping",TEXT_CLEAR_ALL_SORTING:"Clear all Sorting",TEXT_CLEAR_PINNING:"Unfreeze Columns/Rows",TEXT_CLONE:"Clone",TEXT_COLLAPSE_ALL_GROUPS:"Collapse all Groups",TEXT_CONTAINS:"Contains",TEXT_COLUMNS:"Columns",TEXT_COLUMN_RESIZE_BY_CONTENT:"Resize by Content",TEXT_COMMANDS:"Commands",TEXT_COPY:"Copy",TEXT_DROP_COLUMN_HEADER_TO_GROUP_BY:"Drop a column header here to group by the column",TEXT_EQUALS:"Equals",TEXT_EQUAL_TO:"Equal to",TEXT_ENDS_WITH:"Ends With",TEXT_ERROR_EDITABLE_GRID_REQUIRED:"Your grid must be editable in order to use the Composite Editor Modal.",TEXT_ERROR_ENABLE_CELL_NAVIGATION_REQUIRED:'Composite Editor requires the flag "enableCellNavigation" to be set to True in your Grid Options.',TEXT_ERROR_NO_CHANGES_DETECTED:"Sorry we could not detect any changes.",TEXT_ERROR_NO_EDITOR_FOUND:"We could not find any Editor in your Column Definition.",TEXT_ERROR_NO_RECORD_FOUND:"No records selected for edit or clone operation.",TEXT_ERROR_ROW_NOT_EDITABLE:"Current row is not editable.",TEXT_ERROR_ROW_SELECTION_REQUIRED:"You must select some rows before trying to apply new value(s).",TEXT_EXPAND_ALL_GROUPS:"Expand all Groups",TEXT_EXPORT_TO_CSV:"Export in CSV format",TEXT_EXPORT_TO_TEXT_FORMAT:"Export in Text format (Tab delimited)",TEXT_EXPORT_TO_EXCEL:"Export to Excel",TEXT_EXPORT_TO_TAB_DELIMITED:"Export in Text format (Tab delimited)",TEXT_FORCE_FIT_COLUMNS:"Force fit columns",TEXT_FILTER_SHORTCUTS:"Filter Shortcuts",TEXT_FREEZE_COLUMNS:"Freeze Columns",TEXT_GREATER_THAN:"Greater than",TEXT_GREATER_THAN_OR_EQUAL_TO:"Greater than or equal to",TEXT_GROUP_BY:"Group By",TEXT_HIDE_COLUMN:"Hide Column",TEXT_ITEMS:"items",TEXT_ITEMS_PER_PAGE:"items per page",TEXT_ITEMS_SELECTED:"items selected",TEXT_OF:"of",TEXT_OK:"OK",TEXT_OPTIONS:"Options",TEXT_LAST_UPDATE:"Last Update",TEXT_LESS_THAN:"Less than",TEXT_LESS_THAN_OR_EQUAL_TO:"Less than or equal to",TEXT_LOADING:"Loading...",TEXT_NOT_CONTAINS:"Not contains",TEXT_NOT_EQUAL_TO:"Not equal to",TEXT_PAGE:"Page",TEXT_RECORDS_SELECTED:"records selected",TEXT_REFRESH_DATASET:"Refresh Dataset",TEXT_REMOVE_FILTER:"Remove Filter",TEXT_REMOVE_SORT:"Remove Sort",TEXT_RESET_INPUT_VALUE:"Reset Input Value",TEXT_RESET_FORM:"Reset Form",TEXT_SAVE:"Save",TEXT_SELECT_ALL:"Select All",TEXT_SYNCHRONOUS_RESIZE:"Synchronous resize",TEXT_SORT_ASCENDING:"Sort Ascending",TEXT_SORT_DESCENDING:"Sort Descending",TEXT_STARTS_WITH:"Starts With",TEXT_TOGGLE_ALL_GROUPS:"Toggle all Groups",TEXT_TOGGLE_DARK_MODE:"Toggle Dark Mode",TEXT_TOGGLE_FILTER_ROW:"Toggle Filter Row",TEXT_TOGGLE_PRE_HEADER_ROW:"Toggle Pre-Header Row",TEXT_UNFREEZE_COLUMNS:"Unfreeze Columns",TEXT_X_OF_Y_SELECTED:"# of % selected",TEXT_X_OF_Y_MASS_SELECTED:"{{x}} of {{y}} selected"};x.treeDataProperties={CHILDREN_PROP:"children",COLLAPSED_PROP:"__collapsed",HAS_CHILDREN_PROP:"__hasChildren",LAZY_LOADING_PROP:"__lazyLoading",TREE_LEVEL_PROP:"__treeLevel",PARENT_PROP:"__parentId"};x.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL=2;x.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL=2;x.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL=2;x.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL=4;x.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL=void 0;x.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL=void 0;x.DEFAULT_NUMBER_DECIMAL_SEPARATOR=".";x.DEFAULT_NUMBER_THOUSAND_SEPARATOR="";x.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET=!1;x.SLIDER_DEFAULT_MIN_VALUE=0;x.SLIDER_DEFAULT_MAX_VALUE=100;x.SLIDER_DEFAULT_STEP=1;x.VALIDATION_REQUIRED_FIELD="Field is required";x.VALIDATION_EDITOR_VALID_NUMBER="Please enter a valid number";x.VALIDATION_EDITOR_VALID_INTEGER="Please enter a valid integer number";x.VALIDATION_EDITOR_INTEGER_BETWEEN="Please enter a valid integer number between {{minValue}} and {{maxValue}}";x.VALIDATION_EDITOR_INTEGER_MAX="Please enter a valid integer number that is lower than {{maxValue}}";x.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE="Please enter a valid integer number that is lower than or equal to {{maxValue}}";x.VALIDATION_EDITOR_INTEGER_MIN="Please enter a valid integer number that is greater than {{minValue}}";x.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE="Please enter a valid integer number that is greater than or equal to {{minValue}}";x.VALIDATION_EDITOR_NUMBER_BETWEEN="Please enter a valid number between {{minValue}} and {{maxValue}}";x.VALIDATION_EDITOR_NUMBER_MAX="Please enter a valid number that is lower than {{maxValue}}";x.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE="Please enter a valid number that is lower than or equal to {{maxValue}}";x.VALIDATION_EDITOR_NUMBER_MIN="Please enter a valid number that is greater than {{minValue}}";x.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE="Please enter a valid number that is greater than or equal to {{minValue}}";x.VALIDATION_EDITOR_DECIMAL_BETWEEN="Please enter a valid number with a maximum of {{maxDecimal}} decimals";x.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN="Please make sure your text length is between {{minLength}} and {{maxLength}} characters";x.VALIDATION_EDITOR_TEXT_MAX_LENGTH="Please make sure your text is less than {{maxLength}} characters";x.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE="Please make sure your text is less than or equal to {{maxLength}} characters";x.VALIDATION_EDITOR_TEXT_MIN_LENGTH="Please make sure your text is more than {{minLength}} character(s)";x.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE="Please make sure your text is at least {{minLength}} character(s)";var bt;(function(s){s.colon=":",s.comma=",",s.equalSign="=",s.pipe="|",s.semicolon=";",s.space=" ",s.tab="	",s.doubleColon="::",s.doublePipe="||",s.doubleSemicolon=";;"})(bt||(bt={}));var Q;(function(s){s.autoTooltip="autoTooltip",s.cellExternalCopyManager="cellExternalCopyManager",s.cellMenu="cellMenu",s.checkboxSelector="checkboxSelector",s.columnPicker="columnPicker",s.contextMenu="contextMenu",s.customTooltip="customTooltip",s.draggableGrouping="draggableGrouping",s.groupItemMetaProvider="groupItemMetaProvider",s.gridMenu="gridMenu",s.headerButton="headerButton",s.headerMenu="headerMenu",s.rowBasedEdit="rowBasedEdit",s.rowDetailView="rowDetailView",s.rowMoveManager="rowMoveManager",s.rowSelection="rowSelection"})(Q||(Q={}));var _={unknown:"unknown",string:"string",boolean:"boolean",integer:"integer",float:"float",number:"number",date:"date",dateIso:"dateIso",dateUtc:"dateUtc",dateTime:"dateTime",dateTimeIso:"dateTimeIso",dateTimeIsoAmPm:"dateTimeIsoAmPm",dateTimeIsoAM_PM:"dateTimeIsoAM_PM",dateTimeShortIso:"dateTimeShortIso",dateEuro:"dateEuro",dateEuroShort:"dateEuroShort",dateTimeShortEuro:"dateTimeShortEuro",dateTimeEuro:"dateTimeEuro",dateTimeEuroAmPm:"dateTimeEuroAmPm",dateTimeEuroAM_PM:"dateTimeEuroAM_PM",dateTimeEuroShort:"dateTimeEuroShort",dateTimeEuroShortAmPm:"dateTimeEuroShortAmPm",dateTimeEuroShortAM_PM:"dateTimeEuroShortAM_PM",dateUs:"dateUs",dateUsShort:"dateUsShort",dateTimeShortUs:"dateTimeShortUs",dateTimeUs:"dateTimeUs",dateTimeUsAmPm:"dateTimeUsAmPm",dateTimeUsAM_PM:"dateTimeUsAM_PM",dateTimeUsShort:"dateTimeUsShort",dateTimeUsShortAmPm:"dateTimeUsShortAmPm",dateTimeUsShortAM_PM:"dateTimeUsShortAM_PM",object:"object",password:"password",text:"text",readonly:"readonly"};var Dl;(function(s){s.csv="csv",s.txt="txt",s.xls="xls",s.xlsx="xlsx"})(Dl||(Dl={}));var Ml;(function(s){s.columns="columns",s.filter="filter",s.pagination="pagination",s.pinning="pinning",s.rowSelection="rowSelection",s.sorter="sorter",s.treeData="treeData"})(Ml||(Ml={}));var N;(function(s){s.empty="",s.custom="Custom",s.contains="Contains",s.notContains="Not_Contains",s.lessThan="LT",s.lessThanOrEqual="LE",s.greaterThan="GT",s.greaterThanOrEqual="GE",s.notEqual="NE",s.equal="EQ",s.endsWith="EndsWith",s.rangeInclusive="RangeInclusive",s.rangeExclusive="RangeExclusive",s.startsWith="StartsWith",s.startsWithEndsWith="StartsWithEndsWith",s.in="IN",s.notIn="NOT_IN",s.inContains="IN_CONTAINS",s.notInContains="NOT_IN_CONTAINS",s.inCollection="IN_COLLECTION",s.notInCollection="NOT_IN_COLLECTION"})(N||(N={}));var Et;(function(s){s.asc="asc",s.ASC="ASC",s.desc="desc",s.DESC="DESC"})(Et||(Et={}));var ce;(function(s){s[s.asc=1]="asc",s[s.desc=-1]="desc",s[s.neutral=0]="neutral"})(ce||(ce={}));var as=class s extends Error{constructor(e){super(e),Object.setPrototypeOf(this,s.prototype)}};function yh(s){let e=!1;return s instanceof Promise?{promise:s.then(t=>{if(e)throw new as("Cancelled Promise");return t}),cancel:()=>e=!0}:s}function Hl(s,e,t=""){let i=e;if(e instanceof Promise)return e;if(s.isObservable(e)&&(i=s.firstValueFrom(e)),!(i instanceof Promise))throw new Error(`Something went wrong, Slickgrid-Universal ${t} is not able to convert the Observable into a Promise.`);return i}function St(s,e="span"){return s?.preventDocumentFragmentUsage?document.createElement(e):new DocumentFragment}function ls(s,e,t=0){let i=he(e,"childrenPropName");Array.isArray(s)&&s.forEach(o=>{o&&(Array.isArray(o[i])&&o[i].length>0&&(t++,ls(o[i],e,t),t--),o[e.levelPropName]=t)})}function Bi(s,e,t=0,i=null){let o=he(e,"childrenPropName"),{aggregator:r}=e;Array.isArray(s)&&s.forEach(n=>{if(n){let a=Array.isArray(n[o]);Array.isArray(n[o])&&n[o].length>0&&(r.init(n,!0),t++,Bi(n[o],e,t,n),t--),i&&r.isInitialized&&typeof r.accumulate=="function"&&!n?.__filteredOut&&(r.accumulate(n,a),r.storeResult(i.__treeTotals)),n[e.levelPropName]=t}})}function In(s,e){let t=he(e,"identifierPropName"),i=he(e,"childrenPropName"),o=he(e,"hasChildrenPropName"),r=he(e,"parentPropName"),n=he(e,"levelPropName");return e?.shouldAddTreeLevelNumber&&(Array.isArray(e?.aggregators)?e.aggregators.forEach(l=>{Bi(s,{childrenPropName:i,levelPropName:n,aggregator:l})}):ls(s,{childrenPropName:i,levelPropName:n})),Il(s,l=>l[i],(l,d)=>({[t]:l[t],[r]:d!==void 0?d[t]:null,[o]:!!l[i],...Vl(l,i)}))}function he(s,e,t="id"){let i="";switch(e){case"childrenPropName":i=s?.[e]??x.treeDataProperties.CHILDREN_PROP;break;case"collapsedPropName":i=s?.[e]??x.treeDataProperties.COLLAPSED_PROP;break;case"hasChildrenPropName":i=s?.[e]??x.treeDataProperties.HAS_CHILDREN_PROP;break;case"identifierPropName":i=s?.[e]??t;break;case"lazyLoadingPropName":i=s?.[e]??x.treeDataProperties.LAZY_LOADING_PROP;break;case"levelPropName":i=s?.[e]??x.treeDataProperties.TREE_LEVEL_PROP;break;case"parentPropName":i=s?.[e]??x.treeDataProperties.PARENT_PROP;break}return i}function Dn(s,e){let t=he(e,"identifierPropName"),i=he(e,"childrenPropName"),o=he(e,"parentPropName"),r=he(e,"levelPropName"),n=he(e,"collapsedPropName"),a=s||[],l=[],d={};return a.forEach(c=>{d[c[t]]=c,delete c[i]}),Object.keys(d).forEach(c=>{let h=d[c];if(!(o in h)||h[o]===null||h[o]===void 0||h[o]==="")l.push(h);else if(h[o]in d){let u=d[h[o]];i in u||(u[i]=[]),u[i].push(h),u[n]===void 0&&(u[n]=e?.initiallyCollapsed??!1)}}),Array.isArray(e?.aggregators)?e.aggregators.forEach(c=>{Bi(l,{childrenPropName:i,levelPropName:r,aggregator:c},0)}):ls(l,{childrenPropName:i,levelPropName:r},0),l}function Ci(s,e,t){if(!t)throw new Error('findItemInTreeStructure requires parameter "childrenPropertyName"');let i=s.find(e),o=s.filter(r=>t in r&&r[t]);if(i)return i;if(o.length){let r=[];for(let n of o)t in n&&n[t].forEach(a=>r.push(a));return Ci(r,e,t)}}function zi(s,e,t,i=".",o=""){if(isNaN(+s))return s;let r=e===void 0?2:e,n=t===void 0?2:t,a=String(Math.round(+s*Math.pow(10,n))/Math.pow(10,n));for(a.indexOf(".")<0&&r>0&&(a+=".");a.length-a.indexOf(".")<=r;)a+="0";let l=a.split("."),d,c;o?d=l.length>=1?ki(l[0],o):void 0:d=l.length>=1?l[0]:a,l.length>1&&(c=l[1]);let h="";return d!==void 0&&c!==void 0?h=`${d}${i}${c}`:d!=null&&(h=d),h}function Ve(s,e,t,i,o="",r="",n=".",a=""){if(isNaN(+s))return s;let l=Math.round(parseFloat(s)*1e6)/1e6;if(l<0){let d=Math.abs(l);if(i){if(!isNaN(e)||!isNaN(t))return`(${o}${zi(d,e,t,n,a)}${r})`;let c=ki(`${d}`,a);return`(${o}${c}${r})`}else{if(!isNaN(e)||!isNaN(t))return`-${o}${zi(d,e,t,n,a)}${r}`;let c=ki(`${d}`,a);return`-${o}${c}${r}`}}else{if(!isNaN(e)||!isNaN(t))return`${o}${zi(s,e,t,n,a)}${r}`;let d=ki(`${s}`,a);return`${o}${d}${r}`}}function $t(s,e,t){if(typeof s.queryFieldNameGetterFn=="function"){let i=s.queryFieldNameGetterFn(e);i?.indexOf(".")>=0?t=ge(e,i):t=e.hasOwnProperty(i)?e[i]:t}return t}function ge(s,e){return!s||!e?s:e.split(".").reduce((t,i)=>t&&t[i],s)}function $e(s){return s?.translationNamespace?s.translationNamespace+(s.translationNamespaceSeparator||""):""}function Eh(s){return s.outputType||s.type||_.string}function $i(){return[_.date,_.dateTime,_.dateIso,_.dateTimeIso,_.dateTimeShortIso,_.dateTimeIsoAmPm,_.dateTimeIsoAM_PM,_.dateEuro,_.dateEuroShort,_.dateTimeEuro,_.dateTimeShortEuro,_.dateTimeEuroAmPm,_.dateTimeEuroAM_PM,_.dateTimeEuroShort,_.dateTimeEuroShortAmPm,_.dateTimeEuroShortAM_PM,_.dateUs,_.dateUsShort,_.dateTimeUs,_.dateTimeShortUs,_.dateTimeUsAmPm,_.dateTimeUsAM_PM,_.dateTimeUsShort,_.dateTimeUsShortAmPm,_.dateTimeUsShortAM_PM,_.dateUtc]}function ut(s){return!!$i().includes(s)}function Sh(s){let e;switch(s){case"<":case"LT":e=N.lessThan;break;case"<=":case"LE":e=N.lessThanOrEqual;break;case">":case"GT":e=N.greaterThan;break;case">=":case"GE":e=N.greaterThanOrEqual;break;case"!=":case"NE":e=N.notEqual;break;case"*":case"a*":case"StartsWith":e=N.startsWith;break;case"*z":case"EndsWith":e=N.endsWith;break;case"=":case"==":case"EQ":e=N.equal;break;case"IN":e=N.in;break;case"NIN":case"NOT_IN":e=N.notIn;break;case"<>":case"Not_Contains":case"NOT_CONTAINS":e=N.notContains;break;case"Contains":case"CONTAINS":default:e=N.contains;break}return e}function Wt(s){let e="";switch(s){case N.greaterThan:case">":e=">";break;case N.greaterThanOrEqual:case">=":e=">=";break;case N.lessThan:case"<":e="<";break;case N.lessThanOrEqual:case"<=":e="<=";break;case N.notEqual:case"<>":e="<>";break;case N.equal:case"=":case"==":case"EQ":e="=";break;case N.startsWith:case"a*":case"*":e="a*";break;case N.endsWith:case"*z":e="*z";break;default:e=s;break}return e}function ds(s){let e;if(ut(s))e=N.equal;else switch(s){case _.unknown:case _.string:case _.text:case _.password:case _.readonly:e=N.contains;break;case _.float:case _.number:default:e=N.equal;break}return e}function Vl(s,e){return Object.keys(s).reduce((t,i)=>(i!==e&&(t[i]=s[i]),t),{})}function ki(s,e=","){if(s!=null){let t=`${s}`,i=t.split(".");return i.length===2?`${i[0].replace(/\B(?=(\d{3})+(?!\d))/g,e)}.${i[1]}`:t.replace(/\B(?=(\d{3})+(?!\d))/g,e)}return s}function mt(s,e,t={}){return Array.isArray(s)?s.find(e)||t:s}function xo(s,e){return new Promise(t=>{Array.isArray(s)?t(s):s instanceof Promise?s.then(i=>{Array.isArray(i)?t(i):i?.status>=200&&i.status<300&&typeof i.json=="function"?i.bodyUsed?(console.warn("[SlickGrid-Universal] The response body passed to Fetch was already read. Either pass the dataset from the Response or clone the response first using response.clone()"),t(null)):t(i.json()):i?.content?t(i.content):t(i)}):s&&e?.isObservable(s)?t(Hl(e,s)):t(null)})}function Wi(s){if(Array.isArray(s))for(;s.length>0;){let e=s.pop();e?.unsubscribe&&e.unsubscribe()}return s}var Zn={};Co(Zn,{sortByFieldType:()=>jt});var Fl=(s,e,t=ce.neutral)=>{let i=0;return s===e?i=0:s===null?i=-1:e===null?i=1:t?i=s<e?-1:1:i=s<e?1:-1,t*i};var Nl=(s,e,t=ce.neutral,i,o)=>{if(!i||!i.dataKey)throw new Error('Sorting a "FieldType.object" requires you to provide the "dataKey" (object property name) of the object so that we can use it to sort correctly');let r=s?.hasOwnProperty(i.dataKey)?s[i.dataKey]:s,n=e?.hasOwnProperty(i.dataKey)?e[i.dataKey]:e,a=i?.valueCouldBeUndefined??o?.cellValueCouldBeUndefined??!1,l=0;return typeof s!="object"?l=-1/0:typeof e!="object"?l=1/0:r===null||a&&r===void 0?l=-1:n===null||a&&n===void 0?l=1:r===n?l=0:t?l=r<n?-1:1:l=r<n?1:-1,t*l};var $n={};Co($n,{addToArrayWhenNotExists:()=>zl,addWhiteSpaces:()=>cs,arrayRemoveItemByIndex:()=>yo,calculateAvailableSpace:()=>Vn,classNameToList:()=>ae,createDomElement:()=>p,deepCopy:()=>ei,deepMerge:()=>Gt,destroyAllElementProps:()=>ms,emptyElement:()=>j,emptyObject:()=>Th,extend:()=>fe,findFirstAttribute:()=>Ah,findWidthOrDefault:()=>pt,getFunctionDetails:()=>hs,getHtmlStringOutput:()=>wt,getInnerSize:()=>Gi,getOffset:()=>_e,getOffsetRelativeToParent:()=>Fn,getStyleProp:()=>Bl,htmlDecode:()=>Nn,htmlEncode:()=>$l,htmlEncodeWithPadding:()=>zn,insertAfterElement:()=>Bn,isDefined:()=>q,isDefinedNumber:()=>ti,isEmptyObject:()=>us,isNumber:()=>Z,isObject:()=>It,isObjectEmpty:()=>Eo,isPrimitiveOrHTML:()=>Dt,isPrimitiveValue:()=>ii,parseBoolean:()=>So,queueMicrotaskOrSetTimeout:()=>oi,removeAccentFromText:()=>si,setDeepValue:()=>Ae,stripTags:()=>Ze,titleCase:()=>ri,toCamelCase:()=>Pn,toKebabCase:()=>Mt,toSentenceCase:()=>Xe,toSnakeCase:()=>Oh,uniqueArray:()=>Hn,uniqueObjectArray:()=>Rh,windowScrollPosition:()=>ps});function zl(s,e,t="id"){let i=-1;e&&typeof e=="object"&&t in e?i=s.findIndex(o=>o[t]===e[t]):i=s.findIndex(o=>o===e),i<0&&s.push(e)}function cs(s,e=" "){let t="";for(let i=0;i<s;i++)t+=e;return t}function yo(s,e){return s.filter((t,i)=>e!==i)}function ei(s){let e=()=>{let o={};return Object.keys(s).forEach(r=>{Object.prototype.hasOwnProperty.call(s,r)&&(o[r]=ei(s[r]))}),o},t=()=>s.map(o=>ei(o)),i=Object.prototype.toString.call(s).slice(8,-1).toLowerCase();return i==="object"?e():i==="array"?t():s}function Gt(s,...e){if(!e.length)return s;let t=e.shift();return s=!It(s)&&It(t)?{}:s,It(s)&&It(t)&&Object.keys(t).forEach(i=>{t.hasOwnProperty(i)&&(i in s?typeof s[i]!="object"||typeof t[i]!="object"?s[i]=t[i]:s[i].concat&&t[i].concat?s[i]=s[i].concat(t[i]):s[i]=Gt(s[i],t[i]):s[i]=t[i])}),Gt(s,...e)}function Th(s){return It(s)&&Object.keys(s).forEach(e=>{s.hasOwnProperty(e)&&delete s[e]}),s=null,s={},s}function hs(s,e=!0){let t=!1,i=r=>{let n=r.toString();if(t=n.includes("async "),n.replaceAll(" ","").includes("=>({")){let d=n.match(/(({.*}))/g)||[];return d.length>=1?`return ${d[0].trimStart()}`:n}let a=!n.includes("{")&&n.includes("=>"),l=n.substring(n.indexOf("{")+1||n.indexOf("=>")+2,n.includes("}")?n.lastIndexOf("}"):n.length);return e&&a&&!l.startsWith("return")?"return "+l.trimStart():l};return{params:(r=>{let n=/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,)]*))/gm,a=/([^\s,]+)/g,l=r.toString().replace(n,"");return l.slice(l.indexOf("(")+1,l.indexOf(")")).match(a)??[]})(s),body:i(s),isAsync:t}}function us(s){return s==null?!0:Object.entries(s).length===0}function q(s){return s!=null&&s!==""}function ti(s){return s!==null&&!isNaN(s)&&s!==""}function It(s){return s!==null&&typeof s=="object"&&!Array.isArray(s)&&!(s instanceof Date)}function ii(s){return typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s===null||s===void 0}function Dt(s){return s instanceof HTMLElement||s instanceof DocumentFragment||ii(s)}function Z(s,e=!1){return e?s==null||typeof s=="string"?!1:!isNaN(s):s==null||s===""?!1:!isNaN(+s)}function Eo(s){return!s||s&&typeof s=="object"&&Object.keys(s).length===0}function So(s){return/(true|1)/i.test(s+"")}function oi(s){try{queueMicrotask(s)}catch{setTimeout(s,0)}}function si(s,e=!1){let t=typeof s.normalize=="function"?s.normalize("NFD").replace(/[\u0300-\u036f]/g,""):s;return e?t.toLowerCase():t}function Ae(s,e,t){if(typeof e=="string"&&(e=e.split(".")),e.length>1){let i=e.shift();s&&i!==void 0&&Ae(s[i]=q(s[i])&&(Array.isArray(s[i])||Object.prototype.toString.call(s[i])==="[object Object]")?s[i]:{},e,t)}else s&&e[0]&&(s[e[0]]=t)}function ri(s,e=!1){return typeof s=="string"?e?s.replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substring(1).toLowerCase()):s.charAt(0).toUpperCase()+s.slice(1):s}function Pn(s){return typeof s=="string"?s.replace(/(?:^\w|[A-Z]|\b\w|[\s+\-_/])/g,(e,t)=>/[\s+\-_/]/.test(e)?"":t===0?e.toLowerCase():e.toUpperCase()):s}function Mt(s){return typeof s=="string"?Pn(s).replace(/([A-Z])|([-_])/g,"-$1").toLowerCase():s}function Xe(s){if(typeof s=="string"){let e=s.replace(/([A-Z])|([-_])/g," $1").replace(/\s+/g," ").trim();return e.charAt(0).toUpperCase()+e.slice(1)}return s}function Oh(s){return typeof s=="string"?Pn(s).replace(/([A-Z])/g,"_$1").toLowerCase():s}function Hn(s){return Array.isArray(s)&&s.length>0?s.filter((e,t)=>s.indexOf(e)>=t):s}function Rh(s,e="id"){if(Array.isArray(s)&&s.length>0){let t=[],i=new Map;for(let o of s)o&&!i.has(o[e])&&(i.set(o[e],!0),t.push({id:o[e],name:o.name}));return t}return s}function Vn(s){let e=window.innerHeight||0,t=window.innerWidth||0,{top:i,left:o}=ps(),{top:r=0,left:n=0}=_e(s)||{},a=r-i,l=n-o,d=e-(r-i+s.clientHeight),c=t-(n-o+s.clientWidth);return{top:a,bottom:d,left:l,right:c}}function p(s,e,t){let i=document.createElement(s);return e&&Object.keys(e).forEach(o=>{o==="innerHTML"&&console.warn(`[Slickgrid-Universal] For better CSP (Content Security Policy) support, do not use "innerHTML" directly in "createDomElement('${s}', { innerHTML: 'some html'})", it is better as separate assignment: "const elm = createDomElement('span'); elm.innerHTML = 'some html';"`);let r=e[o];typeof r=="object"?Object.assign(i[o],r):i[o]=e[o]}),t?.appendChild(i),i}function ae(s=""){return s.split(" ").filter(e=>e)}function ms(s){typeof s=="object"&&Object.keys(s).forEach(e=>{Array.isArray(s[e])&&ms(s[e]),s[e]instanceof HTMLElement&&(s[e]=null)})}function j(s){for(;s?.firstChild;)s.removeChild(s.firstChild);return s}function wt(s,e="innerHTML"){return s instanceof DocumentFragment?[].map.call(s.childNodes,t=>t[e]).join("")||s.textContent||"":s instanceof HTMLElement?s[e]:String(s??"")}function Fn(s,e){if(!s||!e)return;let t=s.getBoundingClientRect(),i=e.getBoundingClientRect();return{top:i.top-t.top,right:i.right-t.right,bottom:i.bottom-t.bottom,left:i.left-t.left}}function _e(s){if(!s?.getBoundingClientRect)return{top:0,bottom:0,left:0,right:0};let{top:e,left:t,bottom:i,right:o}=s.getBoundingClientRect();return{top:e+window.pageYOffset,left:t+window.pageXOffset,bottom:i,right:o}}function Gi(s,e){let t=0;if(s){let i=e==="height"?"clientHeight":"clientWidth",o=e==="height"?["top","bottom"]:["left","right"];t=s[i];for(let r of o){let n=parseFloat(Bl(s,`padding-${r}`)||"")||0;t-=n}}return t}function Bl(s,e){return s?getComputedStyle(s).getPropertyValue(e):null}function Ah(s,e){if(s)for(let t of e){let i=s.getAttribute(t);if(i)return i}return null}function pt(s,e="auto"){return(/^[0-9]+$/i.test(`${s}`)?`${+s}px`:s)||e}function $l(s){let e=typeof s=="string"?s:String(s),t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return(e||"").toString().replace(/[&<>"']/g,i=>t[i])}function Nn(s){if(q(s)){let e=document.createElement("textarea");return e.innerHTML=s.toString().replace(/&#(\d+);/g,(t,i)=>String.fromCharCode(i)),e.value}return""}function zn(s,e){let t=s.length,i=$l(s);if(t<e)for(let o=t;o<e;o++)i+="&nbsp;";return i}function Bn(s,e){s.parentNode?.insertBefore(e,s.nextSibling)}function ps(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}var gs=Object.prototype.hasOwnProperty,Kl=Object.prototype.toString,Wl=Object.defineProperty,Gl=Object.getOwnPropertyDescriptor,Ul=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Kl.call(e)==="[object Array]"},jl=function(e){if(!e||Kl.call(e)!=="[object Object]")return!1;let t=gs.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&gs.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!i)return!1;let o;for(o in e);return typeof o>"u"||gs.call(e,o)},Yl=function(e,t){Wl&&t.name==="__proto__"?Wl(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},ql=function(e,t){if(t==="__proto__")if(gs.call(e,t)){if(Gl)return Gl(e,t).value}else return;return e[t]};function fe(...s){let e,t,i,o,r,n,a=s[0],l=1,d=s.length,c=!1;for(typeof a=="boolean"&&(c=a,a=s[1]||{},l=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});l<d;++l)if(e=s[l],e!=null)for(t in e)i=ql(a,t),o=ql(e,t),a!==o&&(c&&o&&(jl(o)||(r=Ul(o)))?(r?(r=!1,n=i&&Ul(i)?i:[]):n=i&&jl(i)?i:{},Yl(a,{name:t,newValue:fe(c,n,o)})):typeof o<"u"&&Yl(a,{name:t,newValue:o}));return a}var To=Symbol("plaintext"),Xl=Symbol("html"),Zl=Symbol("comment"),Lh=/<(\w*)>/g,Ih=/<\/?([^\s/>]+)/;function Ze(s,e,t){function i(l,d,c){if(typeof l!="string"&&(Z(l)||typeof l=="boolean"))return String(l);if(l instanceof HTMLElement&&(l=l.innerHTML),typeof l!="string"&&l!==void 0&&l!==null)throw new TypeError("'html' parameter must be a string");return r(l||"",o(d||"",c||""))}function o(l,d){return{allowable_tags:n(l),tag_replacement:d,state:To,tag_buffer:"",depth:0,in_quote_char:""}}function r(l,d){let c=d.allowable_tags,h=d.tag_replacement,u=d.state,m=d.tag_buffer,g=d.depth,f=d.in_quote_char,b="";for(let v=0,k=l.length;v<k;v++){let C=l[v];if(u===To)switch(C){case"<":u=Xl,m+=C;break;default:b+=C;break}else if(u===Xl)switch(C){case"<":if(f)break;g++;break;case">":if(f)break;if(g){g--;break}f="",u=To,m+=">",c.has(a(m))?b+=m:b+=h,m="";break;case'"':case"'":C===f?f="":f=f||C,m+=C;break;case"-":m==="<!-"&&(u=Zl),m+=C;break;case" ":case`
`:if(m==="<"){u=To,b+="< ",m="";break}m+=C;break;default:m+=C;break}else if(u===Zl)switch(C){case">":m.slice(-2)==="--"&&(u=To),m="";break;default:m+=C;break}}return d.state=u,d.tag_buffer=m,d.depth=g,d.in_quote_char=f,b}function n(l){let d=new Set;if(typeof l=="string"){let c;for(;c=Lh.exec(l);)d.add(c[1])}else typeof l[Symbol.iterator]=="function"&&(d=new Set(l));return d}function a(l){let d=Ih.exec(l);return d?d[1].toLowerCase():null}return i(s,e,t)}var Ql=(s,e,t=ce.neutral,i,o)=>{let r=0,n=i?.valueCouldBeUndefined??o?.cellValueCouldBeUndefined??!1;return s===e?r=0:s===null||n&&s===void 0?r=-1:e===null||n&&e===void 0?r=1:(o?.ignoreAccentOnStringFilterAndSort&&(s=si(s,!1),e=si(e,!1)),t?r=s<e?-1:1:r=s<e?1:-1),t*r};var Wn=/^([0-9]{4})-([0-1][0-9])(?:-([0-3][0-9]))?(?:[T ]?([0-2][0-9])(?::([0-5][0-9]))?(?::([0-5][0-9]))?)?(?:\.[0-9]+)?(Z|(?:\+|\-)[0-9]{2}:?[0-9]{2})?$/;function Gn(s){let e=s.match(Wn);if(e){let t=Number(e[2]);if(t<1||t>12)return!1;if(typeof e[3]!==void 0){let i=Number(e[3]);if(i<1||i>31)return!1}if(typeof e[4]!==void 0){let i=Number(e[4]);if(i<0||i>23)return!1}return!0}return!1}function Dh(s){let e=s.match(Wn);return e&&typeof e[4]>"u"?s+="T00:00:00":s}function ee(s){if(s||(s=new Date),s instanceof Date){let e=new Date(s);return e.setMilliseconds(0),e}if(s=s.trim(),Gn(s))return new Date(Dh(s));throw new Error(`Non ISO 8601 compliant date (${s}).`)}function Un(s){let e=ee(s);return e.setDate(1),e.setMonth(e.getMonth()+1),e.setDate(0),e}function _i(s){return Un(s).getDate()}var Ro="1999-03-04T02:05:01.000Z",fs=new Map,vs=[["YYYY",{year:"numeric"}],["YY",{year:"2-digit"}],["MMMM",{month:"long"}],["MMM",{month:"short"}],["MM",{month:"2-digit"}],["M",{month:"numeric"}],["DD",{day:"2-digit"}],["D",{day:"numeric"}],["dddd",{weekday:"long"}],["ddd",{weekday:"short"}],["d",{weekday:"narrow"}],["mm",{minute:"2-digit"}],["m",{minute:"numeric"}],["ss",{second:"2-digit"}],["s",{second:"numeric"}],["ZZ",{timeZoneName:"long"}],["Z",{timeZoneName:"short"}]],bs=[["HH",{hour:"2-digit"}],["H",{hour:"numeric"}]],ws=[["hh",{hour:"2-digit"}],["h",{hour:"numeric"}],["a",{dayPeriod:"narrow"}],["A",{dayPeriod:"narrow"}]],Oo={DD:2,HH:2,MM:2,YY:2,YYYY:4,hh:2,mm:2,ss:2};function ks(s){if(/^[+-]\d{2}:\d{2}/.test(s))return 6;if(/^[+-]\d{4}/.test(s))return 5;throw new Error("Invalid offset format")}var Mh=["MMMM","MMM","dddd","ddd"],Ee=new Map([...vs,...bs,...ws].map(s=>[s[0],s])),jn=new Map,Cs=["full","long","medium","short"],Ut=s=>String(s).padStart(2,"0"),_s=s=>String(s).padStart(2,"0");function kt(s){return s.type==="literal"&&(s.value=s.value.normalize("NFKC")),s}function Jl(s,e,t,i=!1,o=null){let r=Ph(s,e,t,i),n=ee(s);function a({partName:l,partValue:d,token:c}){if(l==="literal")return d;let h=r[l];if(l==="hour"&&c==="H")return h.replace(/^0/,"")||"0";if(["mm","ss","MM"].includes(c)&&h.length===1)return`0${h}`;if(l==="dayPeriod"){let u=Pt(n.getUTCHours()<12?"am":"pm",t);return c==="A"?u.toUpperCase():u.toLowerCase()}return l==="timeZoneName"?o??Yn(-1*n.getTimezoneOffset(),c):h}return e.map(l=>({...l,value:a(l)}))}function Ph(s,e,t,i=!1){let o=ee(s),r=e.filter(c=>c.hour12),n=e.filter(c=>!c.hour12),a=[],l=[];function d(c,h=!1){let u=`${t}-u-hc-${h?"h12":"h23"}`;if(a.push(...new Intl.DateTimeFormat(u,c.reduce((m,g)=>g.partName==="literal"?m:(i&&Mh.includes(g.token)&&l.push(g),Object.assign(m,g.option)),{timeZone:"UTC"})).formatToParts(o).map(kt)),i&&l.length)for(let m of l){let g=[];switch(m.token){case"MMMM":g=new Intl.DateTimeFormat(u,{dateStyle:"long",timeZone:"UTC"}).formatToParts(o).map(kt);break;case"MMM":g=new Intl.DateTimeFormat(u,{dateStyle:"medium",timeZone:"UTC"}).formatToParts(o).map(kt);break}let f=g.find(v=>v.type===m.partName),b=a.findIndex(v=>v.type===m.partName);f&&b>-1&&(a[b]=f)}}return r.length&&d(r,!0),n.length&&d(n),a.reduce((c,h)=>(c[h.type]=h.value,c),{})}function Yn(s,e="Z"){let t=String(Math.floor(Math.abs(s/60))).padStart(2,"0"),i=String(Math.abs(s%60)).padStart(2,"0"),o=s<0?"-":"+";return e==="ZZ"?`${o}${t}${i}`:`${o}${t}:${i}`}function ed(s,e){qn(s,e);let[t,i,o,r]=s.match(/([+-])([0-3][0-9]):?([0-6][0-9])/),n=Number(o)*60+Number(r);return i==="+"?n:-n}function qn(s,e="Z"){if(!(i=>{switch(i){case"Z":return/^([+-])[0-3][0-9]:[0-6][0-9]$/.test(s);case"ZZ":return/^([+-])[0-3][0-9][0-6][0-9]$/.test(s)}})(e))throw new Error(`Invalid offset: ${s}`);return s}function td(s){return vs.concat(bs).concat(ws).sort((e,t)=>e[0].length>t[0].length?1:-1).reduce((e,t)=>e.replace(t[0],`\\${t[0]}`),s)}function Hh(s){return["numeric","2-digit"].includes(s.partValue)}function id(s){let e;for(let t of s){if(t.partName==="literal"&&!isNaN(parseFloat(t.partValue)))throw new Error(`Numbers in format (${t.partValue}).`);if(e&&e.partName!=="literal"&&t.partName!=="literal"&&!(e.token in Oo)&&!(t.token in Oo)&&!(Hh(e)&&t.token.toLowerCase()==="a"))throw new Error(`Illegal adjacent tokens (${e.token}, ${t.token})`);e=t}return s}function od(s){return typeof s=="string"?s.includes("ZZ")?"ZZ":"Z":"time"in s&&s.time==="full"?"Z":"ZZ"}function Pt(s,e){let t=jn.get(e);if(t&&t[s])return t[s];let i=new Date(Ro);i.setUTCHours(s==="am"?5:20);let r=new Intl.DateTimeFormat(e,{timeStyle:"full",timeZone:"UTC",hour12:!0}).formatToParts(i).map(kt).find(n=>n.type==="dayPeriod");if(r){let n=t||{};return jn.set(e,Object.assign(n,{[s]:r.value})),r.value}return s}function xs(s,e="+00:00"){let t=ee(s),i=(()=>{switch(ks(e)){case 5:return"ZZ";case 6:return"Z"}})(),o=ed(e,i);return new Date(t.getTime()+o*1e3*60)}function ys(){return Intl.DateTimeFormat().resolvedOptions().timeZone}function sd(s,e){let t=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZone:e,hourCycle:"h23"}).formatToParts(s).map(kt),i={};return t.forEach(o=>{i[o.type]=o.value}),new Date(`${i.year}-${i.month}-${i.day}T${i.hour}:${i.minute}:${i.second}Z`)}function xi(s,e="UTC",t="device",i="Z"){var o;t=t==="device"?(o=ys())!=null?o:"utc":t;let r=ee(s),n=sd(r,e),a=sd(r,t),l=Math.round((a.getTime()-n.getTime())/1e3/60);return Yn(l,i)}function Es(s){let e=ee(s);return e.setHours(0,0,0),e}function yi(s,e){if(Cs.includes(s)||typeof s=="object")return Vh(s,e);let t=s,i=0,o=c=>{if(c[2]||(c[2]=new RegExp(`(.)?(${c[0]})`,"g")),c[2].test(t)){let h=0;return t=t.replace(c[2],(u,m,g)=>m==="\\"?g:`${typeof m=="string"?m:""}{!${h++?i:i++}!}`),!!h}return!1};function r(c){let h=c.map(m=>m.partName),u=new Set(h);if(h.length>u.size)throw new Error("Cannot reuse format tokens.");return c}function n(c,[h,u,m]){let g=Object.keys(u)[0],f=u[g];return{option:u,partName:g,partValue:f,token:h,pattern:m,hour12:c}}let a=vs.filter(o).concat(bs.filter(o)).map(n.bind(null,!1)),l=r(a.concat(ws.filter(o).map(n.bind(null,!0)))),d=/^\{!(\d+)!\}$/;return t.split(/(\{!\d+!\})/).map(c=>{let h=c.match(d);return h?l[Number(h[1])]:{option:{literal:c},partName:"literal",partValue:c,token:c,pattern:new RegExp(""),hour12:!1}}).filter(c=>!(c.partName==="literal"&&c.partValue===""))}function Vh(s,e){let t={timeZone:"UTC"};typeof s=="string"?t.dateStyle=s:("date"in s&&(t.dateStyle=s.date),"time"in s&&(t.timeStyle=s.time));let i=new Intl.DateTimeFormat(e,t),o=i.formatToParts(new Date(Ro)).map(kt),n=i.formatToParts(new Date("1999-04-05T23:05:01.000Z")).map(kt).find(l=>l.type==="hour"),a=n&&n.value==="23"?24:12;return o.map(l=>{let d=l.type,c=Fh(l.type,l.value,e,l.type==="hour"?a:void 0,t);if(c===void 0)return;let h=c[1][d];if(h)return c[2]||(c[2]=new RegExp(`${c[0]}`,"g")),{option:{[d]:h},partName:d,partValue:h,token:c[0],pattern:c[2],hour12:a===12}}).filter(l=>!!l)}function Fh(s,e,t,i,o){let r=e.length,n=!isNaN(Number(e)),a;switch(s){case"year":return r===2?Ee.get("YY"):Ee.get("YYYY");case"month":if(n)return r===1?Ee.get("M"):Ee.get("MM");switch(a=rd(t,s,e),a){case"long":return Ee.get("MMMM");default:return Ee.get("MMM")}case"day":return r===1?Ee.get("D"):Ee.get("DD");case"weekday":switch(a=rd(t,s,e),a){case"narrow":return Ee.get("d");case"short":return Ee.get("ddd");default:return Ee.get("dddd")}case"hour":return i===12?r===1?Ee.get("h"):Ee.get("hh"):r===1?Ee.get("H"):Ee.get("HH");case"minute":return r===1?Ee.get("m"):Ee.get("mm");case"second":return r===1?Ee.get("s"):Ee.get("ss");case"dayPeriod":return/^[A-Z]+$/u.test(e)?Ee.get("A"):Ee.get("a");case"literal":return[e,{literal:e},new RegExp("")];case"timeZoneName":return o.timeStyle==="full"?Ee.get("Z"):Ee.get("ZZ");default:return}}function rd(s,e,t){if(!fs.has(s)){let o=new Date(Ro),r=[3,8,9,7,6,4,3],n=["weekday","month","dayPeriod"],a=["long","short","narrow"],l={};for(let d=0;d<12;d++){o.setMonth(0+d),d in r&&o.setDate(r[d]),o.setUTCHours(8+d);for(let c of a){let h=new Intl.DateTimeFormat(s,n.reduce((u,m)=>Object.assign(u,{[m]:c}),{hour12:!0,timeZone:"UTC"})).formatToParts(o).map(kt);if(c==="long"||c==="short"){let m=new Intl.DateTimeFormat(s,{dateStyle:c==="short"?"medium":"long",timeZone:"UTC"}).formatToParts(o).map(kt).find(f=>f.type==="month"),g=h.findIndex(f=>f.type==="month");g>-1&&m&&(h[g]=m)}h.forEach(u=>{if(u.type==="literal")return;let m=u.type;l[m]=Object.assign(l[m]||{},{[u.value]:c})})}}fs.set(s,l)}let i=fs.get(s);return i?i[e][t]:void 0}function Ao(s,e="+00:00"){let t=e.slice(0,1)==="+";return xs(s,e.replace(t?"+":"-",t?"-":"+"))}function nd(){return Intl.DateTimeFormat().resolvedOptions().locale}function Fe(s,e="long",t="device",i=!1,o){let r,n;return typeof s=="object"&&!(s instanceof Date)&&({date:s,format:e,locale:t,genitive:i,partFilter:o,tz:r}=s),e==="ISO8601"?ee(s).toISOString():(r&&(n=xi(s,"utc",r,od(e))),r??(r=ys()),r?.toLowerCase()!=="utc"&&(s=Ao(s,xi(s,r,"utc"))),(!t||t==="device")&&(t=nd()),Jl(s,yi(e,t).filter(o??(()=>!0)),t,i,n).map(a=>a.value).join(""))}function Kn(s,e="en",t=!1,i=()=>!0){return yi(s,e).filter(i).reduce((o,r)=>o+=t&&r.partName==="literal"?td(r.token):r.token,"").normalize("NFKC")}function Xn(s){let e=new Date().getFullYear(),t=e%100,i=Math.floor(e/100),o=Number(s);return(i+(o>t+20?-1:0))*100+o}function Ss(s,e="en",t=!1){let i=(o,r)=>Array(o).fill("").map((n,a)=>`${r(a)}`);if(s==="M")return i(12,o=>o+1);if(s==="MM")return i(12,o=>{let r=o+1;return r<10?`0${r}`:r});if(s.startsWith("M"))return Ss("MM").map(o=>Fe(`2000-${o}-05`,s,e,t));if(s.startsWith("d"))return i(7,o=>`0${o+2}`).map(o=>Fe(`2022-10-${o}`,s,e));if(s==="a")return[Pt("am",e).toLowerCase(),Pt("pm",e).toLowerCase()];if(s==="A")return[Pt("am",e).toUpperCase(),Pt("pm",e).toUpperCase()];if(s.startsWith("Y")){let o=new Date().getFullYear();return i(120,r=>r+1).reduce((r,n)=>(n!=="120"&&r.push(Fe(`${o+Number(n)}-06-06`,s,e)),r.unshift(Fe(`${o-Number(n)}-06-06`,s,e)),r),[Fe(`${o}-06-06`,s,e)])}return s.startsWith("D")?i(31,o=>`${s==="DD"&&o<9?"0":""}${o+1}`):s.startsWith("H")?i(24,o=>`${s==="HH"&&o<10?"0":""}${o}`):s.startsWith("h")?i(12,o=>`${s==="hh"&&o<9?"0":""}${o+1}`):s.startsWith("m")||s.startsWith("s")?i(60,o=>`${s.length>1&&o<10?"0":""}${o}`):[]}function ni(s,e="ISO8601",t="device"){let i=()=>!0,o,r="backward";if(typeof s=="object"?{date:o,format:e="ISO8601",locale:t="device",dateOverflow:r="backward",partFilter:i=()=>!0}=s:o=s,!o)throw new Error("parse() requires a date string.");let n=()=>{throw new Error(`Date (${o}) does not match format (${Kn(e,t)})`)};if(e==="ISO8601")return ee(o);let a=Cs.includes(e)||typeof e=="object",l=id(yi(e,t).filter(i));if(!l.length)throw new Error("parse() requires a pattern.");let d;try{d=ad(o,l)}catch{return n()}let c=new Date,h=new Map([["YYYY",c.getFullYear()],["MM",c.getMonth()+1],["DD",c.getDate()],["HH",0],["mm",0],["ss",0]]),u=null,m="";d.forEach(V=>{if(V.partName==="literal")return;if(V.token===V.value)return n();let M=Number(V.value);if(h.has(V.token))h.set(V.token,M);else if(V.token==="YY")h.set("YYYY",Xn(V.value));else{let Y=V.token;if(Y.startsWith("d"))return;if(Y==="D")h.set("DD",M);else if(Y==="H"||Y.startsWith("h"))h.set("HH",M);else if(Y==="M")h.set("MM",M);else if(Y==="a"||Y==="A")u=V.value.toLowerCase()===Pt("am",t).toLowerCase();else if(Y==="Z"||Y==="ZZ")m=qn(V.value,Y);else{let re=Ss(Y,t,a).indexOf(V.value);if(re!==-1)switch(Y){case"MMM":case"MMMM":h.set("MM",re+1);break}}}});let g=h.get("HH")||0;u===!1?(g+=g===12?0:12,h.set("HH",g===24?0:g)):u===!0&&g===12&&h.set("HH",0),h.set("MM",(h.get("MM")||1)-1);let[f,b,v,k,C,E]=Array.from(h.values()),y=_i(new Date(`${_s(f)}-${Ut(b+1)}-10`));if(y<v&&r==="throw")throw new Error(`Invalid date ${_s(f)}-${Ut(b+1)}-${Ut(v)}`);v=r==="backward"?Math.min(v,y):v;let S=`${_s(f)}-${Ut(b+1)}-${Ut(v)}T${Ut(k)}:${Ut(C)}:${Ut(E)}${m}`,F=new Date(S);return isFinite(+F)?F:n()}function ad(s,e){let t=0,i=a=>[a[t++],a[t]],o=0,r=[],n;do{let[a,l]=i(e);n=l;let d=1;if(a.partName==="literal")d=a.partValue.length;else if(a.partName==="timeZoneName")d=ks(s.substring(o));else if(a.token in Oo)d=Oo[a.token];else if(l)if(l.partName==="literal"){if(d=s.indexOf(l.partValue,o)-o,d<0)throw new Error}else if(l.partName==="dayPeriod"){for(let c=1;c<=4;c++)if(isNaN(Number(s.charAt(o+c)))){d=c;break}}else{let c=s.substring(o).search(/\d/);c!==-1&&(d=o+c)}else d=s.length;r.push({...a,value:s.substring(o,o+d)}),o+=d}while(n);return r}function Le(s,e){let t,i=e?.withZeroPadding??!1;switch(s){case _.dateTime:case _.dateTimeIso:t="YYYY-MM-DD HH:mm:ss";break;case _.dateTimeIsoAmPm:t="YYYY-MM-DD hh:mm:ss a";break;case _.dateTimeIsoAM_PM:t="YYYY-MM-DD hh:mm:ss A";break;case _.dateTimeShortIso:t="YYYY-MM-DD HH:mm";break;case _.dateEuro:t="DD/MM/YYYY";break;case _.dateEuroShort:t=i?"DD/MM/YY":"D/M/YY";break;case _.dateTimeEuro:t="DD/MM/YYYY HH:mm:ss";break;case _.dateTimeShortEuro:t=i?"DD/MM/YYYY HH:mm":"D/M/YYYY H:m";break;case _.dateTimeEuroAmPm:t="DD/MM/YYYY hh:mm:ss a";break;case _.dateTimeEuroAM_PM:t="DD/MM/YYYY hh:mm:ss A";break;case _.dateTimeEuroShort:t=i?"DD/MM/YY HH:mm:ss":"D/M/YY H:m:s";break;case _.dateTimeEuroShortAmPm:t=i?"DD/MM/YY hh:mm:ss a":"D/M/YY h:m:s a";break;case _.dateTimeEuroShortAM_PM:t=i?"DD/MM/YY hh:mm:ss A":"D/M/YY h:m:s A";break;case _.dateUs:t="MM/DD/YYYY";break;case _.dateUsShort:t=i?"MM/DD/YY":"M/D/YY";break;case _.dateTimeUs:t="MM/DD/YYYY HH:mm:ss";break;case _.dateTimeUsAmPm:t="MM/DD/YYYY hh:mm:ss a";break;case _.dateTimeUsAM_PM:t="MM/DD/YYYY hh:mm:ss A";break;case _.dateTimeUsShort:t=i?"MM/DD/YY HH:mm:ss":"M/D/YY H:m:s";break;case _.dateTimeUsShortAmPm:t=i?"MM/DD/YY hh:mm:ss a":"M/D/YY h:m:s a";break;case _.dateTimeUsShortAM_PM:t=i?"MM/DD/YY hh:mm:ss A":"M/D/YY h:m:s A";break;case _.dateTimeShortUs:t=i?"MM/DD/YYYY HH:mm":"M/D/YYYY H:m";break;case _.dateUtc:t="ISO8601";break;case _.date:case _.dateIso:default:t=e?.withDefaultIso8601?"ISO8601":"YYYY-MM-DD";break}return t}function gt(s,e,t){let i=e?Le(e):void 0,o=Le(t),r=s instanceof Date?s:nt(s,i);return r&&s!==void 0?t===_.dateUtc?r.toISOString():Fe(r,o,"en-US"):""}function nt(s,e,t=!1){try{return s?s instanceof Date?s:ni({date:s,format:e,dateOverflow:t?"throw":"backward",locale:"en-US"}):!1}catch{return!1}}function ld(s){return Ao(s,xi(s,"utc"))}function dd(s,e,t,i,o){let r=0;if(s===e)r=0;else{let n=nt(s,i,o)||new Date(1001,1,1),a=nt(e,i,o)||new Date(1001,1,1);r=n.valueOf()-a.valueOf()}return t*r}function Os(s){let e=s===_.date?void 0:Le(s);return(t,i,o)=>e===void 0?dd(t,i,o,e,!1):dd(t,i,o,e,!0)}var hd=(s,e,t=ce.neutral,i,o)=>{let r=i?.valueCouldBeUndefined??o?.cellValueCouldBeUndefined??!1,n=cd(s,r),a=cd(e,r);return t*(n===a?0:n>a?1:-1)};function cd(s,e){return isNaN(s)||s===""||s===null||e&&s===void 0?-1/0:parseFloat(s)}function Uh(){let s={boolean:Fl,numeric:hd,objectString:Nl,string:Ql};return $i().forEach(e=>{let t=_[e];t&&(s[e]=Os(t))}),s}var Io=Uh();function jt(s,e,t,i,o,r){let n=0;if(ut(s))n=Os(s)(e,t,i,o,r);else switch(s){case _.boolean:n=Io.boolean(e,t,i,o,r);break;case _.float:case _.integer:case _.number:n=Io.numeric(e,t,i,o,r);break;case _.object:n=Io.objectString(e,t,i,o,r);break;case _.string:case _.text:case _.password:case _.readonly:default:n=Io.string(e,t,i,o,r);break}return n}var We;(function(s){s.camelCase="camelCase",s.camelCaseWithExtraOnPrefix="camelCaseWithExtraOnPrefix",s.kebabCase="kebabCase",s.lowerCase="lowerCase",s.lowerCaseWithoutOnPrefix="lowerCaseWithoutOnPrefix"})(We||(We={}));var Ei=class{get elementSource(){return this._elementSource}set elementSource(e){this._elementSource=e}get subscribedEvents(){return this._subscribedEvents}get subscribedEventNames(){return this._subscribedEvents.map(e=>e.name)}constructor(e){this._subscribedEvents=[],this.eventNamingStyle=We.camelCase,this._elementSource=e||document.createElement("div")}dispose(){this.unsubscribeAll(),this._subscribedEvents=[],clearTimeout(this._timer),this._elementSource?.remove(),this._elementSource=null}dispatchCustomEvent(e,t,i=!0,o=!0,r){let n={bubbles:i,cancelable:o};t&&(n.detail=t);let a=new CustomEvent(e,n);return typeof r=="function"&&r(a),this._elementSource?.dispatchEvent(a)}getEventNameByNamingConvention(e,t){let i=e;switch(this.eventNamingStyle){case We.camelCase:case We.camelCaseWithExtraOnPrefix:this.eventNamingStyle===We.camelCaseWithExtraOnPrefix&&(i=`${t}${e.replace(/^on/,"onOn")}`),i=t!==""?`${t}${ri(i)}`:i;break;case We.kebabCase:i=t!==""?`${t}-${Mt(i)}`:Mt(i);break;case We.lowerCase:case We.lowerCaseWithoutOnPrefix:this.eventNamingStyle===We.lowerCaseWithoutOnPrefix&&(i=`${t}${e.replace(/^on/,"")}`),i=`${t}${i}`.toLowerCase();break}return i}publish(e,t,i,o){let r=this.getEventNameByNamingConvention(e,"");return i?new Promise(n=>{clearTimeout(this._timer),this._timer=setTimeout(()=>n(this.dispatchCustomEvent(r,t,!1,!0,o)),i)}):this.dispatchCustomEvent(r,t,!1,!0,o)}subscribe(e,t){e=Array.isArray(e)?e:[e];let i=[];return e.forEach(o=>{let r=this.getEventNameByNamingConvention(o,"");this._elementSource.addEventListener(r,n=>t.call(null,n.detail)),this._subscribedEvents.push({name:r,listener:t}),i.push(()=>this.unsubscribe(r,t))}),{unsubscribe:()=>i.forEach(o=>o())}}subscribeEvent(e,t){let i=this.getEventNameByNamingConvention(e,"");return this._elementSource.addEventListener(i,t),this._subscribedEvents.push({name:i,listener:t}),{unsubscribe:()=>this.unsubscribe(i,t)}}unsubscribe(e,t,i=!0){let o=this.getEventNameByNamingConvention(e,"");this._elementSource.removeEventListener(o,t),i&&this.removeSubscribedEventWhenFound(e,t)}unsubscribeAll(e){if(Array.isArray(e)){let t;do t=e.pop(),t?.dispose?t.dispose():t?.unsubscribe&&t.unsubscribe();while(t)}else{let t=this._subscribedEvents.pop();for(;t;)this.unsubscribe(t.name,t.listener,!1),t=this._subscribedEvents.pop()}}removeSubscribedEventWhenFound(e,t){let i=this._subscribedEvents.findIndex(o=>o.name===e&&o.listener===t);i>=0&&this._subscribedEvents.splice(i,1)}};function jh(s){var e=document,t=s.container||e.createElement("div"),i=s.preventSubmit||0;t.id=t.id||"autocomplete-"+k();var o=t.style,r=s.debounceWaitMs||0,n=s.disableAutoSelect||!1,a=t.parentElement,l=[],d="",c=2,h=s.showOnFocus,u,m=0,g,f=!1,b=!1;if(s.minLength!==void 0&&(c=s.minLength),!s.input)throw new Error("input undefined");var v=s.input;t.className=[t.className,"autocomplete",s.className||""].join(" ").trim(),t.setAttribute("role","listbox"),v.setAttribute("role","combobox"),v.setAttribute("aria-expanded","false"),v.setAttribute("aria-autocomplete","list"),v.setAttribute("aria-controls",t.id),v.setAttribute("aria-owns",t.id),v.setAttribute("aria-activedescendant",""),v.setAttribute("aria-haspopup","listbox"),o.position="absolute";function k(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function C(){var z=t.parentNode;z&&z.removeChild(t)}function E(){g&&window.clearTimeout(g)}function y(){t.parentNode||(a||e.body).appendChild(t)}function S(){return!!t.parentNode}function F(){m++,l=[],d="",u=void 0,v.setAttribute("aria-activedescendant",""),v.setAttribute("aria-expanded","false"),C()}function V(){if(!S())return;v.setAttribute("aria-expanded","true"),o.height="auto",o.width=v.offsetWidth+"px";var z=0,se;function Be(){var Ye=e.documentElement,st=Ye.clientTop||e.body.clientTop||0,qe=Ye.clientLeft||e.body.clientLeft||0,Lt=window.pageYOffset||Ye.scrollTop,rt=window.pageXOffset||Ye.scrollLeft;se=v.getBoundingClientRect();var Ke=se.top+v.offsetHeight+Lt-st,ko=se.left+rt-qe;o.top=Ke+"px",o.left=ko+"px",z=window.innerHeight-(se.top+v.offsetHeight),z<0&&(z=0),o.top=Ke+"px",o.bottom="",o.left=ko+"px",o.maxHeight=z+"px"}Be(),Be(),s.customize&&se&&s.customize(v,se,t,z)}function M(){t.textContent="",v.setAttribute("aria-activedescendant","");var z=function(qe,Lt,rt){var Ke=e.createElement("div");return Ke.textContent=qe.label||"",Ke};s.render&&(z=s.render);var se=function(qe,Lt){var rt=e.createElement("div");return rt.textContent=qe,rt};s.renderGroup&&(se=s.renderGroup);var Be=e.createDocumentFragment(),Ye=k();if(l.forEach(function(qe,Lt){if(qe.group&&qe.group!==Ye){Ye=qe.group;var rt=se(qe.group,d);rt&&(rt.className+=" group",Be.appendChild(rt))}var Ke=z(qe,d,Lt);Ke&&(Ke.id=t.id+"_"+Lt,Ke.setAttribute("role","option"),Ke.addEventListener("click",function(ko){b=!0;try{s.onSelect(qe,v)}finally{b=!1}F(),ko.preventDefault(),ko.stopPropagation()}),qe===u&&(Ke.className+=" selected",Ke.setAttribute("aria-selected","true"),v.setAttribute("aria-activedescendant",Ke.id)),Be.appendChild(Ke))}),t.appendChild(Be),l.length<1)if(s.emptyMsg){var st=e.createElement("div");st.id=t.id+"_"+k(),st.className="empty",st.textContent=s.emptyMsg,t.appendChild(st),v.setAttribute("aria-activedescendant",st.id)}else{F();return}y(),V(),xe()}function Y(){S()&&M()}function me(){Y()}function re(z){z.target!==t?Y():z.preventDefault()}function pe(){b||X(0)}function xe(){var z=t.getElementsByClassName("selected");if(z.length>0){var se=z[0],Be=se.previousElementSibling;if(Be&&Be.className.indexOf("group")!==-1&&!Be.previousElementSibling&&(se=Be),se.offsetTop<t.scrollTop)t.scrollTop=se.offsetTop;else{var Ye=se.offsetTop+se.offsetHeight,st=t.scrollTop+t.offsetHeight;Ye>st&&(t.scrollTop+=Ye-st)}}}function Qe(){var z=l.indexOf(u);u=z===-1?void 0:l[(z+l.length-1)%l.length],O(z)}function De(){var z=l.indexOf(u);u=l.length<1?void 0:z===-1?l[0]:l[(z+1)%l.length],O(z)}function O(z){l.length>0&&(D(z),T(l.indexOf(u)),xe())}function T(z){var se=e.getElementById(t.id+"_"+z);se&&(se.classList.add("selected"),se.setAttribute("aria-selected","true"),v.setAttribute("aria-activedescendant",se.id))}function D(z){var se=e.getElementById(t.id+"_"+z);se&&(se.classList.remove("selected"),se.removeAttribute("aria-selected"),v.removeAttribute("aria-activedescendant"))}function P(z,se){var Be=S();if(se==="Escape")F();else{if(!Be||l.length<1)return;se==="ArrowUp"?Qe():De()}z.preventDefault(),Be&&z.stopPropagation()}function L(z){if(u){i===2&&z.preventDefault(),b=!0;try{s.onSelect(u,v)}finally{b=!1}F()}i===1&&z.preventDefault()}function W(z){var se=z.key;switch(se){case"ArrowUp":case"ArrowDown":case"Escape":P(z,se);break;case"Enter":L(z);break}}function ne(){h&&X(1)}function X(z){v.value.length>=c||z===1?(E(),g=window.setTimeout(function(){return de(v.value,z,v.selectionStart||0)},z===0||z===2?r:0)):F()}function de(z,se,Be){if(!f){var Ye=++m;s.fetch(z,function(st){m===Ye&&st&&(l=st,d=z,u=l.length<1||n?void 0:l[0],M())},se,Be)}}function we(z){if(s.keyup){s.keyup({event:z,fetch:function(){return X(0)}});return}!S()&&z.key==="ArrowDown"&&X(0)}function Me(z){s.click&&s.click({event:z,fetch:function(){return X(2)}})}function be(){setTimeout(function(){e.activeElement!==v&&F()},200)}function He(){de(v.value,3,v.selectionStart||0)}t.addEventListener("mousedown",function(z){z.stopPropagation(),z.preventDefault()}),t.addEventListener("focus",function(){return v.focus()}),C();function At(){v.removeEventListener("focus",ne),v.removeEventListener("keyup",we),v.removeEventListener("click",Me),v.removeEventListener("keydown",W),v.removeEventListener("input",pe),v.removeEventListener("blur",be),window.removeEventListener("resize",me),e.removeEventListener("scroll",re,!0),v.removeAttribute("role"),v.removeAttribute("aria-expanded"),v.removeAttribute("aria-autocomplete"),v.removeAttribute("aria-controls"),v.removeAttribute("aria-activedescendant"),v.removeAttribute("aria-owns"),v.removeAttribute("aria-haspopup"),E(),F(),f=!0}return v.addEventListener("keyup",we),v.addEventListener("click",Me),v.addEventListener("keydown",W),v.addEventListener("input",pe),v.addEventListener("blur",be),v.addEventListener("focus",ne),window.addEventListener("resize",me),e.addEventListener("scroll",re,!0),{destroy:At,fetch:He}}var Ui=jh;var Rs=class{constructor(e){this._value=null,this._boundedEventWithListeners=[],this._elementBindings=[],this._binding=e,this._property=e.property||"",this._elementBindings=[],e.property&&e.variable&&(e.variable.hasOwnProperty(e.property)||e.property in e.variable)?this._value=e.variable[e.property]:this._value=e.variable,typeof e.variable=="object"&&Object.defineProperty(e.variable,e.property,{get:this.valueGetter.bind(this),set:this.valueSetter.bind(this)})}get boundedEventWithListeners(){return this._boundedEventWithListeners}get elementBindings(){return this._elementBindings}get property(){return this._property}dispose(){this.unbindAll(),this._boundedEventWithListeners=[],this._elementBindings=[]}valueGetter(){return this._value}valueSetter(e){if(this._value=e,Array.isArray(this._elementBindings))for(let t of this._elementBindings)t?.element&&t?.attribute&&(t.element[t.attribute]=e)}bind(e,t,i,o){return e&&e.forEach?e.forEach(r=>this.bindSingleElement(r,t,i,o)):e&&this.bindSingleElement(e,t,i,o),this}unbind(e,t,i,o,r){if(e){e.removeEventListener(t,i,o);let n=this._boundedEventWithListeners.findIndex(a=>a.uid===r);n>=0&&this._boundedEventWithListeners.splice(n,1)}}unbindAll(){let e=this._boundedEventWithListeners.pop();for(;e;){let{element:t,eventName:i,listener:o,uid:r}=e;this.unbind(t,i,o,void 0,r),e=this._boundedEventWithListeners.pop()}}bindSingleElement(e,t,i,o){let r={element:e,attribute:t};if(e){if(i){let n=()=>{let a=e[t];if(this.hasData(a)&&e?.type==="number"&&(a=+a),this.valueSetter(a),(this._binding.variable.hasOwnProperty(this._binding.property)||this._binding.property in this._binding.variable)&&(this._binding.variable[this._binding.property]=this.valueGetter()),typeof o=="function")return o(this.valueGetter())};r.event=i,r.listener=n,e.addEventListener(i,n),this._boundedEventWithListeners.push({element:e,eventName:i,listener:n,uid:this.generateUuidV4()})}this._elementBindings.push(r),e[t]=this._value}}generateUuidV4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}hasData(e){return e!=null&&e!==""}};var ji=class{constructor(){this._observers=[],this._querySelectorPrefix=""}get querySelectorPrefix(){return this._querySelectorPrefix||""}set querySelectorPrefix(e){this._querySelectorPrefix=e}get observers(){return this._observers}dispose(){let e=this._observers.pop();for(;e;)e.dispose(),e=this._observers.pop()}addElementBinding(e,t,i,o,r,n){let a=document.querySelectorAll(`${this.querySelectorPrefix}${i}`),l=this._observers.find(d=>d.property===e)||new Rs({variable:e,property:t});Array.isArray(r)?r.forEach(d=>l?.bind(a,o,d,n)):l?.bind(a,o,r,n),this._observers.push(l)}bindEventHandler(e,t,i,o){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach(r=>{r?.addEventListener(t,i,o)})}setElementAttributeValue(e,t,i){document.querySelectorAll(`${this.querySelectorPrefix}${e}`).forEach(r=>{r.textContent="",r&&t in r&&(r[t]=i)})}};var oe=class{constructor(){this._boundedEvents=[]}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(e,t,i,o,r=""){let n=Array.isArray(t)?t:[t];!(e instanceof HTMLElement||e instanceof DocumentFragment)&&e?.forEach?e.forEach(a=>this.bindElementEvents(a,n,i,o,r)):e&&this.bindElementEvents(e,n,i,o,r)}unbind(e,t,i){let o=Array.isArray(e)?e:[e],r=Array.isArray(t)?t:[t];for(let n of r)for(let a of o)typeof a?.removeEventListener=="function"&&a.removeEventListener(n,i)}unbindByEventName(e,t){let i=this._boundedEvents.find(o=>o.element===e&&o.eventName===t);i&&this.unbind(i.element,i.eventName,i.listener)}unbindAll(e){if(e){let t=Array.isArray(e)?e:[e];for(let i=this._boundedEvents.length-1;i>=0;--i){let o=this._boundedEvents[i];if(t.some(r=>r===o.groupName)){let{element:r,eventName:n,listener:a}=o;this.unbind(r,n,a),this._boundedEvents.splice(i,1)}}}else for(;this._boundedEvents.length>0;){let t=this._boundedEvents.pop(),{element:i,eventName:o,listener:r}=t;this.unbind(i,o,r)}}bindElementEvents(e,t,i,o,r=""){for(let n of t)e.addEventListener(n,i,o),this._boundedEvents.push({element:e,eventName:n,listener:i,groupName:r})}};var Yh=Object.defineProperty,qh=Object.defineProperties,Kh=Object.getOwnPropertyDescriptors,ud=Object.getOwnPropertySymbols,Xh=Object.prototype.hasOwnProperty,Zh=Object.prototype.propertyIsEnumerable,ea=(s,e,t)=>e in s?Yh(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,Yi=(s,e)=>{for(var t in e||(e={}))Xh.call(e,t)&&ea(s,t,e[t]);if(ud)for(var t of ud(e))Zh.call(e,t)&&ea(s,t,e[t]);return s},Qh=(s,e)=>qh(s,Kh(e)),H=(s,e,t)=>(ea(s,typeof e!="symbol"?e+"":e,t),t),li={notFoundSelector:s=>`${s} is not found, check the first argument passed to new Calendar.`,notInit:'The calendar has not been initialized, please initialize it using the "init()" method first.',notLocale:"You specified an incorrect language label or did not specify the required number of values \u200B\u200Bfor \xABlocale.weekdays\xBB or \xABlocale.months\xBB.",incorrectTime:"The value of the time property can be: false, 12 or 24.",incorrectMonthsCount:"For the \xABmultiple\xBB calendar type, the \xABdisplayMonthsCount\xBB parameter can have a value from 2 to 12, and for all others it cannot be greater than 1."},B=(s,e,t)=>{s.context[e]=t},Jh=s=>{var e,t,i,o,r;if(!s.context.isInit)throw new Error(li.notInit);s.inputMode?((e=s.context.mainElement.parentElement)==null||e.removeChild(s.context.mainElement),(i=(t=s.context.inputElement)==null?void 0:t.replaceWith)==null||i.call(t,s.context.originalElement),B(s,"inputElement",void 0)):(r=(o=s.context.mainElement).replaceWith)==null||r.call(o,s.context.originalElement),B(s,"mainElement",s.context.originalElement),s.onDestroy&&s.onDestroy(s)},ta=s=>{s.context.isShowInInputMode&&s.context.currentType&&(s.context.mainElement.dataset.vcCalendarHidden="",B(s,"isShowInInputMode",!1),s.context.cleanupHandlers[0]&&(s.context.cleanupHandlers.forEach(e=>e()),B(s,"cleanupHandlers",[])),s.onHide&&s.onHide(s))};function la(s){if(!s||!s.getBoundingClientRect)return{top:0,bottom:0,left:0,right:0};let e=s.getBoundingClientRect(),t=document.documentElement;return{bottom:e.bottom,right:e.right,top:e.top+window.scrollY-t.clientTop,left:e.left+window.scrollX-t.clientLeft}}function da(){return{vw:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0),vh:Math.max(document.documentElement.clientHeight||0,window.innerHeight||0)}}function eu(){return{left:window.scrollX||document.documentElement.scrollLeft||0,top:window.scrollY||document.documentElement.scrollTop||0}}function tu(s){let{top:e,left:t}=eu(),{top:i,left:o}=la(s),{vh:r,vw:n}=da(),a=i-e,l=o-t;return{top:a,bottom:r-(a+s.clientHeight),left:l,right:n-(l+s.clientWidth)}}function xd(s,e,t=5){let i={top:!0,bottom:!0,left:!0,right:!0},o=[];if(!e||!s)return{canShow:i,parentPositions:o};let{bottom:r,top:n}=tu(s),{top:a,left:l}=la(s),{height:d,width:c}=e.getBoundingClientRect(),{vh:h,vw:u}=da(),m=u/2,g=h/2;return[{condition:a<g,position:"top"},{condition:a>g,position:"bottom"},{condition:l<m,position:"left"},{condition:l>m,position:"right"}].forEach(({condition:f,position:b})=>{f&&o.push(b)}),Object.assign(i,{top:d<=n-t,bottom:d<=r-t,left:c<=l,right:c<=u-l}),{canShow:i,parentPositions:o}}var iu=(s,e,t,i)=>{var o;let r=i.querySelector(`[data-vc-date="${e}"]`),n=r?.querySelector("[data-vc-date-btn]");if(!r||!n||(t?.modifier&&n.classList.add(...t.modifier.trim().split(" ")),!t?.html))return;let a=document.createElement("div");a.className=s.styles.datePopup,a.dataset.vcDatePopup="",a.innerHTML=s.sanitizerHTML(t.html),n.ariaExpanded="true",n.ariaLabel=`${n.ariaLabel}, ${(o=a?.textContent)==null?void 0:o.replace(/^\s+|\s+(?=\s)|\s+$/g,"").replace(/&nbsp;/g," ")}`,r.appendChild(a),requestAnimationFrame(()=>{if(!a)return;let{canShow:l}=xd(r,a),d=l.bottom?r.offsetHeight:-a.offsetHeight,c=l.left&&!l.right?r.offsetWidth-a.offsetWidth/2:!l.left&&l.right?a.offsetWidth/2:0;Object.assign(a.style,{left:`${c}px`,top:`${d}px`})})},ou=(s,e)=>{var t;s.popups&&((t=Object.entries(s.popups))==null||t.forEach(([i,o])=>iu(s,i,o,e)))},te=s=>new Date(`${s}T00:00:00`),Oi=s=>`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`,qt=s=>s.reduce((e,t)=>{if(t instanceof Date||typeof t=="number"){let i=t instanceof Date?t:new Date(t);e.push(i.toISOString().substring(0,10))}else t.match(/^(\d{4}-\d{2}-\d{2})$/g)?e.push(t):t.replace(/(\d{4}-\d{2}-\d{2}).*?(\d{4}-\d{2}-\d{2})/g,(i,o,r)=>{let n=te(o),a=te(r),l=new Date(n.getTime());for(;l<=a;l.setDate(l.getDate()+1))e.push(Oi(l));return i});return e},[]),ai=(s,e,t,i="")=>{e?s.setAttribute(t,i):s.getAttribute(t)===i&&s.removeAttribute(t)},yd=(s,e,t,i,o,r,n)=>{var a,l,d,c;let h=te(s.context.displayDateMin)>te(r)||te(s.context.displayDateMax)<te(r)||((a=s.context.disableDates)==null?void 0:a.includes(r))||!s.selectionMonthsMode&&n!=="current"||!s.selectionYearsMode&&te(r).getFullYear()!==e;ai(t,h,"data-vc-date-disabled"),i&&ai(i,h,"aria-disabled","true"),i&&ai(i,h,"tabindex","-1"),ai(t,!s.disableToday&&s.context.dateToday===r,"data-vc-date-today"),ai(t,!s.disableToday&&s.context.dateToday===r,"aria-current","date"),ai(t,(l=s.selectedWeekends)==null?void 0:l.includes(o),"data-vc-date-weekend");let u=(d=s.selectedHolidays)!=null&&d[0]?qt(s.selectedHolidays):[];if(ai(t,u.includes(r),"data-vc-date-holiday"),(c=s.context.selectedDates)!=null&&c.includes(r)?(t.setAttribute("data-vc-date-selected",""),i&&i.setAttribute("aria-selected","true"),s.context.selectedDates.length>1&&s.selectionDatesMode==="multiple-ranged"&&(s.context.selectedDates[0]===r&&s.context.selectedDates[s.context.selectedDates.length-1]===r?t.setAttribute("data-vc-date-selected","first-and-last"):s.context.selectedDates[0]===r?t.setAttribute("data-vc-date-selected","first"):s.context.selectedDates[s.context.selectedDates.length-1]===r&&t.setAttribute("data-vc-date-selected","last"),s.context.selectedDates[0]!==r&&s.context.selectedDates[s.context.selectedDates.length-1]!==r&&t.setAttribute("data-vc-date-selected","middle"))):t.hasAttribute("data-vc-date-selected")&&(t.removeAttribute("data-vc-date-selected"),i&&i.removeAttribute("aria-selected")),!s.context.disableDates.includes(r)&&s.enableEdgeDatesOnly&&s.context.selectedDates.length>1&&s.selectionDatesMode==="multiple-ranged"){let m=te(s.context.selectedDates[0]),g=te(s.context.selectedDates[s.context.selectedDates.length-1]),f=te(r);ai(t,f>m&&f<g,"data-vc-date-selected","middle")}},su=(s,e,t)=>new Date(`${s}T00:00:00.000Z`).toLocaleString(e,t),Ed=(s,e)=>{let t=te(s),i=(t.getDay()-e+7)%7;t.setDate(t.getDate()+4-i);let o=new Date(t.getFullYear(),0,1),r=Math.ceil(((+t-+o)/864e5+1)/7);return{year:t.getFullYear(),week:r}},ru=(s,e,t)=>{let i=Ed(t,s.firstWeekday);i&&(e.dataset.vcDateWeekNumber=String(i.week))},nu=(s,e,t)=>{var i,o,r,n,a;let l=(i=s.disableWeekdays)==null?void 0:i.includes(t),d=s.disableAllDates&&!!((o=s.context.enableDates)!=null&&o[0]);!l&&!d||(r=s.context.enableDates)!=null&&r.includes(e)||(n=s.context.disableDates)!=null&&n.includes(e)||(s.context.disableDates.push(e),(a=s.context.disableDates)==null||a.sort((c,h)=>+new Date(c)-+new Date(h)))},ca=(s,e,t,i,o,r)=>{let n=te(o).getDay(),a=typeof s.locale=="string"&&s.locale.length?s.locale:"en",l=document.createElement("div"),d;l.className=s.styles.date,l.dataset.vcDate=o,l.dataset.vcDateMonth=r,l.dataset.vcDateWeekDay=String(n),(r==="current"||s.displayDatesOutside)&&(d=document.createElement("button"),d.className=s.styles.dateBtn,d.type="button",d.role="gridcell",d.ariaLabel=su(o,a,{dateStyle:"long",timeZone:"UTC"}),d.dataset.vcDateBtn="",d.innerText=String(i),l.appendChild(d)),s.enableWeekNumbers&&ru(s,l,o),nu(s,o,n),yd(s,e,l,d,n,o,r),t.appendChild(l),s.onCreateDateEls&&s.onCreateDateEls(s,l)},au=(s,e,t,i,o)=>{for(let r=1;r<=t;r++){let n=new Date(i,o,r);ca(s,i,e,r,Oi(n),"current")}},lu=(s,e,t,i,o,r)=>{let n=r+t,a=7*Math.ceil(n/7)-n,l=o+1===12?i+1:i,d=o+1===12?"01":o+2<10?`0${o+2}`:o+2;for(let c=1;c<=a;c++){let h=c<10?`0${c}`:String(c);ca(s,i,e,c,`${l}-${d}-${h}`,"next")}},du=(s,e,t,i,o)=>{let r=new Date(t,i,0).getDate()-(o-1),n=i===0?t-1:t,a=i===0?12:i<10?`0${i}`:i;for(let l=o;l>0;l--,r++)ca(s,t,e,r,`${n}-${a}-${r}`,"prev")},cu=(s,e,t,i,o)=>{if(!s.enableWeekNumbers)return;i.textContent="";let r=document.createElement("b");r.className=s.styles.weekNumbersTitle,r.innerText="#",r.dataset.vcWeekNumbers="title",i.appendChild(r);let n=document.createElement("div");n.className=s.styles.weekNumbersContent,n.dataset.vcWeekNumbers="content",i.appendChild(n);let a=document.createElement("button");a.type="button",a.className=s.styles.weekNumber;let l=o.querySelectorAll("[data-vc-date]"),d=Math.ceil((e+t)/7);for(let c=0;c<d;c++){let h=l[c===0?6:7*c].dataset.vcDate,u=Ed(h,s.firstWeekday);if(!u)return;let m=a.cloneNode(!0);m.innerText=String(u.week),m.dataset.vcWeekNumber=String(u.week),m.dataset.vcWeekYear=String(u.year),m.role="rowheader",m.ariaLabel=`${u.week}`,n.appendChild(m)}},ia=s=>{let e=new Date(s.context.selectedYear,s.context.selectedMonth,1),t=s.context.mainElement.querySelectorAll('[data-vc="dates"]'),i=s.context.mainElement.querySelectorAll('[data-vc-week="numbers"]');t.forEach((o,r)=>{s.selectionDatesMode||(o.dataset.vcDatesDisabled=""),o.textContent="";let n=new Date(e);n.setMonth(n.getMonth()+r);let a=n.getMonth(),l=n.getFullYear(),d=(new Date(l,a,1).getDay()-s.firstWeekday+7)%7,c=new Date(l,a+1,0).getDate();du(s,o,l,a,d),au(s,o,c,l,a),lu(s,o,c,l,a,d),ou(s,o),cu(s,d,c,i[r],o)})},hu=s=>`
  <div class="${s.styles.header}" data-vc="header" role="toolbar" aria-label="${s.labels.navigation}">
    <#ArrowPrev [month] />
    <div class="${s.styles.headerContent}" data-vc-header="content">
      <#Month />
      <#Year />
    </div>
    <#ArrowNext [month] />
  </div>
  <div class="${s.styles.wrapper}" data-vc="wrapper">
    <#WeekNumbers />
    <div class="${s.styles.content}" data-vc="content">
      <#Week />
      <#Dates />
      <#DateRangeTooltip />
    </div>
  </div>
  <#ControlTime />
`,uu=s=>`
  <div class="${s.styles.header}" data-vc="header" role="toolbar" aria-label="${s.labels.navigation}">
    <div class="${s.styles.headerContent}" data-vc-header="content">
      <#Month />
      <#Year />
    </div>
  </div>
  <div class="${s.styles.wrapper}" data-vc="wrapper">
    <div class="${s.styles.content}" data-vc="content">
      <#Months />
    </div>
  </div>
`,mu=s=>`
  <div class="${s.styles.controls}" data-vc="controls" role="toolbar" aria-label="${s.labels.navigation}">
    <#ArrowPrev [month] />
    <#ArrowNext [month] />
  </div>
  <div class="${s.styles.grid}" data-vc="grid">
    <#Multiple>
      <div class="${s.styles.column}" data-vc="column" role="region">
        <div class="${s.styles.header}" data-vc="header">
          <div class="${s.styles.headerContent}" data-vc-header="content">
            <#Month />
            <#Year />
          </div>
        </div>
        <div class="${s.styles.wrapper}" data-vc="wrapper">
          <#WeekNumbers />
          <div class="${s.styles.content}" data-vc="content">
            <#Week />
            <#Dates />
          </div>
        </div>
      </div>
    <#/Multiple>
    <#DateRangeTooltip />
  </div>
  <#ControlTime />
`,pu=s=>`
  <div class="${s.styles.header}" data-vc="header" role="toolbar" aria-label="${s.labels.navigation}">
    <#ArrowPrev [year] />
    <div class="${s.styles.headerContent}" data-vc-header="content">
      <#Month />
      <#Year />
    </div>
    <#ArrowNext [year] />
  </div>
  <div class="${s.styles.wrapper}" data-vc="wrapper">
    <div class="${s.styles.content}" data-vc="content">
      <#Years />
    </div>
  </div>
`,gu=(s,e)=>`<button type="button" class="${s.styles.arrowNext}" data-vc-arrow="next" aria-label="${s.labels.arrowNext[e]}"></button>`,fu=(s,e)=>`<button type="button" class="${s.styles.arrowPrev}" data-vc-arrow="prev" aria-label="${s.labels.arrowPrev[e]}"></button>`,vu=s=>s.selectionTimeMode?`<div class="${s.styles.time}" data-vc="time" role="group" aria-label="${s.labels.selectingTime}"></div>`:"",bu=s=>s.onCreateDateRangeTooltip?`<div class="${s.styles.dateRangeTooltip}" data-vc-date-range-tooltip="hidden"></div>`:"",wu=s=>`<div class="${s.styles.dates}" data-vc="dates" role="grid" aria-live="assertive" aria-label="${s.labels.dates}" ${s.type==="multiple"?"aria-multiselectable":""}></div>`,ku=s=>`<button type="button" class="${s.styles.month}" data-vc="month"></button>`,Cu=s=>`<div class="${s.styles.months}" data-vc="months" role="grid" aria-live="assertive" aria-label="${s.labels.months}"></div>`,_u=s=>`<div class="${s.styles.week}" data-vc="week" role="row" aria-label="${s.labels.week}"></div>`,xu=s=>s.enableWeekNumbers?`<div class="${s.styles.weekNumbers}" data-vc-week="numbers" role="row" aria-label="${s.labels.weekNumber}"></div>`:"",yu=s=>`<button type="button" class="${s.styles.year}" data-vc="year"></button>`,Eu=s=>`<div class="${s.styles.years}" data-vc="years" role="grid" aria-live="assertive" aria-label="${s.labels.years}"></div>`,Su={ArrowNext:gu,ArrowPrev:fu,ControlTime:vu,Dates:wu,DateRangeTooltip:bu,Month:ku,Months:Cu,Week:_u,WeekNumbers:xu,Year:yu,Years:Eu},Tu=s=>Su[s],Qn=(s,e)=>e.replace(/[\n\t]/g,"").replace(/<#(?!\/?Multiple)(.*?)>/g,(t,i)=>{let o=(i.match(/\[(.*?)\]/)||[])[1],r=i.replace(/[/\s\n\t]|\[(.*?)\]/g,""),n=Tu(r),a=n?n(s,o??null):"";return s.sanitizerHTML(a)}).replace(/[\n\t]/g,""),Ou=(s,e)=>e.replace(new RegExp("<#Multiple>(.*?)<#\\/Multiple>","gs"),(t,i)=>{let o=Array(s.context.displayMonthsCount).fill(i).join("");return s.sanitizerHTML(o)}).replace(/[\n\t]/g,""),ha=(s,e)=>{let t={default:hu,month:uu,year:pu,multiple:mu};if(Object.keys(t).forEach(i=>{let o=i;s.layouts[o].length||(s.layouts[o]=t[o](s))}),s.context.mainElement.className=s.styles.calendar,s.context.mainElement.dataset.vc="calendar",s.context.mainElement.dataset.vcType=s.context.currentType,s.context.mainElement.role="application",s.context.mainElement.tabIndex=0,s.context.mainElement.ariaLabel=s.labels.application,s.context.currentType!=="multiple"){if(s.type==="multiple"&&e){let i=s.context.mainElement.querySelector('[data-vc="controls"]'),o=s.context.mainElement.querySelector('[data-vc="grid"]'),r=e.closest('[data-vc="column"]');return i&&s.context.mainElement.removeChild(i),o&&(o.dataset.vcGrid="hidden"),r&&(r.dataset.vcColumn=s.context.currentType),void(r&&(r.innerHTML=s.sanitizerHTML(Qn(s,s.layouts[s.context.currentType]))))}s.context.mainElement.innerHTML=s.sanitizerHTML(Qn(s,s.layouts[s.context.currentType]))}else s.context.mainElement.innerHTML=s.sanitizerHTML(Ou(s,Qn(s,s.layouts[s.context.currentType])))},Sd=(s,e,t,i)=>{s.style.visibility=t?"hidden":"",e.style.visibility=i?"hidden":""},Ru=(s,e,t)=>{let i=te(Oi(new Date(s.context.selectedYear,s.context.selectedMonth,1))),o=new Date(i.getTime()),r=new Date(i.getTime());o.setMonth(o.getMonth()-s.monthsToSwitch),r.setMonth(r.getMonth()+s.monthsToSwitch);let n=te(s.context.dateMin),a=te(s.context.dateMax);s.selectionYearsMode||(n.setFullYear(i.getFullYear()),a.setFullYear(i.getFullYear()));let l=!s.selectionMonthsMode||o.getFullYear()<n.getFullYear()||o.getFullYear()===n.getFullYear()&&o.getMonth()<n.getMonth(),d=!s.selectionMonthsMode||r.getFullYear()>a.getFullYear()||r.getFullYear()===a.getFullYear()&&r.getMonth()>a.getMonth()-(s.context.displayMonthsCount-1);Sd(e,t,l,d)},Au=(s,e,t)=>{let i=te(s.context.dateMin),o=te(s.context.dateMax),r=!!(i.getFullYear()&&s.context.displayYear-7<=i.getFullYear()),n=!!(o.getFullYear()&&s.context.displayYear+7>=o.getFullYear());Sd(e,t,r,n)},Hs=s=>{if(s.context.currentType==="month")return;let e=s.context.mainElement.querySelector('[data-vc-arrow="prev"]'),t=s.context.mainElement.querySelector('[data-vc-arrow="next"]');!e||!t||{default:()=>Ru(s,e,t),year:()=>Au(s,e,t)}[s.context.currentType==="multiple"?"default":s.context.currentType]()},Lu=(s,e,t,i,o)=>{let r=new Date(i.setFullYear(s.context.selectedYear,s.context.selectedMonth+t)).getFullYear(),n=new Date(i.setMonth(s.context.selectedMonth+t)).getMonth(),a=s.context.locale.months.long[n],l=e.closest('[data-vc="column"]');l&&(l.ariaLabel=`${a} ${r}`);let d={month:{id:n,label:a},year:{id:r,label:r}};e.innerText=String(d[o].label),e.dataset[`vc${o.charAt(0).toUpperCase()+o.slice(1)}`]=String(d[o].id),e.ariaLabel=`${s.labels[o]} ${d[o].label}`;let c={month:s.selectionMonthsMode,year:s.selectionYearsMode},h=c[o]===!1||c[o]==="only-arrows";h&&(e.tabIndex=-1),e.disabled=h},Vo=s=>{let e=s.context.mainElement.querySelectorAll('[data-vc="month"]'),t=s.context.mainElement.querySelectorAll('[data-vc="year"]'),i=new Date(s.context.selectedYear,s.context.selectedMonth,1);[e,t].forEach(o=>o?.forEach((r,n)=>Lu(s,r,n,i,r.dataset.vc)))},ua=(s,e,t,i,o)=>{var r;let n={month:"[data-vc-months-month]",year:"[data-vc-years-year]"},a={month:{selected:"data-vc-months-month-selected",aria:"aria-selected",value:"vcMonthsMonth",selectedProperty:"selectedMonth"},year:{selected:"data-vc-years-year-selected",aria:"aria-selected",value:"vcYearsYear",selectedProperty:"selectedYear"}};o&&((r=s.context.mainElement.querySelectorAll(n[t]))==null||r.forEach(l=>{l.removeAttribute(a[t].selected),l.removeAttribute(a[t].aria)}),B(s,a[t].selectedProperty,Number(e.dataset[a[t].value])),Vo(s),t==="year"&&Hs(s)),i&&(e.setAttribute(a[t].selected,""),e.setAttribute(a[t].aria,"true"))},ma=(s,e)=>{var t;if(s.type!=="multiple")return{currentValue:null,columnID:0};let i=s.context.mainElement.querySelectorAll('[data-vc="column"]'),o=Array.from(i).findIndex(r=>r.closest(`[data-vc-column="${e}"]`));return{currentValue:o>=0?Number((t=i[o].querySelector(`[data-vc="${e}"]`))==null?void 0:t.getAttribute(`data-vc-${e}`)):null,columnID:Math.max(o,0)}},Iu=(s,e,t,i,o,r,n)=>{let a=e.cloneNode(!1);return a.className=s.styles.monthsMonth,a.innerText=i,a.ariaLabel=o,a.role="gridcell",a.dataset.vcMonthsMonth=`${n}`,r&&(a.ariaDisabled="true"),r&&(a.tabIndex=-1),a.disabled=r,ua(s,a,"month",t===n,!1),a},Td=(s,e)=>{var t,i;let o=(t=e?.closest('[data-vc="header"]'))==null?void 0:t.querySelector('[data-vc="year"]'),r=o?Number(o.dataset.vcYear):s.context.selectedYear,n=e?.dataset.vcMonth?Number(e.dataset.vcMonth):s.context.selectedMonth;B(s,"currentType","month"),ha(s,e),Vo(s);let a=s.context.mainElement.querySelector('[data-vc="months"]');if(!s.selectionMonthsMode||!a)return;let l=s.monthsToSwitch>1?s.context.locale.months.long.map((c,h)=>n-s.monthsToSwitch*h).concat(s.context.locale.months.long.map((c,h)=>n+s.monthsToSwitch*h)).filter(c=>c>=0&&c<=12):Array.from(Array(12).keys()),d=document.createElement("button");d.type="button";for(let c=0;c<12;c++){let h=te(s.context.dateMin),u=te(s.context.dateMax),m=s.context.displayMonthsCount-1,{columnID:g}=ma(s,"month"),f=r<=h.getFullYear()&&c<h.getMonth()+g||r>=u.getFullYear()&&c>u.getMonth()-m+g||r>u.getFullYear()||c!==n&&!l.includes(c),b=Iu(s,d,n,s.context.locale.months.short[c],s.context.locale.months.long[c],f,c);a.appendChild(b),s.onCreateMonthEls&&s.onCreateMonthEls(s,b)}(i=s.context.mainElement.querySelector("[data-vc-months-month]:not([disabled])"))==null||i.focus()},md=(s,e,t,i,o)=>`
  <label class="${e}" data-vc-time-input="${s}">
    <input type="text" name="${s}" maxlength="2" aria-label="${t[`input${s.charAt(0).toUpperCase()+s.slice(1)}`]}" value="${i}" ${o?"disabled":""}>
  </label>
`,pd=(s,e,t,i,o,r,n)=>`
  <label class="${e}" data-vc-time-range="${s}">
    <input type="range" name="${s}" min="${i}" max="${o}" step="${r}" aria-label="${t[`range${s.charAt(0).toUpperCase()+s.slice(1)}`]}" value="${n}">
  </label>
`,Mo=(s,e,t,i)=>{({hour:()=>B(s,"selectedHours",t),minute:()=>B(s,"selectedMinutes",t)})[i](),B(s,"selectedTime",`${s.context.selectedHours}:${s.context.selectedMinutes}${s.context.selectedKeeping?` ${s.context.selectedKeeping}`:""}`),s.onChangeTime&&s.onChangeTime(s,e,!1),s.inputMode&&s.context.inputElement&&s.context.mainElement&&s.onChangeToInput&&s.onChangeToInput(s,e)},Ds=(s,e)=>{var t;return((t={0:{AM:"00",PM:"12"},1:{AM:"01",PM:"13"},2:{AM:"02",PM:"14"},3:{AM:"03",PM:"15"},4:{AM:"04",PM:"16"},5:{AM:"05",PM:"17"},6:{AM:"06",PM:"18"},7:{AM:"07",PM:"19"},8:{AM:"08",PM:"20"},9:{AM:"09",PM:"21"},10:{AM:"10",PM:"22"},11:{AM:"11",PM:"23"},12:{AM:"00",PM:"12"}}[Number(s)])==null?void 0:t[e])||String(s)},Du=(s,e,t,i,o)=>{let r=n=>{let a=s.context.selectedKeeping==="AM"?"PM":"AM",l=Ds(s.context.selectedHours,a);Number(l)<=i&&Number(l)>=o?(B(s,"selectedKeeping",a),t.value=l,Mo(s,n,s.context.selectedHours,"hour"),e.ariaLabel=`${s.labels.btnKeeping} ${s.context.selectedKeeping}`,e.innerText=s.context.selectedKeeping):s.onChangeTime&&s.onChangeTime(s,n,!0)};return e.addEventListener("click",r),()=>{e.removeEventListener("click",r)}},Po=s=>({0:"12",13:"01",14:"02",15:"03",16:"04",17:"05",18:"06",19:"07",20:"08",21:"09",22:"10",23:"11"})[Number(s)]||String(s),As=(s,e,t,i)=>{s.value=t,e.value=i},Mu=(s,e,t)=>{e&&t&&(B(s,"selectedKeeping",t),e.innerText=t)},gd=(s,e,t,i,o,r,n)=>{let a={hour:(d,c,h)=>{s.selectionTimeMode&&{12:()=>{if(!s.context.selectedKeeping)return;let u=Number(Ds(c,s.context.selectedKeeping));if(!(u<=r&&u>=n))return As(t,e,s.context.selectedHours,s.context.selectedHours),void(s.onChangeTime&&s.onChangeTime(s,h,!0));As(t,e,Po(c),Ds(c,s.context.selectedKeeping)),d>12&&Mu(s,i,"PM"),Mo(s,h,Po(c),o)},24:()=>{if(!(d<=r&&d>=n))return As(t,e,s.context.selectedHours,s.context.selectedHours),void(s.onChangeTime&&s.onChangeTime(s,h,!0));As(t,e,c,c),Mo(s,h,c,o)}}[s.selectionTimeMode]()},minute:(d,c,h)=>{if(!(d<=r&&d>=n))return t.value=s.context.selectedMinutes,void(s.onChangeTime&&s.onChangeTime(s,h,!0));t.value=c,e.value=c,Mo(s,h,c,o)}},l=d=>{let c=Number(t.value),h=t.value.padStart(2,"0");a[o]&&a[o](c,h,d)};return t.addEventListener("change",l),()=>{t.removeEventListener("change",l)}},Pu=(s,e,t,i,o)=>{e.value=o,Mo(s,t,o,i)},Hu=(s,e,t)=>{e&&(B(s,"selectedKeeping",t),e.innerText=t)},fd=(s,e,t,i,o)=>{let r=n=>{let a=Number(e.value),l=e.value.padStart(2,"0"),d=o==="hour",c=s.selectionTimeMode===24,h=a>0&&a<12;d&&!c&&Hu(s,i,a===0||h?"AM":"PM"),Pu(s,t,n,o,!d||c||h?l:Po(e.value))};return e.addEventListener("input",r),()=>{e.removeEventListener("input",r)}},vd=s=>s.setAttribute("data-vc-input-focus",""),bd=s=>s.removeAttribute("data-vc-input-focus"),Vu=(s,e)=>{let t=e.querySelector('[data-vc-time-range="hour"] input[name="hour"]'),i=e.querySelector('[data-vc-time-range="minute"] input[name="minute"]'),o=e.querySelector('[data-vc-time-input="hour"] input[name="hour"]'),r=e.querySelector('[data-vc-time-input="minute"] input[name="minute"]'),n=e.querySelector('[data-vc-time="keeping"]');if(!(t&&i&&o&&r))return;let a=d=>{d.target===t&&vd(o),d.target===i&&vd(r)},l=d=>{d.target===t&&bd(o),d.target===i&&bd(r)};return e.addEventListener("mouseover",a),e.addEventListener("mouseout",l),gd(s,t,o,n,"hour",s.timeMaxHour,s.timeMinHour),gd(s,i,r,n,"minute",s.timeMaxMinute,s.timeMinMinute),fd(s,t,o,n,"hour"),fd(s,i,r,n,"minute"),n&&Du(s,n,t,s.timeMaxHour,s.timeMinHour),()=>{e.removeEventListener("mouseover",a),e.removeEventListener("mouseout",l)}},Fu=s=>{let e=s.context.mainElement.querySelector('[data-vc="time"]');if(!s.selectionTimeMode||!e)return;let[t,i]=[s.timeMinHour,s.timeMaxHour],[o,r]=[s.timeMinMinute,s.timeMaxMinute],n=s.context.selectedKeeping?Ds(s.context.selectedHours,s.context.selectedKeeping):s.context.selectedHours,a=s.timeControls==="range";var l;e.innerHTML=s.sanitizerHTML(`
    <div class="${s.styles.timeContent}" data-vc-time="content">
      ${md("hour",s.styles.timeHour,s.labels,s.context.selectedHours,a)}
      ${md("minute",s.styles.timeMinute,s.labels,s.context.selectedMinutes,a)}
      ${s.selectionTimeMode===12?(l=s.context.selectedKeeping,`<button type="button" class="${s.styles.timeKeeping}" aria-label="${s.labels.btnKeeping} ${l}" data-vc-time="keeping" ${a?"disabled":""}>${l}</button>`):""}
    </div>
    <div class="${s.styles.timeRanges}" data-vc-time="ranges">
      ${pd("hour",s.styles.timeRange,s.labels,t,i,s.timeStepHour,n)}
      ${pd("minute",s.styles.timeRange,s.labels,o,r,s.timeStepMinute,s.context.selectedMinutes)}
    </div>
  `),Vu(s,e)},wd=s=>{let e=s.selectedWeekends?[...s.selectedWeekends]:[],t=[...s.context.locale.weekdays.long].reduce((o,r,n)=>[...o,{id:n,titleShort:s.context.locale.weekdays.short[n],titleLong:r,isWeekend:e.includes(n)}],[]),i=[...t.slice(s.firstWeekday),...t.slice(0,s.firstWeekday)];s.context.mainElement.querySelectorAll('[data-vc="week"]').forEach(o=>{let r=s.onClickWeekDay?document.createElement("button"):document.createElement("b");s.onClickWeekDay&&(r.type="button"),i.forEach(n=>{let a=r.cloneNode(!0);a.innerText=n.titleShort,a.className=s.styles.weekDay,a.role="columnheader",a.ariaLabel=n.titleLong,a.dataset.vcWeekDay=String(n.id),n.isWeekend&&(a.dataset.vcWeekDayOff=""),o.appendChild(a)})})},Nu=(s,e,t,i,o)=>{let r=e.cloneNode(!1);return r.className=s.styles.yearsYear,r.innerText=String(o),r.ariaLabel=String(o),r.role="gridcell",r.dataset.vcYearsYear=`${o}`,i&&(r.ariaDisabled="true"),i&&(r.tabIndex=-1),r.disabled=i,ua(s,r,"year",t===o,!1),r},pa=(s,e)=>{var t;let i=e?.dataset.vcYear?Number(e.dataset.vcYear):s.context.selectedYear;B(s,"currentType","year"),ha(s,e),Vo(s),Hs(s);let o=s.context.mainElement.querySelector('[data-vc="years"]');if(!s.selectionYearsMode||!o)return;let r=s.type!=="multiple"||s.context.selectedYear===i?0:1,n=document.createElement("button");n.type="button";for(let a=s.context.displayYear-7;a<s.context.displayYear+8;a++){let l=a<te(s.context.dateMin).getFullYear()+r||a>te(s.context.dateMax).getFullYear(),d=Nu(s,n,i,l,a);o.appendChild(d),s.onCreateYearEls&&s.onCreateYearEls(s,d)}(t=s.context.mainElement.querySelector("[data-vc-years-year]:not([disabled])"))==null||t.focus()},zu=(s,e,t)=>{new MutationObserver(i=>{for(let o=0;o<i.length;o++)if(i[o].attributeName===e){t();break}}).observe(s,{attributes:!0})},Ms={value:!1,set:()=>Ms.value=!0,check:()=>Ms.value},qi=(s,e)=>s.dataset.vcTheme=e,kd=(s,e)=>{if(qi(s.context.mainElement,e.matches?"dark":"light"),s.selectedTheme!=="system"||Ms.check())return;let t=i=>{let o=document.querySelectorAll('[data-vc="calendar"]');o?.forEach(r=>qi(r,i.matches?"dark":"light"))};e.addEventListener?e.addEventListener("change",t):e.addListener(t),Ms.set()},Bu=(s,e)=>{let t=s.themeAttrDetect.length?document.querySelector(s.themeAttrDetect):null,i=s.themeAttrDetect.replace(/^.*\[(.+)\]/g,(r,n)=>n);if(!t||t.getAttribute(i)==="system")return void kd(s,e);let o=t.getAttribute(i);o?(qi(s.context.mainElement,o),zu(t,i,()=>{let r=t.getAttribute(i);r&&qi(s.context.mainElement,r)})):kd(s,e)},$u=s=>{window.matchMedia("(prefers-color-scheme)").media!=="not all"?s.selectedTheme==="system"?Bu(s,window.matchMedia("(prefers-color-scheme: dark)")):qi(s.context.mainElement,s.selectedTheme):qi(s.context.mainElement,"light")},Ps=s=>s.charAt(0).toUpperCase()+s.slice(1).replace(/\./,""),Wu=(s,e,t)=>{let i=new Date(`1978-01-0${e+1}T00:00:00.000Z`),o=i.toLocaleString(t,{weekday:"short",timeZone:"UTC"}),r=i.toLocaleString(t,{weekday:"long",timeZone:"UTC"});s.context.locale.weekdays.short.push(Ps(o)),s.context.locale.weekdays.long.push(Ps(r))},Gu=(s,e,t)=>{let i=new Date(`1978-${String(e+1).padStart(2,"0")}-01T00:00:00.000Z`),o=i.toLocaleString(t,{month:"short",timeZone:"UTC"}),r=i.toLocaleString(t,{month:"long",timeZone:"UTC"});s.context.locale.months.short.push(Ps(o)),s.context.locale.months.long.push(Ps(r))},Uu=s=>{var e,t,i,o,r,n,a,l;if(!(s.context.locale.weekdays.short[6]&&s.context.locale.weekdays.long[6]&&s.context.locale.months.short[11]&&s.context.locale.months.long[11]))if(typeof s.locale=="string"){if(typeof s.locale=="string"&&!s.locale.length)throw new Error(li.notLocale);Array.from({length:7},(d,c)=>Wu(s,c,s.locale)),Array.from({length:12},(d,c)=>Gu(s,c,s.locale))}else{if(!((t=(e=s.locale)==null?void 0:e.weekdays)!=null&&t.short[6]&&((o=(i=s.locale)==null?void 0:i.weekdays)!=null&&o.long[6])&&((n=(r=s.locale)==null?void 0:r.months)!=null&&n.short[11])&&((l=(a=s.locale)==null?void 0:a.months)!=null&&l.long[11])))throw new Error(li.notLocale);B(s,"locale",Yi({},s.locale))}},Vs=s=>{let e={default:()=>{wd(s),ia(s)},multiple:()=>{wd(s),ia(s)},month:()=>Td(s),year:()=>pa(s)};$u(s),Uu(s),ha(s),Vo(s),Hs(s),Fu(s),e[s.context.currentType]()},Od=s=>{let e=t=>{var i;let o=t.target;if(!["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)||o.localName!=="button")return;let r=Array.from(s.context.mainElement.querySelectorAll('[data-vc="calendar"] button')),n=r.indexOf(o);if(n===-1)return;let a=(l=r[n]).hasAttribute("data-vc-date-btn")?7:l.hasAttribute("data-vc-months-month")?4:l.hasAttribute("data-vc-years-year")?5:1;var l;let d=(0,{ArrowUp:()=>Math.max(0,n-a),ArrowDown:()=>Math.min(r.length-1,n+a),ArrowLeft:()=>Math.max(0,n-1),ArrowRight:()=>Math.min(r.length-1,n+1)}[t.key])();(i=r[d])==null||i.focus()};return s.context.mainElement.addEventListener("keydown",e),()=>s.context.mainElement.removeEventListener("keydown",e)},oa=(s,e)=>{let t=te(Oi(new Date(s.context.selectedYear,s.context.selectedMonth,1)));({prev:()=>t.setMonth(t.getMonth()-s.monthsToSwitch),next:()=>t.setMonth(t.getMonth()+s.monthsToSwitch)})[e](),B(s,"selectedMonth",t.getMonth()),B(s,"selectedYear",t.getFullYear()),Vo(s),Hs(s),ia(s)},ju=(s,e)=>{let t=e.target.closest("[data-vc-arrow]");if(t){if(["default","multiple"].includes(s.context.currentType))oa(s,t.dataset.vcArrow);else if(s.context.currentType==="year"&&s.context.displayYear!==void 0){let i={prev:-15,next:15}[t.dataset.vcArrow];B(s,"displayYear",s.context.displayYear+i),pa(s,e.target)}s.onClickArrow&&s.onClickArrow(s,e)}},sa=s=>s.enableDateToggle===void 0||(typeof s.enableDateToggle=="function"?s.enableDateToggle(s):s.enableDateToggle),Cd=(s,e,t)=>{let i=e.dataset.vcDate,o=e.closest("[data-vc-date][data-vc-date-selected]"),r=sa(s);if(o&&!r)return;let n=o?s.context.selectedDates.filter(a=>a!==i):t?[...s.context.selectedDates,i]:[i];B(s,"selectedDates",n)},Yt=(s,e,t)=>{if(!e)return;if(!t)return e.dataset.vcDateRangeTooltip="hidden",void(e.textContent="");let i=s.context.mainElement.getBoundingClientRect(),o=t.getBoundingClientRect();e.style.left=o.left-i.left+o.width/2+"px",e.style.top=o.bottom-i.top-o.height+"px",e.dataset.vcDateRangeTooltip="visible",e.innerHTML=s.sanitizerHTML(s.onCreateDateRangeTooltip(s,t,e,o,i))},A={self:null,lastDateEl:null,isHovering:!1,rangeMin:void 0,rangeMax:void 0,tooltipEl:null,timeoutId:null},Yu=(s,e,t)=>{var i,o,r;if(!((o=(i=A.self)==null?void 0:i.context)!=null&&o.selectedDates[0]))return;let n=Oi(s);(r=A.self.context.disableDates)!=null&&r.includes(n)||(A.self.context.mainElement.querySelectorAll(`[data-vc-date="${n}"]`).forEach(a=>a.dataset.vcDateHover=""),e.forEach(a=>a.dataset.vcDateHover="first"),t.forEach(a=>{a.dataset.vcDateHover==="first"?a.dataset.vcDateHover="first-and-last":a.dataset.vcDateHover="last"}))},Ho=()=>{var s,e;(e=(s=A.self)==null?void 0:s.context)!=null&&e.mainElement&&A.self.context.mainElement.querySelectorAll("[data-vc-date-hover]").forEach(t=>t.removeAttribute("data-vc-date-hover"))},qu=s=>{var e,t;if(!s||!((t=(e=A.self)==null?void 0:e.context)!=null&&t.selectedDates[0]))return;if(!s.closest('[data-vc="dates"]'))return A.lastDateEl=null,Yt(A.self,A.tooltipEl,null),void Ho();let i=s.closest("[data-vc-date]");if(!i||A.lastDateEl===i)return;A.lastDateEl=i,Yt(A.self,A.tooltipEl,i),Ho();let o=i.dataset.vcDate,r=te(A.self.context.selectedDates[0]),n=te(o),a=A.self.context.mainElement.querySelectorAll(`[data-vc-date="${A.self.context.selectedDates[0]}"]`),l=A.self.context.mainElement.querySelectorAll(`[data-vc-date="${o}"]`),[d,c]=r<n?[a,l]:[l,a],[h,u]=r<n?[r,n]:[n,r];for(let m=new Date(h);m<=u;m.setDate(m.getDate()+1))Yu(m,d,c)},Ku=s=>{let e=s?.closest("[data-vc-date-selected]");if(!e&&A.lastDateEl)return A.lastDateEl=null,void Yt(A.self,A.tooltipEl,null);e&&A.lastDateEl!==e&&(A.lastDateEl=e,Yt(A.self,A.tooltipEl,e))},Rd=s=>e=>{let t=e.target;A.isHovering||(A.isHovering=!0,requestAnimationFrame(()=>{s(t),A.isHovering=!1}))},Is=Rd(qu),Ls=Rd(Ku),Do=s=>{A.self&&s.key==="Escape"&&(A.lastDateEl=null,B(A.self,"selectedDates",[]),A.self.context.mainElement.removeEventListener("mousemove",Is),A.self.context.mainElement.removeEventListener("keydown",Do),Yt(A.self,A.tooltipEl,null),Ho())},Si=()=>{A.timeoutId!==null&&clearTimeout(A.timeoutId),A.timeoutId=setTimeout(()=>{A.lastDateEl=null,Yt(A.self,A.tooltipEl,null),Ho()},50)},Xu=()=>{var s,e,t,i;if(!((t=(e=(s=A.self)==null?void 0:s.context)==null?void 0:e.selectedDates)!=null&&t[0])||!((i=A.self.context.disableDates)!=null&&i[0]))return;let o=te(A.self.context.selectedDates[0]),[r,n]=A.self.context.disableDates.map(a=>te(a)).reduce(([a,l],d)=>[o>=d?d:a,o<d&&l===null?d:l],[null,null]);r&&B(A.self,"displayDateMin",Oi(new Date(r.setDate(r.getDate()+1)))),n&&B(A.self,"displayDateMax",Oi(new Date(n.setDate(n.getDate()-1)))),A.self.disableDatesPast&&!A.self.disableAllDates&&te(A.self.context.displayDateMin)<te(A.self.context.dateToday)&&B(A.self,"displayDateMin",A.self.context.dateToday)},Ad=(s,e)=>{A.self=s,A.lastDateEl=e,Ho(),s.disableDatesGaps&&(A.rangeMin=A.rangeMin?A.rangeMin:s.context.displayDateMin,A.rangeMax=A.rangeMax?A.rangeMax:s.context.displayDateMax),s.onCreateDateRangeTooltip&&(A.tooltipEl=s.context.mainElement.querySelector("[data-vc-date-range-tooltip]"));let t=e?.dataset.vcDate;if(t){let i=s.context.selectedDates.length===1&&s.context.selectedDates[0].includes(t),o=i&&!sa(s)?[t,t]:i&&sa(s)?[]:s.context.selectedDates.length>1?[t]:[...s.context.selectedDates,t];B(s,"selectedDates",o),s.context.selectedDates.length>1&&s.context.selectedDates.sort((r,n)=>+new Date(r)-+new Date(n))}({set:()=>(s.disableDatesGaps&&Xu(),Yt(A.self,A.tooltipEl,e),A.self.context.mainElement.removeEventListener("mousemove",Ls),A.self.context.mainElement.removeEventListener("mouseleave",Si),A.self.context.mainElement.removeEventListener("keydown",Do),A.self.context.mainElement.addEventListener("mousemove",Is),A.self.context.mainElement.addEventListener("mouseleave",Si),A.self.context.mainElement.addEventListener("keydown",Do),()=>{A.self.context.mainElement.removeEventListener("mousemove",Is),A.self.context.mainElement.removeEventListener("mouseleave",Si),A.self.context.mainElement.removeEventListener("keydown",Do)}),reset:()=>{let[i,o]=[s.context.selectedDates[0],s.context.selectedDates[s.context.selectedDates.length-1]],r=s.context.selectedDates[0]!==s.context.selectedDates[s.context.selectedDates.length-1],n=qt([`${i}:${o}`]).filter(l=>!s.context.disableDates.includes(l)),a=r?s.enableEdgeDatesOnly?[i,o]:n:[s.context.selectedDates[0],s.context.selectedDates[0]];if(B(s,"selectedDates",a),s.disableDatesGaps&&(B(s,"displayDateMin",A.rangeMin),B(s,"displayDateMax",A.rangeMax)),A.self.context.mainElement.removeEventListener("mousemove",Is),A.self.context.mainElement.removeEventListener("mouseleave",Si),A.self.context.mainElement.removeEventListener("keydown",Do),s.onCreateDateRangeTooltip)return s.context.selectedDates[0]||(A.self.context.mainElement.removeEventListener("mousemove",Ls),A.self.context.mainElement.removeEventListener("mouseleave",Si),Yt(A.self,A.tooltipEl,null)),s.context.selectedDates[0]&&(A.self.context.mainElement.addEventListener("mousemove",Ls),A.self.context.mainElement.addEventListener("mouseleave",Si),Yt(A.self,A.tooltipEl,e)),()=>{A.self.context.mainElement.removeEventListener("mousemove",Ls),A.self.context.mainElement.removeEventListener("mouseleave",Si)}}})[s.context.selectedDates.length===1?"set":"reset"]()},Jn=s=>{s.context.mainElement.querySelectorAll("[data-vc-date]").forEach(e=>{let t=e.querySelector("[data-vc-date-btn]"),i=e.dataset.vcDate,o=te(i).getDay();yd(s,s.context.selectedYear,e,t,o,i,"current")})},Zu=(s,e)=>{var t;let i=e.target,o=i.closest("[data-vc-date-btn]");if(!s.selectionDatesMode||!["single","multiple","multiple-ranged"].includes(s.selectionDatesMode)||!o)return;let r=o.closest("[data-vc-date]");({single:()=>Cd(s,r,!1),multiple:()=>Cd(s,r,!0),"multiple-ranged":()=>Ad(s,r)})[s.selectionDatesMode](),(t=s.context.selectedDates)==null||t.sort((l,d)=>+new Date(l)-+new Date(d)),s.onClickDate&&s.onClickDate(s,e),s.inputMode&&s.context.inputElement&&s.context.mainElement&&s.onChangeToInput&&s.onChangeToInput(s,e);let n=i.closest('[data-vc-date-month="prev"]'),a=i.closest('[data-vc-date-month="next"]');({prev:()=>s.enableMonthChangeOnDayClick?oa(s,"prev"):Jn(s),next:()=>s.enableMonthChangeOnDayClick?oa(s,"next"):Jn(s),current:()=>Jn(s)})[n?"prev":a?"next":"current"]()},Qu=["month","year"],Ld=(s,e,t)=>{let{currentValue:i,columnID:o}=ma(s,e);return s.context.currentType==="month"&&o>=0?t-o:s.context.currentType==="year"&&s.context.selectedYear!==i?t-1:t},Ju=(s,e)=>{let t=Ld(s,"year",Number(e.dataset.vcYearsYear)),i=te(s.context.dateMin),o=te(s.context.dateMax),r=s.context.displayMonthsCount-1,{columnID:n}=ma(s,"year"),a=s.context.selectedMonth<i.getMonth()&&t<=i.getFullYear(),l=s.context.selectedMonth>o.getMonth()-r+n&&t>=o.getFullYear(),d=t<i.getFullYear(),c=t>o.getFullYear(),h=a||d?i.getFullYear():l||c?o.getFullYear():t,u=a||d?i.getMonth():l||c?o.getMonth()-r+n:s.context.selectedMonth;B(s,"selectedYear",h),B(s,"selectedMonth",u)},em=(s,e)=>{let t=e.closest('[data-vc-column="month"]').querySelector('[data-vc="year"]'),i=Ld(s,"month",Number(e.dataset.vcMonthsMonth)),o=Number(t.dataset.vcYear),r=te(s.context.dateMin),n=te(s.context.dateMax),a=i<r.getMonth()&&o<=r.getFullYear(),l=i>n.getMonth()&&o>=n.getFullYear();B(s,"selectedYear",o),B(s,"selectedMonth",a?r.getMonth():l?n.getMonth():i)},tm=(s,e,t,i)=>{var o;({year:()=>{if(s.type==="multiple")return Ju(s,i);B(s,"selectedYear",Number(i.dataset.vcYearsYear))},month:()=>{if(s.type==="multiple")return em(s,i);B(s,"selectedMonth",Number(i.dataset.vcMonthsMonth))}})[t](),{year:()=>{var r;return(r=s.onClickYear)==null?void 0:r.call(s,s,e)},month:()=>{var r;return(r=s.onClickMonth)==null?void 0:r.call(s,s,e)}}[t](),s.context.currentType!==s.type?(B(s,"currentType",s.type),Vs(s),(o=s.context.mainElement.querySelector(`[data-vc="${t}"]`))==null||o.focus()):ua(s,i,t,!0,!0)},im=(s,e,t)=>{var i;let o=e.target,r=o.closest(`[data-vc="${t}"]`),n={year:()=>pa(s,o),month:()=>Td(s,o)};if(r&&s.onClickTitle&&s.onClickTitle(s,e),r&&s.context.currentType!==t)return n[t]();let a=o.closest(`[data-vc-${t}s-${t}]`);if(a)return tm(s,e,t,a);let l=o.closest('[data-vc="grid"]'),d=o.closest('[data-vc="column"]');(s.context.currentType===t&&r||s.type==="multiple"&&s.context.currentType===t&&l&&!d)&&(B(s,"currentType",s.type),Vs(s),(i=s.context.mainElement.querySelector(`[data-vc="${t}"]`))==null||i.focus())},om=(s,e)=>{let t={month:s.selectionMonthsMode,year:s.selectionYearsMode};Qu.forEach(i=>{t[i]&&e.target&&im(s,e,i)})},sm=(s,e)=>{if(!s.enableWeekNumbers||!s.onClickWeekNumber)return;let t=e.target.closest("[data-vc-week-number]"),i=s.context.mainElement.querySelectorAll("[data-vc-date-week-number]");if(!t||!i[0])return;let o=Number(t.innerText),r=Number(t.dataset.vcWeekYear),n=Array.from(i).filter(a=>Number(a.dataset.vcDateWeekNumber)===o);s.onClickWeekNumber(s,o,r,n,e)},rm=(s,e)=>{if(!s.onClickWeekDay)return;let t=e.target.closest("[data-vc-week-day]"),i=e.target.closest('[data-vc="column"]'),o=i?i.querySelectorAll("[data-vc-date-week-day]"):s.context.mainElement.querySelectorAll("[data-vc-date-week-day]");if(!t||!o[0])return;let r=Number(t.dataset.vcWeekDay),n=Array.from(o).filter(a=>Number(a.dataset.vcDateWeekDay)===r);s.onClickWeekDay(s,r,n,e)},Id=s=>{let e=t=>{ju(s,t),rm(s,t),sm(s,t),Zu(s,t),om(s,t)};return s.context.mainElement.addEventListener("click",e),()=>s.context.mainElement.removeEventListener("click",e)},nm=s=>{if(s.type==="multiple"&&(s.displayMonthsCount<=1||s.displayMonthsCount>12))throw new Error(li.incorrectMonthsCount);if(s.type!=="multiple"&&s.displayMonthsCount>1)throw new Error(li.incorrectMonthsCount);B(s,"displayMonthsCount",s.displayMonthsCount?s.displayMonthsCount:s.type==="multiple"?2:1)},am=()=>{let s=new Date;return new Date(s.getTime()-6e4*s.getTimezoneOffset()).toISOString().substring(0,10)},Ti=(s,e)=>s==="today"?am():s instanceof Date||typeof s=="number"||typeof s=="string"?qt([s])[0]:e,lm=s=>{var e,t,i;let o=Ti(s.dateMin,s.dateMin),r=Ti(s.dateMax,s.dateMax),n=Ti(s.displayDateMin,o),a=Ti(s.displayDateMax,r);B(s,"dateToday",Ti(s.dateToday,s.dateToday)),B(s,"displayDateMin",n?te(o)>=te(n)?o:n:o),B(s,"displayDateMax",a?te(r)<=te(a)?r:a:r);let l=s.disableDatesPast&&!s.disableAllDates&&te(n)<te(s.context.dateToday);B(s,"displayDateMin",l||s.disableAllDates?s.context.dateToday:n),B(s,"displayDateMax",s.disableAllDates?s.context.dateToday:a),B(s,"disableDates",s.disableDates[0]&&!s.disableAllDates?qt(s.disableDates):s.disableAllDates?[s.context.displayDateMin]:[]),s.context.disableDates.length>1&&s.context.disableDates.sort((d,c)=>+new Date(d)-+new Date(c)),B(s,"enableDates",s.enableDates[0]?qt(s.enableDates):[]),(e=s.context.enableDates)!=null&&e[0]&&((t=s.context.disableDates)!=null&&t[0])&&B(s,"disableDates",s.context.disableDates.filter(d=>!s.context.enableDates.includes(d))),s.context.enableDates.length>1&&s.context.enableDates.sort((d,c)=>+new Date(d)-+new Date(c)),(i=s.context.enableDates)!=null&&i[0]&&s.disableAllDates&&(B(s,"displayDateMin",s.context.enableDates[0]),B(s,"displayDateMax",s.context.enableDates[s.context.enableDates.length-1])),B(s,"dateMin",s.displayDisabledDates?o:s.context.displayDateMin),B(s,"dateMax",s.displayDisabledDates?r:s.context.displayDateMax)},dm=s=>{var e;B(s,"selectedDates",(e=s.selectedDates)!=null&&e[0]?qt(s.selectedDates):[])},cm=s=>{let e=o=>{let r=new Date(o);ra(s,r.getMonth(),r.getFullYear())};if(s.displayDateMin&&s.displayDateMin!=="today"&&(t=s.displayDateMin,i=new Date,new Date(t).getTime()>i.getTime())){let o=s.selectedDates.length&&s.selectedDates[0]?qt(s.selectedDates)[0]:s.displayDateMin;return e(te(Ti(o,s.displayDateMin))),!0}var t,i;if(s.displayDateMax&&s.displayDateMax!=="today"&&((o,r)=>new Date(o).getTime()<r.getTime())(s.displayDateMax,new Date)){let o=s.selectedDates.length&&s.selectedDates[0]?qt(s.selectedDates)[0]:s.displayDateMax;return e(te(Ti(o,s.displayDateMax))),!0}return!1},ra=(s,e,t)=>{B(s,"selectedMonth",e),B(s,"selectedYear",t),B(s,"displayYear",t)},hm=s=>{var e;if(s.enableJumpToSelectedDate&&((e=s.selectedDates)!=null&&e[0])&&s.selectedMonth===void 0&&s.selectedYear===void 0){let o=te(qt(s.selectedDates)[0]);return void ra(s,o.getMonth(),o.getFullYear())}if(cm(s))return;let t=s.selectedMonth!==void 0&&Number(s.selectedMonth)>=0&&Number(s.selectedMonth)<12,i=s.selectedYear!==void 0&&Number(s.selectedYear)>=0&&Number(s.selectedYear)<=9999;ra(s,t?Number(s.selectedMonth):te(s.context.dateToday).getMonth(),i?Number(s.selectedYear):te(s.context.dateToday).getFullYear())},um=s=>{var e,t,i;if(!s.selectionTimeMode)return;if(![12,24].includes(s.selectionTimeMode))throw new Error(li.incorrectTime);let o=s.selectionTimeMode===12,r=o?/^(0[1-9]|1[0-2]):([0-5][0-9]) ?(AM|PM)?$/i:/^([0-1]?[0-9]|2[0-3]):([0-5][0-9])$/,[n,a,l]=(i=(t=(e=s.selectedTime)==null?void 0:e.match(r))==null?void 0:t.slice(1))!=null?i:[];n?o&&!l&&(l="AM"):(n=o?Po(String(s.timeMinHour)):String(s.timeMinHour),a=String(s.timeMinMinute),l=o?Number(Po(String(s.timeMinHour)))>=12?"PM":"AM":null),B(s,"selectedHours",n.padStart(2,"0")),B(s,"selectedMinutes",a.padStart(2,"0")),B(s,"selectedKeeping",l),B(s,"selectedTime",`${s.context.selectedHours}:${s.context.selectedMinutes}${l?` ${l}`:""}`)},Dd=s=>{B(s,"currentType",s.type),nm(s),lm(s),hm(s),dm(s),um(s)},Md=(s,{year:e,month:t,dates:i,time:o,locale:r},n=!0)=>{var a;let l={year:s.selectedYear,month:s.selectedMonth,dates:s.selectedDates,time:s.selectedTime};s.selectedYear=e?l.year:s.context.selectedYear,s.selectedMonth=t?l.month:s.context.selectedMonth,s.selectedTime=o?l.time:s.context.selectedTime,s.selectedDates=i==="only-first"&&((a=s.context.selectedDates)!=null&&a[0])?[s.context.selectedDates[0]]:i===!0?l.dates:s.context.selectedDates,r&&B(s,"locale",{months:{short:[],long:[]},weekdays:{short:[],long:[]}}),Dd(s),n&&Vs(s),s.selectedYear=l.year,s.selectedMonth=l.month,s.selectedDates=l.dates,s.selectedTime=l.time,s.selectionDatesMode==="multiple-ranged"&&i&&Ad(s,null)},mm=s=>{let e=document.createElement("div");return e.className=s.styles.calendar,e.dataset.vc="calendar",e.dataset.vcInput="",e.dataset.vcCalendarHidden="",B(s,"inputModeInit",!0),B(s,"isShowInInputMode",!1),B(s,"mainElement",e),document.body.appendChild(s.context.mainElement),Md(s,{year:!0,month:!0,dates:!0,time:!0,locale:!0}),setTimeout(()=>fa(s)),s.onInit&&s.onInit(s),Od(s),Id(s)},pm=s=>{B(s,"inputElement",s.context.mainElement);let e=()=>{s.context.inputModeInit?setTimeout(()=>fa(s)):mm(s)};return s.context.inputElement.addEventListener("click",e),s.context.inputElement.addEventListener("focus",e),()=>{s.context.inputElement.removeEventListener("click",e),s.context.inputElement.removeEventListener("focus",e)}},gm=s=>(B(s,"originalElement",s.context.mainElement.cloneNode(!0)),B(s,"isInit",!0),s.inputMode?pm(s):(Dd(s),Vs(s),s.onInit&&s.onInit(s),Od(s),Id(s))),Pd=(s,e)=>{if(!s.context.isInit)throw new Error(li.notInit);Md(s,Yi(Yi({},{year:!0,month:!0,dates:!0,time:!0,locale:!0}),e),!(s.inputMode&&!s.context.inputModeInit)),s.onUpdate&&s.onUpdate(s)},ga=(s,e)=>{let t=Object.keys(e);for(let i=0;i<t.length;i++){let o=t[i];typeof s[o]!="object"||typeof e[o]!="object"||e[o]instanceof Date||Array.isArray(e[o])?e[o]!==void 0&&(s[o]=e[o]):ga(s[o],e[o])}},fm=(s,e,t)=>{ga(s,e),s.context.isInit&&Pd(s,t)};function vm(s,e){let t="left";if(!e||!s)return t;let{canShow:i,parentPositions:o}=xd(s,e),r=i.left&&i.right;return(r&&i.bottom?"center":r&&i.top?["top","center"]:Array.isArray(o)?[o[0]==="bottom"?"top":"bottom",...o.slice(1)]:o)||t}var _d=(s,e,t)=>{if(!s)return;let i=t==="auto"?vm(s,e):t,o={top:-e.offsetHeight,bottom:s.offsetHeight,left:0,center:s.offsetWidth/2-e.offsetWidth/2,right:s.offsetWidth-e.offsetWidth},r=Array.isArray(i)?i[0]:"bottom",n=Array.isArray(i)?i[1]:i;e.dataset.vcPosition=r;let{top:a,left:l}=la(s),d=a+o[r],c=l+o[n],{vw:h}=da();if(c+e.clientWidth>h){let u=window.innerWidth-document.body.clientWidth;c=h-e.clientWidth-u}else c<0&&(c=0);Object.assign(e.style,{left:`${c}px`,top:`${d}px`})},fa=s=>{if(s.context.isShowInInputMode)return;if(!s.context.currentType)return void s.context.mainElement.click();B(s,"cleanupHandlers",[]),B(s,"isShowInInputMode",!0),_d(s.context.inputElement,s.context.mainElement,s.positionToInput),s.context.mainElement.removeAttribute("data-vc-calendar-hidden");let e=()=>{_d(s.context.inputElement,s.context.mainElement,s.positionToInput)};window.addEventListener("resize",e),s.context.cleanupHandlers.push(()=>window.removeEventListener("resize",e));let t=o=>{o.key==="Escape"&&ta(s)};document.addEventListener("keydown",t),s.context.cleanupHandlers.push(()=>document.removeEventListener("keydown",t));let i=o=>{o.target===s.context.inputElement||s.context.mainElement.contains(o.target)||ta(s)};document.addEventListener("click",i,{capture:!0}),s.context.cleanupHandlers.push(()=>document.removeEventListener("click",i,{capture:!0})),s.onShow&&s.onShow(s)},bm={application:"Calendar",navigation:"Calendar Navigation",arrowNext:{month:"Next month",year:"Next list of years"},arrowPrev:{month:"Previous month",year:"Previous list of years"},month:"Select month, current selected month:",months:"List of months",year:"Select year, current selected year:",years:"List of years",week:"Days of the week",weekNumber:"Numbers of weeks in a year",dates:"Dates in the current month",selectingTime:"Selecting a time ",inputHour:"Hours",inputMinute:"Minutes",rangeHour:"Slider for selecting hours",rangeMinute:"Slider for selecting minutes",btnKeeping:"Switch AM/PM, current position:"},wm={calendar:"vc",controls:"vc-controls",grid:"vc-grid",column:"vc-column",header:"vc-header",headerContent:"vc-header__content",month:"vc-month",year:"vc-year",arrowPrev:"vc-arrow vc-arrow_prev",arrowNext:"vc-arrow vc-arrow_next",wrapper:"vc-wrapper",content:"vc-content",months:"vc-months",monthsMonth:"vc-months__month",years:"vc-years",yearsYear:"vc-years__year",week:"vc-week",weekDay:"vc-week__day",weekNumbers:"vc-week-numbers",weekNumbersTitle:"vc-week-numbers__title",weekNumbersContent:"vc-week-numbers__content",weekNumber:"vc-week-number",dates:"vc-dates",date:"vc-date",dateBtn:"vc-date__btn",datePopup:"vc-date__popup",dateRangeTooltip:"vc-date-range-tooltip",time:"vc-time",timeContent:"vc-time__content",timeHour:"vc-time__hour",timeMinute:"vc-time__minute",timeKeeping:"vc-time__keeping",timeRanges:"vc-time__ranges",timeRange:"vc-time__range"},na=class{constructor(){H(this,"type","default"),H(this,"inputMode",!1),H(this,"positionToInput","left"),H(this,"firstWeekday",1),H(this,"monthsToSwitch",1),H(this,"themeAttrDetect","html[data-theme]"),H(this,"locale","en"),H(this,"dateToday","today"),H(this,"dateMin","1970-01-01"),H(this,"dateMax","2470-12-31"),H(this,"displayDateMin"),H(this,"displayDateMax"),H(this,"displayDatesOutside",!0),H(this,"displayDisabledDates",!1),H(this,"displayMonthsCount"),H(this,"disableDates",[]),H(this,"disableAllDates",!1),H(this,"disableDatesPast",!1),H(this,"disableDatesGaps",!1),H(this,"disableWeekdays",[]),H(this,"disableToday",!1),H(this,"enableDates",[]),H(this,"enableEdgeDatesOnly",!0),H(this,"enableDateToggle",!0),H(this,"enableWeekNumbers",!1),H(this,"enableMonthChangeOnDayClick",!0),H(this,"enableJumpToSelectedDate",!1),H(this,"selectionDatesMode","single"),H(this,"selectionMonthsMode",!0),H(this,"selectionYearsMode",!0),H(this,"selectionTimeMode",!1),H(this,"selectedDates",[]),H(this,"selectedMonth"),H(this,"selectedYear"),H(this,"selectedHolidays",[]),H(this,"selectedWeekends",[0,6]),H(this,"selectedTime"),H(this,"selectedTheme","system"),H(this,"timeMinHour",0),H(this,"timeMaxHour",23),H(this,"timeMinMinute",0),H(this,"timeMaxMinute",59),H(this,"timeControls","all"),H(this,"timeStepHour",1),H(this,"timeStepMinute",1),H(this,"sanitizerHTML",e=>e),H(this,"onClickDate"),H(this,"onClickWeekDay"),H(this,"onClickWeekNumber"),H(this,"onClickTitle"),H(this,"onClickMonth"),H(this,"onClickYear"),H(this,"onClickArrow"),H(this,"onChangeTime"),H(this,"onChangeToInput"),H(this,"onCreateDateRangeTooltip"),H(this,"onCreateDateEls"),H(this,"onCreateMonthEls"),H(this,"onCreateYearEls"),H(this,"onInit"),H(this,"onUpdate"),H(this,"onDestroy"),H(this,"onShow"),H(this,"onHide"),H(this,"popups",{}),H(this,"labels",Yi({},bm)),H(this,"layouts",{default:"",multiple:"",month:"",year:""}),H(this,"styles",Yi({},wm))}},Hd=class aa extends na{constructor(e,t){var i;super(),H(this,"init",()=>gm(this)),H(this,"update",o=>Pd(this,o)),H(this,"destroy",()=>Jh(this)),H(this,"show",()=>fa(this)),H(this,"hide",()=>ta(this)),H(this,"set",(o,r)=>fm(this,o,r)),H(this,"context"),this.context=Qh(Yi({},this.context),{locale:{months:{short:[],long:[]},weekdays:{short:[],long:[]}}}),B(this,"mainElement",typeof e=="string"?(i=aa.memoizedElements.get(e))!=null?i:this.queryAndMemoize(e):e),t&&ga(this,t)}queryAndMemoize(e){let t=document.querySelector(e);if(!t)throw new Error(li.notFoundSelector(e));return aa.memoizedElements.set(e,t),t}};H(Hd,"memoizedElements",new Map);var Ki=Hd;function Fs(s,e){let t=e.fetch;t&&(e.fetch=(i,o,r,n)=>{s.classList.add("slick-autocomplete-loading");let a=o;t(i,d=>{a(d),s.classList.remove("slick-autocomplete-loading")},r,n)})}function Ht(s,e){let t=e?.collectionOptions??{};if(!Array.isArray(s)&&t?.collectionInsideObjectProperty&&It(s)){let i=t.collectionInsideObjectProperty;s=ge(s,i||"")}return s}function Fo(s){let e=new Date;s.selectedDates=[],s.selectedMonth=e.getMonth(),s.selectedYear=e.getFullYear();let t=s.context.inputElement;t&&(t.value=""),s.update()}function No(s,e,t,i){let o={[s]:"",[e]:""};return t&&(o[t]=""),i&&(o[i]=""),o}function Ri(s,e,t,i){let{oldVal:o,newVal:r,columnDef:n,selectedSettings:a,updatePickerUI:l}=i;if(o!==r){let c=s.type||n.type,h=n.outputType||s.type||n.type||_.dateUtc,u=Array.isArray(r)?r:[r||""],m=[],g=Le(_.dateIso),f=c?Le(c):void 0;for(let v of u){let k=v instanceof Date?v:nt(v,f);k&&m.push(k)}let b=a??{selectedDates:[m.map(v=>Fe(v,g)).join(":")],selectedMonth:m[0]?.getMonth(),selectedYear:m[0]?.getFullYear(),selectedTime:f==="ISO8601"||(f||"").toLowerCase().includes("h")?Fe(m[0],"HH:mm"):void 0};l!==!1&&d(t,b)&&t instanceof Ki&&(t.selectedDates=b.selectedDates,t.selectedMonth=b.selectedMonth,t.selectedYear=b.selectedYear,t.selectedTime=b.selectedTime,t.update()),e.value=u.length?m.map(v=>gt(v,void 0,h)).join(" \u2014 "):""}function d(c,h){let u=!1;for(let m of["selectedDates","selectedMonth","selectedYear","selectedTime"])c[m]!==h[m]&&(u=!0);return u}}function Xi(s,e,t,i){if(t){let o=t,r=i?.filterResultAfterEachPass||null;return e?.filterCollection(s,o,r)||[]}return s}function Zi(s,e,t,i,o){if(i){let r=i;return t?.sortCollection(e,s,r,o)||[]}return s}function Se(s,e="",t){if(s)if(e instanceof HTMLElement||e instanceof DocumentFragment)t?.emptyTarget!==!1&&j(s),s.appendChild(e);else{if(t?.skipEmptyReassignment!==!1&&!q(e)&&!s.innerHTML)return;if(typeof e=="number"||typeof e=="boolean")s.textContent=String(e);else{let r=(n=>typeof t?.sanitizer!="function"||!n||typeof n!="string"?n:t.sanitizer(n))(e);t?.enableHtmlRendering&&r?s.innerHTML=r:s.textContent=r}}}function Ai(s,e){return typeof e!="function"||!s||typeof s!="string"?s:e(s)}function Qi(s,e){let t=p("select",{className:"form-control"});for(let i of s){let o=document.createElement("option");o.value=i.operator,Se(o,`${zn(i.operatorAlt||i.operator,3)}${i.descAlt||i.desc}`,e.getOptions()),t.appendChild(o)}return t}function km(s,e,t){let i=e?.filter??{};if(s=Ht(s,i),!Array.isArray(s))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');i.collection=s,t(s)}async function Ns(s,e,t,i,o){let r=e?.filter??{},n=null;if(s){let a=i?.isObservable(s)??!1;if(n=await xo(s,i),n=Ht(n,r),!Array.isArray(n))throw new Error('Something went wrong while trying to pull the collection from the "collectionAsync" call in the Filter, the collection is not a valid array.');r.collection=n,t(n),a&&Cm(e,t,i,o)}return n}function Cm(s,e,t,i){let o=s?.filter??{},r=t?.createSubject();o.collectionAsync=r,i&&r&&i.push(r.subscribe(n=>km(n,s,e)))}function Ct(s,e,t,i,o){if(i?.enableTranslate&&o?.translate){let n=$e(i);return o.translate(`${n}${s}`)}return(i.locales||x.locales)?.[e]??t}function Vd(s,e){return[{operator:"",desc:Ct("CONTAINS","TEXT_CONTAINS","Contains",s,e)},{operator:"<>",desc:Ct("NOT_CONTAINS","TEXT_NOT_CONTAINS","Not Contains",s,e)},{operator:"=",desc:Ct("EQUALS","TEXT_EQUALS","Equals",s,e)},{operator:"!=",desc:Ct("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",s,e)},{operator:"a*",desc:Ct("STARTS_WITH","TEXT_STARTS_WITH","Starts with",s,e)},{operator:"*z",desc:Ct("ENDS_WITH","TEXT_ENDS_WITH","Ends with",s,e)}]}function Ji(s,e){return[{operator:"",desc:""},{operator:"=",desc:Ct("EQUAL_TO","TEXT_EQUAL_TO","Equal to",s,e)},{operator:"<",desc:Ct("LESS_THAN","TEXT_LESS_THAN","Less than",s,e)},{operator:"<=",desc:Ct("LESS_THAN_OR_EQUAL_TO","TEXT_LESS_THAN_OR_EQUAL_TO","Less than or equal to",s,e)},{operator:">",desc:Ct("GREATER_THAN","TEXT_GREATER_THAN","Greater than",s,e)},{operator:">=",desc:Ct("GREATER_THAN_OR_EQUAL_TO","TEXT_GREATER_THAN_OR_EQUAL_TO","Greater than or equal to",s,e)},{operator:"<>",desc:Ct("NOT_EQUAL_TO","TEXT_NOT_EQUAL_TO","Not equal to",s,e)}]}function eo(s,e,t){if(s.compoundOperatorAltTexts){for(let i of e)if(s.compoundOperatorAltTexts.hasOwnProperty(t)){let o=s.compoundOperatorAltTexts[t][i.operator];i.operatorAlt=o?.operatorAlt||"",i.descAlt=o?.descAlt||""}}}var U=class{get defaultPrevented(){return this._isDefaultPrevented}constructor(e,t){this.event=e,this.args=t,this._isPropagationStopped=!1,this._isImmediatePropagationStopped=!1,this._isDefaultPrevented=!1,this.returnValue=void 0,this.nativeEvent=e,this._arguments=t,e&&["altKey","ctrlKey","metaKey","shiftKey","key","keyCode","clientX","clientY","offsetX","offsetY","pageX","pageY","bubbles","target","type","which","x","y"].forEach(i=>this[i]=e[i]),this._eventTarget=this.nativeEvent?this.nativeEvent.target:void 0}stopPropagation(){this._isPropagationStopped=!0,this.nativeEvent?.stopPropagation()}isPropagationStopped(){return this._isPropagationStopped}stopImmediatePropagation(){this._isImmediatePropagationStopped=!0,this.nativeEvent&&this.nativeEvent.stopImmediatePropagation()}isImmediatePropagationStopped(){return this._isImmediatePropagationStopped}getNativeEvent(){return this.nativeEvent}preventDefault(){this.nativeEvent&&this.nativeEvent.preventDefault(),this._isDefaultPrevented=!0}isDefaultPrevented(){return this.nativeEvent?this.nativeEvent.defaultPrevented:this._isDefaultPrevented}addReturnValue(e){this.returnValue===void 0&&e!==void 0&&(this.returnValue=e)}getReturnValue(){return this.returnValue}getArguments(){return this._arguments}resetReturnValue(){this.returnValue=void 0}},R=class{get subscriberCount(){return this._handlers.length}constructor(e,t){this.eventName=e,this.pubSub=t,this._handlers=[],this._pubSubService=t}subscribe(e){this._handlers.push(e)}unsubscribe(e){for(let t=this._handlers.length-1;t>=0;t--)this._handlers[t]===e&&this._handlers.splice(t,1)}notify(e,t,i,o=!1){let r=t instanceof U?t:new U(t,e);o&&r.resetReturnValue(),i=i||this;for(let n=0;n<this._handlers.length&&!(r.isPropagationStopped()||r.isImmediatePropagationStopped());n++){let a=this._handlers[n].call(i,r,e);r.addReturnValue(a)}if(typeof this._pubSubService?.publish=="function"&&this.eventName){let n=this._pubSubService.publish(this.eventName,{args:e,eventData:r},void 0,a=>r.nativeEvent??=a);r.addReturnValue(n)}return r}setPubSubService(e){this._pubSubService=e}},G=class{constructor(){this.handlers=[]}get subscriberCount(){return this.handlers.length}subscribe(e,t){return this.handlers.push({event:e,handler:t}),e.subscribe(t),this}unsubscribe(e,t){let i=this.handlers.length;for(;i--;)if(this.handlers[i].event===e&&this.handlers[i].handler===t){this.handlers.splice(i,1),e.unsubscribe(t);return}return this}unsubscribeAll(){let e=this.handlers.length;for(;e--;)this.handlers[e].event.unsubscribe(this.handlers[e].handler);return this.handlers=[],this}},Ne=class{constructor(e,t,i,o){i===void 0&&o===void 0&&(i=e,o=t),this.fromRow=Math.min(e,i),this.fromCell=Math.min(t,o),this.toRow=Math.max(e,i),this.toCell=Math.max(t,o)}isSingleCell(){return this.fromRow===this.toRow&&this.fromCell===this.toCell}isSingleRow(){return this.fromRow===this.toRow}contains(e,t){return e>=this.fromRow&&e<=this.toRow&&t>=this.fromCell&&t<=this.toCell}toString(){return this.isSingleCell()?`(${this.fromRow}:${this.fromCell})`:`(${this.fromRow}:${this.fromCell} - ${this.toRow}:${this.toCell})`}},zs=class{constructor(){this.__nonDataRow=!0}},di=class extends zs{constructor(){super(),this.__group=!0,this.level=0,this.count=0,this.value=null,this.title=null,this.collapsed=!1,this.selectChecked=!1,this.totals=null,this.rows=[],this.groups=null,this.groupingKey=""}equals(e){return this.value===e.value&&this.count===e.count&&this.collapsed===e.collapsed&&this.title===e.title}},Bs=class extends zs{constructor(){super(),this.__groupTotals=!0,this.group=null,this.initialized=!1}},va=class{constructor(){this.activeEditController=null}isActive(e){return e?this.activeEditController===e:this.activeEditController!==null}activate(e){if(e!==this.activeEditController){if(this.activeEditController!==null)throw new Error("SlickEditorLock.activate: an editController is still active, can't activate another editController");if(!e.commitCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .commitCurrentEdit()");if(!e.cancelCurrentEdit)throw new Error("SlickEditorLock.activate: editController must implement .cancelCurrentEdit()");this.activeEditController=e}}deactivate(e){if(this.activeEditController){if(this.activeEditController!==e)throw new Error("SlickEditorLock.deactivate: specified editController is not the currently active one");this.activeEditController=null}}commitCurrentEdit(){return this.activeEditController?this.activeEditController.commitCurrentEdit():!0}cancelCurrentEdit(){return this.activeEditController?this.activeEditController.cancelCurrentEdit():!0}},w=class s{static height(e,t){if(e){if(t===void 0)return e.getBoundingClientRect().height;s.setStyleSize(e,"height",t)}}static width(e,t){if(!(!e||!e.getBoundingClientRect)){if(t===void 0)return e.getBoundingClientRect().width;s.setStyleSize(e,"width",t)}}static setStyleSize(e,t,i){typeof i=="function"&&(i=i()),e.style[t]=typeof i=="string"?i:`${i}px`}static isHidden(e){return e.offsetWidth===0&&e.offsetHeight===0}static parents(e,t){let i=[],o=t===":visible",r=t===":hidden";for(;(e=e.parentNode)&&e!==document&&!(!e||!e.parentNode);)r?s.isHidden(e)&&i.push(e):o?s.isHidden(e)||i.push(e):(!t||e.matches(t))&&i.push(e);return i}static toFloat(e){let t=parseFloat(e);return isNaN(t)?0:t}static show(e,t=""){Array.isArray(e)?e.forEach(i=>i.style.display=t):e.style.display=t}static hide(e){Array.isArray(e)?e.forEach(t=>t.style.display="none"):e.style.display="none"}static applyDefaults(e,t){typeof t=="object"&&Object.keys(t).forEach(i=>{t.hasOwnProperty(i)&&!e.hasOwnProperty(i)&&(e[i]=t[i])})}static addSlickEventPubSubWhenDefined(e,t){if(e)for(let i in t)t[i]instanceof R&&typeof t[i].setPubSubService=="function"&&t[i].setPubSubService(e)}};w.storage={_storage:new WeakMap,put:function(s,e,t){this._storage.has(s)||this._storage.set(s,new Map),this._storage.get(s).set(e,t)},get:function(s,e){let t=this._storage.get(s);return t?t.get(e):null},remove:function(s,e){let t=this._storage.get(s).delete(e);return this._storage.get(s).size!==0&&this._storage.delete(s),t}};var Li=new va,Fd="slick-edit-preclick";var to=class{constructor(e){this.pluginName="GroupItemMetadataProvider",this._defaults={groupCssClass:"slick-group",groupTitleCssClass:"slick-group-title",totalsCssClass:"slick-group-totals",groupFocusable:!0,indentation:15,totalsFocusable:!1,toggleCssClass:"slick-group-toggle",toggleExpandedCssClass:"expanded",toggleCollapsedCssClass:"collapsed",enableExpandCollapse:!0,groupFormatter:this.defaultGroupCellFormatter.bind(this),totalsFormatter:this.defaultTotalsCellFormatter.bind(this),includeHeaderTotals:!1},this._eventHandler=new G,this._options=fe(!0,{},this._defaults,e)}get eventHandler(){return this._eventHandler}get dataView(){return this._grid?.getData()??{}}get gridOptions(){return this._grid?.getOptions()||{}}init(e,t){this._grid=e,this._options={...this._defaults,...t},this._eventHandler.subscribe(e.onClick,this.handleGridClick.bind(this)),this._eventHandler.subscribe(e.onKeyDown,this.handleGridKeyDown.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll()}getOptions(){return this._options}setOptions(e){this._options={...this._options,...e}}getGroupRowMetadata(e,t){return{selectable:!1,focusable:this._options.groupFocusable,cssClasses:`${this._options.groupCssClass} slick-group-level-${e?.level||0}`,formatter:this._options.includeHeaderTotals&&this._options.totalsFormatter||void 0,columns:{0:{colspan:this._options.includeHeaderTotals?"1":"*",formatter:this._options.groupFormatter,editorClass:null}}}}getTotalsRowMetadata(e,t){return{selectable:!1,focusable:this._options.totalsFocusable,cssClasses:`${this._options.totalsCssClass} slick-group-level-${e?.group?.level||0}`,formatter:this._options.totalsFormatter,editorClass:null}}defaultGroupCellFormatter(e,t,i,o,r){if(!this._options.enableExpandCollapse)return r.title;let n=r.level||0,a=this._options?.indentation??15,l=`${n*a}px`,d=r.collapsed?this._options.toggleCollapsedCssClass:this._options.toggleExpandedCssClass,c=St(this.gridOptions);c.appendChild(p("span",{className:`${this._options.toggleCssClass} ${d}`,ariaExpanded:String(!r.collapsed),style:{marginLeft:l}}));let h=p("span",{className:this._options.groupTitleCssClass||""});return h.setAttribute("level",n),r.title instanceof HTMLElement||r.title instanceof DocumentFragment?h.appendChild(r.title):Se(h,r.title??"",this.gridOptions),c.appendChild(h),c}defaultTotalsCellFormatter(e,t,i,o,r,n){return o?.groupTotalsFormatter?.(r,o,n)??""}handleGridClick(e,t){let i=e.target,o=this._grid?.getDataItem(t.row);o instanceof di&&i.classList.contains(this._options.toggleCssClass||"")&&(this.handleDataViewExpandOrCollapse(o),e.stopImmediatePropagation(),e.preventDefault())}handleGridKeyDown(e){if(this._options.enableExpandCollapse&&e.key===" "){let t=this._grid?.getActiveCell();if(t){let i=this._grid.getDataItem(t.row);i instanceof di&&(this.handleDataViewExpandOrCollapse(i),e.stopImmediatePropagation(),e.preventDefault())}}}handleDataViewExpandOrCollapse(e){let t=this._grid?.getRenderedRange();this.dataView.setRefreshHints({ignoreDiffsBefore:t.top,ignoreDiffsAfter:t.bottom+1}),e.collapsed?this.dataView.expandGroup(e.groupingKey):this.dataView.collapseGroup(e.groupingKey)}};var $s=class{constructor(e,t){this.externalPubSub=t,this.defaults={globalItemMetadataProvider:null,groupItemMetadataProvider:null,inlineFilters:!1,useCSPSafeFilter:!1},this.idProperty="id",this.items=[],this.rows=[],this.idxById=new Map,this.rowsById=void 0,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.suspend=!1,this.isBulkSuspend=!1,this.bulkDeleteIds=new Map,this.sortAsc=!0,this.refreshHints={},this.prevRefreshHints={},this.filteredItems=[],this.filterCache=[],this.groupingInfoDefaults={getter:void 0,formatter:void 0,comparer:(i,o)=>i.value===o.value?0:i.value>o.value?1:-1,predefinedValues:[],aggregators:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1},this.groupingInfos=[],this.groups=[],this.toggledGroupsByLevel=[],this.groupingDelimiter=":|:",this.selectedRowIds=[],this.pagesize=0,this.pagenum=0,this.totalRows=0,this.onBeforePagingInfoChanged=new R("onBeforePagingInfoChanged",t),this.onGroupExpanded=new R("onGroupExpanded",t),this.onGroupCollapsed=new R("onGroupCollapsed",t),this.onPagingInfoChanged=new R("onPagingInfoChanged",t),this.onRowCountChanged=new R("onRowCountChanged",t),this.onRowsChanged=new R("onRowsChanged",t),this.onRowsOrCountChanged=new R("onRowsOrCountChanged",t),this.onSelectedRowIdsChanged=new R("onSelectedRowIdsChanged",t),this.onSetItemsCalled=new R("onSetItemsCalled",t),this._options=fe(!0,{},this.defaults,e)}beginUpdate(e){this.suspend=!0,this.isBulkSuspend=e===!0}endUpdate(){let e=this.isBulkSuspend;this.isBulkSuspend=!1,this.suspend=!1,e&&(this.processBulkDelete(),this.ensureIdUniqueness()),this.refresh()}destroy(){this.items=[],this.idProperty="id",this.idxById=null,this.rowsById=null,this.filter=null,this.filterCSPSafe=null,this.updated=null,this.sortComparer=null,this.filterCache=[],this.filteredItems=[],this.compiledFilter=null,this.compiledFilterCSPSafe=null,this.compiledFilterWithCaching=null,this.compiledFilterWithCachingCSPSafe=null,this._grid&&(this._grid.onSelectedRowsChanged?.unsubscribe(),this._grid.onCellCssStylesChanged?.unsubscribe()),this.onRowsOrCountChanged?.unsubscribe()}setRefreshHints(e){this.refreshHints=e}getFilterArgs(){return this.filterArgs}setFilterArgs(e){this.filterArgs=e}processBulkDelete(){if(!this.idxById)return;let e,t,i=0;for(let o=0,r=this.items.length;o<r;o++){if(t=this.items[o],e=t[this.idProperty],e===void 0)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.bulkDeleteIds.has(e)?this.idxById.delete(e):(this.items[i]=t,this.idxById.set(e,i),++i)}this.items.length=i,this.bulkDeleteIds=new Map}updateIdxById(e){if(this.isBulkSuspend||!this.idxById)return;e=e||0;let t;for(let i=e,o=this.items.length;i<o;i++){if(t=this.items[i][this.idProperty],t===void 0)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property");this.idxById.set(t,i)}}ensureIdUniqueness(){if(this.isBulkSuspend||!this.idxById)return;let e;for(let t=0,i=this.items.length;t<i;t++)if(e=this.items[t][this.idProperty],e===void 0||this.idxById.get(e)!==t)throw new Error("[SlickGrid DataView] Each data element must implement a unique 'id' property")}getItems(){return this.items}getIdPropertyName(){return this.idProperty}setItems(e,t){t!==void 0&&(this.idProperty=t),this.items=this.filteredItems=e,this.onSetItemsCalled.notify({idProperty:this.idProperty,itemCount:this.items.length},null,this),this.idxById=new Map,this.updateIdxById(),this.ensureIdUniqueness(),this.refresh()}setPagingOptions(e){this.onBeforePagingInfoChanged.notify(this.getPagingInfo(),null,this).getReturnValue()!==!1&&(q(e.pageSize)&&(this.pagesize=e.pageSize,this.pagenum=this.pagesize?Math.min(this.pagenum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1)):0),q(e.pageNum)&&(this.pagenum=Math.min(e.pageNum,Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1))),this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),this.refresh())}getPagingInfo(){let e=this.pagesize?Math.max(1,Math.ceil(this.totalRows/this.pagesize)):1;return{pageSize:this.pagesize,pageNum:this.pagenum,totalRows:this.totalRows,totalPages:e,dataView:this}}sort(e,t){this.sortAsc=t,this.sortComparer=e,t===!1&&this.items.reverse(),this.items.sort(e),t===!1&&this.items.reverse(),this.idxById=new Map,this.updateIdxById(),this.refresh()}reSort(){this.sortComparer&&this.sort(this.sortComparer,this.sortAsc)}getFilteredItems(){return this.filteredItems}getFilteredItemCount(){return this.filteredItems.length}getFilter(){return this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter}setFilter(e){this.filterCSPSafe=e,this.filter=e,this._options.inlineFilters&&(this.compiledFilterCSPSafe=this.compileFilterCSPSafe,this.compiledFilterWithCachingCSPSafe=this.compileFilterWithCachingCSPSafe,this.compiledFilter=this.compileFilter(this._options.useCSPSafeFilter),this.compiledFilterWithCaching=this.compileFilterWithCaching(this._options.useCSPSafeFilter)),this.refresh()}getGrouping(){return this.groupingInfos}setGrouping(e){this._options.groupItemMetadataProvider||(this._options.groupItemMetadataProvider=new to),this.groups=[],this.toggledGroupsByLevel=[],e=e||[],this.groupingInfos=e instanceof Array?e:[e];for(let t=0;t<this.groupingInfos.length;t++){let i=this.groupingInfos[t]=fe(!0,{},this.groupingInfoDefaults,this.groupingInfos[t]);i.getterIsAFn=typeof i.getter=="function",i.compiledAccumulators=[];let o=i.aggregators.length;for(;o--;)i.compiledAccumulators[o]=this.compileAccumulatorLoopCSPSafe(i.aggregators[o]);this.toggledGroupsByLevel[t]={}}this.refresh()}getItemByIdx(e){return this.items[e]}getIdxById(e){return this.idxById?.get(e)}ensureRowsByIdCache(){if(!this.rowsById){this.rowsById={};for(let e=0,t=this.rows.length;e<t;e++)this.rowsById[this.rows[e][this.idProperty]]=e}}getRowByItem(e){return this.ensureRowsByIdCache(),this.rowsById?.[e[this.idProperty]]}getRowById(e){return this.ensureRowsByIdCache(),this.rowsById?.[e]}getItemById(e){return this.items[this.idxById.get(e)]}mapItemsToRows(e){let t=[];this.ensureRowsByIdCache();for(let i=0,o=e.length;i<o;i++){let r=this.rowsById?.[e[i][this.idProperty]];q(r)&&(t[t.length]=r)}return t}mapIdsToRows(e){let t=[];this.ensureRowsByIdCache();for(let i=0,o=e.length;i<o;i++){let r=this.rowsById?.[e[i]];q(r)&&(t[t.length]=r)}return t}mapRowsToIds(e){let t=[];for(let i=0,o=e.length;i<o;i++)if(e[i]<this.rows.length){let r=this.rows[e[i]];t[t.length]=r[this.idProperty]}return t}updateSingleItem(e,t){if(this.idxById){if(!this.idxById.has(e))throw new Error("[SlickGrid DataView] Invalid id");if(e!==t[this.idProperty]){let i=t[this.idProperty];if(!q(i))throw new Error("[SlickGrid DataView] Cannot update item to associate with a null id");if(this.idxById.has(i))throw new Error("[SlickGrid DataView] Cannot update item to associate with a non-unique id");this.idxById.set(i,this.idxById.get(e)),this.idxById.delete(e),this.updated?.[e]&&delete this.updated[e],e=i}this.items[this.idxById.get(e)]=t,this.updated||(this.updated={}),this.updated[e]=!0}}updateItem(e,t){this.updateSingleItem(e,t),this.refresh()}updateItems(e,t){if(e.length!==t.length)throw new Error("[SlickGrid DataView] Mismatch on the length of ids and items provided to update");for(let i=0,o=t.length;i<o;i++)this.updateSingleItem(e[i],t[i]);this.refresh()}insertItem(e,t){this.items.splice(e,0,t),this.updateIdxById(e),this.refresh()}insertItems(e,t){Array.prototype.splice.apply(this.items,[e,0].concat(t)),this.updateIdxById(e),this.refresh()}addItem(e){this.items.push(e),this.updateIdxById(this.items.length-1),this.refresh()}addItems(e){this.items=this.items.concat(e),this.updateIdxById(this.items.length-e.length),this.refresh()}deleteItem(e){if(this.idxById)if(this.isBulkSuspend)this.bulkDeleteIds.set(e,!0);else{let t=this.idxById.get(e);if(t===void 0)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(e),this.items.splice(t,1),this.updateIdxById(t),this.refresh()}}deleteItems(e){if(!(e.length===0||!this.idxById))if(this.isBulkSuspend)for(let t=0,i=e.length;t<i;t++){let o=e[t];if(this.idxById.get(o)===void 0)throw new Error("[SlickGrid DataView] Invalid id");this.bulkDeleteIds.set(o,!0)}else{let t=[];for(let i=0,o=e.length;i<o;i++){let r=e[i],n=this.idxById.get(r);if(n===void 0)throw new Error("[SlickGrid DataView] Invalid id");this.idxById.delete(r),t.push(n)}t.sort();for(let i=t.length-1;i>=0;--i)this.items.splice(t[i],1);this.updateIdxById(t[0]),this.refresh()}}sortedAddItem(e){if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedAddItem() requires a sort comparer, use sort()");this.insertItem(this.sortedIndex(e),e)}sortedUpdateItem(e,t){if(!this.idxById)return;if(!this.idxById.has(e)||e!==t[this.idProperty])throw new Error(`[SlickGrid DataView] Invalid or non-matching id ${e}`);if(!this.sortComparer)throw new Error("[SlickGrid DataView] sortedUpdateItem() requires a sort comparer, use sort()");let i=this.getItemById(e);this.sortComparer(i,t)!==0?(this.deleteItem(e),this.sortedAddItem(t)):this.updateItem(e,t)}sortedIndex(e){let t=0,i=this.items.length;for(;t<i;){let o=t+i>>>1;this.sortComparer(this.items[o],e)===-1?t=o+1:i=o}return t}getItemCount(){return this.items.length}getLength(){return this.rows.length}getItem(e){let t=this.rows[e];if(t?.__group&&t.totals&&!t.totals?.initialized){let i=this.groupingInfos[t.level];i.displayTotalsRow||(this.calculateTotals(t.totals),t.title=i.formatter?i.formatter(t):t.value)}else t?.__groupTotals&&!t.initialized&&this.calculateTotals(t);return t}getItemMetadata(e){let t=this.rows[e];return t===void 0?null:this._options.globalItemMetadataProvider?.getRowMetadata?this._options.globalItemMetadataProvider.getRowMetadata(t,e):t.__group&&this._options.groupItemMetadataProvider?.getGroupRowMetadata?this._options.groupItemMetadataProvider.getGroupRowMetadata(t,e):t.__groupTotals&&this._options.groupItemMetadataProvider?.getTotalsRowMetadata?this._options.groupItemMetadataProvider.getTotalsRowMetadata(t,e):null}expandCollapseAllGroups(e,t){if(q(e))this.toggledGroupsByLevel[e]={},this.groupingInfos[e].collapsed=t,t===!0?this.onGroupCollapsed.notify({level:e,groupingKey:null}):this.onGroupExpanded.notify({level:e,groupingKey:null});else for(let i=0;i<this.groupingInfos.length;i++)this.toggledGroupsByLevel[i]={},this.groupingInfos[i].collapsed=t,t===!0?this.onGroupCollapsed.notify({level:i,groupingKey:null}):this.onGroupExpanded.notify({level:i,groupingKey:null});this.refresh()}collapseAllGroups(e){this.expandCollapseAllGroups(e,!0)}expandAllGroups(e){this.expandCollapseAllGroups(e,!1)}expandCollapseGroup(e,t,i){this.toggledGroupsByLevel[e]&&(this.toggledGroupsByLevel[e][t]=this.groupingInfos[e].collapsed^i),this.refresh()}collapseGroup(...e){let i=Array.prototype.slice.call(e)[0],o,r;e.length===1&&i.indexOf(this.groupingDelimiter)!==-1?(o=i,r=i.split(this.groupingDelimiter).length-1):(o=e.join(this.groupingDelimiter),r=e.length-1),this.expandCollapseGroup(r,o,!0),this.onGroupCollapsed.notify({level:r,groupingKey:o})}expandGroup(...e){let i=Array.prototype.slice.call(e)[0],o,r;e.length===1&&i.indexOf(this.groupingDelimiter)!==-1?(r=i.split(this.groupingDelimiter).length-1,o=i):(r=e.length-1,o=e.join(this.groupingDelimiter)),this.expandCollapseGroup(r,o,!1),this.onGroupExpanded.notify({level:r,groupingKey:o})}getGroups(){return this.groups}extractGroups(e,t){let i,o,r=[],n={},a,l=t?t.level+1:0,d=this.groupingInfos[l];for(let c=0,h=d.predefinedValues?.length??0;c<h;c++)o=d.predefinedValues?.[c],i=n[o],i||(i=new di,i.value=o,i.level=l,i.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+o,r[r.length]=i,n[o]=i);for(let c=0,h=e.length;c<h;c++)a=e[c],o=d.getterIsAFn?d.getter(a):a[d.getter],i=n[o],i||(i=new di,i.value=o,i.level=l,i.groupingKey=(t?t.groupingKey+this.groupingDelimiter:"")+o,r[r.length]=i,n[o]=i),i.rows[i.count++]=a;if(l<this.groupingInfos.length-1)for(let c=0;c<r.length;c++)i=r[c],i.groups=this.extractGroups(i.rows,i);return r.length&&this.addTotals(r,l),r.sort(this.groupingInfos[l].comparer),r}calculateTotals(e){let t=e.group,i=this.groupingInfos[t?.level??0],o=t.level===this.groupingInfos.length,r,n=i.aggregators.length;if(!o&&i.aggregateChildGroups){let a=t.groups?.length??0;for(;a--;)t.groups[a].totals.initialized||this.calculateTotals(t.groups[a].totals)}for(;n--;)r=i.aggregators[n],r.init(),!o&&i.aggregateChildGroups?i.compiledAccumulators[n].call(r,t.groups):i.compiledAccumulators[n].call(r,t.rows),r.storeResult(e);e.initialized=!0}addGroupTotals(e){let t=this.groupingInfos[e.level],i=new Bs;i.group=e,e.totals=i,t.lazyTotalsCalculation||this.calculateTotals(i)}addTotals(e,t){t=t||0;let i=this.groupingInfos[t],o=i.collapsed,r=this.toggledGroupsByLevel[t],n=e.length,a;for(;n--;)a=e[n],!(a.collapsed&&!i.aggregateCollapsed)&&(a.groups&&this.addTotals(a.groups,t+1),i.aggregators?.length&&(i.aggregateEmpty||a.rows.length||a.groups?.length)&&this.addGroupTotals(a),a.collapsed=o^r[a.groupingKey],a.title=i.formatter?i.formatter(a):a.value)}flattenGroupedRows(e,t){t=t||0;let i=this.groupingInfos[t],o=[],r,n=0,a;for(let l=0,d=e.length;l<d;l++){if(a=e[l],o[n++]=a,!a.collapsed){r=a.groups?this.flattenGroupedRows(a.groups,t+1):a.rows;for(let c=0,h=r.length;c<h;c++)o[n++]=r[c]}a.totals&&i.displayTotalsRow&&(!a.collapsed||i.aggregateCollapsed)&&(o[n++]=a.totals)}return o}compileAccumulatorLoopCSPSafe(e){return e.accumulate?function(t){let i;if(Array.isArray(t))for(let o=0;o<t.length;o++){let r=t[o];i=e.accumulate.call(e,r)}return i}:function(){}}compileFilterCSPSafe(e,t){if(typeof this.filterCSPSafe!="function")return[];let i=[],o=e.length;for(let r=0;r<o;r++)this.filterCSPSafe(e[r],t)&&i.push(e[r]);return i}compileFilter(e=!1){if(e)return null;let t=hs(this.filter),i="{ continue _coreloop; }$1",o="{ _retval[_idx++] = $item$; continue _coreloop; }$1",r=t.body.replace(/return false\s*([;}]|\}|$)/gi,i).replace(/return!1([;}]|\}|$)/gi,i).replace(/return true\s*([;}]|\}|$)/gi,o).replace(/return!0([;}]|\}|$)/gi,o).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,r),n=n.replace(/\$item\$/gi,t.params[0]),n=n.replace(/\$args\$/gi,t.params[1]);let a=new Function("_items,_args",n),l="compiledFilter";return a.displayName=l,a.name=this.setFunctionName(a,l),a}compileFilterWithCaching(e=!1){if(e)return null;let t=hs(this.filter),i="{ continue _coreloop; }$1",o="{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1",r=t.body.replace(/return false\s*([;}]|\}|$)/gi,i).replace(/return!1([;}]|\}|$)/gi,i).replace(/return true\s*([;}]|\}|$)/gi,o).replace(/return!0([;}]|\}|$)/gi,o).replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=n.replace(/\$filter\$/gi,r),n=n.replace(/\$item\$/gi,t.params[0]),n=n.replace(/\$args\$/gi,t.params[1]);let a=new Function("_items,_args,_cache",n),l="compiledFilterWithCaching";return a.displayName=l,a.name=this.setFunctionName(a,l),a}compileFilterWithCachingCSPSafe(e,t,i){if(typeof this.filterCSPSafe!="function")return[];let o=[],r=e.length;for(let n=0;n<r;n++)(i[n]||this.filterCSPSafe(e[n],t))&&o.push(e[n]);return o}setFunctionName(e,t){try{Object.defineProperty(e,"name",{writable:!0,value:t})}catch{e.name=t}}uncompiledFilter(e,t){let i=[],o=0;for(let r=0,n=e.length;r<n;r++)this.filter?.(e[r],t)&&(i[o++]=e[r]);return i}uncompiledFilterWithCaching(e,t,i){let o=[],r=0,n;for(let a=0,l=e.length;a<l;a++)n=e[a],i[a]?o[r++]=n:this.filter?.(n,t)&&(o[r++]=n,i[a]=!0);return o}getFilteredAndPagedItems(e){if(this._options.useCSPSafeFilter?this.filterCSPSafe:this.filter){let i,o;this._options.useCSPSafeFilter?(i=this._options.inlineFilters?this.compiledFilterCSPSafe:this.uncompiledFilter,o=this._options.inlineFilters?this.compiledFilterWithCachingCSPSafe:this.uncompiledFilterWithCaching):(i=this._options.inlineFilters?this.compiledFilter:this.uncompiledFilter,o=this._options.inlineFilters?this.compiledFilterWithCaching:this.uncompiledFilterWithCaching),this.refreshHints.isFilterNarrowing?this.filteredItems=i.call(this,this.filteredItems,this.filterArgs):this.refreshHints.isFilterExpanding?this.filteredItems=o.call(this,e,this.filterArgs,this.filterCache):this.refreshHints.isFilterUnchanged||(this.filteredItems=i.call(this,e,this.filterArgs))}else this.filteredItems=this.pagesize?e:e.concat();let t;return this.pagesize?(this.filteredItems.length<=this.pagenum*this.pagesize&&(this.filteredItems.length===0?this.pagenum=0:this.pagenum=Math.floor((this.filteredItems.length-1)/this.pagesize)),t=this.filteredItems.slice(this.pagesize*this.pagenum,this.pagesize*this.pagenum+this.pagesize)):t=this.filteredItems,{totalRows:this.filteredItems.length,rows:t}}getRowDiffs(e,t){let i,o,r,n=[],a=0,l=Math.max(t.length,e.length);this.refreshHints?.ignoreDiffsBefore&&(a=Math.max(0,Math.min(t.length,this.refreshHints.ignoreDiffsBefore))),this.refreshHints?.ignoreDiffsAfter&&(l=Math.min(t.length,Math.max(0,this.refreshHints.ignoreDiffsAfter)));for(let d=a,c=e.length;d<l;d++)d>=c?n[n.length]=d:(i=t[d],o=e[d],(!i||this.groupingInfos.length&&(r=i.__nonDataRow||o.__nonDataRow)&&i.__group!==o.__group||i.__group&&!i.equals(o)||r&&(i.__groupTotals||o.__groupTotals)||i[this.idProperty]!==o[this.idProperty]||this.updated?.[i[this.idProperty]])&&(n[n.length]=d));return n}recalc(e){this.rowsById=void 0,(this.refreshHints.isFilterNarrowing!==this.prevRefreshHints.isFilterNarrowing||this.refreshHints.isFilterExpanding!==this.prevRefreshHints.isFilterExpanding)&&(this.filterCache=[]);let t=this.getFilteredAndPagedItems(e);this.totalRows=t.totalRows;let i=t.rows;this.groups=[],this.groupingInfos.length&&(this.groups=this.extractGroups(i),this.groups.length&&(i=this.flattenGroupedRows(this.groups)));let o=this.getRowDiffs(this.rows,i);return this.rows=i,o}refresh(){if(this.suspend)return;let e=fe(!0,{},this.getPagingInfo()),t=this.rows.length,i=this.totalRows,o=this.recalc(this.items);this.pagesize&&this.totalRows<this.pagenum*this.pagesize&&(this.pagenum=Math.max(0,Math.ceil(this.totalRows/this.pagesize)-1),o=this.recalc(this.items)),this.updated=null,this.prevRefreshHints=this.refreshHints,this.refreshHints={},i!==this.totalRows&&this.onBeforePagingInfoChanged.notify(e,null,this).getReturnValue()!==!1&&this.onPagingInfoChanged.notify(this.getPagingInfo(),null,this),t!==this.rows.length&&this.onRowCountChanged.notify({previous:t,current:this.rows.length,itemCount:this.items.length,dataView:this,changedRows:o,callingOnRowsChanged:o.length>0},null,this),o.length>0&&this.onRowsChanged.notify({rows:o,itemCount:this.items.length,dataView:this,calledOnRowCountChanged:t!==this.rows.length},null,this),(t!==this.rows.length||o.length>0)&&this.onRowsOrCountChanged.notify({rowsDiff:o,previousRowCount:t,currentRowCount:this.rows.length,itemCount:this.items.length,rowCountChanged:t!==this.rows.length,rowsChanged:o.length>0,dataView:this},null,this)}syncGridSelection(e,t,i){this._grid=e;let o;this.selectedRowIds=this.mapRowsToIds(e.getSelectedRows());let r=e.getOptions(),n=l=>{l===!1?this.selectedRowIds=[]:this.selectedRowIds.sort().join(",")!==l.sort().join(",")&&(this.selectedRowIds=l)},a=()=>{if((this.selectedRowIds||[]).length>0&&!o){o=!0;let l=this.mapIdsToRows(this.selectedRowIds||[]);if(!t){let d={grid:this._grid,ids:this.mapRowsToIds(l),rows:l,dataView:this};this.preSelectedRowIdsChangeFn(d),this.onSelectedRowIdsChanged.notify(Object.assign(d,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new U,this)}e.setSelectedRows(l),o=!1}};return e.onSelectedRowsChanged.subscribe((l,d)=>{if(!o){let c=this.mapRowsToIds(d.rows),h={grid:this._grid,ids:c,rows:d.rows,added:!0,dataView:this};this.preSelectedRowIdsChangeFn(h),this.onSelectedRowIdsChanged.notify(Object.assign(h,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new U,this)}}),this.preSelectedRowIdsChangeFn=l=>{if(!o){if(o=!0,typeof l.added>"u")n(l.ids);else{let c;if(l.added)i&&r.multiSelect?c=(this.selectedRowIds?.filter(u=>this.getRowById(u)===void 0)).concat(l.ids):c=l.ids;else if(i&&r.multiSelect){let h=new Set(l.ids);c=this.selectedRowIds?.filter(u=>!h.has(u))}else c=[];n(c)}o=!1}},this.onRowsOrCountChanged.subscribe(a.bind(this)),this.onSelectedRowIdsChanged}getAllSelectedIds(){return this.selectedRowIds}getAllSelectedFilteredIds(){return this.getAllSelectedFilteredItems().map(e=>e[this.idProperty])}setSelectedIds(e,t){let i=t?.isRowBeingAdded,o=t?.shouldTriggerEvent,r=t?.applyRowSelectionToGrid;i!==!1&&(i=!0);let n=this.mapIdsToRows(e),a={grid:this._grid,ids:e,rows:n,added:i,dataView:this};this.preSelectedRowIdsChangeFn?.(a),o!==!1&&this.onSelectedRowIdsChanged.notify(Object.assign(a,{selectedRowIds:this.selectedRowIds,filteredIds:this.getAllSelectedFilteredIds()}),new U,this),r!==!1&&this._grid&&this._grid.setSelectedRows(n)}getAllSelectedItems(){let e=[];return this.getAllSelectedIds().forEach(i=>{e.push(this.getItemById(i))}),e}getAllSelectedFilteredItems(){if(!Array.isArray(this.selectedRowIds))return[];let e=new Set(this.selectedRowIds);return this.filteredItems.filter(i=>e.has(i[this.idProperty]))||[]}syncGridCellCssStyles(e,t){let i,o,r=a=>{i={},typeof a=="object"&&Object.keys(a).forEach(l=>{if(a&&this.rows[l]){let d=this.rows[l][this.idProperty];i[d]=a[l]}})};r(e.getCellCssStyles(t));let n=()=>{if(typeof i=="object"){o=!0,this.ensureRowsByIdCache();let a={};Object.keys(i).forEach(l=>{let d=this.rowsById?.[l];q(d)&&(a[d]=i[l])}),e.setCellCssStyles(t,a),o=!1}};e.onCellCssStylesChanged.subscribe((a,l)=>{o||t!==l.key||(l.hash?r(l.hash):(e.onCellCssStylesChanged.unsubscribe(),this.onRowsOrCountChanged.unsubscribe(n)))}),this.onRowsOrCountChanged.subscribe(n.bind(this))}};function Nd(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(s,o).enumerable})),t.push.apply(t,i)}return t}function Vt(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Nd(Object(t),!0).forEach(function(i){_m(s,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):Nd(Object(t)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(t,i))})}return s}function qs(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qs=function(e){return typeof e}:qs=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qs(s)}function _m(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function ui(){return ui=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(s[i]=t[i])}return s},ui.apply(this,arguments)}function xm(s,e){if(s==null)return{};var t={},i=Object.keys(s),o,r;for(r=0;r<i.length;r++)o=i[r],!(e.indexOf(o)>=0)&&(t[o]=s[o]);return t}function ym(s,e){if(s==null)return{};var t=xm(s,e),i,o;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(s,i)&&(t[i]=s[i])}return t}var Em="1.15.6";function Kt(s){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(s)}var mi=Kt(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),sr=Kt(/Edge/i),zd=Kt(/firefox/i),Ks=Kt(/safari/i)&&!Kt(/chrome/i)&&!Kt(/android/i),Ta=Kt(/iP(ad|od|hone)/i),Kd=Kt(/chrome/i)&&Kt(/android/i),Xd={capture:!1,passive:!1};function ve(s,e,t){s.addEventListener(e,t,!mi&&Xd)}function ue(s,e,t){s.removeEventListener(e,t,!mi&&Xd)}function Js(s,e){if(e){if(e[0]===">"&&(e=e.substring(1)),s)try{if(s.matches)return s.matches(e);if(s.msMatchesSelector)return s.msMatchesSelector(e);if(s.webkitMatchesSelector)return s.webkitMatchesSelector(e)}catch{return!1}return!1}}function Zd(s){return s.host&&s!==document&&s.host.nodeType?s.host:s.parentNode}function Ot(s,e,t,i){if(s){t=t||document;do{if(e!=null&&(e[0]===">"?s.parentNode===t&&Js(s,e):Js(s,e))||i&&s===t)return s;if(s===t)break}while(s=Zd(s))}return null}var Bd=/\s+/g;function ft(s,e,t){if(s&&e)if(s.classList)s.classList[t?"add":"remove"](e);else{var i=(" "+s.className+" ").replace(Bd," ").replace(" "+e+" "," ");s.className=(i+(t?" "+e:"")).replace(Bd," ")}}function K(s,e,t){var i=s&&s.style;if(i){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(s,""):s.currentStyle&&(t=s.currentStyle),e===void 0?t:t[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=t+(typeof t=="string"?"":"px")}}function no(s,e){var t="";if(typeof s=="string")t=s;else do{var i=K(s,"transform");i&&i!=="none"&&(t=i+" "+t)}while(!e&&(s=s.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(t)}function Qd(s,e,t){if(s){var i=s.getElementsByTagName(e),o=0,r=i.length;if(t)for(;o<r;o++)t(i[o],o);return i}return[]}function Xt(){var s=document.scrollingElement;return s||document.documentElement}function ze(s,e,t,i,o){if(!(!s.getBoundingClientRect&&s!==window)){var r,n,a,l,d,c,h;if(s!==window&&s.parentNode&&s!==Xt()?(r=s.getBoundingClientRect(),n=r.top,a=r.left,l=r.bottom,d=r.right,c=r.height,h=r.width):(n=0,a=0,l=window.innerHeight,d=window.innerWidth,c=window.innerHeight,h=window.innerWidth),(e||t)&&s!==window&&(o=o||s.parentNode,!mi))do if(o&&o.getBoundingClientRect&&(K(o,"transform")!=="none"||t&&K(o,"position")!=="static")){var u=o.getBoundingClientRect();n-=u.top+parseInt(K(o,"border-top-width")),a-=u.left+parseInt(K(o,"border-left-width")),l=n+r.height,d=a+r.width;break}while(o=o.parentNode);if(i&&s!==window){var m=no(o||s),g=m&&m.a,f=m&&m.d;m&&(n/=f,a/=g,h/=g,c/=f,l=n+c,d=a+h)}return{top:n,left:a,bottom:l,right:d,width:h,height:c}}}function $d(s,e,t){for(var i=er(s,!0),o=ze(s)[e];i;){var r=ze(i)[t],n=void 0;if(t==="top"||t==="left"?n=o>=r:n=o<=r,!n)return i;if(i===Xt())break;i=er(i,!1)}return!1}function ao(s,e,t,i){for(var o=0,r=0,n=s.children;r<n.length;){if(n[r].style.display!=="none"&&n[r]!==J.ghost&&(i||n[r]!==J.dragged)&&Ot(n[r],t.draggable,s,!1)){if(o===e)return n[r];o++}r++}return null}function Oa(s,e){for(var t=s.lastElementChild;t&&(t===J.ghost||K(t,"display")==="none"||e&&!Js(t,e));)t=t.previousElementSibling;return t||null}function _t(s,e){var t=0;if(!s||!s.parentNode)return-1;for(;s=s.previousElementSibling;)s.nodeName.toUpperCase()!=="TEMPLATE"&&s!==J.clone&&(!e||Js(s,e))&&t++;return t}function Wd(s){var e=0,t=0,i=Xt();if(s)do{var o=no(s),r=o.a,n=o.d;e+=s.scrollLeft*r,t+=s.scrollTop*n}while(s!==i&&(s=s.parentNode));return[e,t]}function Sm(s,e){for(var t in s)if(s.hasOwnProperty(t)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===s[t][i])return Number(t)}return-1}function er(s,e){if(!s||!s.getBoundingClientRect)return Xt();var t=s,i=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var o=K(t);if(t.clientWidth<t.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return Xt();if(i||e)return t;i=!0}}while(t=t.parentNode);return Xt()}function Tm(s,e){if(s&&e)for(var t in e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s}function ba(s,e){return Math.round(s.top)===Math.round(e.top)&&Math.round(s.left)===Math.round(e.left)&&Math.round(s.height)===Math.round(e.height)&&Math.round(s.width)===Math.round(e.width)}var wa;function Jd(s,e){return function(){if(!wa){var t=arguments,i=this;t.length===1?s.call(i,t[0]):s.apply(i,t),wa=setTimeout(function(){wa=void 0},e)}}}function ec(s,e,t){s.scrollLeft+=e,s.scrollTop+=t}function tc(s){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(s).cloneNode(!0):t?t(s).clone(!0)[0]:s.cloneNode(!0)}function ic(s,e,t){var i={};return Array.from(s.children).forEach(function(o){var r,n,a,l;if(!(!Ot(o,e.draggable,s,!1)||o.animated||o===t)){var d=ze(o);i.left=Math.min((r=i.left)!==null&&r!==void 0?r:1/0,d.left),i.top=Math.min((n=i.top)!==null&&n!==void 0?n:1/0,d.top),i.right=Math.max((a=i.right)!==null&&a!==void 0?a:-1/0,d.right),i.bottom=Math.max((l=i.bottom)!==null&&l!==void 0?l:-1/0,d.bottom)}}),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var ct="Sortable"+new Date().getTime();function Om(){var s=[],e;return{captureAnimationState:function(){if(s=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(o){if(!(K(o,"display")==="none"||o===J.ghost)){s.push({target:o,rect:ze(o)});var r=Vt({},s[s.length-1].rect);if(o.thisAnimationDuration){var n=no(o,!0);n&&(r.top-=n.f,r.left-=n.e)}o.fromRect=r}})}},addAnimationState:function(i){s.push(i)},removeAnimationState:function(i){s.splice(Sm(s,{target:i}),1)},animateAll:function(i){var o=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var r=!1,n=0;s.forEach(function(a){var l=0,d=a.target,c=d.fromRect,h=ze(d),u=d.prevFromRect,m=d.prevToRect,g=a.rect,f=no(d,!0);f&&(h.top-=f.f,h.left-=f.e),d.toRect=h,d.thisAnimationDuration&&ba(u,h)&&!ba(c,h)&&(g.top-h.top)/(g.left-h.left)===(c.top-h.top)/(c.left-h.left)&&(l=Am(g,u,m,o.options)),ba(h,c)||(d.prevFromRect=c,d.prevToRect=h,l||(l=o.options.animation),o.animate(d,g,h,l)),l&&(r=!0,n=Math.max(n,l),clearTimeout(d.animationResetTimer),d.animationResetTimer=setTimeout(function(){d.animationTime=0,d.prevFromRect=null,d.fromRect=null,d.prevToRect=null,d.thisAnimationDuration=null},l),d.thisAnimationDuration=l)}),clearTimeout(e),r?e=setTimeout(function(){typeof i=="function"&&i()},n):typeof i=="function"&&i(),s=[]},animate:function(i,o,r,n){if(n){K(i,"transition",""),K(i,"transform","");var a=no(this.el),l=a&&a.a,d=a&&a.d,c=(o.left-r.left)/(l||1),h=(o.top-r.top)/(d||1);i.animatingX=!!c,i.animatingY=!!h,K(i,"transform","translate3d("+c+"px,"+h+"px,0)"),this.forRepaintDummy=Rm(i),K(i,"transition","transform "+n+"ms"+(this.options.easing?" "+this.options.easing:"")),K(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){K(i,"transition",""),K(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},n)}}}}function Rm(s){return s.offsetWidth}function Am(s,e,t,i){return Math.sqrt(Math.pow(e.top-s.top,2)+Math.pow(e.left-s.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*i.animation}var io=[],ka={initializeByDefault:!0},Go={mount:function(e){for(var t in ka)ka.hasOwnProperty(t)&&!(t in e)&&(e[t]=ka[t]);io.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),io.push(e)},pluginEvent:function(e,t,i){var o=this;this.eventCanceled=!1,i.cancel=function(){o.eventCanceled=!0};var r=e+"Global";io.forEach(function(n){t[n.pluginName]&&(t[n.pluginName][r]&&t[n.pluginName][r](Vt({sortable:t},i)),t.options[n.pluginName]&&t[n.pluginName][e]&&t[n.pluginName][e](Vt({sortable:t},i)))})},initializePlugins:function(e,t,i,o){io.forEach(function(a){var l=a.pluginName;if(!(!e.options[l]&&!a.initializeByDefault)){var d=new a(e,t,e.options);d.sortable=e,d.options=e.options,e[l]=d,ui(i,d.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var n=this.modifyOption(e,r,e.options[r]);typeof n<"u"&&(e.options[r]=n)}},getEventProperties:function(e,t){var i={};return io.forEach(function(o){typeof o.eventProperties=="function"&&ui(i,o.eventProperties.call(t[o.pluginName],e))}),i},modifyOption:function(e,t,i){var o;return io.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[t]=="function"&&(o=r.optionListeners[t].call(e[r.pluginName],i))}),o}};function Lm(s){var e=s.sortable,t=s.rootEl,i=s.name,o=s.targetEl,r=s.cloneEl,n=s.toEl,a=s.fromEl,l=s.oldIndex,d=s.newIndex,c=s.oldDraggableIndex,h=s.newDraggableIndex,u=s.originalEvent,m=s.putSortable,g=s.extraEventProperties;if(e=e||t&&t[ct],!!e){var f,b=e.options,v="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!mi&&!sr?f=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent(i,!0,!0)),f.to=n||t,f.from=a||t,f.item=o||t,f.clone=r,f.oldIndex=l,f.newIndex=d,f.oldDraggableIndex=c,f.newDraggableIndex=h,f.originalEvent=u,f.pullMode=m?m.lastPutMode:void 0;var k=Vt(Vt({},g),Go.getEventProperties(i,e));for(var C in k)f[C]=k[C];t&&t.dispatchEvent(f),b[v]&&b[v].call(e,f)}}var Im=["evt"],dt=function(e,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.evt,r=ym(i,Im);Go.pluginEvent.bind(J)(e,t,Vt({dragEl:I,parentEl:Ie,ghostEl:ie,rootEl:Te,nextEl:Mi,lastDownEl:Xs,cloneEl:Re,cloneHidden:hi,dragStarted:zo,putSortable:Je,activeSortable:J.active,originalEvent:o,oldIndex:ro,oldDraggableIndex:Bo,newIndex:vt,newDraggableIndex:ci,hideGhostForTarget:nc,unhideGhostForTarget:ac,cloneNowHidden:function(){hi=!0},cloneNowShown:function(){hi=!1},dispatchSortableEvent:function(a){at({sortable:t,name:a,originalEvent:o})}},r))};function at(s){Lm(Vt({putSortable:Je,cloneEl:Re,targetEl:I,rootEl:Te,oldIndex:ro,oldDraggableIndex:Bo,newIndex:vt,newDraggableIndex:ci},s))}var I,Ie,ie,Te,Mi,Xs,Re,hi,ro,vt,Bo,ci,Ws,Je,so=!1,tr=!1,ir=[],Ii,Tt,Ca,_a,Gd,Ud,zo,oo,$o,Wo=!1,Gs=!1,Zs,ot,xa=[],Ea=!1,or=[],rr=typeof document<"u",Us=Ta,jd=sr||mi?"cssFloat":"float",Dm=rr&&!Kd&&!Ta&&"draggable"in document.createElement("div"),oc=function(){if(rr){if(mi)return!1;var s=document.createElement("x");return s.style.cssText="pointer-events:auto",s.style.pointerEvents==="auto"}}(),sc=function(e,t){var i=K(e),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),r=ao(e,0,t),n=ao(e,1,t),a=r&&K(r),l=n&&K(n),d=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+ze(r).width,c=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+ze(n).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&a.float&&a.float!=="none"){var h=a.float==="left"?"left":"right";return n&&(l.clear==="both"||l.clear===h)?"vertical":"horizontal"}return r&&(a.display==="block"||a.display==="flex"||a.display==="table"||a.display==="grid"||d>=o&&i[jd]==="none"||n&&i[jd]==="none"&&d+c>o)?"vertical":"horizontal"},Mm=function(e,t,i){var o=i?e.left:e.top,r=i?e.right:e.bottom,n=i?e.width:e.height,a=i?t.left:t.top,l=i?t.right:t.bottom,d=i?t.width:t.height;return o===a||r===l||o+n/2===a+d/2},Pm=function(e,t){var i;return ir.some(function(o){var r=o[ct].options.emptyInsertThreshold;if(!(!r||Oa(o))){var n=ze(o),a=e>=n.left-r&&e<=n.right+r,l=t>=n.top-r&&t<=n.bottom+r;if(a&&l)return i=o}}),i},rc=function(e){function t(r,n){return function(a,l,d,c){var h=a.options.group.name&&l.options.group.name&&a.options.group.name===l.options.group.name;if(r==null&&(n||h))return!0;if(r==null||r===!1)return!1;if(n&&r==="clone")return r;if(typeof r=="function")return t(r(a,l,d,c),n)(a,l,d,c);var u=(n?a:l).options.group.name;return r===!0||typeof r=="string"&&r===u||r.join&&r.indexOf(u)>-1}}var i={},o=e.group;(!o||qs(o)!="object")&&(o={name:o}),i.name=o.name,i.checkPull=t(o.pull,!0),i.checkPut=t(o.put),i.revertClone=o.revertClone,e.group=i},nc=function(){!oc&&ie&&K(ie,"display","none")},ac=function(){!oc&&ie&&K(ie,"display","")};rr&&!Kd&&document.addEventListener("click",function(s){if(tr)return s.preventDefault(),s.stopPropagation&&s.stopPropagation(),s.stopImmediatePropagation&&s.stopImmediatePropagation(),tr=!1,!1},!0);var Di=function(e){if(I){e=e.touches?e.touches[0]:e;var t=Pm(e.clientX,e.clientY);if(t){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);i.target=i.rootEl=t,i.preventDefault=void 0,i.stopPropagation=void 0,t[ct]._onDragOver(i)}}},Hm=function(e){I&&I.parentNode[ct]._isOutsideThisEl(e.target)};function J(s,e){if(!(s&&s.nodeType&&s.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(s));this.el=s,this.options=e=ui({},e),s[ct]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(s.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return sc(s,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(n,a){n.setData("Text",a.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:J.supportPointer!==!1&&"PointerEvent"in window&&(!Ks||Ta),emptyInsertThreshold:5};Go.initializePlugins(this,s,t);for(var i in t)!(i in e)&&(e[i]=t[i]);rc(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:Dm,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?ve(s,"pointerdown",this._onTapStart):(ve(s,"mousedown",this._onTapStart),ve(s,"touchstart",this._onTapStart)),this.nativeDraggable&&(ve(s,"dragover",this),ve(s,"dragenter",this)),ir.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),ui(this,Om())}J.prototype={constructor:J,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(oo=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,I):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,i=this.el,o=this.options,r=o.preventOnFilter,n=e.type,a=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(a||e).target,d=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,c=o.filter;if(Gm(i),!I&&!(/mousedown|pointerdown/.test(n)&&e.button!==0||o.disabled)&&!d.isContentEditable&&!(!this.nativeDraggable&&Ks&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=Ot(l,o.draggable,i,!1),!(l&&l.animated)&&Xs!==l)){if(ro=_t(l),Bo=_t(l,o.draggable),typeof c=="function"){if(c.call(this,e,l,this)){at({sortable:t,rootEl:d,name:"filter",targetEl:l,toEl:i,fromEl:i}),dt("filter",t,{evt:e}),r&&e.preventDefault();return}}else if(c&&(c=c.split(",").some(function(h){if(h=Ot(d,h.trim(),i,!1),h)return at({sortable:t,rootEl:h,name:"filter",targetEl:l,fromEl:i,toEl:i}),dt("filter",t,{evt:e}),!0}),c)){r&&e.preventDefault();return}o.handle&&!Ot(d,o.handle,i,!1)||this._prepareDragStart(e,a,l)}}},_prepareDragStart:function(e,t,i){var o=this,r=o.el,n=o.options,a=r.ownerDocument,l;if(i&&!I&&i.parentNode===r){var d=ze(i);if(Te=r,I=i,Ie=I.parentNode,Mi=I.nextSibling,Xs=i,Ws=n.group,J.dragged=I,Ii={target:I,clientX:(t||e).clientX,clientY:(t||e).clientY},Gd=Ii.clientX-d.left,Ud=Ii.clientY-d.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,I.style["will-change"]="all",l=function(){if(dt("delayEnded",o,{evt:e}),J.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!zd&&o.nativeDraggable&&(I.draggable=!0),o._triggerDragStart(e,t),at({sortable:o,name:"choose",originalEvent:e}),ft(I,n.chosenClass,!0)},n.ignore.split(",").forEach(function(c){Qd(I,c.trim(),ya)}),ve(a,"dragover",Di),ve(a,"mousemove",Di),ve(a,"touchmove",Di),n.supportPointer?(ve(a,"pointerup",o._onDrop),!this.nativeDraggable&&ve(a,"pointercancel",o._onDrop)):(ve(a,"mouseup",o._onDrop),ve(a,"touchend",o._onDrop),ve(a,"touchcancel",o._onDrop)),zd&&this.nativeDraggable&&(this.options.touchStartThreshold=4,I.draggable=!0),dt("delayStart",this,{evt:e}),n.delay&&(!n.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(sr||mi))){if(J.eventCanceled){this._onDrop();return}n.supportPointer?(ve(a,"pointerup",o._disableDelayedDrag),ve(a,"pointercancel",o._disableDelayedDrag)):(ve(a,"mouseup",o._disableDelayedDrag),ve(a,"touchend",o._disableDelayedDrag),ve(a,"touchcancel",o._disableDelayedDrag)),ve(a,"mousemove",o._delayedDragTouchMoveHandler),ve(a,"touchmove",o._delayedDragTouchMoveHandler),n.supportPointer&&ve(a,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(l,n.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){I&&ya(I),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;ue(e,"mouseup",this._disableDelayedDrag),ue(e,"touchend",this._disableDelayedDrag),ue(e,"touchcancel",this._disableDelayedDrag),ue(e,"pointerup",this._disableDelayedDrag),ue(e,"pointercancel",this._disableDelayedDrag),ue(e,"mousemove",this._delayedDragTouchMoveHandler),ue(e,"touchmove",this._delayedDragTouchMoveHandler),ue(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?ve(document,"pointermove",this._onTouchMove):t?ve(document,"touchmove",this._onTouchMove):ve(document,"mousemove",this._onTouchMove):(ve(I,"dragend",this),ve(Te,"dragstart",this._onDragStart));try{document.selection?Qs(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(so=!1,Te&&I){dt("dragStarted",this,{evt:t}),this.nativeDraggable&&ve(document,"dragover",Hm);var i=this.options;!e&&ft(I,i.dragClass,!1),ft(I,i.ghostClass,!0),J.active=this,e&&this._appendGhost(),at({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Tt){this._lastX=Tt.clientX,this._lastY=Tt.clientY,nc();for(var e=document.elementFromPoint(Tt.clientX,Tt.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Tt.clientX,Tt.clientY),e!==t);)t=e;if(I.parentNode[ct]._isOutsideThisEl(e),t)do{if(t[ct]){var i=void 0;if(i=t[ct]._onDragOver({clientX:Tt.clientX,clientY:Tt.clientY,target:e,rootEl:t}),i&&!this.options.dragoverBubble)break}e=t}while(t=Zd(t));ac()}},_onTouchMove:function(e){if(Ii){var t=this.options,i=t.fallbackTolerance,o=t.fallbackOffset,r=e.touches?e.touches[0]:e,n=ie&&no(ie,!0),a=ie&&n&&n.a,l=ie&&n&&n.d,d=Us&&ot&&Wd(ot),c=(r.clientX-Ii.clientX+o.x)/(a||1)+(d?d[0]-xa[0]:0)/(a||1),h=(r.clientY-Ii.clientY+o.y)/(l||1)+(d?d[1]-xa[1]:0)/(l||1);if(!J.active&&!so){if(i&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(ie){n?(n.e+=c-(Ca||0),n.f+=h-(_a||0)):n={a:1,b:0,c:0,d:1,e:c,f:h};var u="matrix(".concat(n.a,",").concat(n.b,",").concat(n.c,",").concat(n.d,",").concat(n.e,",").concat(n.f,")");K(ie,"webkitTransform",u),K(ie,"mozTransform",u),K(ie,"msTransform",u),K(ie,"transform",u),Ca=c,_a=h,Tt=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!ie){var e=this.options.fallbackOnBody?document.body:Te,t=ze(I,!0,Us,!0,e),i=this.options;if(Us){for(ot=e;K(ot,"position")==="static"&&K(ot,"transform")==="none"&&ot!==document;)ot=ot.parentNode;ot!==document.body&&ot!==document.documentElement?(ot===document&&(ot=Xt()),t.top+=ot.scrollTop,t.left+=ot.scrollLeft):ot=Xt(),xa=Wd(ot)}ie=I.cloneNode(!0),ft(ie,i.ghostClass,!1),ft(ie,i.fallbackClass,!0),ft(ie,i.dragClass,!0),K(ie,"transition",""),K(ie,"transform",""),K(ie,"box-sizing","border-box"),K(ie,"margin",0),K(ie,"top",t.top),K(ie,"left",t.left),K(ie,"width",t.width),K(ie,"height",t.height),K(ie,"opacity","0.8"),K(ie,"position",Us?"absolute":"fixed"),K(ie,"zIndex","100000"),K(ie,"pointerEvents","none"),J.ghost=ie,e.appendChild(ie),K(ie,"transform-origin",Gd/parseInt(ie.style.width)*100+"% "+Ud/parseInt(ie.style.height)*100+"%")}},_onDragStart:function(e,t){var i=this,o=e.dataTransfer,r=i.options;if(dt("dragStart",this,{evt:e}),J.eventCanceled){this._onDrop();return}dt("setupClone",this),J.eventCanceled||(Re=tc(I),Re.removeAttribute("id"),Re.draggable=!1,Re.style["will-change"]="",this._hideClone(),ft(Re,this.options.chosenClass,!1),J.clone=Re),i.cloneId=Qs(function(){dt("clone",i),!J.eventCanceled&&(i.options.removeCloneOnHide||Te.insertBefore(Re,I),i._hideClone(),at({sortable:i,name:"clone"}))}),!t&&ft(I,r.dragClass,!0),t?(tr=!0,i._loopId=setInterval(i._emulateDragOver,50)):(ue(document,"mouseup",i._onDrop),ue(document,"touchend",i._onDrop),ue(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",r.setData&&r.setData.call(i,o,I)),ve(document,"drop",i),K(I,"transform","translateZ(0)")),so=!0,i._dragStartId=Qs(i._dragStarted.bind(i,t,e)),ve(document,"selectstart",i),zo=!0,window.getSelection().removeAllRanges(),Ks&&K(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,i=e.target,o,r,n,a=this.options,l=a.group,d=J.active,c=Ws===l,h=a.sort,u=Je||d,m,g=this,f=!1;if(Ea)return;function b(T,D){dt(T,g,Vt({evt:e,isOwner:c,axis:m?"vertical":"horizontal",revert:n,dragRect:o,targetRect:r,canSort:h,fromSortable:u,target:i,completed:k,onMove:function(L,W){return js(Te,t,I,o,L,ze(L),e,W)},changed:C},D))}function v(){b("dragOverAnimationCapture"),g.captureAnimationState(),g!==u&&u.captureAnimationState()}function k(T){return b("dragOverCompleted",{insertion:T}),T&&(c?d._hideClone():d._showClone(g),g!==u&&(ft(I,Je?Je.options.ghostClass:d.options.ghostClass,!1),ft(I,a.ghostClass,!0)),Je!==g&&g!==J.active?Je=g:g===J.active&&Je&&(Je=null),u===g&&(g._ignoreWhileAnimating=i),g.animateAll(function(){b("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==u&&(u.animateAll(),u._ignoreWhileAnimating=null)),(i===I&&!I.animated||i===t&&!i.animated)&&(oo=null),!a.dragoverBubble&&!e.rootEl&&i!==document&&(I.parentNode[ct]._isOutsideThisEl(e.target),!T&&Di(e)),!a.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function C(){vt=_t(I),ci=_t(I,a.draggable),at({sortable:g,name:"change",toEl:t,newIndex:vt,newDraggableIndex:ci,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=Ot(i,a.draggable,t,!0),b("dragOver"),J.eventCanceled)return f;if(I.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||g._ignoreWhileAnimating===i)return k(!1);if(tr=!1,d&&!a.disabled&&(c?h||(n=Ie!==Te):Je===this||(this.lastPutMode=Ws.checkPull(this,d,I,e))&&l.checkPut(this,d,I,e))){if(m=this._getDirection(e,i)==="vertical",o=ze(I),b("dragOverValid"),J.eventCanceled)return f;if(n)return Ie=Te,v(),this._hideClone(),b("revert"),J.eventCanceled||(Mi?Te.insertBefore(I,Mi):Te.appendChild(I)),k(!0);var E=Oa(t,a.draggable);if(!E||zm(e,m,this)&&!E.animated){if(E===I)return k(!1);if(E&&t===e.target&&(i=E),i&&(r=ze(i)),js(Te,t,I,o,i,r,e,!!i)!==!1)return v(),E&&E.nextSibling?t.insertBefore(I,E.nextSibling):t.appendChild(I),Ie=t,C(),k(!0)}else if(E&&Nm(e,m,this)){var y=ao(t,0,a,!0);if(y===I)return k(!1);if(i=y,r=ze(i),js(Te,t,I,o,i,r,e,!1)!==!1)return v(),t.insertBefore(I,y),Ie=t,C(),k(!0)}else if(i.parentNode===t){r=ze(i);var S=0,F,V=I.parentNode!==t,M=!Mm(I.animated&&I.toRect||o,i.animated&&i.toRect||r,m),Y=m?"top":"left",me=$d(i,"top","top")||$d(I,"top","top"),re=me?me.scrollTop:void 0;oo!==i&&(F=r[Y],Wo=!1,Gs=!M&&a.invertSwap||V),S=Bm(e,i,r,m,M?1:a.swapThreshold,a.invertedSwapThreshold==null?a.swapThreshold:a.invertedSwapThreshold,Gs,oo===i);var pe;if(S!==0){var xe=_t(I);do xe-=S,pe=Ie.children[xe];while(pe&&(K(pe,"display")==="none"||pe===ie))}if(S===0||pe===i)return k(!1);oo=i,$o=S;var Qe=i.nextElementSibling,De=!1;De=S===1;var O=js(Te,t,I,o,i,r,e,De);if(O!==!1)return(O===1||O===-1)&&(De=O===1),Ea=!0,setTimeout(Fm,30),v(),De&&!Qe?t.appendChild(I):i.parentNode.insertBefore(I,De?Qe:i),me&&ec(me,0,re-me.scrollTop),Ie=I.parentNode,F!==void 0&&!Gs&&(Zs=Math.abs(F-ze(i)[Y])),C(),k(!0)}if(t.contains(I))return k(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){ue(document,"mousemove",this._onTouchMove),ue(document,"touchmove",this._onTouchMove),ue(document,"pointermove",this._onTouchMove),ue(document,"dragover",Di),ue(document,"mousemove",Di),ue(document,"touchmove",Di)},_offUpEvents:function(){var e=this.el.ownerDocument;ue(e,"mouseup",this._onDrop),ue(e,"touchend",this._onDrop),ue(e,"pointerup",this._onDrop),ue(e,"pointercancel",this._onDrop),ue(e,"touchcancel",this._onDrop),ue(document,"selectstart",this)},_onDrop:function(e){var t=this.el,i=this.options;if(vt=_t(I),ci=_t(I,i.draggable),dt("drop",this,{evt:e}),Ie=I&&I.parentNode,vt=_t(I),ci=_t(I,i.draggable),J.eventCanceled){this._nulling();return}so=!1,Gs=!1,Wo=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Sa(this.cloneId),Sa(this._dragStartId),this.nativeDraggable&&(ue(document,"drop",this),ue(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ks&&K(document.body,"user-select",""),K(I,"transform",""),e&&(zo&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),ie&&ie.parentNode&&ie.parentNode.removeChild(ie),(Te===Ie||Je&&Je.lastPutMode!=="clone")&&Re&&Re.parentNode&&Re.parentNode.removeChild(Re),I&&(this.nativeDraggable&&ue(I,"dragend",this),ya(I),I.style["will-change"]="",zo&&!so&&ft(I,Je?Je.options.ghostClass:this.options.ghostClass,!1),ft(I,this.options.chosenClass,!1),at({sortable:this,name:"unchoose",toEl:Ie,newIndex:null,newDraggableIndex:null,originalEvent:e}),Te!==Ie?(vt>=0&&(at({rootEl:Ie,name:"add",toEl:Ie,fromEl:Te,originalEvent:e}),at({sortable:this,name:"remove",toEl:Ie,originalEvent:e}),at({rootEl:Ie,name:"sort",toEl:Ie,fromEl:Te,originalEvent:e}),at({sortable:this,name:"sort",toEl:Ie,originalEvent:e})),Je&&Je.save()):vt!==ro&&vt>=0&&(at({sortable:this,name:"update",toEl:Ie,originalEvent:e}),at({sortable:this,name:"sort",toEl:Ie,originalEvent:e})),J.active&&((vt==null||vt===-1)&&(vt=ro,ci=Bo),at({sortable:this,name:"end",toEl:Ie,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){dt("nulling",this),Te=I=Ie=ie=Mi=Re=Xs=hi=Ii=Tt=zo=vt=ci=ro=Bo=oo=$o=Je=Ws=J.dragged=J.ghost=J.clone=J.active=null,or.forEach(function(e){e.checked=!0}),or.length=Ca=_a=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":I&&(this._onDragOver(e),Vm(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,i=this.el.children,o=0,r=i.length,n=this.options;o<r;o++)t=i[o],Ot(t,n.draggable,this.el,!1)&&e.push(t.getAttribute(n.dataIdAttr)||Wm(t));return e},sort:function(e,t){var i={},o=this.el;this.toArray().forEach(function(r,n){var a=o.children[n];Ot(a,this.options.draggable,o,!1)&&(i[r]=a)},this),t&&this.captureAnimationState(),e.forEach(function(r){i[r]&&(o.removeChild(i[r]),o.appendChild(i[r]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return Ot(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var i=this.options;if(t===void 0)return i[e];var o=Go.modifyOption(this,e,t);typeof o<"u"?i[e]=o:i[e]=t,e==="group"&&rc(i)},destroy:function(){dt("destroy",this);var e=this.el;e[ct]=null,ue(e,"mousedown",this._onTapStart),ue(e,"touchstart",this._onTapStart),ue(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(ue(e,"dragover",this),ue(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),ir.splice(ir.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!hi){if(dt("hideClone",this),J.eventCanceled)return;K(Re,"display","none"),this.options.removeCloneOnHide&&Re.parentNode&&Re.parentNode.removeChild(Re),hi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(hi){if(dt("showClone",this),J.eventCanceled)return;I.parentNode==Te&&!this.options.group.revertClone?Te.insertBefore(Re,I):Mi?Te.insertBefore(Re,Mi):Te.appendChild(Re),this.options.group.revertClone&&this.animate(I,Re),K(Re,"display",""),hi=!1}}};function Vm(s){s.dataTransfer&&(s.dataTransfer.dropEffect="move"),s.cancelable&&s.preventDefault()}function js(s,e,t,i,o,r,n,a){var l,d=s[ct],c=d.options.onMove,h;return window.CustomEvent&&!mi&&!sr?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=s,l.dragged=t,l.draggedRect=i,l.related=o||e,l.relatedRect=r||ze(e),l.willInsertAfter=a,l.originalEvent=n,s.dispatchEvent(l),c&&(h=c.call(d,l,n)),h}function ya(s){s.draggable=!1}function Fm(){Ea=!1}function Nm(s,e,t){var i=ze(ao(t.el,0,t.options,!0)),o=ic(t.el,t.options,ie),r=10;return e?s.clientX<o.left-r||s.clientY<i.top&&s.clientX<i.right:s.clientY<o.top-r||s.clientY<i.bottom&&s.clientX<i.left}function zm(s,e,t){var i=ze(Oa(t.el,t.options.draggable)),o=ic(t.el,t.options,ie),r=10;return e?s.clientX>o.right+r||s.clientY>i.bottom&&s.clientX>i.left:s.clientY>o.bottom+r||s.clientX>i.right&&s.clientY>i.top}function Bm(s,e,t,i,o,r,n,a){var l=i?s.clientY:s.clientX,d=i?t.height:t.width,c=i?t.top:t.left,h=i?t.bottom:t.right,u=!1;if(!n){if(a&&Zs<d*o){if(!Wo&&($o===1?l>c+d*r/2:l<h-d*r/2)&&(Wo=!0),Wo)u=!0;else if($o===1?l<c+Zs:l>h-Zs)return-$o}else if(l>c+d*(1-o)/2&&l<h-d*(1-o)/2)return $m(e)}return u=u||n,u&&(l<c+d*r/2||l>h-d*r/2)?l>c+d/2?1:-1:0}function $m(s){return _t(I)<_t(s)?1:-1}function Wm(s){for(var e=s.tagName+s.className+s.src+s.href+s.textContent,t=e.length,i=0;t--;)i+=e.charCodeAt(t);return i.toString(36)}function Gm(s){or.length=0;for(var e=s.getElementsByTagName("input"),t=e.length;t--;){var i=e[t];i.checked&&or.push(i)}}function Qs(s){return setTimeout(s,0)}function Sa(s){return clearTimeout(s)}rr&&ve(document,"touchmove",function(s){(J.active||so)&&s.cancelable&&s.preventDefault()});J.utils={on:ve,off:ue,css:K,find:Qd,is:function(e,t){return!!Ot(e,t,e,!1)},extend:Tm,throttle:Jd,closest:Ot,toggleClass:ft,clone:tc,index:_t,nextTick:Qs,cancelNextTick:Sa,detectDirection:sc,getChild:ao,expando:ct};J.get=function(s){return s[ct]};J.mount=function(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(J.utils=Vt(Vt({},J.utils),i.utils)),Go.mount(i)})};J.create=function(s,e){return new J(s,e)};J.version=Em;var Ge=[],Ys,Yd,Um=!1;var qd;function jm(){Ge.forEach(function(s){clearInterval(s.pid)}),Ge=[]}var J0=Jd(function(s,e,t,i){if(e.scroll){var o=(s.touches?s.touches[0]:s).clientX,r=(s.touches?s.touches[0]:s).clientY,n=e.scrollSensitivity,a=e.scrollSpeed,l=Xt(),d=!1,c;Yd!==t&&(Yd=t,jm(),Ys=e.scroll,c=e.scrollFn,Ys===!0&&(Ys=er(t,!0)));var h=0,u=Ys;do{var m=u,g=ze(m),f=g.top,b=g.bottom,v=g.left,k=g.right,C=g.width,E=g.height,y=void 0,S=void 0,F=m.scrollWidth,V=m.scrollHeight,M=K(m),Y=m.scrollLeft,me=m.scrollTop;m===l?(y=C<F&&(M.overflowX==="auto"||M.overflowX==="scroll"||M.overflowX==="visible"),S=E<V&&(M.overflowY==="auto"||M.overflowY==="scroll"||M.overflowY==="visible")):(y=C<F&&(M.overflowX==="auto"||M.overflowX==="scroll"),S=E<V&&(M.overflowY==="auto"||M.overflowY==="scroll"));var re=y&&(Math.abs(k-o)<=n&&Y+C<F)-(Math.abs(v-o)<=n&&!!Y),pe=S&&(Math.abs(b-r)<=n&&me+E<V)-(Math.abs(f-r)<=n&&!!me);if(!Ge[h])for(var xe=0;xe<=h;xe++)Ge[xe]||(Ge[xe]={});(Ge[h].vx!=re||Ge[h].vy!=pe||Ge[h].el!==m)&&(Ge[h].el=m,Ge[h].vx=re,Ge[h].vy=pe,clearInterval(Ge[h].pid),(re!=0||pe!=0)&&(d=!0,Ge[h].pid=setInterval(function(){i&&this.layer===0&&J.active._onTouchMove(qd);var Qe=Ge[this.layer].vy?Ge[this.layer].vy*a:0,De=Ge[this.layer].vx?Ge[this.layer].vx*a:0;typeof c=="function"&&c.call(J.dragged.parentNode[ct],De,Qe,s,qd,Ge[this.layer].el)!=="continue"||ec(Ge[this.layer].el,De,Qe)}.bind({layer:h}),24))),h++}while(e.bubbleScroll&&u!==l&&(u=er(u,!1)));Um=d}},30),lc=function(e){var t=e.originalEvent,i=e.putSortable,o=e.dragEl,r=e.activeSortable,n=e.dispatchSortableEvent,a=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(t){var d=i||r;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,h=document.elementFromPoint(c.clientX,c.clientY);l(),d&&!d.el.contains(h)&&(n("spill"),this.onSpill({dragEl:o,putSortable:i}))}};function dc(){}dc.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var o=ao(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),i&&i.animateAll()},drop:lc};ui(dc,{pluginName:"revertOnSpill"});function cc(){}cc.prototype={onSpill:function(e){var t=e.dragEl,i=e.putSortable,o=i||this.sortable;o.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),o.animateAll()},drop:lc};ui(cc,{pluginName:"removeOnSpill"});var pi=J;function Ra(s){let{containerElement:e}=s,{onDragInit:t,onDragStart:i,onDrag:o,onDragEnd:r,preventDragFromKeys:n}=s,a,l,d,c,h,u;e||(e=document.body);let m={dragSource:e,dragHandle:null};function g(){e&&(e.addEventListener("mousedown",k),e.addEventListener("touchstart",k))}function f(y,S,F){if(typeof y=="function")return y(S,F)}function b(){e&&(e.removeEventListener("mousedown",k),e.removeEventListener("touchstart",k))}function v(y){let S=!1;return n&&n.forEach(F=>{y[F]&&(S=!0)}),S}function k(y){if(a=y.target,!v(y)){let S=y?.touches?.[0]??y,{target:F}=S;if(!s.allowDragFrom||s.allowDragFrom&&a.matches(s.allowDragFrom)||s.allowDragFromClosest&&a.closest(s.allowDragFromClosest)){m.dragHandle=a;let V=ps();l=V.left+S.clientX,d=V.top+S.clientY,c=S.clientX-S.clientX,h=S.clientY-S.clientY,m=Object.assign(m,{deltaX:c,deltaY:h,startX:l,startY:d,target:F}),f(t,y,m)!==!1&&(document.body.addEventListener("mousemove",C),document.body.addEventListener("touchmove",C),window.addEventListener("mouseup",E),window.addEventListener("touchend",E),window.addEventListener("touchcancel",E))}}}function C(y){let S=y?.touches?.[0]??y;if(!v(y)){c=S.clientX-l,h=S.clientY-d;let{target:F}=S;u||(m=Object.assign(m,{deltaX:c,deltaY:h,startX:l,startY:d,target:F}),f(i,y,m),u=!0),m=Object.assign(m,{deltaX:c,deltaY:h,startX:l,startY:d,target:F}),f(o,y,m)}}function E(y){if(document.body.removeEventListener("mousemove",C),document.body.removeEventListener("touchmove",C),window.removeEventListener("mouseup",E),window.removeEventListener("touchend",E),window.removeEventListener("touchcancel",E),u){let{target:S}=y;m=Object.assign(m,{target:S}),f(r,y,m),u=!1}}return g(),{destroy:b}}function Aa(s){let{element:e,onMouseWheel:t}=s;function i(){e.removeEventListener("wheel",r),e.removeEventListener("mousewheel",r)}function o(){e.addEventListener("wheel",r),e.addEventListener("mousewheel",r)}function r(n){let a=n||window.event,l=0,d=0,c=0;a.wheelDelta&&(l=a.wheelDelta/120),a.detail&&(l=-a.detail/3),c=l,a.axis!==void 0&&a.axis===a.HORIZONTAL_AXIS&&(c=0,d=-1*l),a.wheelDeltaY!==void 0&&(c=a.wheelDeltaY/120),a.wheelDeltaX!==void 0&&(d=-1*a.wheelDeltaX/120),typeof t=="function"&&t(n,l,d,c)}return o(),{destroy:i}}function hc(s){let{resizeableElement:e,resizeableHandleElement:t,onResizeStart:i,onResize:o,onResizeEnd:r}=s;if(!t||typeof t.addEventListener!="function")throw new Error("[SlickResizable] You did not provide a valid html element that will be used for the handle to resize.");function n(){t.addEventListener("mousedown",d),t.addEventListener("touchstart",d)}function a(){typeof t?.removeEventListener=="function"&&(t.removeEventListener("mousedown",d),t.removeEventListener("touchstart",d))}function l(u,m){if(typeof u=="function")return u(m,{resizeableElement:e,resizeableHandleElement:t})}function d(u){u.preventDefault();let m=u.touches?u.changedTouches[0]:u;l(i,m)!==!1&&(document.body.addEventListener("mousemove",c),document.body.addEventListener("mouseup",h),document.body.addEventListener("touchmove",c),document.body.addEventListener("touchend",h))}function c(u){u.preventDefault&&u.type!=="touchmove"&&u.preventDefault();let m=u.touches?u.changedTouches[0]:u;typeof o=="function"&&o(m,{resizeableElement:e,resizeableHandleElement:t})}function h(u){let m=u.touches?u.changedTouches[0]:u;l(r,m),document.body.removeEventListener("mousemove",c),document.body.removeEventListener("mouseup",h),document.body.removeEventListener("touchmove",c),document.body.removeEventListener("touchend",h)}return n(),{destroy:a}}var lo=(s,e,t,i,o,r)=>{let n=i.params||{};if(!n.formatters||!Array.isArray(n.formatters))throw new Error(`[Slickgrid-Universal] The multiple formatter requires the "formatters" to be provided as a column params.
    For example: this.columnDefinitions = [{ id: title, field: title, formatter: Formatters.multiple, params: { formatters: [Formatters.lowercase, Formatters.uppercase] }`);let a=n.formatters,l=t;return a.forEach((d,c)=>{if(typeof d!="function")throw new Error(`[Slickgrid-Universal] the "params.formatters" at index(${c}) to be used by "Formatters.multiple" is invalid, please verify all formatter functions.`);l=d.call(void 0,s,e,l,i,o,r)}),l};function La(s,e){if(Array.isArray(s)){for(let t of s)if(t.editor)if(t.formatter&&t.formatter!==lo&&t.formatter!==e){let i=t.formatter;t.formatter=lo,t.params={...t.params,formatters:[i,e]}}else t.formatter&&t.formatter===lo&&t.params?t.params.formatters.findIndex(i=>i===e)===-1&&(t.params.formatters=[...t.params.formatters,e]):t.formatter=e}}async function nr(s){let e="";try{let t=s?.grid||{},i=t.getOptions(),o=s?.cell??0,r=s?.row??0,n=s?.column,a=s?.dataContext,l=i&&(i.excelExportOptions||i.textExportOptions),d=Ym(r,o,n,a,t,l);typeof n.queryFieldNameGetterFn=="function"&&(d=$t(n,a,"")),e=d,typeof d=="string"&&(e=d.replace(/^([||]\s*)|([||])\s*/gi,"").replace(/[\u00b7|\u034f]/gi,"").trim());let c=i.clipboardWriteOverride;c?c(e):await navigator.clipboard.writeText(e)}catch(t){console.error(`Unable to read/write to clipboard. Please check your browser settings or permissions. Error: ${t}`)}return e}function Pe(s,e,t,i){let o,r,n="",a="";switch(t){case"currency":o=x.DEFAULT_FORMATTER_CURRENCY_MIN_DECIMAL,r=x.DEFAULT_FORMATTER_CURRENCY_MAX_DECIMAL;break;case"decimal":o=x.DEFAULT_FORMATTER_NUMBER_MIN_DECIMAL,r=x.DEFAULT_FORMATTER_NUMBER_MAX_DECIMAL;break;case"percent":o=x.DEFAULT_FORMATTER_PERCENT_MIN_DECIMAL,r=x.DEFAULT_FORMATTER_PERCENT_MAX_DECIMAL;break;default:break}let l=e.getOptions?.()??{},d=Zt("minDecimal",s,l,o),c=Zt("maxDecimal",s,l,r),h=Zt("decimalSeparator",s,l,x.DEFAULT_NUMBER_DECIMAL_SEPARATOR),u=Zt("thousandSeparator",s,l,x.DEFAULT_NUMBER_THOUSAND_SEPARATOR),m=Zt("displayNegativeNumberWithParentheses",s,l,x.DEFAULT_NEGATIVE_NUMBER_WRAPPED_IN_BRAQUET),g=Zt("currencyPrefix",s,l,""),f=Zt("currencySuffix",s,l,"");return i==="cell"&&(n=Zt("numberPrefix",s,l,""),a=Zt("numberSuffix",s,l,"")),{minDecimal:d,maxDecimal:c,decimalSeparator:h,thousandSeparator:u,wrapNegativeNumber:m,currencyPrefix:g,currencySuffix:f,numberPrefix:n,numberSuffix:a}}function Zt(s,e,t,i){let o=e.params;return o?.hasOwnProperty(s)?o[s]:t?.formatterOptions?.hasOwnProperty(s)?t.formatterOptions[s]:i}function uc(s,e){let t=Le(s,{withZeroPadding:!0});return(i,o,r,n,a,l)=>{let c=(l.getOptions?.()??{})?.formatterOptions?.dateSeparator??e,h=n?.type??_.date,u=Le(h,{withDefaultIso8601:!0}),m=pc(n,r,u,t);if(m&&c!==e){let g=new RegExp(e,"ig");m=m.replace(g,c)}return m}}function mc(){return(s,e,t,i)=>{let o=i?.type??_.date,r=Le(o,{withDefaultIso8601:!0}),n=i.params?.dateFormat;if(!n)throw new Error(`[Slickgrid-Universal] Using the base "Formatter.date" requires "params.outputFormat" defined and was not found in your column "${i.id}".`);return pc(i,t,r,n)}}function Ym(s,e,t,i,o,r){let n=!1;t?.hasOwnProperty("exportWithFormatter")?n=!!t.exportWithFormatter:r?.hasOwnProperty("exportWithFormatter")&&(n=!!r.exportWithFormatter);let a;i&&t.exportCustomFormatter?a=t.exportCustomFormatter:n&&t.formatter&&(a=t.formatter);let l=Pi(a,s,e,t,i,o);return r?.sanitizeDataExport&&typeof l=="string"?Ze(l):l}function Pi(s,e,t,i,o,r){let n="",l=i.field||i.id||"";if(typeof i.field=="string"&&i.field.indexOf(".")>0){let c=i.field.split(".");l=c.length>0?c[0]:i.field}let d=o?.hasOwnProperty(l)?o[l]:null;if(typeof s=="function"){let c=s(e,t,d,i,o,r),h=Dt(c)?c:c.html||c.text;n=wt(h)}else n=o?.hasOwnProperty(l)?d:"";return n==null&&(n=""),typeof n=="object"&&!(n instanceof Date)&&Object.entries(n).length===0&&(n=""),n}function pc(s,e,t,i){let o=s.params?.parseDateAsUtc??!1,r=nt(e,t),n=e;if(r){let a=o?ld(r):r;n=Fe(a,i,"en-US")}return n}var ar=class{constructor(e,t,i,o,r){if(this.container=e,this.data=t,this.columns=i,this.externalPubSub=r,this.canvas=null,this.canvas_context=null,this._defaults={alwaysShowVerticalScroll:!1,alwaysAllowHorizontalScroll:!1,explicitInitialization:!1,rowHeight:25,defaultColumnWidth:80,enableHtmlRendering:!0,enableAddRow:!1,leaveSpaceForNewRows:!1,editable:!1,autoEdit:!0,autoEditNewRow:!0,autoCommitEdit:!1,suppressActiveCellChangeOnEdit:!1,enableCellNavigation:!0,enableColumnReorder:!0,unorderableColumnCssClass:"unorderable",asyncEditorLoading:!1,asyncEditorLoadDelay:100,forceFitColumns:!1,enableAsyncPostRender:!1,asyncPostRenderDelay:50,enableAsyncPostRenderCleanup:!1,asyncPostRenderCleanupDelay:40,columnResizingDelay:300,nonce:"",editorLock:Li,showColumnHeader:!0,showHeaderRow:!1,headerRowHeight:25,createFooterRow:!1,showFooterRow:!1,footerRowHeight:25,createPreHeaderPanel:!1,createTopHeaderPanel:!1,showPreHeaderPanel:!1,showTopHeaderPanel:!1,preHeaderPanelHeight:25,preHeaderPanelWidth:"auto",topHeaderPanelHeight:25,topHeaderPanelWidth:"auto",showTopPanel:!1,topPanelHeight:25,formatterFactory:null,editorFactory:null,cellFlashingCssClass:"flashing",rowHighlightCssClass:"highlight-animate",rowHighlightDuration:400,selectedCellCssClass:"selected",multiSelect:!0,enableCellRowSpan:!1,enableTextSelectionOnCells:!1,dataItemColumnValueExtractor:null,frozenBottom:!1,frozenColumn:-1,frozenRow:-1,frozenRightViewportMinWidth:100,throwWhenFrozenNotAllViewable:!1,fullWidthRows:!1,multiColumnSort:!1,numberedMultiColumnSort:!1,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!1,defaultFormatter:this.defaultFormatter,forceSyncScrolling:!1,addNewRowCssClass:"new-row",preserveCopiedSelectionOnPaste:!1,preventDragFromKeys:["ctrlKey","metaKey"],showCellSelection:!0,viewportClass:void 0,minRowBuffer:3,emulatePagingWhenScrolling:!0,editorCellNavOnLRKeys:!1,enableMouseWheelScrollHandler:!0,doPaging:!0,rowTopOffsetRenderType:"top",scrollRenderThrottling:10,suppressCssChangesOnHiddenInit:!1,ffMaxSupportedCssHeight:6e6,maxSupportedCssHeight:1e9,maxPartialRowSpanRemap:5e3,sanitizer:void 0,mixinDefaults:!1,shadowRoot:void 0},this._columnDefaults={name:"",headerCssClass:null,defaultSortAsc:!0,focusable:!0,hidden:!1,minWidth:30,maxWidth:void 0,rerenderOnResize:!1,reorderable:!0,resizable:!0,sortable:!1,selectable:!0},this.page=0,this.offset=0,this.vScrollDir=1,this._bindingEventService=new oe,this.initialized=!1,this.uid=`slickgrid_${Math.round(1e6*Math.random())}`,this._groupHeaders=[],this._headerScroller=[],this._headers=[],this._boundAncestors=[],this.viewportH=0,this.viewportW=0,this.canvasWidth=0,this.canvasWidthL=0,this.canvasWidthR=0,this.headersWidth=0,this.headersWidthL=0,this.headersWidthR=0,this.viewportHasHScroll=!1,this.viewportHasVScroll=!1,this.headerColumnWidthDiff=0,this.headerColumnHeightDiff=0,this.cellWidthDiff=0,this.cellHeightDiff=0,this.hasFrozenRows=!1,this.frozenRowsHeight=0,this.actualFrozenRow=-1,this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.topPanelH=0,this.headerRowH=0,this.footerRowH=0,this.tabbingDirection=1,this.activeCellNode=null,this.currentEditor=null,this._prevDataLength=0,this._prevInvalidatedRowsCount=0,this._rowSpanIsCached=!1,this._colsWithRowSpanCache={},this.rowsCache={},this.renderedRows=0,this.numVisibleRows=0,this.prevScrollTop=0,this.scrollHeight=0,this.scrollTop=0,this.lastRenderedScrollTop=0,this.lastRenderedScrollLeft=0,this.prevScrollLeft=0,this.scrollLeft=0,this.selectedRows=[],this.plugins=[],this.cellCssClasses={},this.columnsById={},this.sortColumns=[],this.columnPosLeft=[],this.columnPosRight=[],this.pagingActive=!1,this.pagingIsLastPage=!1,this.postProcessedRows={},this.postProcessToRow=null,this.postProcessFromRow=null,this.postProcessedCleanupQueue=[],this.postProcessgroupId=0,this.counter_rows_rendered=0,this.counter_rows_removed=0,this.cssShow={position:"absolute",visibility:"hidden",display:"block"},this._hiddenParents=[],this.oldProps=[],this.enforceFrozenRowHeightRecalc=!1,this.columnResizeDragging=!1,this.slickDraggableInstance=null,this.slickMouseWheelInstances=[],this.slickResizableInstances=[],this._container=typeof this.container=="string"?document.querySelector(this.container):this.container,!this._container)throw new Error(`SlickGrid requires a valid container, ${this.container} does not exist in the DOM.`);this._pubSubService=r,this.onActiveCellChanged=new R("onActiveCellChanged",r),this.onActiveCellPositionChanged=new R("onActiveCellPositionChanged",r),this.onAddNewRow=new R("onAddNewRow",r),this.onAfterSetColumns=new R("onAfterSetColumns",r),this.onAutosizeColumns=new R("onAutosizeColumns",r),this.onBeforeAppendCell=new R("onBeforeAppendCell",r),this.onBeforeCellEditorDestroy=new R("onBeforeCellEditorDestroy",r),this.onBeforeColumnsResize=new R("onBeforeColumnsResize",r),this.onBeforeDestroy=new R("onBeforeDestroy",r),this.onBeforeEditCell=new R("onBeforeEditCell",r),this.onBeforeFooterRowCellDestroy=new R("onBeforeFooterRowCellDestroy",r),this.onBeforeHeaderCellDestroy=new R("onBeforeHeaderCellDestroy",r),this.onBeforeHeaderRowCellDestroy=new R("onBeforeHeaderRowCellDestroy",r),this.onBeforeRemoveCachedRow=new R("onRowRemovedFromCache",r),this.onBeforeSetColumns=new R("onBeforeSetColumns",r),this.onBeforeSort=new R("onBeforeSort",r),this.onBeforeUpdateColumns=new R("onBeforeUpdateColumns",r),this.onCellChange=new R("onCellChange",r),this.onCellCssStylesChanged=new R("onCellCssStylesChanged",r),this.onClick=new R("onClick",r),this.onColumnsReordered=new R("onColumnsReordered",r),this.onColumnsDrag=new R("onColumnsDrag",r),this.onColumnsResized=new R("onColumnsResized",r),this.onColumnsResizeDblClick=new R("onColumnsResizeDblClick",r),this.onCompositeEditorChange=new R("onCompositeEditorChange",r),this.onContextMenu=new R("onContextMenu",r),this.onDblClick=new R("onDblClick",r),this.onDrag=new R("onDrag",r),this.onDragInit=new R("onDragInit",r),this.onDragStart=new R("onDragStart",r),this.onDragEnd=new R("onDragEnd",r),this.onFooterClick=new R("onFooterClick",r),this.onFooterContextMenu=new R("onFooterContextMenu",r),this.onFooterRowCellRendered=new R("onFooterRowCellRendered",r),this.onHeaderCellRendered=new R("onHeaderCellRendered",r),this.onHeaderClick=new R("onHeaderClick",r),this.onHeaderContextMenu=new R("onHeaderContextMenu",r),this.onHeaderMouseEnter=new R("onHeaderMouseEnter",r),this.onHeaderMouseLeave=new R("onHeaderMouseLeave",r),this.onHeaderMouseOver=new R("onHeaderMouseOver",r),this.onHeaderMouseOut=new R("onHeaderMouseOut",r),this.onHeaderRowMouseOver=new R("onHeaderRowMouseOver",r),this.onHeaderRowMouseOut=new R("onHeaderRowMouseOut",r),this.onHeaderRowCellRendered=new R("onHeaderRowCellRendered",r),this.onHeaderRowMouseEnter=new R("onHeaderRowMouseEnter",r),this.onHeaderRowMouseLeave=new R("onHeaderRowMouseLeave",r),this.onKeyDown=new R("onKeyDown",r),this.onMouseEnter=new R("onMouseEnter",r),this.onMouseLeave=new R("onMouseLeave",r),this.onPreHeaderClick=new R("onPreHeaderClick",r),this.onPreHeaderContextMenu=new R("onPreHeaderContextMenu",r),this.onRendered=new R("onRendered",r),this.onScroll=new R("onScroll",r),this.onSelectedRowsChanged=new R("onSelectedRowsChanged",r),this.onSetOptions=new R("onSetOptions",r),this.onActivateChangedOptions=new R("onActivateChangedOptions",r),this.onSort=new R("onSort",r),this.onValidationError=new R("onValidationError",r),this.onViewportChanged=new R("onViewportChanged",r),this.initialize(o)}init(){!this._options.silenceWarnings&&document.body.style.zoom&&document.body.style.zoom!=="100%"&&console.warn("[Slickgrid] Zoom level other than 100% is not supported by the library and will give subpar experience. SlickGrid relies on the `rowHeight` grid option to do row positioning & calculation and when zoom is not 100% then calculation becomes all offset."),this._options.rowTopOffsetRenderType==="transform"&&(this._options.enableCellRowSpan||this._options.enableRowDetailView)&&console.warn('[Slickgrid-Universal] `rowTopOffsetRenderType` should be set to "top" when using either RowDetail and/or RowSpan since "transform" is known to have UI issues.'),this.finishInitialization()}applyHtmlCode(e,t="",i){Se(e,t,{...this._options,...i})}initialize(e){e?.mixinDefaults?(this._options||(this._options=e),w.applyDefaults(this._options,this._defaults)):this._options=fe(!0,{},this._defaults,e),this.scrollThrottle=this.actionThrottle(this.render.bind(this),this._options.scrollRenderThrottling),this.maxSupportedCssHeight=this.maxSupportedCssHeight||this.getMaxSupportedCssHeight(),this.validateAndEnforceOptions(),this._columnDefaults.width=this._options.defaultColumnWidth,this._options.suppressCssChangesOnHiddenInit||this.cacheCssForHiddenInit(),this.updateColumnProps(),this.editController={commitCurrentEdit:this.commitCurrentEdit.bind(this),cancelCurrentEdit:this.cancelCurrentEdit.bind(this)},j(this._container),this._container.style.outline=String(0),this._container.classList.add(this.uid),this._container.classList.add("slick-widget"),this._container.setAttribute("role","grid");let t=getComputedStyle(this._container);/relative|absolute|fixed/.test(t.position)||(this._container.style.position="relative"),this._focusSink=p("div",{tabIndex:0,style:{position:"fixed",width:"0px",height:"0px",top:"0px",left:"0px",outline:"0px"}},this._container),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller=p("div",{className:"slick-topheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._container),this._topHeaderPanelScroller.appendChild(document.createElement("div")),this._topHeaderPanel=p("div",null,this._topHeaderPanelScroller),this._topHeaderPanelSpacer=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._topHeaderPanelScroller),this._options.showTopHeaderPanel||w.hide(this._topHeaderPanelScroller)),this._paneHeaderL=p("div",{className:"slick-pane slick-pane-header slick-pane-left",tabIndex:0},this._container),this._paneHeaderR=p("div",{className:"slick-pane slick-pane-header slick-pane-right",tabIndex:0},this._container),this._paneTopL=p("div",{className:"slick-pane slick-pane-top slick-pane-left",tabIndex:0},this._container),this._paneTopR=p("div",{className:"slick-pane slick-pane-top slick-pane-right",tabIndex:0},this._container),this._paneBottomL=p("div",{className:"slick-pane slick-pane-bottom slick-pane-left",tabIndex:0},this._container),this._paneBottomR=p("div",{className:"slick-pane slick-pane-bottom slick-pane-right",tabIndex:0},this._container),this._options.createPreHeaderPanel&&(this._preHeaderPanelScroller=p("div",{className:"slick-preheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderL),this._preHeaderPanelScroller.appendChild(document.createElement("div")),this._preHeaderPanel=p("div",null,this._preHeaderPanelScroller),this._preHeaderPanelSpacer=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScroller),this._preHeaderPanelScrollerR=p("div",{className:"slick-preheader-panel slick-state-default",style:{overflow:"hidden",position:"relative"}},this._paneHeaderR),this._preHeaderPanelR=p("div",null,this._preHeaderPanelScrollerR),this._preHeaderPanelSpacerR=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._preHeaderPanelScrollerR),this._options.showPreHeaderPanel||(w.hide(this._preHeaderPanelScroller),w.hide(this._preHeaderPanelScrollerR))),this._headerScrollerL=p("div",{className:"slick-header slick-state-default slick-header-left"},this._paneHeaderL),this._headerScrollerR=p("div",{className:"slick-header slick-state-default slick-header-right"},this._paneHeaderR),this._headerScroller.push(this._headerScrollerL),this._headerScroller.push(this._headerScrollerR),this._headerL=p("div",{className:"slick-header-columns slick-header-columns-left",style:{left:"-1000px"}},this._headerScrollerL),this._headerR=p("div",{className:"slick-header-columns slick-header-columns-right",style:{left:"-1000px"}},this._headerScrollerR),this._headers=[this._headerL,this._headerR],this._headerRowScrollerL=p("div",{className:"slick-headerrow slick-state-default"},this._paneTopL),this._headerRowScrollerR=p("div",{className:"slick-headerrow slick-state-default"},this._paneTopR),this._headerRowScroller=[this._headerRowScrollerL,this._headerRowScrollerR],this._headerRowSpacerL=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerL),this._headerRowSpacerR=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._headerRowScrollerR),this._headerRowL=p("div",{className:"slick-headerrow-columns slick-headerrow-columns-left"},this._headerRowScrollerL),this._headerRowR=p("div",{className:"slick-headerrow-columns slick-headerrow-columns-right"},this._headerRowScrollerR),this._headerRows=[this._headerRowL,this._headerRowR],this._topPanelScrollerL=p("div",{className:"slick-top-panel-scroller slick-state-default"},this._paneTopL),this._topPanelScrollerR=p("div",{className:"slick-top-panel-scroller slick-state-default"},this._paneTopR),this._topPanelScrollers=[this._topPanelScrollerL,this._topPanelScrollerR],this._topPanelL=p("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerL),this._topPanelR=p("div",{className:"slick-top-panel",style:{width:"10000px"}},this._topPanelScrollerR),this._topPanels=[this._topPanelL,this._topPanelR],this._options.showColumnHeader||this._headerScroller.forEach(o=>{w.hide(o)}),this._options.showTopPanel||this._topPanelScrollers.forEach(o=>{w.hide(o)}),this._options.showHeaderRow||this._headerRowScroller.forEach(o=>{w.hide(o)}),this._viewportTopL=p("div",{className:"slick-viewport slick-viewport-top slick-viewport-left",tabIndex:0},this._paneTopL),this._viewportTopR=p("div",{className:"slick-viewport slick-viewport-top slick-viewport-right",tabIndex:0},this._paneTopR),this._viewportBottomL=p("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-left",tabIndex:0},this._paneBottomL),this._viewportBottomR=p("div",{className:"slick-viewport slick-viewport-bottom slick-viewport-right",tabIndex:0},this._paneBottomR),this._viewport=[this._viewportTopL,this._viewportTopR,this._viewportBottomL,this._viewportBottomR],this._options.viewportClass&&this._viewport.forEach(o=>{o.classList.add(...ae(this._options.viewportClass))}),this._activeViewportNode=this._viewportTopL,this._canvasTopL=p("div",{className:"grid-canvas grid-canvas-top grid-canvas-left",tabIndex:0},this._viewportTopL),this._canvasTopR=p("div",{className:"grid-canvas grid-canvas-top grid-canvas-right",tabIndex:0},this._viewportTopR),this._canvasBottomL=p("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-left",tabIndex:0},this._viewportBottomL),this._canvasBottomR=p("div",{className:"grid-canvas grid-canvas-bottom grid-canvas-right",tabIndex:0},this._viewportBottomR),this._canvas=[this._canvasTopL,this._canvasTopR,this._canvasBottomL,this._canvasBottomR],this.scrollbarDimensions=this.scrollbarDimensions||this.measureScrollbar();let i=this.getCanvasWidth()+this.scrollbarDimensions.width;this._activeCanvasNode=this._canvasTopL,this._topHeaderPanelSpacer&&w.width(this._topHeaderPanelSpacer,i),this._preHeaderPanelSpacer&&w.width(this._preHeaderPanelSpacer,i),this._headers.forEach(o=>{w.width(o,this.getHeadersWidth())}),w.width(this._headerRowSpacerL,i),w.width(this._headerRowSpacerR,i),this._options.createFooterRow&&(this._footerRowScrollerR=p("div",{className:"slick-footerrow slick-state-default"},this._paneTopR),this._footerRowScrollerL=p("div",{className:"slick-footerrow slick-state-default"},this._paneTopL),this._footerRowScroller=[this._footerRowScrollerL,this._footerRowScrollerR],this._footerRowSpacerL=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerL),w.width(this._footerRowSpacerL,i),this._footerRowSpacerR=p("div",{style:{display:"block",height:"1px",position:"absolute",top:"0px",left:"0px"}},this._footerRowScrollerR),w.width(this._footerRowSpacerR,i),this._footerRowL=p("div",{className:"slick-footerrow-columns slick-footerrow-columns-left"},this._footerRowScrollerL),this._footerRowR=p("div",{className:"slick-footerrow-columns slick-footerrow-columns-right"},this._footerRowScrollerR),this._footerRow=[this._footerRowL,this._footerRowR],this._options.showFooterRow||this._footerRowScroller.forEach(o=>{w.hide(o)})),this._focusSink2=this._focusSink.cloneNode(!0),this._container.appendChild(this._focusSink2),this._options.explicitInitialization||this.finishInitialization()}finishInitialization(){this.initialized||(this.initialized=!0,this.getViewportWidth(),this.getViewportHeight(),this.measureCellPaddingAndBorder(),this.disableSelection(this._headers),this._options.enableTextSelectionOnCells||this._viewport.forEach(e=>{this._bindingEventService.bind(e,"selectstart",t=>{t.target instanceof HTMLInputElement||t.target instanceof HTMLTextAreaElement})}),this.setFrozenOptions(),this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setScroller(),this.setOverflow(),this.updateColumnCaches(),this.createColumnHeaders(),this.createColumnFooter(),this.setupColumnSort(),this.createCssRules(),this.resizeCanvas(),this.bindAncestorScrollEvents(),this._bindingEventService.bind(this._container,"resize",this.resizeCanvas.bind(this)),this._viewport.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleScroll.bind(this))}),this._options.enableMouseWheelScrollHandler&&this._viewport.forEach(e=>{this.slickMouseWheelInstances.push(Aa({element:e,onMouseWheel:this.handleMouseWheel.bind(this)}))}),this._headerScroller.forEach(e=>{this._bindingEventService.bind(e,"contextmenu",this.handleHeaderContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleHeaderClick.bind(this))}),this._headerRowScroller.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleHeaderRowScroll.bind(this))}),this._options.createFooterRow&&(this._footerRow.forEach(e=>{this._bindingEventService.bind(e,"contextmenu",this.handleFooterContextMenu.bind(this)),this._bindingEventService.bind(e,"click",this.handleFooterClick.bind(this))}),this._footerRowScroller.forEach(e=>{this._bindingEventService.bind(e,"scroll",this.handleFooterRowScroll.bind(this))})),this._options.createTopHeaderPanel&&this._bindingEventService.bind(this._topHeaderPanelScroller,"scroll",this.handleTopHeaderPanelScroll.bind(this)),this._options.createPreHeaderPanel&&(this._bindingEventService.bind(this._preHeaderPanelScroller,"scroll",this.handlePreHeaderPanelScroll.bind(this)),this._bindingEventService.bind([this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],"contextmenu",this.handlePreHeaderContextMenu.bind(this)),this._bindingEventService.bind([this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],"click",this.handlePreHeaderClick.bind(this))),this._bindingEventService.bind(this._focusSink,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(this._focusSink2,"keydown",this.handleKeyDown.bind(this)),this._canvas.forEach(e=>{this._bindingEventService.bind(e,"keydown",this.handleKeyDown.bind(this)),this._bindingEventService.bind(e,"click",this.handleClick.bind(this)),this._bindingEventService.bind(e,"dblclick",this.handleDblClick.bind(this)),this._bindingEventService.bind(e,"contextmenu",this.handleContextMenu.bind(this)),this._bindingEventService.bind(e,"mouseover",this.handleCellMouseOver.bind(this)),this._bindingEventService.bind(e,"mouseout",this.handleCellMouseOut.bind(this))}),Ra&&(this.slickDraggableInstance=Ra({containerElement:this._container,allowDragFrom:"div.slick-cell",allowDragFromClosest:"div.slick-cell.dnd, div.slick-cell.cell-reorder",preventDragFromKeys:this._options.preventDragFromKeys,onDragInit:this.handleDragInit.bind(this),onDragStart:this.handleDragStart.bind(this),onDrag:this.handleDrag.bind(this),onDragEnd:this.handleDragEnd.bind(this)})),this._options.suppressCssChangesOnHiddenInit||this.restoreCssFromHiddenInit())}cacheCssForHiddenInit(){this._hiddenParents=w.parents(this._container,":hidden"),this.oldProps=[],this._hiddenParents.forEach(e=>{let t={};Object.keys(this.cssShow).forEach(i=>{this.cssShow&&(t[i]=e.style[i],e.style[i]=this.cssShow[i])}),this.oldProps.push(t)})}restoreCssFromHiddenInit(){let e=0;this._hiddenParents&&(this._hiddenParents.forEach(t=>{let i=this.oldProps[e++];Object.keys(this.cssShow).forEach(o=>{this.cssShow&&(t.style[o]=i[o])})}),this._hiddenParents=[])}hasFrozenColumns(){return this._options.frozenColumn>-1}registerPlugin(e){this.plugins.unshift(e),e.init(this)}unregisterPlugin(e){for(let t=this.plugins.length;t>=0;t--)if(this.plugins[t]===e){this.plugins[t]?.destroy(),this.plugins.splice(t,1);break}}getPluginByName(e){for(let t=this.plugins.length-1;t>=0;t--)if(this.plugins[t]?.pluginName===e)return this.plugins[t]}getPubSubService(){return this._pubSubService}setSelectionModel(e){this.selectionModel&&(this.selectionModel.onSelectedRangesChanged.unsubscribe(this.handleSelectedRangesChanged.bind(this)),this.selectionModel.destroy&&this.selectionModel.destroy()),this.selectionModel=e,this.selectionModel&&(this.selectionModel.init(this),this.selectionModel.onSelectedRangesChanged.subscribe(this.handleSelectedRangesChanged.bind(this)))}getSelectionModel(){return this.selectionModel}getCanvasNode(e,t){return this._getContainerElement(this.getCanvases(),e,t)}getActiveCanvasNode(e){return e===void 0?this._activeCanvasNode:(e instanceof U&&(e=e.getNativeEvent()),this._activeCanvasNode=e?.target?.closest(".grid-canvas"),this._activeCanvasNode)}getCanvases(){return this._canvas}getViewportNode(e,t){return this._getContainerElement(this.getViewports(),e,t)}getViewports(){return this._viewport}getActiveViewportNode(e){return this.setActiveViewportNode(e),this._activeViewportNode}setActiveViewportNode(e){return e instanceof U&&(e=e.getNativeEvent()),this._activeViewportNode=e?.target?.closest(".slick-viewport"),this._activeViewportNode}_getContainerElement(e,t,i){if(!e)return;t||(t=0),i||(i=0);let o=typeof t=="number"?t:this.getColumnIndex(t),r=this.hasFrozenRows&&i>=this.actualFrozenRow+(this._options.frozenBottom?0:1),n=this.hasFrozenColumns()&&o>this._options.frozenColumn;return e[(r?2:0)+(n?1:0)]}measureScrollbar(){let e="";this._viewport.forEach(r=>e+=r.className);let t=p("div",{className:e,style:{position:"absolute",top:"-10000px",left:"-10000px",overflow:"auto",width:"100px",height:"100px"}},document.body),i=p("div",{style:{width:"200px",height:"200px",overflow:"auto"}},t),o={width:t.offsetWidth-t.clientWidth,height:t.offsetHeight-t.clientHeight};return i.remove(),t.remove(),o}getHeadersWidth(){this.headersWidth=this.headersWidthL=this.headersWidthR=0;let e=!this._options.autoHeight,t=0,i=this.columns.length;for(t=0;t<i;t++){if(!this.columns[t]||this.columns[t].hidden)continue;let o=this.columns[t].width;this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=o||0:this.headersWidthL+=o||0}return e&&(this._options.frozenColumn>-1&&t>this._options.frozenColumn?this.headersWidthR+=this.scrollbarDimensions?.width||0:this.headersWidthL+=this.scrollbarDimensions?.width||0),this.hasFrozenColumns()?(this.headersWidthL=this.headersWidthL+1e3,this.headersWidthR=Math.max(this.headersWidthR,this.viewportW)+this.headersWidthL,this.headersWidthR+=this.scrollbarDimensions?.width||0):(this.headersWidthL+=this.scrollbarDimensions?.width||0,this.headersWidthL=Math.max(this.headersWidthL,this.viewportW)+1e3),this.headersWidth=this.headersWidthL+this.headersWidthR,Math.max(this.headersWidth,this.viewportW)+1e3}getCanvasWidth(){let e=this.getViewportInnerWidth(),t=this.columns.length;for(this.canvasWidthL=this.canvasWidthR=0;t--;)!this.columns[t]||this.columns[t].hidden||(this.hasFrozenColumns()&&t>this._options.frozenColumn?this.canvasWidthR+=this.columns[t].width||0:this.canvasWidthL+=this.columns[t].width||0);let i=this.canvasWidthL+this.canvasWidthR;if(this._options.fullWidthRows){let o=Math.max(i,e)-i;o>0&&(i+=o,this.hasFrozenColumns()?this.canvasWidthR+=o:this.canvasWidthL+=o)}return i}updateCanvasWidth(e){let t=this.canvasWidth,i=this.canvasWidthL,o=this.canvasWidthR;this.canvasWidth=this.getCanvasWidth(),this._options.createTopHeaderPanel&&w.width(this._topHeaderPanel,this._options.topHeaderPanelWidth??this.canvasWidth);let r=this.canvasWidth!==t||this.canvasWidthL!==i||this.canvasWidthR!==o;if(r||this.hasFrozenColumns()||this.hasFrozenRows)if(w.width(this._canvasTopL,this.canvasWidthL),this.getHeadersWidth(),w.width(this._headerL,this.headersWidthL),w.width(this._headerR,this.headersWidthR),this.hasFrozenColumns()){let n=w.width(this._container)||0;if(n>0&&this.canvasWidthL>n&&this._options.throwWhenFrozenNotAllViewable)throw new Error("[SlickGrid] Frozen columns cannot be wider than the actual grid container width. Make sure to have less columns freezed or make your grid container wider");w.width(this._canvasTopR,this.canvasWidthR),w.width(this._paneHeaderL,this.canvasWidthL),w.setStyleSize(this._paneHeaderR,"left",this.canvasWidthL),w.setStyleSize(this._paneHeaderR,"width",this.viewportW-this.canvasWidthL),w.width(this._paneTopL,this.canvasWidthL),w.setStyleSize(this._paneTopR,"left",this.canvasWidthL),w.width(this._paneTopR,this.viewportW-this.canvasWidthL),w.width(this._headerRowScrollerL,this.canvasWidthL),w.width(this._headerRowScrollerR,this.viewportW-this.canvasWidthL),w.width(this._headerRowL,this.canvasWidthL),w.width(this._headerRowR,this.canvasWidthR),this._options.createFooterRow&&(w.width(this._footerRowScrollerL,this.canvasWidthL),w.width(this._footerRowScrollerR,this.viewportW-this.canvasWidthL),w.width(this._footerRowL,this.canvasWidthL),w.width(this._footerRowR,this.canvasWidthR)),this._options.createPreHeaderPanel&&w.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),w.width(this._viewportTopL,this.canvasWidthL),w.width(this._viewportTopR,this.viewportW-this.canvasWidthL),this.hasFrozenRows&&(w.width(this._paneBottomL,this.canvasWidthL),w.setStyleSize(this._paneBottomR,"left",this.canvasWidthL),w.width(this._viewportBottomL,this.canvasWidthL),w.width(this._viewportBottomR,this.viewportW-this.canvasWidthL),w.width(this._canvasBottomL,this.canvasWidthL),w.width(this._canvasBottomR,this.canvasWidthR))}else w.width(this._paneHeaderL,"100%"),w.width(this._paneTopL,"100%"),w.width(this._headerRowScrollerL,"100%"),w.width(this._headerRowL,this.canvasWidth),this._options.createFooterRow&&(w.width(this._footerRowScrollerL,"100%"),w.width(this._footerRowL,this.canvasWidth)),this._options.createPreHeaderPanel&&w.width(this._preHeaderPanel,this._options.preHeaderPanelWidth??this.canvasWidth),w.width(this._viewportTopL,"100%"),this.hasFrozenRows&&(w.width(this._viewportBottomL,"100%"),w.width(this._canvasBottomL,this.canvasWidthL));this.viewportHasHScroll=this.canvasWidth>=this.viewportW-(this.scrollbarDimensions?.width||0),w.width(this._headerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),w.width(this._headerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),this._options.createFooterRow&&(w.width(this._footerRowSpacerL,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0)),w.width(this._footerRowSpacerR,this.canvasWidth+(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0))),(r||e)&&this.applyColumnWidths()}disableSelection(e){e.forEach(t=>{t.setAttribute("unselectable","on"),t.style.mozUserSelect="none",this._bindingEventService.bind(t,"selectstart",()=>!1)})}getMaxSupportedCssHeight(){let e=1e6,t=navigator.userAgent.toLowerCase().match(/firefox/)?this._options.ffMaxSupportedCssHeight:this._options.maxSupportedCssHeight,i=p("div",{style:{display:"hidden"}},document.body),o=!0;for(;o;){let r=e*2;w.height(i,r);let n=w.height(i);if(r>t||n!==r){o=!1;break}else e=r}return i.remove(),e}getUID(){return this.uid}getHeaderColumnWidthDiff(){return this.headerColumnWidthDiff}getScrollbarDimensions(){return this.scrollbarDimensions}getDisplayedScrollbarDimensions(){return{width:this.viewportHasVScroll&&this.scrollbarDimensions?.width?this.scrollbarDimensions.width:0,height:this.viewportHasHScroll&&this.scrollbarDimensions?.height?this.scrollbarDimensions.height:0}}getAbsoluteColumnMinWidth(){return this.absoluteColumnMinWidth}bindAncestorScrollEvents(){let e=this.hasFrozenRows&&!this._options.frozenBottom?this._canvasBottomL:this._canvasTopL;for(;(e=e.parentNode)!==document.body&&e;)(e===this._viewportTopL||e.scrollWidth!==e.clientWidth||e.scrollHeight!==e.clientHeight)&&(this._boundAncestors.push(e),this._bindingEventService.bind(e,"scroll",this.handleActiveCellPositionChange.bind(this)))}unbindAncestorScrollEvents(){this._boundAncestors.forEach(e=>{this._bindingEventService.unbindByEventName(e,"scroll")}),this._boundAncestors=[]}updateColumnHeader(e,t,i){if(this.initialized){let o=this.getColumnIndex(e);if(!q(o))return;let r=this.columns[o],n=this.getColumnByIndex(o);return n&&(t!==void 0&&(this.columns[o].name=t),i!==void 0&&(this.columns[o].toolTip=i),this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:n,column:r,grid:this}),n.setAttribute("title",i||""),t!==void 0&&Se(n.children[0],t,this._options),this.triggerEvent(this.onHeaderCellRendered,{node:n,column:r,grid:this})),n}}getHeader(e){if(!e)return this.hasFrozenColumns()?this._headers:this._headerL;let t=this.getColumnIndex(e.id);return this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL}getHeaderColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),i=this.hasFrozenColumns()?t<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,o=this.hasFrozenColumns()?t<=this._options.frozenColumn?t:t-this._options.frozenColumn-1:t;return i.children[o]}getHeaderRow(){return this.hasFrozenColumns()?this._headerRows:this._headerRows?.[0]}getFooterRow(){return this.hasFrozenColumns()?this._footerRow:this._footerRow?.[0]}getPreHeaderPanel(){return this._preHeaderPanel}getPreHeaderPanelLeft(){return this._preHeaderPanel}getPreHeaderPanelRight(){return this._preHeaderPanelR}getTopHeaderPanel(){return this._topHeaderPanel}getHeaderRowColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),i;return this.hasFrozenColumns()?t<=this._options.frozenColumn?i=this._headerRowL:(i=this._headerRowR,t-=this._options.frozenColumn+1):i=this._headerRowL,i.children[t]}getFooterRowColumn(e){let t=typeof e=="number"?e:this.getColumnIndex(e),i;return this.hasFrozenColumns()?t<=this._options.frozenColumn?i=this._footerRowL:(i=this._footerRowR,t-=this._options.frozenColumn+1):i=this._footerRowL,i?.children[t]}createColumnFooter(){if(this._options.createFooterRow){this._footerRow.forEach(e=>{e.querySelectorAll(".slick-footerrow-column").forEach(i=>{let o=w.storage.get(i,"column");this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:i,column:o,grid:this})})}),j(this._footerRowL),j(this._footerRowR);for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(!t||t.hidden)continue;let i=p("div",{className:`slick-state-default slick-footerrow-column l${e} r${e}`},this.hasFrozenColumns()&&e>this._options.frozenColumn?this._footerRowR:this._footerRowL),o=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;o&&i.classList.add(o),w.storage.put(i,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:i,column:t,grid:this})}}}handleHeaderMouseHoverOn(e){e?.target.classList.add("slick-state-hover")}handleHeaderMouseHoverOff(e){e?.target.classList.remove("slick-state-hover")}createColumnHeaders(){this._headers.forEach(e=>{e.querySelectorAll(".slick-header-column").forEach(i=>{let o=w.storage.get(i,"column");o&&this.triggerEvent(this.onBeforeHeaderCellDestroy,{node:i,column:o,grid:this})})}),j(this._headerL),j(this._headerR),this.getHeadersWidth(),w.width(this._headerL,this.headersWidthL),w.width(this._headerR,this.headersWidthR),this._headerRows.forEach(e=>{e.querySelectorAll(".slick-headerrow-column").forEach(i=>{let o=w.storage.get(i,"column");o&&this.triggerEvent(this.onBeforeHeaderRowCellDestroy,{node:this,column:o,grid:this})})}),j(this._headerRowL),j(this._headerRowR),this._options.createFooterRow&&(this._footerRowL.querySelectorAll(".slick-footerrow-column").forEach(t=>{let i=w.storage.get(t,"column");i&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:i,grid:this})}),j(this._footerRowL),this.hasFrozenColumns()&&(this._footerRowR.querySelectorAll(".slick-footerrow-column").forEach(i=>{let o=w.storage.get(i,"column");o&&this.triggerEvent(this.onBeforeFooterRowCellDestroy,{node:this,column:o,grid:this})}),j(this._footerRowR)));for(let e=0;e<this.columns.length;e++){let t=this.columns[e];if(!t||t.hidden)continue;let i=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerL:this._headerR:this._headerL,o=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._headerRowL:this._headerRowR:this._headerRowL,r=p("div",{id:`${this.uid+t.id}`,dataset:{id:String(t.id)},role:"columnheader",className:"slick-state-default slick-header-column"},i);t.toolTip&&(r.title=t.toolTip),t.reorderable||r.classList.add(this._options.unorderableColumnCssClass);let n=p("span",{className:"slick-column-name"},r);Se(n,t.name,this._options),w.width(r,t.width-this.headerColumnWidthDiff);let a=t.headerCssClass||null;if(a&&r.classList.add(...ae(a)),a=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null,a&&r.classList.add(a),this._bindingEventService.bind(r,"mouseenter",this.handleHeaderMouseEnter.bind(this)),this._bindingEventService.bind(r,"mouseleave",this.handleHeaderMouseLeave.bind(this)),this._bindingEventService.bind(r,"mouseover",this.handleHeaderMouseOver.bind(this)),this._bindingEventService.bind(r,"mouseout",this.handleHeaderMouseOut.bind(this)),w.storage.put(r,"column",t),(this._options.enableColumnReorder||t.sortable)&&(this._bindingEventService.bind(r,"mouseenter",this.handleHeaderMouseHoverOn.bind(this)),this._bindingEventService.bind(r,"mouseleave",this.handleHeaderMouseHoverOff.bind(this))),t.hasOwnProperty("headerCellAttrs")&&t.headerCellAttrs instanceof Object&&Object.keys(t.headerCellAttrs).forEach(l=>{t.headerCellAttrs.hasOwnProperty(l)&&r.setAttribute(l,t.headerCellAttrs[l])}),t.sortable&&(r.classList.add("slick-header-sortable"),p("div",{className:`slick-sort-indicator ${this._options.numberedMultiColumnSort&&!this._options.sortColNumberInSeparateSpan?" slick-sort-indicator-numbered":""}`},r),this._options.numberedMultiColumnSort&&this._options.sortColNumberInSeparateSpan&&p("div",{className:"slick-sort-indicator-numbered"},r)),this.triggerEvent(this.onHeaderCellRendered,{node:r,column:t,grid:this}),this._options.showHeaderRow){let l=p("div",{className:`slick-state-default slick-headerrow-column l${e} r${e}`},o),d=this.hasFrozenColumns()&&e<=this._options.frozenColumn?"frozen":null;d&&l.classList.add(d),this._bindingEventService.bind(l,"mouseenter",this.handleHeaderRowMouseEnter.bind(this)),this._bindingEventService.bind(l,"mouseleave",this.handleHeaderRowMouseLeave.bind(this)),this._bindingEventService.bind(l,"mouseover",this.handleHeaderRowMouseOver.bind(this)),this._bindingEventService.bind(l,"mouseout",this.handleHeaderRowMouseOut.bind(this)),w.storage.put(l,"column",t),this.triggerEvent(this.onHeaderRowCellRendered,{node:l,column:t,grid:this})}if(this._options.createFooterRow&&this._options.showFooterRow){let l=this.hasFrozenColumns()?e<=this._options.frozenColumn?this._footerRow[0]:this._footerRow[1]:this._footerRow[0],d=p("div",{className:`slick-state-default slick-footerrow-column l${e} r${e}`},l);w.storage.put(d,"column",t),this.triggerEvent(this.onFooterRowCellRendered,{node:d,column:t,grid:this})}}this.setSortColumns(this.sortColumns),this.setupColumnResize(),this._options.enableColumnReorder&&(typeof this._options.enableColumnReorder=="function"?this._options.enableColumnReorder(this,this._headers,this.headerColumnWidthDiff,this.setColumns,this.setupColumnResize,this.columns,this.getColumnIndex,this.uid,this.triggerEvent):this.setupColumnReorder())}setupColumnSort(){this._headers.forEach(e=>{this._bindingEventService.bind(e,"click",t=>{if(this.columnResizeDragging||t.target.classList.contains("slick-resizable-handle"))return;let i=t.target.closest(".slick-header-column");if(!i)return;let o=w.storage.get(i,"column");if(o?.sortable){if(!this.getEditorLock()?.commitCurrentEdit())return;let r=this.sortColumns.slice(),n=null,a=0;for(;a<this.sortColumns.length;a++)if(this.sortColumns[a].columnId===o.id){n=this.sortColumns[a],n.sortAsc=!n.sortAsc;break}let l=!!n;this._options.tristateMultiColumnSort?(n||(n={columnId:o.id,sortAsc:o.defaultSortAsc,sortCol:o}),l&&n.sortAsc&&(this.sortColumns.splice(a,1),n=null),this._options.multiColumnSort||(this.sortColumns=[]),n&&(!l||!this._options.multiColumnSort)&&this.sortColumns.push(n)):t.metaKey&&this._options.multiColumnSort?n&&this.sortColumns.splice(a,1):((!t.shiftKey&&!t.metaKey||!this._options.multiColumnSort)&&(this.sortColumns=[]),n?this.sortColumns.length===0&&this.sortColumns.push(n):(n={columnId:o.id,sortAsc:o.defaultSortAsc,sortCol:o},this.sortColumns.push(n)));let d;this._options.multiColumnSort?d={multiColumnSort:!0,previousSortColumns:r,sortCols:this.sortColumns.map(c=>{let h=this.columns[this.getColumnIndex(c.columnId)];return h&&!h.hidden?{columnId:h.id,sortCol:h,sortAsc:c.sortAsc}:null}).filter(c=>c)}:d={multiColumnSort:!1,previousSortColumns:r,columnId:this.sortColumns.length>0?o.id:null,sortCol:this.sortColumns.length>0?o:null,sortAsc:this.sortColumns.length>0?this.sortColumns[0].sortAsc:!0},this.triggerEvent(this.onBeforeSort,d,t).getReturnValue()!==!1&&(this.setSortColumns(this.sortColumns),this.triggerEvent(this.onSort,d,t))}})})}setupColumnReorder(){this.sortableSideLeftInstance?.destroy(),this.sortableSideRightInstance?.destroy();let e,t=()=>this._viewportScrollContainerX.scrollLeft+=10,i=()=>this._viewportScrollContainerX.scrollLeft-=10,o=[],r=!1,n={animation:50,direction:"horizontal",ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dragoverBubble:!1,revertClone:!0,scroll:!this.hasFrozenColumns(),filter:`.${this._options.unorderableColumnCssClass}`,onMove:a=>!a.related.classList.contains(this._options.unorderableColumnCssClass),onStart:a=>{a.item.classList.add("slick-header-column-active"),r=!this.hasFrozenColumns()||_e(a.item).left>_e(this._viewportScrollContainerX).left,r&&a.originalEvent.pageX>this._container.clientWidth?e||(e=setInterval(t,100)):r&&a.originalEvent.pageX<_e(this._viewportScrollContainerX).left?e||(e=setInterval(i,100)):clearInterval(e),o=this.columns.map(l=>l.id)},onEnd:a=>{if(a.item.classList.remove("slick-header-column-active"),clearInterval(e),!this.getEditorLock()?.commitCurrentEdit())return;let l=this.sortableSideLeftInstance?.toArray()??[];l=l.concat(this.sortableSideRightInstance?.toArray()??[]);let d=[];for(let c=0;c<l.length;c++)d.push(this.columns[this.getColumnIndex(l[c])]);a.stopPropagation(),this.arrayEquals(o,l)||(this.setColumns(d),this.triggerEvent(this.onColumnsReordered,{impactedColumns:this.columns,previousColumnOrder:o}),this.setupColumnResize()),this.activeCellNode&&this.setFocus()}};this.sortableSideLeftInstance=pi.create(this._headerL,n),this.sortableSideRightInstance=pi.create(this._headerR,n)}getHeaderChildren(){let e=Array.from(this._headers[0].children),t=Array.from(this._headers[1].children);return e.concat(t)}handleResizeableDoubleClick(e){let t=e.target.parentElement.id.replace(this.uid,"");this.triggerEvent(this.onColumnsResizeDblClick,{triggeredByColumn:t})}setupColumnResize(){let e,t,i,o,r,n,a,l=-1,d=0,c=this.getHeaderChildren(),h=this.getVisibleColumns();for(let u=0;u<c.length;u++)c[u].querySelectorAll(".slick-resizable-handle").forEach(f=>f.remove()),u<h.length&&h[u]?.resizable&&(a===void 0&&(a=u),l=u);if(a!==void 0)for(let u=0;u<c.length;u++){let m=c[u];if(u>=h.length||!h[u]||u<a||this._options.forceFitColumns&&u>=l)continue;let g=p("div",{className:"slick-resizable-handle",role:"separator",ariaOrientation:"horizontal"},m);this._bindingEventService.bind(g,"dblclick",this.handleResizeableDoubleClick.bind(this)),this.slickResizableInstances.push(hc({resizeableElement:m,resizeableHandleElement:g,onResizeStart:(f,b)=>{let v=f.touches?f.changedTouches[0]:f;if(!this.getEditorLock()?.commitCurrentEdit())return!1;o=v.pageX,d=0,b.resizeableElement.classList.add("slick-header-column-active");let k=null,C=null;for(let S=0;S<c.length;S++)S<h.length&&h[S]&&(h[S].previousWidth=c[S].offsetWidth);if(this._options.forceFitColumns)for(k=0,C=0,e=u+1;e<h.length;e++)i=h[e],i?.resizable&&(C!==null&&(i.maxWidth?C+=i.maxWidth-(i.previousWidth||0):C=null),k+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));let E=0,y=0;for(e=0;e<=u;e++)i=h[e],i?.resizable&&(y!==null&&(i.maxWidth?y+=i.maxWidth-(i.previousWidth||0):y=null),E+=(i.previousWidth||0)-Math.max(i.minWidth||0,this.absoluteColumnMinWidth));n=o+Math.min(k??1e5,y??1e5),r=o-Math.min(E??1e5,C??1e5)},onResize:(f,b)=>{let v=f.touches?f.changedTouches[0]:f;this.columnResizeDragging=!0;let k,C=v.pageX,E=Math.min(n,Math.max(r,C))-o,y,S=0,F=0,V=this.getViewportInnerWidth();if(E<0){for(y=E,e=u;e>=0;e--)i=h[e],i&&i.resizable&&!i.hidden&&(k=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),y&&(i.previousWidth||0)+y<k?(y+=(i.previousWidth||0)-k,i.width=k):(i.width=(i.previousWidth||0)+y,y=0));for(t=0;t<=u;t++)i=h[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?F+=i.width||0:S+=i.width||0);if(this._options.forceFitColumns)for(y=-E,e=u+1;e<h.length;e++)i=h[e],i&&!i.hidden&&i.resizable&&(y&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<y?(y-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+y,y=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?F+=i.width||0:S+=i.width||0);else for(e=u+1;e<h.length;e++)i=h[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?F+=i.width||0:S+=i.width||0);if(this._options.forceFitColumns)for(y=-E,e=u+1;e<h.length;e++)i=h[e],i&&!i.hidden&&i.resizable&&(y&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<y?(y-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth):(i.width=(i.previousWidth||0)+y,y=0))}else{for(y=E,S=0,F=0,e=u;e>=0;e--)if(i=h[e],i&&!i.hidden&&i.resizable)if(y&&i.maxWidth&&i.maxWidth-(i.previousWidth||0)<y)y-=i.maxWidth-(i.previousWidth||0),i.width=i.maxWidth;else{let M=(i.previousWidth||0)+y,Y=this.canvasWidthL+y;this.hasFrozenColumns()&&e<=this._options.frozenColumn?(M>d&&Y<V-this._options.frozenRightViewportMinWidth&&(d=M),i.width=Y+this._options.frozenRightViewportMinWidth>V?d:M):i.width=M,y=0}for(t=0;t<=u;t++)i=h[t],i&&!i.hidden&&(this.hasFrozenColumns()&&t>this._options.frozenColumn?F+=i.width||0:S+=i.width||0);if(this._options.forceFitColumns)for(y=-E,e=u+1;e<h.length;e++)i=h[e],i&&!i.hidden&&i.resizable&&(k=Math.max(i.minWidth||0,this.absoluteColumnMinWidth),y&&(i.previousWidth||0)+y<k?(y+=(i.previousWidth||0)-k,i.width=k):(i.width=(i.previousWidth||0)+y,y=0),this.hasFrozenColumns()&&e>this._options.frozenColumn?F+=i.width||0:S+=i.width||0);else for(e=u+1;e<h.length;e++)i=h[e],i&&!i.hidden&&(this.hasFrozenColumns()&&e>this._options.frozenColumn?F+=i.width||0:S+=i.width||0)}this.hasFrozenColumns()&&S!==this.canvasWidthL&&(w.width(this._headerL,S+1e3),w.setStyleSize(this._paneHeaderR,"left",S)),this.applyColumnHeaderWidths(),this._options.syncColumnCellResize&&this.applyColumnWidths(),this.triggerEvent(this.onColumnsDrag,{triggeredByColumn:b.resizeableElement,resizeHandle:b.resizeableHandleElement})},onResizeEnd:(f,b)=>{b.resizeableElement.classList.remove("slick-header-column-active");let v=b.resizeableElement.id.replace(this.uid,"");this.triggerEvent(this.onBeforeColumnsResize,{triggeredByColumn:v}).getReturnValue()===!0&&this.applyColumnHeaderWidths();let k;for(e=0;e<h.length;e++)i=h[e],i&&!i.hidden&&c[e]&&(k=c[e].offsetWidth,i.previousWidth!==k&&i.rerenderOnResize&&this.invalidateAllRows());this.updateCanvasWidth(!0),this.render(),this.triggerEvent(this.onColumnsResized,{triggeredByColumn:v}),clearTimeout(this._columnResizeTimer),this._columnResizeTimer=setTimeout(()=>this.columnResizeDragging=!1,this._options.columnResizingDelay)}}))}}getVBoxDelta(e){let t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=getComputedStyle(e),o=0;return t.forEach(r=>o+=w.toFloat(i[r])),o}setFrozenOptions(){if(this._options.frozenColumn=this._options.frozenColumn>=0&&this._options.frozenColumn<this.columns.length?parseInt(this._options.frozenColumn,10):-1,this._options.frozenRow>-1){this.hasFrozenRows=!0,this.frozenRowsHeight=this._options.frozenRow*this._options.rowHeight;let e=this.getDataLength();this.actualFrozenRow=this._options.frozenBottom?e-this._options.frozenRow:this._options.frozenRow}else this.hasFrozenRows=!1}setPaneFrozenClasses(){let e=this.hasFrozenColumns()?"add":"remove";for(let t of[this._paneHeaderL,this._paneTopL,this._paneBottomL])t.classList[e]("frozen")}setPaneVisibility(){this.hasFrozenColumns()?(w.show(this._paneHeaderR),w.show(this._paneTopR),this.hasFrozenRows?(w.show(this._paneBottomL),w.show(this._paneBottomR)):(w.hide(this._paneBottomR),w.hide(this._paneBottomL))):(w.hide(this._paneHeaderR),w.hide(this._paneTopR),w.hide(this._paneBottomR),this.hasFrozenRows?w.show(this._paneBottomL):(w.hide(this._paneBottomR),w.hide(this._paneBottomL)))}setOverflow(){if(this._viewportTopL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportTopR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"scroll":this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"hidden":"auto",this._viewportTopR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?this.hasFrozenRows?"scroll":"auto":this.hasFrozenRows?"scroll":"auto",this._viewportBottomL.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomL.style.overflowY=!this.hasFrozenColumns()&&this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"hidden"):this.hasFrozenRows?"scroll":"auto",this._viewportBottomR.style.overflowX=this.hasFrozenColumns()?this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll?"scroll":"auto":(this.hasFrozenRows&&!this._options.alwaysAllowHorizontalScroll,"auto"),this._viewportBottomR.style.overflowY=this._options.alwaysShowVerticalScroll?"scroll":this.hasFrozenColumns()?(this.hasFrozenRows,"auto"):(this.hasFrozenRows,"auto"),this._options.viewportClass){let e=ae(this._options.viewportClass);this._viewportTopL.classList.add(...e),this._viewportTopR.classList.add(...e),this._viewportBottomL.classList.add(...e),this._viewportBottomR.classList.add(...e)}}setScroller(){this.hasFrozenColumns()?(this._headerScrollContainer=this._headerScrollerR,this._headerRowScrollContainer=this._headerRowScrollerR,this._footerRowScrollContainer=this._footerRowScrollerR,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomR,this._viewportScrollContainerY=this._viewportTopR):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomR:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopR):(this._headerScrollContainer=this._headerScrollerL,this._headerRowScrollContainer=this._headerRowScrollerL,this._footerRowScrollContainer=this._footerRowScrollerL,this.hasFrozenRows?this._options.frozenBottom?(this._viewportScrollContainerX=this._viewportBottomL,this._viewportScrollContainerY=this._viewportTopL):this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportBottomL:this._viewportScrollContainerX=this._viewportScrollContainerY=this._viewportTopL)}measureCellPaddingAndBorder(){let e=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],t=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],i=this._headers[0];this.headerColumnWidthDiff=this.headerColumnHeightDiff=0,this.cellWidthDiff=this.cellHeightDiff=0;let o=p("div",{className:"slick-state-default slick-header-column",style:{visibility:"hidden"},textContent:"-"},i),r=getComputedStyle(o);r.boxSizing!=="border-box"&&(e.forEach(a=>this.headerColumnWidthDiff+=w.toFloat(r[a])),t.forEach(a=>this.headerColumnHeightDiff+=w.toFloat(r[a]))),o.remove();let n=p("div",{className:"slick-row"},this._canvas[0]);o=p("div",{className:"slick-cell",id:"",style:{visibility:"hidden"},textContent:"-"},n),r=getComputedStyle(o),r.boxSizing!=="border-box"&&(e.forEach(a=>this.cellWidthDiff+=w.toFloat(r[a])),t.forEach(a=>this.cellHeightDiff+=w.toFloat(r[a]))),n.remove(),this.absoluteColumnMinWidth=Math.max(this.headerColumnWidthDiff,this.cellWidthDiff)}createCssRules(){this._style=document.createElement("style"),this._style.nonce=this._options.nonce||"",(this._options.shadowRoot||document.head).appendChild(this._style);let e=this._options.rowHeight-this.cellHeightDiff,t=[`.${this.uid} .slick-group-header-column { left: 1000px; }`,`.${this.uid} .slick-header-column { left: 1000px; }`,`.${this.uid} .slick-top-panel { height: ${this._options.topPanelHeight}px; }`,`.${this.uid} .slick-preheader-panel { height: ${this._options.preHeaderPanelHeight}px; }`,`.${this.uid} .slick-topheader-panel { height: ${this._options.topHeaderPanelHeight}px; }`,`.${this.uid} .slick-headerrow-columns { height: ${this._options.headerRowHeight}px; }`,`.${this.uid} .slick-footerrow-columns { height: ${this._options.footerRowHeight}px; }`,`.${this.uid} .slick-cell { height: ${e}px; }`,`.${this.uid} .slick-row { height: ${this._options.rowHeight}px; }`],i=this._style.sheet;if(i){t.forEach(o=>i.insertRule(o));for(let o=0;o<this.columns.length;o++)this.columns[o]&&!this.columns[o].hidden&&(i.insertRule(`.${this.uid} .l${o} { }`),i.insertRule(`.${this.uid} .r${o} { }`))}else this.createCssRulesAlternative(t)}createCssRulesAlternative(e){let t=document.createElement("template");t.innerHTML='<style type="text/css" rel="stylesheet" />',this._style=t.content.firstChild,(this._options.shadowRoot||document.head).appendChild(this._style);for(let i=0;i<this.columns.length;i++)this.columns[i]&&!this.columns[i].hidden&&(e.push(`.${this.uid} .l${i} { }`),e.push(`.${this.uid} .r${i} { }`));this._style.styleSheet?this._style.styleSheet.cssText=e.join(" "):this._style.appendChild(document.createTextNode(e.join(" ")))}getColumnCssRules(e){let t;if(!this.stylesheet){let i=(this._options.shadowRoot||document).styleSheets;for(this._options.devMode&&typeof this._options.devMode.ownerNodeIndex=="number"&&this._options.devMode.ownerNodeIndex>=0&&(i[this._options.devMode.ownerNodeIndex].ownerNode=this._style),t=0;t<i.length;t++){let a=i[t];if((a.ownerNode||a.owningElement)===this._style){this.stylesheet=a;break}}if(!this.stylesheet)throw new Error("SlickGrid Cannot find stylesheet.");this.columnCssRulesL=[],this.columnCssRulesR=[];let o=this.stylesheet.cssRules||this.stylesheet.rules,r,n;for(t=0;t<o.length;t++){let a=o[t].selectorText;(r=/\.l\d+/.exec(a))?(n=parseInt(r[0].substr(2,r[0].length-2),10),this.columnCssRulesL[n]=o[t]):(r=/\.r\d+/.exec(a))&&(n=parseInt(r[0].substr(2,r[0].length-2),10),this.columnCssRulesR[n]=o[t])}}return{left:this.columnCssRulesL[e],right:this.columnCssRulesR[e]}}removeCssRules(){this._style?.remove(),this.stylesheet=null}clearAllTimers(){clearTimeout(this._columnResizeTimer),clearTimeout(this._executionBlockTimer),clearTimeout(this._flashCellTimer),clearTimeout(this._highlightRowTimer),clearTimeout(this.h_editorLoader)}destroy(e){this._bindingEventService.unbindAll(),this.slickDraggableInstance=this.destroyAllInstances(this.slickDraggableInstance),this.slickMouseWheelInstances=this.destroyAllInstances(this.slickMouseWheelInstances),this.slickResizableInstances=this.destroyAllInstances(this.slickResizableInstances),this.getEditorLock()?.cancelCurrentEdit(),this.triggerEvent(this.onBeforeDestroy,{});let t=this.plugins.length;for(;t--;)this.unregisterPlugin(this.plugins[t]);this._options.enableColumnReorder&&typeof this.sortableSideLeftInstance?.destroy=="function"&&typeof this.sortableSideRightInstance?.destroy=="function"&&(this.sortableSideLeftInstance.destroy(),this.sortableSideRightInstance.destroy()),this.unbindAncestorScrollEvents(),this._bindingEventService.unbindByEventName(this._container,"resize"),this.removeCssRules(),this._canvas.forEach(r=>{this._bindingEventService.unbindByEventName(r,"keydown"),this._bindingEventService.unbindByEventName(r,"click"),this._bindingEventService.unbindByEventName(r,"dblclick"),this._bindingEventService.unbindByEventName(r,"contextmenu"),this._bindingEventService.unbindByEventName(r,"mouseover"),this._bindingEventService.unbindByEventName(r,"mouseout")}),this._viewport.forEach(r=>{this._bindingEventService.unbindByEventName(r,"scroll")}),this._headerScroller.forEach(r=>{this._bindingEventService.unbindByEventName(r,"contextmenu"),this._bindingEventService.unbindByEventName(r,"click")}),this._headerRowScroller.forEach(r=>{this._bindingEventService.unbindByEventName(r,"scroll")}),this._footerRow&&this._footerRow.forEach(r=>{this._bindingEventService.unbindByEventName(r,"contextmenu"),this._bindingEventService.unbindByEventName(r,"click")}),this._footerRowScroller&&this._footerRowScroller.forEach(r=>{this._bindingEventService.unbindByEventName(r,"scroll")}),this._preHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._preHeaderPanelScroller,"scroll"),this._topHeaderPanelScroller&&this._bindingEventService.unbindByEventName(this._topHeaderPanelScroller,"scroll"),this._bindingEventService.unbindByEventName(this._focusSink,"keydown"),this._bindingEventService.unbindByEventName(this._focusSink2,"keydown");let i=this._container.querySelectorAll(".slick-resizable-handle");[].forEach.call(i,r=>{this._bindingEventService.unbindByEventName(r,"dblclick")});let o=this._container.querySelectorAll(".slick-header-column");[].forEach.call(o,r=>{this._bindingEventService.unbindByEventName(r,"mouseenter"),this._bindingEventService.unbindByEventName(r,"mouseleave"),this._bindingEventService.unbindByEventName(r,"mouseover"),this._bindingEventService.unbindByEventName(r,"mouseout")}),j(this._container),this._container.classList.remove(this.uid),this.clearAllTimers(),e&&ms(this)}destroyAllInstances(e){if(e){let t=Array.isArray(e)?e:[e],i;for(;q(i=t.pop());)i&&typeof i.destroy=="function"&&i.destroy()}return e=Array.isArray(e)?[]:null,e}autosizeColumns(){this.legacyAutosizeColumns()}legacyAutosizeColumns(){let e,t,i=0,o=0,r=0,n=[],a=this.getViewportInnerWidth();for(e=0;e<this.columns.length;e++){if(t=this.columns[e],!t||t.hidden){n.push(0);continue}n.push(t.width||0),o+=t.width||0,t.resizable&&(i+=(t.width||0)-Math.max(t.minWidth||0,this.absoluteColumnMinWidth))}for(r=o;o>a&&i;){let d=(o-a)/i;for(e=0;e<this.columns.length&&o>a;e++)if(t=this.columns[e],t&&!t.hidden){let c=n[e];if(!t.resizable||c<=t.minWidth||c<=this.absoluteColumnMinWidth)continue;let h=Math.max(t.minWidth,this.absoluteColumnMinWidth),u=Math.floor(d*(c-h))||1;u=Math.min(u,c-h),o-=u,i-=u,n[e]-=u}if(r<=o)break;r=o}for(r=o;o<a;){let d=a/o;for(e=0;e<this.columns.length&&o<a;e++)if(t=this.columns[e],t&&!t.hidden){let c=n[e],h;!t.resizable||t.maxWidth<=c?h=0:h=Math.min(Math.floor(d*c)-c,t.maxWidth-c||1e6)||1,o+=h,n[e]+=o<=a?h:0}if(r>=o)break;r=o}let l=!1;for(e=0;e<this.columns.length;e++)t&&!t.hidden&&(this.columns[e].rerenderOnResize&&this.columns[e].width!==n[e]&&(l=!0),this.columns[e].width=n[e]);this.reRenderColumns(l)}reRenderColumns(e){this.applyColumnHeaderWidths(),this.updateCanvasWidth(!0),this.triggerEvent(this.onAutosizeColumns,{columns:this.columns}),e&&(this.invalidateAllRows(),this.render())}getVisibleColumns(){return this.columns.filter(e=>!e.hidden)}triggerEvent(e,t,i){let o=i||new U(i,t),r=t||{};return r.grid=this,e.notify(r,o,this)}getEditorLock(){return this._options.editorLock}getEditController(){return this.editController}getColumnIndex(e){return this.columnsById[e]}applyColumnHeaderWidths(){if(this.initialized){let e=0,t=this.getVisibleColumns();this._headers.forEach(i=>{for(let o=0;o<i.children.length;o++,e++){let r=i.children[o],a=((t[e]||{}).width||0)-this.headerColumnWidthDiff;w.width(r)!==a&&w.width(r,a)}}),this.updateColumnCaches()}}applyColumnWidths(){let e=0,t=0,i;for(let o=0;o<this.columns.length;o++)this.columns[o]?.hidden||(t=this.columns[o].width||0,i=this.getColumnCssRules(o),i.left&&(i.left.style.left=`${e}px`),i.right&&(i.right.style.right=(this._options.frozenColumn!==-1&&o>this._options.frozenColumn?this.canvasWidthR:this.canvasWidthL)-e-t+"px"),this._options.frozenColumn!==o&&(e+=this.columns[o].width)),this._options.frozenColumn===o&&(e=0)}setSortColumn(e,t){this.setSortColumns([{columnId:e,sortAsc:t}])}getColumnByIndex(e){let t;return this._headers.every(i=>{let o=i.children.length;return e<o?(t=i.children[e],!1):(e-=o,!0)}),t}setSortColumns(e){this.sortColumns=e;let t=this._options.numberedMultiColumnSort&&this.sortColumns.length>1;this._headers.forEach(o=>{let r=o.querySelectorAll(".slick-header-column-sorted");r.forEach(n=>n.classList.remove("slick-header-column-sorted")),r=o.querySelectorAll(".slick-sort-indicator"),r.forEach(n=>n.classList.remove("slick-sort-indicator-asc","slick-sort-indicator-desc")),r=o.querySelectorAll(".slick-sort-indicator-numbered"),r.forEach(n=>n.textContent="")});let i=1;this.sortColumns.forEach(o=>{q(o.sortAsc)||(o.sortAsc=!0);let r=this.getColumnIndex(o.columnId);if(q(r)){let n=this.getColumnByIndex(r);if(n){n.classList.add("slick-header-column-sorted");let a=n.querySelector(".slick-sort-indicator");a?.classList.add(o.sortAsc?"slick-sort-indicator-asc":"slick-sort-indicator-desc"),t&&(a=n.querySelector(".slick-sort-indicator-numbered"),a&&(a.textContent=String(i)))}}i++})}getSortColumns(){return this.sortColumns}handleSelectedRangesChanged(e,t){let i=e.getNativeEvent(),o=this.selectedRows.slice(0);this.selectedRows=[];let r={};for(let n=0;n<t.length;n++)for(let a=t[n].fromRow;a<=t[n].toRow;a++){r[a]||(this.selectedRows.push(a),r[a]={});for(let l=t[n].fromCell;l<=t[n].toCell;l++)this.canCellBeSelected(a,l)&&(r[a][this.columns[l].id]=this._options.selectedCellCssClass)}if(this.setCellCssStyles(this._options.selectedCellCssClass||"",r),!this.arrayEquals(o.sort(),this.selectedRows.sort())){let n=i?.detail?.caller??"click",a=new Set(this.getSelectedRows()),l=new Set(o),d=Array.from(a).filter(h=>!l.has(h)),c=Array.from(l).filter(h=>!a.has(h));this.triggerEvent(this.onSelectedRowsChanged,{rows:this.getSelectedRows(),previousSelectedRows:o,caller:n,changedSelectedRows:d,changedUnselectedRows:c},e)}}arrayEquals(e,t){return Array.isArray(e)&&Array.isArray(t)&&t.toString()===e.toString()}getColumns(){return this.columns}updateColumnCaches(){this.columnPosLeft=[],this.columnPosRight=[];let e=0;for(let t=0,i=this.columns.length;t<i;t++)this.columns[t]&&!this.columns[t].hidden&&(this.columnPosLeft[t]=e,this.columnPosRight[t]=e+(this.columns[t].width||0),this._options.frozenColumn===t?e=0:e+=this.columns[t].width||0)}updateColumnProps(){this.columnsById={};for(let e=0;e<this.columns.length;e++){let t=this.columns[e]||{};t.width&&(t.widthRequest=t.width),this._options.mixinDefaults?w.applyDefaults(t,this._columnDefaults):t=this.columns[e]=fe({},this._columnDefaults,t),this.columnsById[t.id]=e,t.minWidth&&(t.width||0)<t.minWidth&&(t.width=t.minWidth),t.maxWidth&&(t.width||0)>t.maxWidth&&(t.width=t.maxWidth)}}setColumns(e){this.triggerEvent(this.onBeforeSetColumns,{previousColumns:this.columns,newColumns:e,grid:this}),this.columns=e,this.updateColumnsInternal(),this.triggerEvent(this.onAfterSetColumns,{newColumns:e,grid:this})}updateColumns(){this.triggerEvent(this.onBeforeUpdateColumns,{columns:this.columns,grid:this}),this.updateColumnsInternal()}updateColumnsInternal(){this.updateColumnProps(),this.updateColumnCaches(),this.initialized&&(this.setPaneFrozenClasses(),this.setPaneVisibility(),this.setOverflow(),this.invalidateAllRows(),this.createColumnHeaders(),this.createColumnFooter(),this.removeCssRules(),this.createCssRules(),this.resizeCanvas(),this.updateCanvasWidth(),this.applyColumnWidths(),this.handleScroll(),this.getSelectionModel()?.refreshSelections())}getOptions(){return this._options}setOptions(e,t,i,o){this.prepareForOptionsChange(),this._options.enableAddRow!==e.enableAddRow&&this.invalidateRow(this.getDataLength()),e.frozenColumn!==void 0&&e.frozenColumn>=0&&(this.getViewports().forEach(n=>n.scrollLeft=0),this.handleScroll());let r=fe(!0,{},this._options);this._options=fe(!0,this._options,e),this.triggerEvent(this.onSetOptions,{optionsBefore:r,optionsAfter:this._options}),this.internal_setOptions(t,i,o)}activateChangedOptions(e,t,i){this.prepareForOptionsChange(),this.invalidateRow(this.getDataLength()),this.triggerEvent(this.onActivateChangedOptions,{options:this._options}),this.internal_setOptions(e,t,i)}prepareForOptionsChange(){this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellNormal()}internal_setOptions(e,t,i){this._options.showColumnHeader!==void 0&&this.setColumnHeaderVisibility(this._options.showColumnHeader),this.validateAndEnforceOptions(),this.setFrozenOptions(),this._options.frozenBottom!==void 0&&(this.enforceFrozenRowHeightRecalc=!0),this._viewport.forEach(o=>{o.style.overflowY=this._options.autoHeight?"hidden":"auto"}),e||this.render(),this.setScroller(),i||this.setOverflow(),t||this.setColumns(this.columns),this._options.enableMouseWheelScrollHandler&&this._viewport&&(!this.slickMouseWheelInstances||this.slickMouseWheelInstances.length===0)?this._viewport.forEach(o=>{this.slickMouseWheelInstances.push(Aa({element:o,onMouseWheel:this.handleMouseWheel.bind(this)}))}):this._options.enableMouseWheelScrollHandler===!1&&this.destroyAllInstances(this.slickMouseWheelInstances)}validateAndEnforceOptions(){this._options.autoHeight&&(this._options.leaveSpaceForNewRows=!1)}setData(e,t){this.data=e,this.invalidateAllRows(),this.updateRowCount(),t&&this.scrollTo(0)}getData(){return this.data}getDataLength(){return this.data.getLength?this.data.getLength():this.data?.length||0}getDataLengthIncludingAddNew(){return this.getDataLength()+(this._options.enableAddRow&&(!this.pagingActive||this.pagingIsLastPage)?1:0)}getDataItem(e){return this.data.getItem?this.data.getItem(e):this.data[e]}getItemMetadaWhenExists(e){return"getItemMetadata"in this.data?this.data.getItemMetadata(e):null}getTopPanel(){return this._topPanels[0]}getTopPanels(){return this._topPanels}hasDataView(){return!Array.isArray(this.data)}togglePanelVisibility(e,t,i){this._options[e]!==i&&(this._options[e]=i,i?w.show(t):w.hide(t),this.resizeCanvas())}setTopPanelVisibility(e){this.togglePanelVisibility("showTopPanel",this._topPanelScrollers,e)}setHeaderRowVisibility(e){this.togglePanelVisibility("showHeaderRow",this._headerRowScroller,e)}setColumnHeaderVisibility(e){this.togglePanelVisibility("showColumnHeader",this._headerScroller,e)}setFooterRowVisibility(e){this.togglePanelVisibility("showFooterRow",this._footerRowScroller,e)}setPreHeaderPanelVisibility(e){this.togglePanelVisibility("showPreHeaderPanel",[this._preHeaderPanelScroller,this._preHeaderPanelScrollerR],e)}setTopHeaderPanelVisibility(e){this.togglePanelVisibility("showTopHeaderPanel",this._topHeaderPanelScroller,e)}getContainerNode(){return this._container}getRowHeight(){return this._options.rowHeight}getRowTop(e){return Math.round(this._options.rowHeight*e-this.offset)}getRowBottom(e){return this.getRowTop(e)+this._options.rowHeight}getRowFromPosition(e){return Math.floor((e+this.offset)/this._options.rowHeight)}scrollTo(e){e=Math.max(e,0),e=Math.min(e,(this.th||0)-w.height(this._viewportScrollContainerY)+((this.viewportHasHScroll||this.hasFrozenColumns())&&this.scrollbarDimensions?.height||0));let t=this.offset;this.offset=Math.round(this.page*(this.cj||0)),this.page=Math.min((this.n||0)-1,Math.floor(e/(this.ph||0)));let i=e-this.offset;if(this.offset!==t){let o=this.getVisibleRange(i);this.cleanupRows(o),this.updateRowPositions()}this.prevScrollTop!==i&&(this.vScrollDir=this.prevScrollTop+t<i+this.offset?1:-1,this.lastRenderedScrollTop=this.scrollTop=this.prevScrollTop=i,this.hasFrozenColumns()&&(this._viewportTopL.scrollTop=i),this.hasFrozenRows&&(this._viewportBottomL.scrollTop=this._viewportBottomR.scrollTop=i),this._viewportScrollContainerY&&(this._viewportScrollContainerY.scrollTop=i),this.triggerEvent(this.onViewportChanged,{}))}defaultFormatter(e,t,i){return q(i)?(i+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}getFormatter(e,t){let i=this.data?.getItemMetadata?.(e);return(i?.columns&&(i.columns[t.id]||i.columns[this.getColumnIndex(t.id)]))?.formatter||i?.formatter||t.formatter||this._options.formatterFactory?.getFormatter(t)||this._options.defaultFormatter}getEditor(e,t){let i=this.columns[t],r=this.getItemMetadaWhenExists(e)?.columns;return r?.[i.id]?.editorClass!==void 0?r[i.id].editorClass:r?.[t]?.editorClass!==void 0?r[t].editorClass:i.editorClass||this._options?.editorFactory?.getEditor(i)}getDataItemValueForColumn(e,t){return this._options.dataItemColumnValueExtractor?this._options.dataItemColumnValueExtractor(e,t):e[t.field]}appendRowHtml(e,t,i,o,r){let n=this.getDataItem(i),a=i<r&&!n,l="slick-row"+(this.hasFrozenRows&&i<=this._options.frozenRow?" frozen":"")+(a?" loading":"")+(i===this.activeRow&&this._options.showCellSelection?" active":"")+(i%2===1?" odd":" even");n||(l+=` ${this._options.addNewRowCssClass}`);let d=this.getItemMetadaWhenExists(i);d?.cssClasses&&(l+=` ${d.cssClasses}`);let c=p("div",{className:`ui-widget-content ${l}`,role:"row",dataset:{row:`${i}`}}),h=this.getFrozenRowOffset(i),u=this.getRowTop(i)-h;this._options.rowTopOffsetRenderType==="transform"?c.style.transform=`translateY(${u}px)`:c.style.top=`${u}px`;let m;e.push(c),this.hasFrozenColumns()&&(m=c.cloneNode(!0),t.push(m));let g=this.columns.length,f,b,v,k,C=!0;for(let E=0,y=g;E<y;E++)if(C=!0,k=this.columns[E],k&&!k.hidden){b=1,v=1,f=null,d?.columns&&(f=d.columns[k.id]||d.columns[E],b=f?.colspan||1,v=f?.rowspan||1,b==="*"&&(b=y-E),v>r-i&&(v=r-i)),!this._options.enableCellRowSpan&&v>1&&console.warn('[SlickGrid] Cell "rowspan" is an opt-in grid option because of its small perf hit, you must enable it via the "enableCellRowSpan" grid option.');let S=b;if(this.getParentRowSpanByCell(i,E))continue;if(this.columnPosRight[Math.min(y-1,E+S-1)]>o.leftPx){if(!k.alwaysRenderColumn&&this.columnPosLeft[E]>o.rightPx&&(C=!1),C){let F=this.hasFrozenColumns()&&E>this._options.frozenColumn?m:c;this.appendCellHtml(F,i,E,S,v,f,n)}}else(k.alwaysRenderColumn||this.hasFrozenColumns()&&E<=this._options.frozenColumn)&&this.appendCellHtml(c,i,E,S,v,f,n);S>1&&(E+=S-1)}}appendCellHtml(e,t,i,o,r,n,a){let l=this.columns[i],d=`slick-cell l${i} r${Math.min(this.columns.length-1,i+o-1)}`+(l.cssClass?` ${l.cssClass}`:"")+(r>1?" rowspan":"")+(n?.cssClass?` ${n.cssClass}`:"");this.hasFrozenColumns()&&i<=this._options.frozenColumn&&(d+=" frozen"),t===this.activeRow&&i===this.activeCell&&this._options.showCellSelection&&(d+=" active"),Object.keys(this.cellCssClasses).forEach(k=>{this.cellCssClasses[k][t]?.[l.id]&&(d+=` ${this.cellCssClasses[k][t][l.id]}`)});let c=null,h="";a&&(c=this.getDataItemValueForColumn(a,l),h=this.getFormatter(t,l)(t,i,c,l,a,this),h==null&&(h=""));let m=this.triggerEvent(this.onBeforeAppendCell,{row:t,cell:i,value:c,dataContext:a}).getReturnValue(),g=typeof m=="string"?m:"";h?.addClasses&&(g+=ae((g?" ":"")+h.addClasses).join(" "));let f=h?.toolTip?`${h.toolTip}`:"",b=p("div",{className:ae(`${d} ${g||""}`).join(" "),role:"gridcell",tabIndex:-1});b.setAttribute("aria-describedby",this.uid+l.id),f&&b.setAttribute("title",f);let v=this.getCellHeight(t,r);if(r>1&&v!==this._options.rowHeight-this.cellHeightDiff&&(b.style.height=`${v||0}px`),l.hasOwnProperty("cellAttrs")&&l.cellAttrs instanceof Object&&Object.keys(l.cellAttrs).forEach(k=>{l.cellAttrs.hasOwnProperty(k)&&b.setAttribute(k,l.cellAttrs[k])}),a){let k=Dt(h)?h:h.html||h.text;Se(b,k,this._options)}e.appendChild(b),h.insertElementAfterTarget&&Bn(b,h.insertElementAfterTarget),this.rowsCache[t].cellRenderQueue.push(i),this.rowsCache[t].cellColSpans[i]=o}cleanupRows(e){let t=new Set;if(this._options.enableCellRowSpan)for(let i=e.top,o=e.bottom;i<=o;i++){let r=this.getRowSpanIntersect(i);r!==null&&t.add(r)}Object.keys(this.rowsCache).forEach(i=>{if(this.rowsCache){let o=+i,r=!0;this.hasFrozenRows&&(this._options.frozenBottom&&o>=this.actualFrozenRow||!this._options.frozenBottom&&o<=this.actualFrozenRow)&&(r=!1),(o=parseInt(i,10))!==this.activeRow&&(o<e.top||o>e.bottom)&&r&&!t.has(o)&&this.removeRowFromCache(o)}}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}getRowSpanColumnIntersects(e){return this.getRowSpanIntersection(e,"columns")}getRowSpanIntersect(e){return this.getRowSpanIntersection(e)}getRowSpanIntersection(e,t){let i=[],o=null;for(let r=0,n=this.columns.length;r<n;r++){let a=this._colsWithRowSpanCache[r];if(a)for(let l of Array.from(a)){let[d,c]=l.split(":").map(Number);if(e>=d&&e<=c)if(t==="columns")i.push(r);else{o=d;break}}}return t==="columns"?i:o}getParentRowSpanByCell(e,t,i=!0){let o=null,r=this._colsWithRowSpanCache[t]||new Set;for(let n of Array.from(r)){let[a,l]=n.split(":").map(Number);if((i?e>a:e>=a)&&e<=l){o={start:a,end:l,range:n};break}}return o}remapAllColumnsRowSpan(){let e=this.getDataLength();if(e>0){this._colsWithRowSpanCache={};for(let t=0;t<e;t++)this.remapRowSpanMetadataByRow(t);this._rowSpanIsCached=!0}}remapRowSpanMetadataByRow(e){let t=this.getItemMetadaWhenExists(e);t?.columns&&Object.keys(t.columns).forEach(i=>{let o=+i,r=t.columns[o],n=+(r?.colspan||1),a=+(r?.rowspan||1);this.remapRowSpanMetadata(e,o,n,a)})}remapRowSpanMetadata(e,t,i,o){if(o>1){let r=`${e}:${e+o-1}`;if(this._colsWithRowSpanCache[t]??=new Set,this._colsWithRowSpanCache[t].add(r),i>1)for(let n=1;n<i;n++)this._colsWithRowSpanCache[t+n]??=new Set,this._colsWithRowSpanCache[t+n].add(r)}}invalidate(){this.updateRowCount(),this.invalidateAllRows(),this.render()}invalidateAllRows(){this.currentEditor&&this.makeActiveCellNormal(),typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(e=>{this.rowsCache&&this.removeRowFromCache(+e)}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup()}invalidateRows(e){if(!e||!e.length)return;let t;this.vScrollDir=0;let i=e.length,o=new Set,r=new Set,n=e.length>this._options.maxPartialRowSpanRemap||e.length===this.getDataLength()||this._prevInvalidatedRowsCount+e.length===this.getDataLength();for(let a=0;a<i;a++)if(t=e[a],this.currentEditor&&this.activeRow===t&&this.makeActiveCellNormal(),this.rowsCache[t]&&this.removeRowFromCache(t),this._options.enableCellRowSpan&&!n){o.add(t);let l=this.getRowSpanIntersect(t);l!==null&&o.add(l)}if(this._options.enableCellRowSpan&&!n){for(let a of Array.from(o)){let l=this.getRowSpanColumnIntersects(a);for(let d of l){let c=this.getParentRowSpanByCell(a,d);c&&this._colsWithRowSpanCache[d]&&(this._colsWithRowSpanCache[d].delete(c.range),r.add(c.range.split(":").map(Number)[0]))}}for(let a of Array.from(r))this.remapRowSpanMetadataByRow(a)}this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this._prevInvalidatedRowsCount=e.length}invalidateRow(e){if(e>=0){let t=[e];if(this._options.enableCellRowSpan){let i=this.getRowSpanIntersect(e);i!==null&&t.push(i)}this.invalidateRows(t)}}queuePostProcessedRowForCleanup(e,t,i){this.postProcessgroupId++,typeof t=="object"&&Object.keys(t).forEach(o=>{t.hasOwnProperty(o)&&this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e.cellNodesByColumnIdx[+o],columnIdx:+o,rowIdx:i})}),e.rowNode||(e.rowNode=[]),this.postProcessedCleanupQueue.push({actionType:"R",groupId:this.postProcessgroupId,node:e.rowNode}),e.rowNode?.forEach(o=>o.remove())}queuePostProcessedCellForCleanup(e,t,i){this.postProcessedCleanupQueue.push({actionType:"C",groupId:this.postProcessgroupId,node:e,columnIdx:t,rowIdx:i}),e.remove()}removeRowFromCache(e){let t=this.rowsCache[e];t?.rowNode&&(this.triggerEvent(this.onBeforeRemoveCachedRow,{row:e}),this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[e]?this.queuePostProcessedRowForCleanup(t,this.postProcessedRows[e],e):t.rowNode?.forEach(i=>i.parentElement?.removeChild(i)),delete this.rowsCache[e],delete this.postProcessedRows[e],this.renderedRows--,this.counter_rows_removed++)}applyFormatResultToCellNode(e,t,i){if(e==null&&(e=""),Dt(e)){Se(t,e,this._options);return}let o=e.html||e.text;Se(t,o,this._options),e.removeClasses&&!i&&t.classList.remove(...ae(e.removeClasses)),e.addClasses&&t.classList.add(...ae(e.addClasses)),e.toolTip&&t.setAttribute("title",e.toolTip)}updateCell(e,t){let i=this.getCellNode(e,t);if(i){let o=this.columns[t],r=this.getDataItem(e);if(this.currentEditor&&this.activeRow===e&&this.activeCell===t)this.currentEditor.loadValue(r);else{let n=r?this.getFormatter(e,o)(e,t,this.getDataItemValueForColumn(r,o),o,r,this):"";this.applyFormatResultToCellNode(n,i),this.invalidatePostProcessingResults(e)}}}updateRow(e){let t=this.rowsCache[e];if(!t)return;this.ensureCellNodesInRowsCache(e);let i,o=this.getDataItem(e);Object.keys(t.cellNodesByColumnIdx).forEach(r=>{if(t.cellNodesByColumnIdx.hasOwnProperty(r)){let n=+r,a=this.columns[n],l=t.cellNodesByColumnIdx[n];this.currentEditor&&e===this.activeRow&&n===this.activeCell?this.currentEditor.loadValue(o):o?(i=this.getFormatter(e,a)(e,n,this.getDataItemValueForColumn(o,a),a,o,this),this.applyFormatResultToCellNode(i,l)):j(l)}}),this.invalidatePostProcessingResults(e)}getCellHeight(e,t){let i=this._options.rowHeight||0;if(t>1){let o=e+t-1;i=this.getRowBottom(o)-this.getRowTop(e)}else{let o=this.getRowHeight();o!==i-this.cellHeightDiff&&(i=o)}return i-=this.cellHeightDiff,Math.ceil(i)}getViewportRowCount(){let e=this.getViewportHeight(),t=this.getScrollbarDimensions()?.height||0;return Math.floor((e-t)/this._options.rowHeight)}getViewportHeight(){if((!this._options.autoHeight||this._options.frozenColumn!==-1)&&(this.topPanelH=this._options.showTopPanel?this._options.topPanelHeight+this.getVBoxDelta(this._topPanelScrollers[0]):0,this.headerRowH=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,this.footerRowH=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0),this._options.autoHeight){let e=this._paneHeaderL.offsetHeight;e+=this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,e+=this._options.showHeaderRow?this._options.headerRowHeight+this.getVBoxDelta(this._headerRowScroller[0]):0,e+=this._options.showFooterRow?this._options.footerRowHeight+this.getVBoxDelta(this._footerRowScroller[0]):0,e+=this.getCanvasWidth()>this.viewportW&&this.scrollbarDimensions?.height||0,this.viewportH=this._options.rowHeight*this.getDataLengthIncludingAddNew()+(this._options.frozenColumn===-1?e:0)}else{let e=getComputedStyle(this._container),t=e.boxSizing!=="content-box"?this.getVBoxDelta(this._container):0,i=this._options.createTopHeaderPanel&&this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight+this.getVBoxDelta(this._topHeaderPanelScroller):0,o=this._options.createPreHeaderPanel&&this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight+this.getVBoxDelta(this._preHeaderPanelScroller):0,r=this._options.showColumnHeader?w.toFloat(w.height(this._headerScroller[0])):0;this.viewportH=w.toFloat(e.height)-w.toFloat(e.paddingTop)-w.toFloat(e.paddingBottom)-this.topPanelH-i-o-this.headerRowH-r-this.footerRowH-t}return this.numVisibleRows=Math.ceil(this.viewportH/this._options.rowHeight),this.viewportH}getViewportInnerWidth(){return this.viewportHasVScroll?this.viewportW-(this.scrollbarDimensions?.width||0):this.viewportW}getViewportWidth(){return this.viewportW=parseFloat(Gi(this._container,"width"))||this._options.devMode&&this._options.devMode.containerClientWidth||0,this.viewportW}resizeCanvas(){if(this.initialized){if(this.paneTopH=0,this.paneBottomH=0,this.viewportTopH=0,this.viewportBottomH=0,this.getViewportWidth(),this.getViewportHeight(),this.hasFrozenRows?this._options.frozenBottom?(this.paneTopH=this.viewportH-this.frozenRowsHeight-(this.scrollbarDimensions?.height||0),this.paneBottomH=this.frozenRowsHeight+(this.scrollbarDimensions?.height||0)):(this.paneTopH=this.frozenRowsHeight,this.paneBottomH=this.viewportH-this.frozenRowsHeight):this.paneTopH=this.viewportH,this.paneTopH+=this.topPanelH+this.headerRowH+this.footerRowH,this.hasFrozenColumns()&&this._options.autoHeight&&(this.paneTopH+=this.scrollbarDimensions?.height||0),this.viewportTopH=this.paneTopH-this.topPanelH-this.headerRowH-this.footerRowH,this._options.autoHeight){if(this.hasFrozenColumns()){let i=this.paneTopH+this._headerScrollerL.offsetHeight;i+=this.getVBoxDelta(this._container),this._options.showPreHeaderPanel&&(i+=this._options.preHeaderPanelHeight),w.height(this._container,i)}this._paneTopL.style.position="relative"}let e=w.height(this._paneHeaderL);e?e+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0:e=(this._options.showHeaderRow?this._options.headerRowHeight:0)+(this._options.showPreHeaderPanel?this._options.preHeaderPanelHeight:0),w.setStyleSize(this._paneTopL,"top",e||e),w.height(this._paneTopL,this.paneTopH);let t=this._paneTopL.offsetTop+this.paneTopH;if(this._options.autoHeight||w.height(this._viewportTopL,this.viewportTopH),this.hasFrozenColumns()){let i=w.height(this._paneHeaderL);i&&(i+=this._options.showTopHeaderPanel?this._options.topHeaderPanelHeight:0),w.setStyleSize(this._paneTopR,"top",i),w.height(this._paneTopR,this.paneTopH),w.height(this._viewportTopR,this.viewportTopH),this.hasFrozenRows&&(w.setStyleSize(this._paneBottomL,"top",t),w.height(this._paneBottomL,this.paneBottomH),w.setStyleSize(this._paneBottomR,"top",t),w.height(this._paneBottomR,this.paneBottomH),w.height(this._viewportBottomR,this.paneBottomH))}else this.hasFrozenRows&&(w.width(this._paneBottomL,"100%"),w.height(this._paneBottomL,this.paneBottomH),w.setStyleSize(this._paneBottomL,"top",t));this.hasFrozenRows?(w.height(this._viewportBottomL,this.paneBottomH),this._options.frozenBottom?(w.height(this._canvasBottomL,this.frozenRowsHeight),this.hasFrozenColumns()&&w.height(this._canvasBottomR,this.frozenRowsHeight)):(w.height(this._canvasTopL,this.frozenRowsHeight),this.hasFrozenColumns()&&w.height(this._canvasTopR,this.frozenRowsHeight))):w.height(this._viewportTopR,this.viewportTopH),(!this.scrollbarDimensions||!this.scrollbarDimensions.width)&&(this.scrollbarDimensions=this.measureScrollbar()),this._options.forceFitColumns&&this.legacyAutosizeColumns(),this.updateRowCount(),this.handleScroll(),this.lastRenderedScrollLeft=-1,this.render()}}updatePagingStatusFromView(e){this.pagingActive=e.pageSize!==0,this.pagingIsLastPage=e.pageNum===e.totalPages-1}updateRowCount(){if(this.initialized){let e=this.getDataLength();e>0&&e!==this._prevDataLength&&(this._rowSpanIsCached=!1),this._options.enableCellRowSpan&&!this._rowSpanIsCached&&this.remapAllColumnsRowSpan(),this._prevDataLength=e;let t=this.getDataLengthIncludingAddNew(),i=0,o=this.hasFrozenRows&&!this._options.frozenBottom?w.height(this._canvasBottomL):w.height(this._canvasTopL);this.hasFrozenRows?i=this.getDataLength()-this._options.frozenRow:i=t+(this._options.leaveSpaceForNewRows?this.numVisibleRows-1:0);let r=w.height(this._viewportScrollContainerY),n=this.viewportHasVScroll;this.viewportHasVScroll=this._options.alwaysShowVerticalScroll||!this._options.autoHeight&&i*this._options.rowHeight>r,this.makeActiveCellNormal();let a=e-1;typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(d=>{let c=+d;c>a&&this.removeRowFromCache(c)}),this._options.enableAsyncPostRenderCleanup&&this.startPostProcessingCleanup(),this.activeCellNode&&this.activeRow>a&&this.resetActiveCell(),o=this.h,this._options.autoHeight?this.h=this._options.rowHeight*i:(this.th=Math.max(this._options.rowHeight*i,r-(this.scrollbarDimensions?.height||0)),this.th<this.maxSupportedCssHeight?(this.h=this.ph=this.th,this.n=1,this.cj=0):(this.h=this.maxSupportedCssHeight,this.ph=this.h/100,this.n=Math.floor(this.th/this.ph),this.cj=(this.th-this.h)/(this.n-1))),(this.h!==o||this.enforceFrozenRowHeightRecalc)&&(this.hasFrozenRows&&!this._options.frozenBottom?(w.height(this._canvasBottomL,this.h),this.hasFrozenColumns()&&w.height(this._canvasBottomR,this.h)):(w.height(this._canvasTopL,this.h),w.height(this._canvasTopR,this.h)),this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.enforceFrozenRowHeightRecalc=!1);let l=this.scrollTop+this.offset<=this.th-r;this.th===0||this.scrollTop===0?this.page=this.offset=0:l?this.scrollTo(this.scrollTop+this.offset):this.scrollTo(this.th-r+(this.scrollbarDimensions?.height||0)),this.h!==o&&this._options.autoHeight&&this.resizeCanvas(),this._options.forceFitColumns&&n!==this.viewportHasVScroll&&this.legacyAutosizeColumns(),this.updateCanvasWidth(!1)}}getViewport(e,t){return this.getVisibleRange(e,t)}getVisibleRange(e,t){return e??=this.scrollTop,t??=this.scrollLeft,{top:this.getRowFromPosition(e),bottom:this.getRowFromPosition(e+this.viewportH)+1,leftPx:t,rightPx:t+this.viewportW}}getRenderedRange(e,t){let i=this.getVisibleRange(e,t),o=Math.round(this.viewportH/this._options.rowHeight),r=this._options.minRowBuffer;return this.vScrollDir===-1?(i.top-=o,i.bottom+=r):this.vScrollDir===1?(i.top-=r,i.bottom+=o):(i.top-=r,i.bottom+=r),i.top=Math.max(0,i.top),i.bottom=Math.min(this.getDataLengthIncludingAddNew()-1,i.bottom),i.leftPx-=this.viewportW,i.rightPx+=this.viewportW,i.leftPx=Math.max(0,i.leftPx),i.rightPx=Math.min(this.canvasWidth,i.rightPx),i}getRowCache(){return this.rowsCache}ensureCellNodesInRowsCache(e){let t=this.rowsCache[e];if(t?.cellRenderQueue.length&&t.rowNode?.length){let i=t.rowNode,o=Array.from(i[0].children);i.length>1&&(o=o.concat(Array.from(i[1].children)));let r=o.length-1;for(;t.cellRenderQueue.length;){let n=t.cellRenderQueue.pop();t.cellNodesByColumnIdx[n]=o[r--]}}}cleanUpCells(e,t){if(this.hasFrozenRows&&(this._options.frozenBottom&&t>this.actualFrozenRow||t<=this.actualFrozenRow))return;let i=0,o=this.rowsCache[t],r=[];Object.keys(o.cellNodesByColumnIdx).forEach(l=>{if(!o.cellNodesByColumnIdx.hasOwnProperty(l))return;let d=+l;if(d<=this._options.frozenColumn||Array.isArray(this.columns)&&this.columns[d]?.alwaysRenderColumn)return;let c=o.cellColSpans[d];(this.columnPosLeft[d]>e.rightPx||this.columnPosRight[Math.min(this.columns.length-1,(d||0)+c-1)]<e.leftPx)&&(t===this.activeRow&&Number(d)===this.activeCell||r.push(d))});let n,a;for(;q(n=r.pop());)a=o.cellNodesByColumnIdx[n],this._options.enableAsyncPostRenderCleanup&&this.postProcessedRows[t]?.[n]?this.queuePostProcessedCellForCleanup(a,n,t):a.parentElement?.removeChild(a),delete o.cellColSpans[n],delete o.cellNodesByColumnIdx[n],this.postProcessedRows[t]&&delete this.postProcessedRows[t][n],i++}cleanUpAndRenderCells(e){let t,i=document.createElement("div"),o=[],r,n=0,a,l,d=this.columns.length;for(let u=e.top,m=e.bottom;u<=m;u++)if(t=this.rowsCache[u],t){this.ensureCellNodesInRowsCache(u),(!this._options.enableCellRowSpan||this.getRowSpanIntersect(u)===null)&&this.cleanUpCells(e,u),r=0;let g=this.getItemMetadaWhenExists(u);g=g?.columns;let f=this.getDataItem(u);for(let b=0,v=d;b<v;b++)if(this.columns[b]&&!this.columns[b].hidden){if(this.columnPosLeft[b]>e.rightPx)break;if(q(a=t.cellColSpans[b])){b+=a>1?a-1:0;continue}a=1,l=null,g&&(l=g[this.columns[b].id]||g[b],a=l?.colspan??1,a==="*"&&(a=v-b));let k=a;if(this.getParentRowSpanByCell(u,b))continue;if(this.columnPosRight[Math.min(v-1,b+k-1)]>e.leftPx){let C=this.getRowspan(u,b);this.appendCellHtml(i,u,b,k,C,l,f),r++}b+=k>1?k-1:0}r&&(n+=r,o.push(u))}if(!i.children.length)return;let c,h;for(;q(c=o.pop());){t=this.rowsCache[c];let u;for(;q(u=t.cellRenderQueue.pop());)h=i.lastChild,h&&(this.hasFrozenColumns()&&u>this._options.frozenColumn?t.rowNode[1].appendChild(h):t.rowNode[0].appendChild(h),t.cellNodesByColumnIdx[u]=h)}}createEmptyCachingRow(){return{rowNode:null,cellColSpans:[],cellNodesByColumnIdx:[],cellRenderQueue:[]}}renderRows(e){let t=[],i=[],o=[],r=!1,n=this.getDataLength(),a=new Set,l=new Set;for(let c=e.top,h=e.bottom;c<=h;c++)if(!(this.rowsCache[c]||this.hasFrozenRows&&this._options.frozenBottom&&c===this.getDataLength())){if(this.renderedRows++,o.push(c),l.add(c),this.rowsCache[c]=this.createEmptyCachingRow(),this._options.enableCellRowSpan){let u=this.getRowSpanIntersect(c);u!==null&&l.add(u)}this.appendRowHtml(t,i,c,e,n),a.add(c),this.activeCellNode&&this.activeRow===c&&(r=!0),this.counter_rows_rendered++}let d=this.setDifference(l,a);if(d.size>0&&d.forEach(c=>{this.removeRowFromCache(c),o.push(c),this.rowsCache[c]=this.createEmptyCachingRow(),this.appendRowHtml(t,i,c,e,n)}),o.length){let c=document.createElement("div"),h=document.createElement("div");t.forEach(u=>c.appendChild(u)),i.forEach(u=>h.appendChild(u));for(let u=0,m=o.length;u<m;u++)this.hasFrozenRows&&o[u]>=this.actualFrozenRow?this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(o[u])&&c.firstChild&&h.firstChild&&(this.rowsCache[o[u]].rowNode=[c.firstChild,h.firstChild],this._canvasBottomL.appendChild(c.firstChild),this._canvasBottomR.appendChild(h.firstChild)):this.rowsCache?.hasOwnProperty(o[u])&&c.firstChild&&(this.rowsCache[o[u]].rowNode=[c.firstChild],this._canvasBottomL.appendChild(c.firstChild)):this.hasFrozenColumns()?this.rowsCache?.hasOwnProperty(o[u])&&c.firstChild&&h.firstChild&&(this.rowsCache[o[u]].rowNode=[c.firstChild,h.firstChild],this._canvasTopL.appendChild(c.firstChild),this._canvasTopR.appendChild(h.firstChild)):this.rowsCache?.hasOwnProperty(o[u])&&c.firstChild&&(this.rowsCache[o[u]].rowNode=[c.firstChild],this._canvasTopL.appendChild(c.firstChild));r&&(this.activeCellNode=this.getCellNode(this.activeRow,this.activeCell))}}setDifference(e,t){return new Set(Array.from(e).filter(i=>!t.has(i)))}startPostProcessing(){this._options.enableAsyncPostRender&&(clearTimeout(this.h_postrender),this.h_postrender=setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay))}startPostProcessingCleanup(){this._options.enableAsyncPostRenderCleanup&&(clearTimeout(this.h_postrenderCleanup),this.h_postrenderCleanup=setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay))}invalidatePostProcessingResults(e){typeof this.postProcessedRows[e]=="object"&&Object.keys(this.postProcessedRows[e]).forEach(t=>{this.postProcessedRows[e].hasOwnProperty(t)&&(this.postProcessedRows[e][t]="C")}),this.postProcessFromRow=Math.min(this.postProcessFromRow,e),this.postProcessToRow=Math.max(this.postProcessToRow,e),this.startPostProcessing()}updateRowPositions(){this.rowsCache&&typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(e=>{let t=e?parseInt(e,10):0,i=this.rowsCache[t].rowNode[0];this._options.rowTopOffsetRenderType==="transform"?i.style.transform=`translateY(${this.getRowTop(t)}px)`:i.style.top=`${this.getRowTop(t)}px`})}render(){if(this.initialized){this.scrollThrottle.dequeue();let e=this.getVisibleRange(),t=this.getRenderedRange();if(this.cleanupRows(t),this.lastRenderedScrollLeft!==this.scrollLeft){if(this.hasFrozenRows){let i=fe(!0,{},t);this._options.frozenBottom?(i.top=this.actualFrozenRow,i.bottom=this.getDataLength()):(i.top=0,i.bottom=this._options.frozenRow),this.cleanUpAndRenderCells(i)}this.cleanUpAndRenderCells(t)}this.renderRows(t),this.hasFrozenRows&&(this._options.frozenBottom?this.renderRows({top:this.actualFrozenRow,bottom:this.getDataLength()-1,leftPx:t.leftPx,rightPx:t.rightPx}):this.renderRows({top:0,bottom:this._options.frozenRow-1,leftPx:t.leftPx,rightPx:t.rightPx})),this.postProcessFromRow=e.top,this.postProcessToRow=Math.min(this.getDataLengthIncludingAddNew()-1,e.bottom),this.startPostProcessing(),this.lastRenderedScrollTop=this.scrollTop,this.lastRenderedScrollLeft=this.scrollLeft,this.triggerEvent(this.onRendered,{startRow:e.top,endRow:e.bottom,grid:this})}}handleHeaderRowScroll(){let e=this._headerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handleFooterRowScroll(){let e=this._footerRowScrollContainer.scrollLeft;e!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=e)}handlePreHeaderPanelScroll(){this.handleElementScroll(this._preHeaderPanelScroller)}handleTopHeaderPanelScroll(){this.handleElementScroll(this._topHeaderPanelScroller)}handleElementScroll(e){let t=e.scrollLeft;t!==this._viewportScrollContainerX.scrollLeft&&(this._viewportScrollContainerX.scrollLeft=t)}handleScroll(e){return this.scrollHeight=this._viewportScrollContainerY.scrollHeight,this.scrollTop=this._viewportScrollContainerY.scrollTop,this.scrollLeft=this._viewportScrollContainerX.scrollLeft,this._handleScroll(e?"scroll":"system")}_handleScroll(e="system"){let t=this._viewportScrollContainerY.scrollHeight-this._viewportScrollContainerY.clientHeight,i=this._viewportScrollContainerY.scrollWidth-this._viewportScrollContainerY.clientWidth;t=Math.max(0,t),i=Math.max(0,i),this.scrollTop>t&&(this.scrollTop=t,this.scrollHeight=t),this.scrollLeft>i&&(this.scrollLeft=i);let o=Math.abs(this.scrollTop-this.prevScrollTop),r=Math.abs(this.scrollLeft-this.prevScrollLeft);if(r&&(this.prevScrollLeft=this.scrollLeft,this._viewportScrollContainerX.scrollLeft=this.scrollLeft,this._headerScrollContainer.scrollLeft=this.scrollLeft,this._topPanelScrollers[0].scrollLeft=this.scrollLeft,this._options.createFooterRow&&(this._footerRowScrollContainer.scrollLeft=this.scrollLeft),this._options.createPreHeaderPanel&&(this.hasFrozenColumns()?this._preHeaderPanelScrollerR.scrollLeft=this.scrollLeft:this._preHeaderPanelScroller.scrollLeft=this.scrollLeft),this._options.createTopHeaderPanel&&(this._topHeaderPanelScroller.scrollLeft=this.scrollLeft),this.hasFrozenColumns()?(this.hasFrozenRows&&(this._viewportTopR.scrollLeft=this.scrollLeft),this._headerRowScrollerR.scrollLeft=this.scrollLeft):(this.hasFrozenRows&&(this._viewportTopL.scrollLeft=this.scrollLeft),this._headerRowScrollerL.scrollLeft=this.scrollLeft)),o&&!this._options.autoHeight&&(this.vScrollDir=this.prevScrollTop<this.scrollTop?1:-1,this.prevScrollTop=this.scrollTop,e==="mousewheel"&&(this._viewportScrollContainerY.scrollTop=this.scrollTop),this.hasFrozenColumns()&&(this.hasFrozenRows&&!this._options.frozenBottom?this._viewportBottomL.scrollTop=this.scrollTop:this._viewportTopL.scrollTop=this.scrollTop),o<this.viewportH?this.scrollTo(this.scrollTop+this.offset):(this.h===this.viewportH?this.page=0:this.page=Math.min(this.n-1,Math.floor(this.scrollTop*((this.th-this.viewportH)/(this.h-this.viewportH))*(1/this.ph))),this.offset=Math.round(this.page*this.cj))),r||o){let n=Math.abs(this.lastRenderedScrollLeft-this.scrollLeft),a=Math.abs(this.lastRenderedScrollTop-this.scrollTop);(n>20||a>20)&&(this._options.forceSyncScrolling||a<this.viewportH&&n<this.viewportW?this.render():this.scrollThrottle.enqueue(),this.triggerEvent(this.onViewportChanged,{}))}return this.triggerEvent(this.onScroll,{triggeredBy:e,scrollHeight:this.scrollHeight,scrollLeft:this.scrollLeft,scrollTop:this.scrollTop}),!!(r||o)}handleActiveCellPositionChange(){if(this.activeCellNode&&(this.triggerEvent(this.onActiveCellPositionChanged,{}),this.currentEditor)){let e=this.getActiveCellPosition();this.currentEditor.show&&this.currentEditor.hide&&(e.visible?this.currentEditor.show():this.currentEditor.hide()),this.currentEditor.position&&this.currentEditor.position(e)}}actionThrottle(e,t){let i=!1,o=!1,r=()=>{i?o=!0:a()},n=()=>{o=!1},a=()=>{i=!0,clearTimeout(this._executionBlockTimer),this._executionBlockTimer=setTimeout(l,t),e.call(this)},l=()=>{o?(n(),a()):i=!1};return{enqueue:r.bind(this),dequeue:n.bind(this)}}asyncPostProcessRows(){let e=this.getDataLength();for(;this.postProcessFromRow<=this.postProcessToRow;){let t=this.vScrollDir>=0?this.postProcessFromRow++:this.postProcessToRow--,i=this.rowsCache[t];if(!(!i||t>=e)){this.postProcessedRows[t]||(this.postProcessedRows[t]={}),this.ensureCellNodesInRowsCache(t),Object.keys(i.cellNodesByColumnIdx).forEach(o=>{if(i.cellNodesByColumnIdx.hasOwnProperty(o)){let r=+o,n=this.columns[r],a=this.postProcessedRows[t][r];if(n.asyncPostRender&&a!=="R"){let l=i.cellNodesByColumnIdx[r];l&&n.asyncPostRender(l,t,this.getDataItem(t),n,a==="C"),this.postProcessedRows[t][r]="R"}}}),this.h_postrender=setTimeout(this.asyncPostProcessRows.bind(this),this._options.asyncPostRenderDelay);return}}}asyncPostProcessCleanupRows(){if(this.postProcessedCleanupQueue.length>0){let e=this.postProcessedCleanupQueue[0].groupId;for(;this.postProcessedCleanupQueue.length>0&&this.postProcessedCleanupQueue[0].groupId===e;){let t=this.postProcessedCleanupQueue.shift();if(t?.actionType==="R"&&t.node.forEach(i=>{i.remove()}),t?.actionType==="C"){let i=this.columns[t.columnIdx];i.asyncPostRenderCleanup&&t.node&&i.asyncPostRenderCleanup(t.node,t.rowIdx,i)}}this.h_postrenderCleanup=setTimeout(this.asyncPostProcessCleanupRows.bind(this),this._options.asyncPostRenderCleanupDelay)}}updateCellCssStylesOnRenderedRows(e,t){let i,o,r;typeof this.rowsCache=="object"&&Object.keys(this.rowsCache).forEach(n=>{this.rowsCache&&(r=t?.[n],o=e?.[n],r&&Object.keys(r).forEach(a=>{(!o||r[a]!==o[a])&&(i=this.getCellNode(+n,this.getColumnIndex(a)),i&&i.classList.remove(r[a]))}),o&&Object.keys(o).forEach(a=>{(!r||r[a]!==o[a])&&(i=this.getCellNode(+n,this.getColumnIndex(a)),i&&i.classList.add(o[a]))}))})}addCellCssStyles(e,t){if(this.cellCssClasses[e])throw new Error(`SlickGrid addCellCssStyles: cell CSS hash with key "${e}" already exists.`);this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,null),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}removeCellCssStyles(e){this.cellCssClasses[e]&&(this.updateCellCssStylesOnRenderedRows(null,this.cellCssClasses[e]),delete this.cellCssClasses[e],this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:null,grid:this}))}setCellCssStyles(e,t){let i=this.cellCssClasses[e];this.cellCssClasses[e]=t,this.updateCellCssStylesOnRenderedRows(t,i),this.triggerEvent(this.onCellCssStylesChanged,{key:e,hash:t,grid:this})}getCellCssStyles(e){return this.cellCssClasses[e]}flashCell(e,t,i=250){let o=(r,n)=>{n>0&&(clearTimeout(this._flashCellTimer),this._flashCellTimer=setTimeout(()=>{r.classList.toggle(this._options.cellFlashingCssClass||"",n%2===0),o(r,n-1)},i))};if(this.rowsCache[e]){let r=this.getCellNode(e,t);r&&o(r,5)}}highlightRow(e,t){let i=this.rowsCache[e];t||=this._options.rowHighlightDuration,Array.isArray(i?.rowNode)&&this._options.rowHighlightCssClass&&(i.rowNode.forEach(o=>o.classList.add(...ae(this._options.rowHighlightCssClass))),clearTimeout(this._highlightRowTimer),this._highlightRowTimer=setTimeout(()=>{i.rowNode?.forEach(o=>o.classList.remove(...ae(this._options.rowHighlightCssClass)))},t))}handleMouseWheel(e,t,i,o){this.scrollHeight=this._viewportScrollContainerY.scrollHeight,e.shiftKey?this.scrollLeft=this._viewportScrollContainerX.scrollLeft+i*10:(this.scrollTop=Math.max(0,this._viewportScrollContainerY.scrollTop-o*this._options.rowHeight),this.scrollLeft=this._viewportScrollContainerX.scrollLeft+i*10),this._handleScroll("mousewheel")&&e.stopPropagation()}handleDragInit(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;let o=this.triggerEvent(this.onDragInit,t,e);return o.isImmediatePropagationStopped()?o.getReturnValue():!1}handleDragStart(e,t){let i=this.getCellFromEvent(e);if(!i||!this.cellExists(i.row,i.cell))return!1;let o=this.triggerEvent(this.onDragStart,t,e);return o.isImmediatePropagationStopped()?o.getReturnValue():!1}handleDrag(e,t){return this.triggerEvent(this.onDrag,t,e).getReturnValue()}handleDragEnd(e,t){this.triggerEvent(this.onDragEnd,t,e)}handleKeyDown(e){let i=this.triggerEvent(this.onKeyDown,{row:this.activeRow,cell:this.activeCell},e).isImmediatePropagationStopped();if(!i){if(this._options.enableCellNavigation&&e.ctrlKey&&e.key.toLowerCase()==="c"&&!this._options.enableExcelCopyBuffer)nr({grid:this,cell:this.activeCell,row:this.activeRow,column:this.columns[this.activeCell],dataContext:this.getDataItem(this.activeRow)});else if(!e.shiftKey&&!e.altKey){if(this._options.editable&&this.currentEditor?.keyCaptureList&&this.currentEditor.keyCaptureList.indexOf(e.which)>-1)return;e.ctrlKey&&e.key==="Home"?this.navigateTopStart():e.ctrlKey&&e.key==="End"?this.navigateBottomEnd():e.ctrlKey&&e.key==="ArrowUp"?this.navigateTop():e.ctrlKey&&e.key==="ArrowDown"?this.navigateBottom():e.ctrlKey&&e.key==="ArrowLeft"||!e.ctrlKey&&e.key==="Home"?this.navigateRowStart():(e.ctrlKey&&e.key==="ArrowRight"||!e.ctrlKey&&e.key==="End")&&this.navigateRowEnd()}}if(!i)if(!e.shiftKey&&!e.altKey&&!e.ctrlKey)if(e.key==="Escape"){if(!this.getEditorLock()?.isActive())return;this.cancelEditAndSetFocus()}else e.key==="PageDown"?(this.navigatePageDown(),i=!0):e.key==="PageUp"?(this.navigatePageUp(),i=!0):e.key==="ArrowLeft"?i=this.navigateLeft():e.key==="ArrowRight"?i=this.navigateRight():e.key==="ArrowUp"?i=this.navigateUp():e.key==="ArrowDown"?i=this.navigateDown():e.key==="Tab"?i=this.navigateNext():e.key==="Enter"&&(this._options.editable&&(this.currentEditor?this.activeRow===this.getDataLength()?this.navigateDown():this.commitEditAndSetFocus():this.getEditorLock()?.commitCurrentEdit()&&this.makeActiveCellEditable(void 0,void 0,e)),i=!0);else e.key==="Tab"&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&(i=this.navigatePrev());i&&(e.stopPropagation(),e.preventDefault())}handleClick(e){let t=e instanceof U?e.getNativeEvent():e;if(!this.currentEditor&&(t.target!==document.activeElement||t.target.classList.contains("slick-cell"))){let o=this.getTextSelection();this.setFocus(),this.setTextSelection(o)}let i=this.getCellFromEvent(t);if(!(!i||this.currentEditor!==null&&this.activeRow===i.row&&this.activeCell===i.cell)&&(e=this.triggerEvent(this.onClick,{row:i.row,cell:i.cell},e||t),!(e.isImmediatePropagationStopped()||t.defaultPrevented)&&this.canCellBeActive(i.row,i.cell)&&(!this.getEditorLock()?.isActive()||this.getEditorLock()?.commitCurrentEdit()))){this.scrollRowIntoView(i.row,!1);let o=t.target?.className===Fd,r=this.columns[i.cell],n=!!(this._options.editable&&r?.editorClass&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(this.getCellNode(i.row,i.cell),null,o,n,t)}}handleContextMenu(e){let t=e.target.closest(".slick-cell");t&&(this.activeCellNode===t&&this.currentEditor!==null||this.triggerEvent(this.onContextMenu,{},e))}handleDblClick(e){let t=this.getCellFromEvent(e);!t||this.currentEditor!==null&&this.activeRow===t.row&&this.activeCell===t.cell||(this.triggerEvent(this.onDblClick,{row:t.row,cell:t.cell},e),!e.defaultPrevented&&this._options.editable&&this.gotoCell(t.row,t.cell,!0,e))}handleHeaderMouseEnter(e){let t=w.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseEnter,{column:t,grid:this},e)}handleHeaderMouseOver(e){let t=w.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseOver,{column:t,grid:this},e)}handleHeaderMouseLeave(e){let t=w.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseLeave,{column:t,grid:this},e)}handleHeaderMouseOut(e){let t=w.storage.get(e.target.closest(".slick-header-column"),"column");t&&this.triggerEvent(this.onHeaderMouseOut,{column:t,grid:this},e)}handleHeaderRowMouseEnter(e){let t=w.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseEnter,{column:t,grid:this},e)}handleHeaderRowMouseOver(e){let t=w.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseOver,{column:t,grid:this},e)}handleHeaderRowMouseLeave(e){let t=w.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseLeave,{column:t,grid:this},e)}handleHeaderRowMouseOut(e){let t=w.storage.get(e.target.closest(".slick-headerrow-column"),"column");t&&this.triggerEvent(this.onHeaderRowMouseOut,{column:t,grid:this},e)}handleHeaderContextMenu(e){let t=e.target.closest(".slick-header-column"),i=t&&w.storage.get(t,"column");this.triggerEvent(this.onHeaderContextMenu,{column:i},e)}handleHeaderClick(e){if(!this.columnResizeDragging){let t=e.target.closest(".slick-header-column"),i=t&&w.storage.get(t,"column");i&&this.triggerEvent(this.onHeaderClick,{column:i},e)}}handlePreHeaderContextMenu(e){this.triggerEvent(this.onPreHeaderContextMenu,{node:e.target},e)}handlePreHeaderClick(e){this.columnResizeDragging||this.triggerEvent(this.onPreHeaderClick,{node:e.target},e)}handleFooterContextMenu(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&w.storage.get(t,"column");this.triggerEvent(this.onFooterContextMenu,{column:i},e)}handleFooterClick(e){let t=e.target.closest(".slick-footerrow-column"),i=t&&w.storage.get(t,"column");this.triggerEvent(this.onFooterClick,{column:i},e)}handleCellMouseOver(e){this.triggerEvent(this.onMouseEnter,{},e)}handleCellMouseOut(e){this.triggerEvent(this.onMouseLeave,{},e)}cellExists(e,t){return!(e<0||e>=this.getDataLength()||t<0||t>=this.columns.length)}getCellFromPoint(e,t){let i=this.getRowFromPosition(t),o=0,r=0;for(let n=0;n<this.columns.length&&r<=e;n++)this.columns[n]&&(r+=this.columns[n].width,o++);return o-=1,i<-1&&(i=-1),{row:i,cell:o}}getCellFromNode(e){let t=/l\d+/.exec(e.className);if(!t)throw new Error(`SlickGrid getCellFromNode: cannot get cell - ${e.className}`);return parseInt(t[0].substr(1,t[0].length-1),10)}getRowFromNode(e){for(let t in this.rowsCache)if(this.rowsCache){for(let i in this.rowsCache[t].rowNode)if(this.rowsCache[t].rowNode?.[+i]===e)return t?parseInt(t,10):0}return null}getFrozenRowOffset(e){let t=0;return this.hasFrozenRows?this._options.frozenBottom?e>=this.actualFrozenRow?this.h<this.viewportTopH?t=this.actualFrozenRow*this._options.rowHeight:t=this.h:t=0:e>=this.actualFrozenRow?t=this.frozenRowsHeight:t=0:t=0,t}getCellFromEvent(e){let t=e instanceof U?e.getNativeEvent():e;if(!t)return null;let i=t.touches?t.touches[0]:t,o=t.target.closest(".slick-cell");if(!o)return null;let r=this.getRowFromNode(o.parentNode);if(this.hasFrozenRows){let a=0,l=_e(w.parents(o,".grid-canvas")[0]);w.parents(o,".grid-canvas-bottom").length&&(a=this._options.frozenBottom?w.height(this._canvasTopL):this.frozenRowsHeight);let c=i.clientX-l.left,h=i.clientY-l.top+a+document.documentElement.scrollTop;r=this.getCellFromPoint(c,h).row}let n=this.getCellFromNode(o);return!ti(r)||!ti(n)?null:{row:r,cell:n}}getCellNodeBox(e,t){if(!this.cellExists(e,t))return null;let i=this.getFrozenRowOffset(e),o=this.getRowTop(e)-i,r=o+this._options.rowHeight-1,n=0;for(let l=0;l<t;l++)this.columns[l]&&!this.columns[l].hidden&&(n+=this.columns[l].width||0,this._options.frozenColumn===l&&(n=0));let a=n+(this.columns[t]?.width||0);return{top:o,left:n,bottom:r,right:a}}resetActiveCell(){this.setActiveCellInternal(null,!1)}unsetActiveCell(){q(this.activeCellNode)&&(this.makeActiveCellNormal(),this.activeCellNode.classList.remove("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach(e=>e.classList.remove("active")))}focus(){this.setFocus()}setFocus(){this.tabbingDirection===-1?this._focusSink.focus():this._focusSink2.focus()}scrollCellIntoView(e,t,i){if(this.scrollRowIntoView(e,i),t>this._options.frozenColumn){let o=this.getColspan(e,t);this.internalScrollColumnIntoView(this.columnPosLeft[t],this.columnPosRight[t+(o>1?o-1:0)])}}internalScrollColumnIntoView(e,t){let i=this.scrollLeft+w.width(this._viewportScrollContainerX)-(this.viewportHasVScroll&&this.scrollbarDimensions?.width||0);e<this.scrollLeft?(this._viewportScrollContainerX.scrollLeft=e,this.handleScroll(),this.render()):t>i&&(this._viewportScrollContainerX.scrollLeft=Math.min(e,t-this._viewportScrollContainerX.clientWidth),this.handleScroll(),this.render())}scrollColumnIntoView(e){this.internalScrollColumnIntoView(this.columnPosLeft[e],this.columnPosRight[e])}setActiveCellInternal(e,t,i,o,r){if(this.unsetActiveCell(),this.activeCellNode=e,q(this.activeCellNode)){let n=_e(this.activeCellNode),a=Math.floor(_e(w.parents(this.activeCellNode,".grid-canvas")[0]).top),l=w.parents(this.activeCellNode,".grid-canvas-bottom").length;this.hasFrozenRows&&l&&(a-=this._options.frozenBottom?w.height(this._canvasTopL):this.frozenRowsHeight);let d=this.getCellFromPoint(n.left,Math.ceil(n.top)-a);this.activeRow=this.activePosY=d.row,this.activeCell=this.activePosX=this.getCellFromNode(this.activeCellNode),!q(t)&&this._options.autoEditNewRow&&(t=this.activeRow===this.getDataLength()||this._options.autoEdit),this._options.showCellSelection&&(document.querySelectorAll(".slick-cell.active").forEach(c=>c.classList.remove("active")),this.activeCellNode.classList.add("active"),this.rowsCache[this.activeRow]?.rowNode?.forEach(c=>c.classList.add("active"))),this._options.editable&&t&&this.isCellPotentiallyEditable(this.activeRow,this.activeCell)&&(this._options.asyncEditorLoading?(clearTimeout(this.h_editorLoader),this.h_editorLoader=setTimeout(()=>{this.makeActiveCellEditable(void 0,i,r)},this._options.asyncEditorLoadDelay)):this.makeActiveCellEditable(void 0,i,r))}else this.activeRow=this.activeCell=null;o||this.triggerEvent(this.onActiveCellChanged,this.getActiveCell())}isCellPotentiallyEditable(e,t){let i=this.getDataLength();return!(e<i&&!this.getDataItem(e)||this.columns[t].cannotTriggerInsert&&e>=i||!this.columns[t]||this.columns[t].hidden||!this.getEditor(e,t))}makeActiveCellNormal(e=!1){if(this.currentEditor){if(this.triggerEvent(this.onBeforeCellEditorDestroy,{editor:this.currentEditor}),this.currentEditor.destroy(),this.currentEditor=null,this.activeCellNode){let t=this.getDataItem(this.activeRow);if(this.activeCellNode.classList.remove("editable","invalid"),t){let i=this.columns[this.activeCell],r=this.getFormatter(this.activeRow,i)(this.activeRow,this.activeCell,this.getDataItemValueForColumn(t,i),i,t,this);this.applyFormatResultToCellNode(r,this.activeCellNode),this.invalidatePostProcessingResults(this.activeRow)}e&&this.setFocus()}this.getEditorLock()?.deactivate(this.editController)}}editActiveCell(e,t,i){this.makeActiveCellEditable(e,t,i)}makeActiveCellEditable(e,t,i){if(!this.activeCellNode)return;if(!this._options.editable)throw new Error("SlickGrid makeActiveCellEditable : should never get called when grid options.editable is false");if(clearTimeout(this.h_editorLoader),!this.isCellPotentiallyEditable(this.activeRow,this.activeCell))return;let o=this.columns[this.activeCell],r=this.getDataItem(this.activeRow);if(this.triggerEvent(this.onBeforeEditCell,{row:this.activeRow,cell:this.activeCell,item:r,column:o,target:"grid"}).getReturnValue()===!1){this.setFocus();return}this.getEditorLock()?.activate(this.editController),this.activeCellNode.classList.add("editable");let n=e||this.getEditor(this.activeRow,this.activeCell);if(typeof n=="function"){!e&&!n.suppressClearOnEdit&&j(this.activeCellNode);let a=this.getItemMetadaWhenExists(this.activeRow);a=a?.columns;let l=a&&(a[o.id]||a[this.activeCell]),d={grid:this,gridPosition:this.absBox(this._container),position:this.absBox(this.activeCellNode),container:this.activeCellNode,column:o,columnMetaData:l,item:r||{},event:i,commitChanges:this.commitEditAndSetFocus.bind(this),cancelChanges:this.cancelEditAndSetFocus.bind(this)};this.currentEditor=new n(d),r&&this.currentEditor&&(this.currentEditor.loadValue(r),t&&typeof this.currentEditor?.preClick=="function"&&this.currentEditor.preClick()),this.serializedEditorValue=this.currentEditor?.serializeValue(),this.currentEditor?.position&&this.handleActiveCellPositionChange()}}commitEditAndSetFocus(e=!0){this.getEditorLock()?.commitCurrentEdit()&&(this.setFocus(),this._options.autoEdit&&!this._options.autoCommitEdit&&e&&this.navigateDown())}cancelEditAndSetFocus(){this.getEditorLock()?.cancelCurrentEdit()&&this.setFocus()}absBox(e){let t=e.getBoundingClientRect(),i=this._container?.getBoundingClientRect?.()||{top:0,left:0,bottom:0,right:0},o={top:t.top-i.top,left:t.left-i.left,bottom:t.bottom-i.top,right:t.right-i.left,width:t.width,height:t.height,visible:!0};return(o.bottom<0||o.top>(this._container?.clientHeight??window.innerHeight)||o.right<0||o.left>(this._container?.clientWidth??window.innerWidth))&&(o.visible=!1),o}getActiveCellPosition(){return this.absBox(this.activeCellNode)}getGridPosition(){return this.absBox(this._container)}getCellEditor(){return this.currentEditor}getActiveCell(){return this.activeCellNode?{row:this.activeRow,cell:this.activeCell}:null}getActiveCellNode(){return this.activeCellNode}getTextSelection(){let e=null;if(window.getSelection){let t=window.getSelection();(t?.rangeCount||0)>0&&(e=t.getRangeAt(0))}return e}setTextSelection(e){if(window.getSelection&&e){let t=window.getSelection();t&&(t.removeAllRanges(),t.addRange(e))}}scrollRowIntoView(e,t){if(!this.hasFrozenRows||!this._options.frozenBottom&&e>this.actualFrozenRow-1||this._options.frozenBottom&&e<this.actualFrozenRow-1){let i=w.height(this._viewportScrollContainerY),o=this.hasFrozenRows&&!this._options.frozenBottom?e-this._options.frozenRow:e,r=o*this._options.rowHeight,n=(o+1)*this._options.rowHeight-i+(this.viewportHasHScroll&&this.scrollbarDimensions?.height||0);(o+1)*this._options.rowHeight>this.scrollTop+i+this.offset?(this.scrollTo(t?r:n),this.render()):o*this._options.rowHeight<this.scrollTop+this.offset&&(this.scrollTo(t?n:r),this.render())}}scrollRowToTop(e){this.scrollTo(e*this._options.rowHeight),this.render()}scrollPage(e){let t=e*this.numVisibleRows,i=this.scrollTop+this._options.rowHeight-1;if(this.scrollTo((this.getRowFromPosition(i)+t)*this._options.rowHeight),this.render(),this._options.enableCellNavigation&&q(this.activeRow)){let o=this.activeRow+t,r=this.getDataLengthIncludingAddNew();o>=r&&(o=r-1),o<0&&(o=0);let n=e===1?this.gotoDown(o-1||0,this.activeCell,this.activePosY,this.activePosX):this.gotoUp(o+1,this.activeCell,this.activePosY,this.activePosX);this.navigateToPos(n)}}navigatePageDown(){this.unsetActiveCell(),this.scrollPage(1)}navigatePageUp(){this.unsetActiveCell(),this.scrollPage(-1)}navigateTop(){this.unsetActiveCell(),this.navigateToRow(0)}navigateBottom(){let e=this.getDataLength()-1,t=this.getParentRowSpanByCell(e,this.activeCell)?.start??e;do if(this._options.enableCellRowSpan&&this.setActiveRow(t),this.navigateToRow(t)&&this.activeCell===this.activePosX||!q(this.activeCell))break;while(--t>0)}navigateToRow(e){let t=this.getDataLength();if(!t)return!1;e<0?e=0:e>=t&&(e=t-1),this.scrollCellIntoView(e,0,!0);let i=!q(this.activeCell)||!q(this.activeRow);if(this._options.enableCellNavigation&&q(this.activeRow)){let o=0,r=null,n=this.activePosX;for(;o<=this.activePosX;)this.canCellBeActive(e,o)&&(r=o,(!q(this.activeCell)||o===this.activeCell)&&(i=!0)),o+=this.getColspan(e,o);r!==null?(this.setActiveCellInternal(this.getCellNode(e,r)),this.activePosX=n):this.resetActiveCell()}return i}getColspan(e,t){let i=this.getItemMetadaWhenExists(e);if(!i||!i.columns)return 1;t>=this.columns.length&&(t=this.columns.length-1);let r=(i.columns[this.columns[t].id]||i.columns[t])?.colspan;return r==="*"?r=this.columns.length-t:r=r||1,r}getRowspan(e,t){let i=1,o=this.getItemMetadaWhenExists(e);return o?.columns&&Object.keys(o.columns).forEach(r=>{let n=Number(r);if(n===t){let a=o.columns[n];i=Number(a?.rowspan||1)}}),i}findFocusableRow(e,t,i){let o=e,r=this._colsWithRowSpanCache[t]||new Set,n=!1;return Array.from(r).forEach(a=>{let[l,d]=a.split(":").map(Number);!n&&e>=l&&e<=d&&(o=i==="up"?l:d,this.canCellBeActive(o,t)&&(n=!0))}),o}findFirstFocusableCell(e){let t=0,i=e,o=-1;for(;t<this.columns.length;){let r=this.getParentRowSpanByCell(e,t);if(i=r!==null&&r.start!==e?r.start:e,this.canCellBeActive(i,t)){o=t;break}t+=this.getColspan(i,t)}return{cell:o,row:i}}findLastFocusableCell(e){let t=0,i=e,o=-1;for(;t<this.columns.length;){let r=this.getParentRowSpanByCell(e,t);i=r!==null&&r.start!==e?r.start:e,this.canCellBeActive(i,t)&&(o=t),t+=this.getColspan(i,t)}return{cell:o,row:i}}findSpanStartingCell(e,t){let i=this.getParentRowSpanByCell(e,t),o=i!==null&&i.start!==e?i.start:e,r=0,n=0;for(;r<this.columns.length;){if(r+=this.getColspan(o,r),r>t)return r=n,{cell:r,row:o};n=r}return{cell:r,row:o}}gotoRight(e,t,i,o){if(t<this.columns.length){let r=t+1,n=i;do{let a=this.findSpanStartingCell(i,r);if(n=a.row,r=a.cell,this.canCellBeActive(n,r)&&r>t)break;r+=this.getColspan(n,a.cell)}while(r<this.columns.length);if(r<this.columns.length)return{row:n,cell:r,posX:r,posY:i}}return null}gotoLeft(e,t,i,o){let r=this.findFirstFocusableCell(e);if(t<=0||r.cell>=t)return null;let n,a={row:e,cell:r.cell,posX:r.cell,posY:i};for(;;){if(n=this.gotoRight(a.row,a.cell,a.posY,a.posX),!n)return null;if(n.cell>=t){let l=this.findFocusableRow(i,a.cell,"up");return l!==a.row&&(a.row=l),a}a=n}}gotoDown(e,t,i,o){let r,n=this.getDataLengthIncludingAddNew();do for(e+=this.getRowspan(e,o),r=t=0;t<=o;)r=t,t+=this.getColspan(e,t);while(e<=n&&!this.canCellBeActive(e,r));return e<=n?{row:e,cell:r,posX:o,posY:e}:null}gotoUp(e,t,i,o){let r;if(e>0){do for(e=this.findFocusableRow(e-1,o,"up"),r=t=0;t<=o;)r=t,t+=this.getColspan(e,t);while(e>=0&&!this.canCellBeActive(e,r));if(t<=this.columns.length)return{row:e,cell:r,posX:o,posY:e}}return null}gotoNext(e,t,i,o){if(!ti(e)&&!ti(t)&&(e=t=i=o=0,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let r=this.gotoRight(e,t,i,o);if(!r){let n;for(;!r&&++i<this.getDataLength()+(this._options.enableAddRow?1:0);)n=this.findFirstFocusableCell(i),e=this.getParentRowSpanByCell(i,n.cell)?.start??i,r={row:e,cell:n.cell,posX:n.cell,posY:i}}return r}gotoPrev(e,t,i,o){if(!ti(e)&&!ti(t)&&(e=i=this.getDataLengthIncludingAddNew()-1,t=o=this.columns.length-1,this.canCellBeActive(e,t)))return{row:e,cell:t,posX:t,posY:i};let r=this.gotoLeft(e,t,i,o);if(!r){let n;for(;!r&&--i>=0;)n=this.findLastFocusableCell(i),n.cell>-1&&(e=this.getParentRowSpanByCell(i,n.cell)?.start??i,r={row:e,cell:n.cell,posX:n.cell,posY:i})}return r}gotoRowStart(e,t,i,o){let r=this.findFirstFocusableCell(e);return{row:r.row,cell:r.cell,posX:r.cell,posY:e}}gotoRowEnd(e,t,i,o){let r=this.findLastFocusableCell(e);return r.cell===-1?null:{row:r.row,cell:r.cell,posX:r.cell,posY:e}}navigateRight(){return this.navigate("right")}navigateLeft(){return this.navigate("left")}navigateDown(){return this.navigate("down")}navigateUp(){return this.navigate("up")}navigateNext(){return this.navigate("next")}navigatePrev(){return this.navigate("prev")}navigateRowStart(){return this.navigate("home")}navigateRowEnd(){return this.navigate("end")}navigateTopStart(){return this.unsetActiveCell(),this.navigateToRow(0),this.navigate("home")}navigateBottomEnd(){return this.navigateBottom(),this.navigate("end")}navigate(e){if(!this._options.enableCellNavigation||!this.activeCellNode&&e!=="prev"&&e!=="next")return!1;if(!this.getEditorLock()?.commitCurrentEdit())return!0;this.setFocus(),this.unsetActiveCell();let t={up:-1,down:1,left:-1,right:1,prev:-1,next:1,home:-1,end:1};this.tabbingDirection=t[e];let r={up:this.gotoUp,down:this.gotoDown,left:this.gotoLeft,right:this.gotoRight,prev:this.gotoPrev,next:this.gotoNext,home:this.gotoRowStart,end:this.gotoRowEnd}[e].call(this,this.activeRow,this.activeCell,this.activePosY,this.activePosX);return this.navigateToPos(r)}navigateToPos(e){if(e){if(this.hasFrozenRows&&this._options.frozenBottom&&e.row===this.getDataLength())return;let t=e.row===this.getDataLength();return(!this._options.frozenBottom&&e.row>=this.actualFrozenRow||this._options.frozenBottom&&e.row<this.actualFrozenRow)&&this.scrollCellIntoView(e.row,e.cell,!t&&this._options.emulatePagingWhenScrolling),this.setActiveCellInternal(this.getCellNode(e.row,e.cell)),this.activePosX=e.posX,this.activePosY=e.posY,!0}else return this.setActiveCellInternal(this.getCellNode(this.activeRow,this.activeCell)),!1}getCellNode(e,t){if(this.rowsCache[e]){this.ensureCellNodesInRowsCache(e);try{return this.rowsCache[e].cellNodesByColumnIdx.length>t?this.rowsCache[e].cellNodesByColumnIdx[t]:null}catch{return this.rowsCache[e].cellNodesByColumnIdx[t]}}return null}setActiveCell(e,t,i,o,r){!this.initialized||!this._options.enableCellNavigation||e>this.getDataLength()||e<0||t>=this.columns.length||t<0||(this.scrollCellIntoView(e,t,!1),this.setActiveCellInternal(this.getCellNode(e,t),i,o,r))}setActiveRow(e,t,i){t??=0,!(!this.initialized||e>this.getDataLength()||e<0||t>=this.columns.length||t<0)&&(this.activeRow=e,i||this.scrollCellIntoView(e,t,!1))}canCellBeActive(e,t){if(!this._options.enableCellNavigation||e>=this.getDataLengthIncludingAddNew()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden||(this.getParentRowSpanByCell(e,t)?.start??e)!==e)return!1;let o=this.getItemMetadaWhenExists(e);if(o?.focusable!==void 0)return!!o.focusable;let r=o?.columns;return r?.[this.columns[t].id]?.focusable!==void 0?!!r[this.columns[t].id].focusable:r?.[t]?.focusable!==void 0?!!r[t].focusable:!!this.columns[t].focusable}canCellBeSelected(e,t){if(e>=this.getDataLength()||e<0||t>=this.columns.length||t<0||!this.columns[t]||this.columns[t].hidden)return!1;let i=this.getItemMetadaWhenExists(e);if(i?.selectable!==void 0)return!!i.selectable;let o=i?.columns&&(i.columns[this.columns[t].id]||i.columns[t]);return o?.selectable!==void 0?!!o.selectable:!!this.columns[t].selectable}gotoCell(e,t,i,o){if(this.initialized&&this.canCellBeActive(e,t)&&this.getEditorLock()?.commitCurrentEdit()){this.scrollCellIntoView(e,t,!1);let r=this.getCellNode(e,t),n=this.columns[t],a=!!(this._options.editable&&n?.editorClass&&this._options.suppressActiveCellChangeOnEdit);this.setActiveCellInternal(r,i||e===this.getDataLength()||this._options.autoEdit,null,a,o),this.currentEditor||this.setFocus()}}commitCurrentEdit(){let e=this,t=e.getDataItem(e.activeRow),i=e.columns[e.activeCell];if(e.currentEditor){if(e.currentEditor.isValueChanged()){let o=e.currentEditor.validate();if(o.valid){let r=e.activeRow,n=e.activeCell,a=e.currentEditor,l=e.currentEditor.serializeValue(),d=e.serializedEditorValue;if(e.activeRow<e.getDataLength()){let c={row:r,cell:n,editor:a,serializedValue:l,prevSerializedValue:d,execute:()=>{a.applyValue(t,l),e.updateRow(r),e.triggerEvent(e.onCellChange,{command:"execute",row:r,cell:n,item:t,column:i})},undo:()=>{a.applyValue(t,d),e.updateRow(r),e.triggerEvent(e.onCellChange,{command:"undo",row:r,cell:n,item:t,column:i})}};e._options.editCommandHandler?(e.makeActiveCellNormal(!0),e._options.editCommandHandler(t,i,c)):(c.execute(),e.makeActiveCellNormal(!0))}else{let c={};e.currentEditor.applyValue(c,e.currentEditor.serializeValue()),e.makeActiveCellNormal(!0),e.triggerEvent(e.onAddNewRow,{item:c,column:i})}return!e.getEditorLock()?.isActive()}else return e.activeCellNode&&(e.activeCellNode.classList.remove("invalid"),w.width(e.activeCellNode),e.activeCellNode.classList.add("invalid")),e.triggerEvent(e.onValidationError,{editor:e.currentEditor,cellNode:e.activeCellNode,validationResults:o,row:e.activeRow,cell:e.activeCell,column:i}),e.currentEditor.focus(),!1}e.makeActiveCellNormal(!0)}return!0}cancelCurrentEdit(){return this.makeActiveCellNormal(),!0}rowsToRanges(e){let t=[],i=this.columns.length-1;for(let o=0;o<e.length;o++)t.push(new Ne(e[o],0,e[o],i));return t}getSelectedRows(){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");return this.selectedRows.slice(0)}setSelectedRows(e,t){if(!this.selectionModel)throw new Error("SlickGrid Selection model is not set");let i=this.getEditorLock();typeof i?.isActive=="function"&&!i.isActive()&&this.selectionModel.setSelectedRanges(this.rowsToRanges(e),t||"SlickGrid.setSelectedRows")}sanitizeHtmlString(e){return Ai(e,this._options?.sanitizer)}};var lr=class{constructor(e,t,i){this.translaterService=e,this.collectionService=t,this.rxjs=i,this._clearFilterTriggered=!1,this._collectionObservers=[],this._shouldTriggerQuery=!0,this.searchTerms=[],this.isFilled=!1,this.isItemSelected=!1,this.valueName="label",this.enableTranslateLabel=!1,this.subscriptions=[],this._bindEventService=new oe}get autocompleterOptions(){return this._autocompleterOptions||{}}get collection(){return this._collection}get columnFilter(){return this.columnDef?.filter||{}}get filterDomElement(){return this._filterElm}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.autocompleter,...this.columnFilter?.filterOptions,...this.columnFilter?.options}}get customStructure(){let e=this.columnFilter?.customStructure,t=this.columnFilter?.type??this.columnDef?.type;return!e&&t===_.object&&this.columnDef?.dataKey&&this.columnDef?.labelKey&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get defaultOperator(){return N.equal}get gridOptions(){return this.grid?.getOptions()??{}}get instance(){return this._instance}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection&&!this.columnFilter.collectionAsync&&Eo(this.filterOptions))throw new Error(`[Slickgrid-Universal] You need to pass a "collection" (or "collectionAsync") for the AutoComplete Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.autocompleter, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }`);this.enableTranslateLabel=this.columnFilter?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.valueName=this.customStructure?.value??"value",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this._locales=this.gridOptions?.locales??x.locales;let t=this.columnFilter.collection;return this._collection=t,this.renderDomElement(t),new Promise(async(i,o)=>{try{let r=this.columnFilter.collectionAsync,n;r&&!this.columnFilter.collection?(n=Ns(r,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),i(n)):(n=t,i(t)),(r||this.columnFilter.enableCollectionWatch)&&(await(n??r),this.watchCollectionChanges())}catch(r){o(r)}})}clear(e=!0){this._filterElm&&(this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[],this._filterElm.value="",this._filterElm.dispatchEvent(new CustomEvent("input")),this.updateFilterStyle(!1))}destroy(){typeof this._instance?.destroy=="function"&&this._instance.destroy(),this._filterElm,this._filterElm?.remove?.(),this._collection=void 0,this._bindEventService.unbindAll(),this._collectionObservers.forEach(e=>e?.disconnect()),Wi(this.subscriptions)}getValues(){return this._filterElm?.value||""}setValues(e,t,i=!1){e&&this._filterElm&&(this._filterElm.value=e),this.updateFilterStyle(this.getValues()!==""),this.operator=t||this.defaultOperator,i&&this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:[this.getValues()],shouldTriggerQuery:!0})}watchCollectionChanges(){this.columnFilter?.collection&&(this._collectionObservers.push(Bt(this.columnFilter.collection,e=>{this.renderDomElement(this.columnFilter.collection||e||[])})),wi(this.columnFilter,"collection",e=>{this.renderDomElement(e||[]),this.columnFilter.collection&&this._collectionObservers.push(Bt(this.columnFilter.collection,t=>{this.renderDomElement(this.columnFilter.collection||t||[])}))}))}renderDomElement(e){e=Ht(e,this.columnFilter);let t=e;t&&(t=Xi(t,this.collectionService,this.columnFilter?.collectionFilterBy,this.columnFilter.collectionOptions),t=Zi(t,this.columnDef,this.collectionService,this.columnFilter?.collectionSortBy,this.enableTranslateLabel));let i=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this._collection=t,this._filterElm=this.createFilterElement(t,i),this._bindEventService.bind(this._filterElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._filterElm,"blur",()=>{this.isItemSelected||this.clear()})}createFilterElement(e,t){this._collection=e;let i=this.columnDef?.id??"";j(this.filterContainerElm);let o=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(o=this.columnFilter.placeholder),this._filterElm=p("input",{type:"text",ariaLabel:this.columnFilter?.ariaLabel??`${Xe(i+"")} Search Filter`,autocomplete:"off",ariaAutoComplete:"none",placeholder:o,className:`form-control search-filter slick-filter filter-${i} slick-autocomplete-container`,value:t??"",dataset:{columnid:`${i}`}});let r=t;Array.isArray(e)&&(e.every(a=>ii(a))?e=e.map(a=>({label:a,value:a})):e=e.map(a=>({label:a?.[this.labelName],value:a?.[this.valueName],labelPrefix:a?.[this.labelPrefixName]??"",labelSuffix:a?.[this.labelSuffixName]??""}))),this._autocompleterOptions={input:this._filterElm,debounceWaitMs:200,className:`slick-autocomplete ${this.filterOptions?.className??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&this.translaterService?.translate?this.translaterService.translate("NO_ELEMENTS_FOUND"):this._locales?.TEXT_NO_ELEMENTS_FOUND??"No elements found",customize:(a,l,d)=>{d.style.width=""},onSelect:a=>{this.isItemSelected=!0,this.handleSelect(a)},...this.filterOptions},this.gridOptions?.darkMode&&(this._autocompleterOptions.className+=" slick-dark-mode"),this.autocompleterOptions.className=ae(this.autocompleterOptions.className).join(" "),this._autocompleterOptions.renderItem?.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${Mt(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=this._autocompleterOptions.render?.bind(this)??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),this.filterOptions?.fetch?(Fs(this._filterElm,this._autocompleterOptions),this._instance=Ui(this._autocompleterOptions)):this._instance=Ui({...this._autocompleterOptions,fetch:(a,l)=>{e&&l(e.filter(d=>((typeof d=="string"?d:d?.label)||"").toLowerCase().includes(a.toLowerCase())))}}),this._filterElm.value=r??"";let n=p("div",{className:"autocomplete-filter-container"});return n.appendChild(this._filterElm),n.appendChild(p("span")),t&&this._filterElm.classList.add("filled"),this.filterContainerElm.appendChild(n),this.filterContainerElm.appendChild(document.createElement("span")),this.columnFilter.onInstantiated?.(this._instance),this._filterElm}handleSelect(e){if(e!==void 0){let t=this.filterOptions?.renderItem??!1,i=typeof e=="string"?e:t?e[this.labelName]:e.label,o=typeof e=="string"?e:t?e[this.valueName]:e.value;o=this.trimWhitespaceWhenEnabled(o),this.updateFilterStyle(o!==""),this.setValues(i),this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:[o],shouldTriggerQuery:this._shouldTriggerQuery}),this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}return!1}handleOnInputChange(e){let t=e?.target?.value??"",i=this.filterOptions.triggerOnEveryKeyStroke??!1;if(t=this.trimWhitespaceWhenEnabled(t),this._clearFilterTriggered||t===""||i){let o={columnDef:this.columnDef,shouldTriggerQuery:this._shouldTriggerQuery};this._clearFilterTriggered?o.clearFilterTriggered=this._clearFilterTriggered:(o.operator=this.operator,o.searchTerms=[t]),this.updateFilterStyle(t!==""),this.callback(e,o)}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0}renderRegularItem(e){let t=typeof e=="string"?e:e?.label??"";return p("div",{textContent:t||""})}renderCustomItem(e){let t=this._autocompleterOptions?.renderItem?.templateCallback(e)??"",i=document.createElement("div");return Se(i,t,this.gridOptions),i}renderCollectionItem(e){let t=this.columnFilter?.enableRenderHtml??!1,i=e.labelPrefix||"",o=e.label||"",r=e.labelSuffix||"",n=i+o+r,a=this.grid.sanitizeHtmlString(n)||"",l=document.createElement("div");return l[t?"innerHTML":"textContent"]=a,l}trimWhitespaceWhenEnabled(e){let t=e,i=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;return typeof e=="string"&&i&&(t=e.trim()),t}updateFilterStyle(e){this.isItemSelected=e,this._filterElm.classList.toggle("filled",e)}};var co=class{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._lastClickIsDate=!1,this._shouldTriggerQuery=!0,this.hasTimePicker=!1,this.inputFilterType="range",this.searchTerms=[],this._bindEventService=new oe}get gridOptions(){return this.grid?.getOptions()??{}}get columnFilter(){return this.columnDef?.filter||{}}get currentDateOrDates(){return this._currentDateOrDates}get defaultOperator(){return this.inputFilterType==="compound"?N.empty:this.gridOptions.defaultFilterRangeOperator||N.rangeInclusive}get pickerOptions(){return this._pickerOptions||{}}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.date,...this.columnFilter?.filterOptions,...this.columnFilter?.options}}get operator(){return this.inputFilterType==="compound"?this._operator||this.columnFilter.operator||this.defaultOperator:this.columnFilter?.operator??this.defaultOperator}set operator(e){this.inputFilterType==="compound"?this._operator=e:this.columnFilter&&(this.columnFilter.operator=e)}init(e){this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.inputFilterType==="compound"&&(this.operator=e.operator||""),this.searchTerms=e?.searchTerms??[],this.filterContainerElm=e.filterContainerElm;let t=this.inputFilterType==="compound"?Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"":this.searchTerms;this._filterElm=this.createDomFilterElement(t),this.updateFilterStyle(this.searchTerms.length>0),this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this)),this._bindEventService.bind(document.body,"keydown",i=>{(i.key==="Escape"||i.key==="Tab")&&this.hide()}),this._bindEventService.bind(this._dateInputElm,"keydown",i=>{i.key==="Backspace"&&this.clear(!0,!1)})}clear(e=!0,t=!0){this.calendarInstance&&(this._clearFilterTriggered=t,this._shouldTriggerQuery=e,this._currentValue="",this.searchTerms=[],this._currentDateStrings=[],this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.calendarInstance&&Fo(this.calendarInstance)),this.onTriggerEvent(new Event("keyup")),this.updateFilterStyle(!1)}destroy(){this._bindEventService.unbindAll(),this.calendarInstance?.destroy(),j(this.filterContainerElm),this.filterContainerElm?.remove(),this._selectOperatorElm?.remove(),this._filterElm?.remove()}hide(){typeof this.calendarInstance?.hide=="function"&&this.calendarInstance.hide()}show(){typeof this.calendarInstance?.show=="function"&&this.calendarInstance.show()}getValues(){return this._currentDateOrDates}setValues(e,t,i=!1){let o;this.inputFilterType==="compound"?o=Array.isArray(e)?e[0]:e:typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"&&e[0].indexOf("..")>0?o=typeof e=="string"?[e]:e[0].split(".."):Array.isArray(e)&&(o=e),this.calendarInstance&&o!==void 0&&(Ri(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:o}),this._currentDateOrDates=e&&o?o:void 0);let r=this.getValues()||[],n=Array.isArray(r)?r:[r];if(this.updateFilterStyle(n.length>0),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){let a=Wt(this.operator);this._selectOperatorElm.value=a}i&&this.callback(void 0,{columnDef:this.columnDef,searchTerms:n,operator:this.operator,shouldTriggerQuery:!0})}buildDatePickerInput(e){let t=this.columnDef?.id??"",i=this.columnFilter.type||this.columnDef.type||_.dateIso,o=this.columnDef.outputType||this.columnFilter.type||this.columnDef.type||_.dateUtc,r=Le(o),n=this.columnFilter.type||this.columnDef.type||_.dateIso;r&&this.inputFilterType!=="range"&&(r==="ISO8601"||r.toLowerCase().includes("h"))&&(this.hasTimePicker=!0);let a=Le(this.hasTimePicker?_.dateTimeIsoAM_PM:_.dateIso),l=(this.filterOptions?.locale??this.translaterService?.getCurrentLanguage?.())||this.gridOptions.locale||"en",d;this.inputFilterType==="compound"?e&&(d=e,this._currentDateOrDates=e):(typeof e=="string"||Array.isArray(e)&&typeof e[0]=="string"&&e[0].indexOf("..")>0?d=typeof e=="string"?[e]:e[0].split(".."):Array.isArray(e)&&(d=e),Array.isArray(d)&&(this._currentDateOrDates=d,this._currentDateStrings=d.map(u=>gt(u,void 0,n))));let c={inputMode:!0,enableJumpToSelectedDate:!0,firstWeekday:0,enableDateToggle:!0,locale:l,selectedTheme:this.gridOptions?.darkMode?"dark":"light",positionToInput:"auto",sanitizerHTML:u=>this.grid.sanitizeHtmlString(u),selectedWeekends:[],type:this.inputFilterType==="range"?"multiple":"default",onClickDate:()=>{this._lastClickIsDate=!0},onChangeToInput:u=>{if(u.context.inputElement){let m=[],g="",f="";if(u.context.selectedDates[1]){u.context.selectedDates.sort((k,C)=>+new Date(k)-+new Date(C)),g=u.context.selectedDates[0],f=u.context.selectedDates[u.context.selectedDates.length-1];let b=Fe(u.context.selectedDates[0],r,"en-US"),v=Fe(f,r,"en-US");u.context.inputElement.value=`${b} \u2014 ${v}`,m=[g,f]}else u.context.selectedDates[0]?(g=u.context.selectedDates[0],u.context.inputElement.value=gt(g,_.dateIso,o),m=u.context.selectedDates):u.context.inputElement.value="";if(this.hasTimePicker&&g){let b=ni(g,a);b.setHours(+(u.context.selectedHours||0)),b.setMinutes(+(u.context.selectedMinutes||0)),u.context.inputElement.value=gt(b,void 0,o),m=[b]}if(this.inputFilterType==="compound"?this._currentValue=gt(m[0],void 0,i):Array.isArray(m)&&(this._currentDateStrings=m.map(b=>gt(b,void 0,i)),this._currentValue=this._currentDateStrings.join("..")),this._currentDateOrDates=m.map(b=>b instanceof Date?b:ni(b,a)),this._currentValue){let b=this.hasTimePicker?new Event("keyup"):void 0;this.onTriggerEvent(b)}this.inputFilterType==="range"&&u.context.selectedDates.length<2&&(this._lastClickIsDate=!1),this._lastClickIsDate&&(u.hide(),this._lastClickIsDate=!1)}}};this.inputFilterType==="range"&&(c.type="multiple",c.displayMonthsCount=2,c.monthsToSwitch=2,c.enableEdgeDatesOnly=!0,c.selectionDatesMode="multiple-ranged",c.displayDatesOutside=!1),this.hasTimePicker&&(c.selectionTimeMode=24),this._pickerOptions=fe(!0,{},c,this.filterOptions);let h=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(h=this.columnFilter.placeholder),this._dateInputElm=p("input",{type:"text",className:"form-control date-picker",placeholder:h,readOnly:!0,dataset:{input:"",columnid:`${t}`}}),this.calendarInstance=new Ki(this._dateInputElm,this._pickerOptions),this.calendarInstance.init(),this._pickerOptions?.selectedDates&&(d=this._pickerOptions.selectedDates),d&&Ri(this.columnFilter,this._dateInputElm,this.calendarInstance,{columnDef:this.columnDef,oldVal:void 0,newVal:d,updatePickerUI:!1}),this.columnFilter.onInstantiated?.(this.calendarInstance)}getOperatorOptionValues(){let e;return this.columnFilter?.compoundOperatorList?e=this.columnFilter.compoundOperatorList:e=Ji(this.gridOptions,this.translaterService),eo(this.gridOptions,e,"numeric"),e}createDomFilterElement(e){let t=this.columnDef?.id??"";if(j(this.filterContainerElm),this.buildDatePickerInput(e),this.inputFilterType==="range"){let i=p("div",{className:`date-picker form-group search-filter slick-filter filter-${t}`});return Array.isArray(e)&&e.length>0&&e[0]!==""&&(this._currentDateOrDates=e,this._currentValue=e[0]),i.appendChild(this._dateInputElm),i&&this.filterContainerElm.appendChild(i),i}else{this._selectOperatorElm=Qi(this.getOperatorOptionValues(),this.grid);let i=p("div",{className:`date-picker form-group search-filter slick-filter filter-${t}`}),o=p("div",{className:"input-group date-picker"},i);if(p("div",{className:"input-group-addon input-group-prepend operator"},o).appendChild(this._selectOperatorElm),o.appendChild(this._dateInputElm),this.operator){let n=Wt(this.operator);this._selectOperatorElm.value=n}return this._currentDateOrDates=e,this._currentValue=e,i&&this.filterContainerElm.appendChild(i),i}}onTriggerEvent(e){if(this._clearFilterTriggered)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,shouldTriggerQuery:this._shouldTriggerQuery}),this.updateFilterStyle(!1);else if(this.inputFilterType==="range"){let t=this._currentDateStrings?this._currentDateStrings:[this._currentValue];this.updateFilterStyle(t.length>0),this.callback(e,{columnDef:this.columnDef,searchTerms:t,operator:this.operator||"",shouldTriggerQuery:this._shouldTriggerQuery})}else if(this.inputFilterType==="compound"&&this._selectOperatorElm){let t=this._selectOperatorElm.value;this.updateFilterStyle(!!this._currentValue);let i=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput===void 0,o=i&&q(this._currentDateOrDates)||this._currentDateOrDates===""&&q(this._lastSearchValue);(!i||!i||o)&&this.callback(e,{columnDef:this.columnDef,searchTerms:this._currentValue?[this._currentValue]:null,operator:t||"",shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._lastSearchValue=this._currentValue}updateFilterStyle(e){this._filterElm.classList.toggle("filled",e)}};var dr=class extends co{constructor(e){super(e),this.translaterService=e,this.inputFilterType="compound"}};var ho=class{constructor(e){this.translaterService=e}filterCollection(e,t,i="chain"){let o=[];return Array.isArray(t)?(o=i==="merge"?[]:[...e],t.forEach(r=>{if(i==="merge"){let n=this.singleFilterCollection(e,r);o=Hn([...o,...n])}else o=this.singleFilterCollection(o,r)})):o=this.singleFilterCollection(e,t),o}preParseByMutationDateItems(e,t,i){let o=[];t.getColumns().forEach(r=>{let n=this.getParseDateInfo(r,i);n&&o.push(n)}),e.forEach(r=>{o.forEach(({columnId:n,dateFormat:a,queryFieldName:l})=>{this.reassignDateWhenValid(r,n,a,l)})})}parseSingleDateItem(e,t,i){i&&t.getColumns().forEach(o=>{let r=this.getParseDateInfo(o,i);r&&this.reassignDateWhenValid(e,o.id,r.dateFormat,r.queryFieldName)})}singleFilterCollection(e,t){let i=[];if(t){let o=t.property,r=t.operator||N.equal,n=typeof t.value>"u"?"":t.value;switch(r){case N.equal:o?i=e.filter(a=>a[o]===n):i=e.filter(a=>a===n);break;case N.contains:o?i=e.filter(a=>a[o]?.toString().indexOf(n.toString())!==-1):i=e.filter(a=>a!=null&&a.toString().indexOf(n.toString())!==-1);break;case N.notContains:o?i=e.filter(a=>a[o]?.toString().indexOf(n.toString())===-1):i=e.filter(a=>a!=null&&a.toString().indexOf(n.toString())===-1);break;case N.notEqual:default:o?i=e.filter(a=>a[o]!==n):i=e.filter(a=>a!==n)}}return i}sortCollection(e,t,i,o){if(o&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let r=[];if(i){if(Array.isArray(i))r=t.sort((n,a)=>{for(let l=0,d=i.length;l<d;l++){let c=i[l];if(c?.property){let h=c.sortDesc?ce.desc:ce.asc,u=c.property,m=c?.fieldType??e?.type??_.string,g=o?this.translaterService?.translate?.(n[u]||" "):n[u],f=o?this.translaterService?.translate?.(a[u]||" "):a[u],b=jt(m,g,f,h,e);if(b!==ce.neutral)return b}}return ce.neutral});else if(i?.property){let n=i.property,a=i.sortDesc?ce.desc:ce.asc,l=i?.fieldType??e?.type??_.string;r=t.sort((d,c)=>{let h=o?this.translaterService?.translate&&this.translaterService.translate(d[n]||" "):d[n],u=o?this.translaterService?.translate&&this.translaterService.translate(c[n]||" "):c[n],m=jt(l,h,u,a,e);return m!==ce.neutral?m:ce.neutral})}else if(i&&!i.property){let n=i.sortDesc?ce.desc:ce.asc,a=i?.fieldType??e?.type??_.string;r=t.sort((l,d)=>{let c=o?this.translaterService?.translate&&this.translaterService.translate(l||" "):l,h=o?this.translaterService?.translate&&this.translaterService.translate(d||" "):d,u=jt(a,c,h,n,e);return u!==ce.neutral?u:ce.neutral})}}return r}getParseDateInfo(e,t){let i=e.type||_.string,o=Le(i);if(ut(i)&&t){let r=typeof t=="string"?`${t}${e.id}`:`${e.id}`;return{columnId:e.id,dateFormat:o,queryFieldName:r}}}reassignDateWhenValid(e,t,i,o){let r=nt(e[t],i,!1);r&&(e[o]=r)}};var cr=class{init(e){this._grid=e,e.hasDataView()&&(this._dataView=e.getData())}getDataItem(e){return this._dataView?.getItem(e)??this._grid.getDataItem(e)}getDataItems(){return this._dataView?.getItems()??this._grid.getData()}getDataLength(){return this._dataView?.getItemCount()??this._grid.getDataLength()}setDataItems(e){this._dataView?.setItems(e)??this._grid.setData(e)}};function hr(s,e,t,i,o=!1,r,n){let a=t?.id??"",l=i.getOptions(),d=(s==="editor"?t?.editor:t?.filter)??{},h=(d?.collectionOptions??{})?.separatorBetweenTextLabels??"",u=d?.enableTranslateLabel??!1,m=l?.enableTranslate??!1,g=d?.enableRenderHtml??!1,f=d?.customStructure?.label??"label",b=d?.customStructure?.labelPrefix??"labelPrefix",v=d?.customStructure?.labelSuffix??"labelSuffix",k=d?.customStructure?.optionLabel??"value",C=d?.customStructure?.value??"value",E=p("select",{className:"ms-filter"}),y=s==="filter"?["search-filter",`filter-${a}`]:["select-editor",`editor-${a}`];E.classList.add(...y),E.multiple=o;let S=[],F=!1;return Array.isArray(e)&&(e.every(V=>typeof V=="number"||typeof V=="string")?e.forEach(V=>{let M={text:String(V),value:V};s==="filter"&&Array.isArray(n)&&(M.selected=n.findIndex(Y=>Y===V)>=0),S.push(M),(M.selected&&o||M.selected&&!o&&V!=="")&&(F=!0)}):e.forEach(V=>{if(V===void 0||typeof V=="object"&&V[f]===void 0&&V.labelKey===void 0)throw new Error("[Slickgrid-Universal] Select Filter/Editor collection with value/label (or value/labelKey when using Locale) is required to populate the Select list, for example:: { filter: model: Filters.multipleSelect, collection: [ { value: '1', label: 'One' } ]')");let M=V.labelKey||V[f],Y=(V.labelKey||u&&r)&&M&&m?r?.translate(M||" "):M,me=V[b]||"",re=V[v]||"",pe=V.hasOwnProperty(k)?V[k]:"";pe?.toString&&(pe=pe.toString().replace(/"/g,"'")),me=Ia(me,u,r),re=Ia(re,u,r),pe=Ia(pe,u,r);let Qe=[me,typeof Y=="string"||typeof Y=="number"?Y.toString():Y,re].filter(T=>T).join(h),De={text:"",value:""};g&&(Qe=Ai(Qe,l.sanitizer)),De.text=Qe;let O=V[C];O==null&&(O=""),s==="filter"&&Array.isArray(n)&&(De.selected=n.findIndex(T=>`${T}`==`${V[C]}`)>=0),De.value=`${O??""}`,S.push(De),(De.selected&&o||De.selected&&!o&&V[C]!=="")&&(F=!0)})),{selectElement:E,dataCollection:S,hasFoundSearchTerm:F}}function Ia(s,e,t){return e&&t&&s&&typeof s=="string"?t.translate(s||" "):s}var ur=class{constructor(e,t,i){this.sharedService=e,this.backendUtilities=t,this.translaterService=i}getPickerTitleOutputString(e,t){if(this.sharedService.gridOptions?.enableTranslate&&!this.translaterService?.translate)throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');let i="",o=this.sharedService.gridOptions?.[t]??{},r=o?.[e],n=o?.[`${e}Key`],a=this.sharedService.gridOptions,l=$e(a);if(!r&&n&&this.translaterService?.translate)i=this.translaterService.translate(n||" ");else{let d="";switch(e){case"commandTitle":d="COMMANDS";break;case"columnTitle":d="COLUMNS";break;case"forceFitTitle":d="FORCE_FIT_COLUMNS";break;case"syncResizeTitle":d="SYNCHRONOUS_RESIZE";break}i=d?this.translateWhenEnabledAndServiceExist(`${l}${d}`,`TEXT_${d}`,r):r}return i}readjustFrozenColumnIndexWhenNeeded(e,t,i){if(e>=0){let o=i.findIndex(r=>r.id===this.sharedService.frozenVisibleColumnId);o>=0&&o!==e&&(this.sharedService.gridOptions.frozenColumn=o,this.sharedService.slickGrid.setOptions({frozenColumn:o})),Array.isArray(i)&&Array.isArray(t)&&i.length!==t.length&&this.sharedService.slickGrid.setColumns(i)}}refreshBackendDataset(e){let t=this.sharedService.gridOptions;e&&(t={...this.sharedService.gridOptions,...e},this.sharedService.gridOptions=t),this.backendUtilities?.refreshBackendDataset(t)}runOverrideFunctionWhenExists(e,t){return typeof e=="function"?!!e.call(this,t):!0}sortItems(e,t){Array.isArray(e)&&e.sort((i,o)=>i&&o&&i.hasOwnProperty(t)&&o.hasOwnProperty(t)?i[t]-o[t]:0)}translateItems(e,t,i){if(Array.isArray(e))for(let o of e)o.hasOwnProperty(t)&&(o[i]=this.translaterService?.translate?.(o[t]))}translateMenuItemsFromTitleKey(e,t="commandItems"){for(let i of e)typeof i=="object"&&(i.titleKey&&(i.title=this.translateWhenEnabledAndServiceExist(`${i.titleKey}`,`TEXT_${i.titleKey}`,i._orgTitle)),i.subMenuTitleKey&&(i.subMenuTitle=this.translateWhenEnabledAndServiceExist(`${i.subMenuTitleKey}`,`TEXT_${i.subMenuTitleKey}`))),Array.isArray(i?.[t])&&this.translateMenuItemsFromTitleKey(i?.[t])}translateWhenEnabledAndServiceExist(e,t,i){let o="",r=this.sharedService?.gridOptions,n=r?.locales??x.locales;return i?o=i:r.enableTranslate&&this.translaterService?.translate?o=this.translaterService.translate(e||" "):t in n?o=n[t]:o=t,o}};var mr=class{constructor(e){this.pluginName="AutoTooltips",this._defaults={enableForCells:!0,enableForHeaderCells:!1,maxToolTipLength:void 0,replaceExisting:!0},this._eventHandler=new G,this._addonOptions=e}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e){this._addonOptions={...this._defaults,...this.addonOptions},this._grid=e,this._addonOptions.enableForCells&&this._eventHandler.subscribe(this._grid.onMouseEnter,this.handleMouseEnter.bind(this)),this._addonOptions.enableForHeaderCells&&this._eventHandler.subscribe(this._grid.onHeaderMouseEnter,this.handleHeaderMouseEnter.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll()}handleMouseEnter(e){let t=this._grid.getCellFromEvent(e);if(t){let i=this._grid.getCellNode(t.row,t.cell),o;this._addonOptions&&i&&(!i.title||this._addonOptions?.replaceExisting)&&(i.clientWidth<i.scrollWidth?(o=i.textContent?.trim()??"",this._addonOptions?.maxToolTipLength&&o.length>this._addonOptions?.maxToolTipLength&&(o=o.substring(0,this._addonOptions.maxToolTipLength-3)+"...")):o="",i.title=o),i=null}}handleHeaderMouseEnter(e,t){let i=t.column,o,r=e.target;if(r&&(o=r.closest(".slick-header-column"),o&&!i?.toolTip)){let n=r.clientWidth<o.clientWidth?i?.name??"":"";o.title=Ze(wt(n,"innerHTML"))}o=null}};var pr=class{constructor(){this.pluginName="CellExcelCopyManager",this._eventHandler=new G,this._bindingEventService=new oe}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get commandQueue(){return this._commandQueue}get gridOptions(){return this._grid?.getOptions()??{}}get undoRedoBuffer(){return this._undoRedoBuffer}init(e,t){this._grid=e,this.createUndoRedoBuffer(),this._cellSelectionModel=new fr,this._grid.setSelectionModel(this._cellSelectionModel),this._bindingEventService.bind(document.body,"keydown",this.handleBodyKeyDown.bind(this)),this._addonOptions={...this.getDefaultOptions(),...t},this._cellExternalCopyManagerPlugin=new gr,this._cellExternalCopyManagerPlugin.init(this._grid,this._addonOptions),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCells,(i,o)=>{this._addonOptions&&typeof this._addonOptions.onCopyCells=="function"&&this._addonOptions.onCopyCells(i,o)}),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onCopyCancelled,(i,o)=>{this._addonOptions&&typeof this._addonOptions.onCopyCancelled=="function"&&this._addonOptions.onCopyCancelled(i,o)}),this._eventHandler.subscribe(this._cellExternalCopyManagerPlugin.onPasteCells,(i,o)=>{this._addonOptions&&typeof this._addonOptions.onPasteCells=="function"&&this._addonOptions.onPasteCells(i,o)})}dispose(){this._eventHandler.unsubscribeAll(),this._bindingEventService.unbindAll(),this._cellSelectionModel?.dispose(),this._cellExternalCopyManagerPlugin?.dispose()}createUndoRedoBuffer(){let e=0;this._commandQueue=[],this._undoRedoBuffer={queueAndExecuteCommand:t=>{this._commandQueue[e]=t,e++,t.execute()},undo:()=>{if(e===0)return;e--;let t=this._commandQueue[e];t&&Li.cancelCurrentEdit()&&t.undo()},redo:()=>{if(e>=this._commandQueue.length)return;let t=this._commandQueue[e];e++,t&&Li.cancelCurrentEdit()&&t.execute()}}}getDefaultOptions(){let e=0;return{clipboardCommandHandler:t=>{this._undoRedoBuffer.queueAndExecuteCommand.call(this._undoRedoBuffer,t)},dataItemColumnValueExtractor:(t,i,o=0,r=0)=>{let n=this._grid.getActiveCell(),a=this._grid.getCellEditor()&&n?.row===o&&n?.cell===r,l=this.addonOptions?.copyActiveEditorCell||!1;if(!this.gridOptions.editable||!i.editor||!a||l){let d=i.exportWithFormatter!==void 0?i.exportWithFormatter:this.gridOptions.textExportOptions?.exportWithFormatter;if(i.formatter&&d){let c=i.formatter(o,r,t[i.field],i,t,this._grid),h=Dt(c)?c:c.html||c.text;if(i.sanitizeDataExport||this.gridOptions.textExportOptions?.sanitizeDataExport){let u=h instanceof HTMLElement?h.innerHTML:h;return Ze(u??"")}return c}}return null},readOnlyMode:!1,includeHeaderWhenCopying:!1,newRowCreator:t=>{for(let i=0;i<t;i++)this._grid.getData().addItem({[this.gridOptions.datasetIdPropertyName||"id"]:`newRow_${e++}`})},replaceNewlinesWith:!1,removeDoubleQuotesOnPaste:!1}}handleBodyKeyDown(e){e.key==="Z"&&(e.ctrlKey||e.metaKey)&&(e.shiftKey?this._undoRedoBuffer.redo():this._undoRedoBuffer.undo())}};var qm=2e3,vr=()=>{},gr=class{constructor(){this.pluginName="CellExternalCopyManager",this._copiedCellStyle="copied",this._copiedCellStyleLayerKey="copy-manager",this._copiedRanges=null,this._dataWrapper=new cr,this.onCopyCells=new R("onCopyCells"),this.onCopyCancelled=new R("onCopyCancelled"),this.onPasteCells=new R("onPasteCells"),this.onBeforePasteCell=new R("onBeforePasteCell"),this._eventHandler=new G}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}init(e,t){this._grid=e,this._dataWrapper.init(e),this._addonOptions={...this._addonOptions,...t},this._copiedCellStyleLayerKey=this._addonOptions.copiedCellStyleLayerKey||"copy-manager",this._copiedCellStyle=this._addonOptions.copiedCellStyle||"copied",this._onCopyInit=this._addonOptions.onCopyInit||void 0,this._onCopySuccess=this._addonOptions.onCopySuccess||void 0;let i=e.getPubSubService();i&&w.addSlickEventPubSubWhenDefined(i,this),this._eventHandler.subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this));let o=e.getSelectionModel();if(!o)throw new Error("Selection model is mandatory for this plugin. Please set a selection model on the grid before adding this plugin: grid.setSelectionModel(new SlickCellSelectionModel())");this._eventHandler.subscribe(o.onSelectedRangesChanged,()=>{!this._grid.getEditorLock().isActive()&&!document.activeElement?.classList.contains("slick-filter")&&this._grid.focus()}),e&&typeof this._addonOptions?.onBeforePasteCell=="function"&&this._eventHandler.subscribe(this.onBeforePasteCell,(r,n)=>{let a=e.getColumns()[n.cell],l={row:n.row,cell:n.cell,dataView:e.getData(),grid:e,columnDef:a,dataContext:e.getDataItem(n.row)};return this._addonOptions.onBeforePasteCell?.(r,l)})}dispose(){this._eventHandler.unsubscribeAll()}clearCopySelection(){this._grid.removeCellCssStyles(this._copiedCellStyleLayerKey)}getHeaderValueForColumn(e){if(typeof this._addonOptions.headerColumnValueExtractor=="function"){let t=wt(this._addonOptions.headerColumnValueExtractor(e),"innerHTML");if(t)return Ze(t)}return wt(e.name||"","innerHTML")}getDataItemValueForColumn(e,t,i,o,r){if(typeof this._addonOptions.dataItemColumnValueExtractor=="function"){let a=this._addonOptions.dataItemColumnValueExtractor(e,t,i,o);if(a)return a instanceof HTMLElement?Ze(a.innerHTML):a}let n="";if(t)if(t.editorClass){let a=document.createElement("p"),l=new t.editorClass({container:a,column:t,event:r,position:{top:0,left:0},gridPosition:{top:0,left:0},grid:this._grid,cancelChanges:vr,commitChanges:vr});l.loadValue(e),n=l.serializeValue(),l.destroy(),a.remove()}else n=e[t.field||""];return n}setDataItemValueForColumn(e,t,i){if(!t?.denyPaste){if(this._addonOptions.dataItemColumnValueSetter){let o=this._addonOptions.dataItemColumnValueSetter(e,t,i);if(o!==!0)return o}if(t.editorClass){let o=document.createElement("div"),r=new t.editorClass({container:o,column:t,event:null,position:{top:0,left:0},gridPosition:{top:0,left:0},grid:this._grid,cancelChanges:vr,commitChanges:vr});r.loadValue(e);let n=r.validate(void 0,i);if(!n.valid){let a=this._grid.getActiveCell();this._grid.onValidationError.notify({editor:r,cellNode:this._grid.getActiveCellNode(),validationResults:n,row:a?.row,cell:a?.cell,column:t,grid:this._grid})}r.applyValue(e,i),r.destroy(),o.remove()}else e[t.field]=i}}setIncludeHeaderWhenCopying(e){this._addonOptions.includeHeaderWhenCopying=e}decodeTabularData(e,t){let i=e.getColumns(),o=t.replace(`\r
`,`
`).split(/[\n\f\r](?=(?:[^"]*"[^"]*")*[^"]*$)/);o[o.length-1]===""&&o.pop();let r=0,n=[];for(let k of o)k.startsWith('"')&&k.endsWith('"')?n[r++]=[k.replaceAll(`
`,this._addonOptions.replaceNewlinesWith||`
`).replaceAll("\r","").replaceAll('"',this._addonOptions.removeDoubleQuotesOnPaste?"":'"')]:n[r++]=k.split("	");let a=this._grid.getActiveCell(),l=this._grid.getSelectionModel()?.getSelectedRanges(),d=l?.length?l[0]:null,c,h;if(d)c=d.fromRow,h=d.fromCell;else if(a)c=a.row,h=a.cell;else return;let u=!1,m=n.length,g=n.length?n[0].length:0;n.length===1&&n[0].length===1&&d&&(u=!0,m=d.toRow-d.fromRow+1,g=d.toCell-d.fromCell+1);let f=this._dataWrapper.getDataLength()-c;if(f<m&&typeof this._addonOptions.newRowCreator=="function"){let k=m-f,C=this._dataWrapper.getDataLength();this._addonOptions.newRowCreator(k);let E=this._dataWrapper.getDataLength();E!==C+k&&console.warn(`[Slickgrid-Universal] The "newRowCreator" did not add the correct amount of rows, it should add "${k}" rows but it added "${E-C}" rows`),this._grid.render()}if(c+m>this._dataWrapper.getDataLength()&&typeof this._addonOptions.newRowCreator=="function"){let k=c+m-this._dataWrapper.getDataLength();this._addonOptions.newRowCreator(k)}let v={isClipboardCommand:!0,clippedRange:n,oldValues:[],cellExternalCopyManager:this,_options:this._addonOptions,setDataItemValueForColumn:this.setDataItemValueForColumn,markCopySelection:this.markCopySelection,oneCellToMultiple:u,activeRow:c,activeCell:h,destH:m,destW:g,maxDestY:this._dataWrapper.getDataLength(),maxDestX:this._grid.getColumns().length,h:0,w:0,execute:()=>{v.h=0;for(let C=0;C<v.destH;C++){v.oldValues[C]=[],v.w=0,v.h++;let E=0;for(let y=0;y<v.destW;y++){let S=c+C,F=h+y,V=i[F];if(V.hidden){v.destW++,E++;continue}if(v.w++,S<v.maxDestY&&F<v.maxDestX){let M=this._dataWrapper.getDataItem(S);if(this._grid.triggerEvent(this.onBeforePasteCell,{row:S,cell:F,dt:M,column:V,target:"grid"}).getReturnValue()===!1)continue;v.oldValues[C][y-E]=M[V.field],u?this.setDataItemValueForColumn(M,V,n[0][0]):this.setDataItemValueForColumn(M,V,n[C]?n[C][y-E]:""),this._grid.updateCell(S,F),this._grid.onCellChange.notify({row:S,cell:F,item:M,grid:this._grid,column:{}})}}}let k=new Ne(c,h,c+v.h-1,h+v.w-1);this.markCopySelection([k]),this._grid.getSelectionModel()?.setSelectedRanges([k]),this.onPasteCells.notify({ranges:[k]})},undo:()=>{for(let C=0;C<v.destH;C++)for(let E=0;E<v.destW;E++){let y=c+C,S=h+E;if(y<v.maxDestY&&S<v.maxDestX){let F=this._dataWrapper.getDataItem(y);u?this.setDataItemValueForColumn(F,i[S],v.oldValues[0][0]):this.setDataItemValueForColumn(F,i[S],v.oldValues[C][E]),this._grid.updateCell(y,S),this._grid.onCellChange.notify({row:y,cell:S,item:F,grid:this._grid,column:{}})}}let k=new Ne(c,h,c+v.h-1,h+v.w-1);this.markCopySelection([k]),this._grid.getSelectionModel()?.setSelectedRanges([k]),this.onPasteCells.notify({ranges:[k]}),typeof this._addonOptions.onPasteCells=="function"&&this._addonOptions.onPasteCells(new U,{ranges:[k]})}};this._addonOptions.clipboardCommandHandler?this._addonOptions.clipboardCommandHandler(v):v.execute()}async handleKeyDown(e){try{let t;if(!this._grid.getEditorLock().isActive()||this._grid.getOptions().autoEdit){if(e.key==="Escape"&&this._copiedRanges&&(e.preventDefault(),this.clearCopySelection(),this.onCopyCancelled.notify({ranges:this._copiedRanges}),typeof this._addonOptions.onCopyCancelled=="function"&&this._addonOptions.onCopyCancelled(e,{ranges:this._copiedRanges}),this._copiedRanges=null),(e.key==="c"||e.key==="Insert")&&(e.ctrlKey||e.metaKey)&&!e.shiftKey&&(typeof this._onCopyInit=="function"&&this._onCopyInit.call(this),t=this._grid.getSelectionModel()?.getSelectedRanges()??[],t.length!==0)){this._copiedRanges=t,this.markCopySelection(t),this.onCopyCells.notify({ranges:t}),typeof this._addonOptions.onCopyCells=="function"&&this._addonOptions.onCopyCells(e,{ranges:t});let i=this._grid.getColumns(),o="";for(let n=0;n<t.length;n++){let a=t[n],l=[];for(let d=a.fromRow;d<a.toRow+1;d++){let c=[],h=this._dataWrapper.getDataItem(d);if(l.length===0&&this._addonOptions.includeHeaderWhenCopying){let u=[];for(let m=a.fromCell;m<a.toCell+1;m++)i[m]&&(i[m].name instanceof HTMLElement?Ze(i[m].name.innerHTML):i[m].name).length>0&&!i[m].hidden&&u.push(this.getHeaderValueForColumn(i[m]));l.push(u.join("	"))}for(let u=a.fromCell;u<a.toCell+1;u++)i[u]&&(i[u].name instanceof HTMLElement?Ze(i[u].name.innerHTML):i[u].name).length>0&&!i[u].hidden&&c.push(this.getDataItemValueForColumn(h,i[u],d,u,e));l.push(c.join("	"))}o+=l.join(`\r
`)+`\r
`}let r=this._grid.getOptions().clipboardWriteOverride;if(r?r(o):await navigator.clipboard.writeText(o),typeof this._onCopySuccess=="function"){let n=t.length===1?t[0].toRow+1-t[0].fromRow:t.length;this._onCopySuccess(n)}return!1}if(!this._addonOptions.readOnlyMode&&(e.key==="v"&&(e.ctrlKey||e.metaKey)&&!e.shiftKey||e.key==="Insert"&&e.shiftKey&&!e.ctrlKey)){let i=await navigator.clipboard.readText();this.decodeTabularData(this._grid,i)}}}catch(t){console.error(`Unable to read/write to clipboard. Please check your browser settings or permissions. Error: ${t}`)}}markCopySelection(e){this.clearCopySelection();let t=this._grid.getColumns(),i={};for(let o of e)for(let r=o.fromRow;r<=o.toRow;r++){i[r]={};for(let n=o.fromCell;n<=o.toCell&&n<t.length;n++)i[r][t[n].id]=this._copiedCellStyle}this._grid.setCellCssStyles(this._copiedCellStyleLayerKey,i),clearTimeout(this._clearCopyTI),this._clearCopyTI=setTimeout(()=>this.clearCopySelection(),this.addonOptions?.clearCopySelectionDelay||qm)}};var Ft=class{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._addonOptions={},this._camelPluginName="",this._gridUid="",this._menuCssPrefix="",this._menuPluginCssPrefix="",this.pluginName="",this._bindEventService=new oe,this._eventHandler=new G}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){return this._gridUid||(this.grid?.getUID()??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get menuCssClass(){return this._menuPluginCssPrefix||this._menuCssPrefix}get menuElement(){return this._menuElm||document.querySelector(`.${this.menuCssClass}${this.gridUidSelector}`)}dispose(){this._eventHandler?.unsubscribeAll(),this._bindEventService.unbindAll(),this.pubSubService.unsubscribeAll(),this._commandTitleElm?.remove(),this._optionTitleElm?.remove(),this.disposeAllMenus(),j(this._menuElm),this.menuElement?.remove(),this._menuElm?.remove()}disposeAllMenus(){this.disposeSubMenus(),this._bindEventService.unbindAll("parent-menu"),document.querySelectorAll(`.${this.menuCssClass}${this.gridUidSelector}`).forEach(e=>e.remove())}disposeSubMenus(){this._bindEventService.unbindAll("sub-menu"),document.querySelectorAll(`.${this.menuCssClass}.slick-submenu${this.gridUidSelector}`).forEach(e=>e.remove())}setOptions(e){this._addonOptions={...this._addonOptions,...e}}addSubMenuTitleWhenExists(e,t){if(e!=="divider"&&e?.subMenuTitle){let i=document.createElement("div");i.className="slick-menu-title",i.textContent=e.subMenuTitle;let o=e.subMenuTitleCssClass;o&&i.classList.add(...ae(o)),t.appendChild(i)}}populateCommandOrOptionItems(e,t,i,o,r,n,a){if(r&&o&&t)for(let l of o)this.populateSingleCommandOrOptionItem(e,t,i,l,r,n,a)}populateCommandOrOptionTitle(e,t,i,o){if(t){let r=o>0,n=this._menuElm?.querySelector(`.slick-${e}-header`)??p("div",{className:`slick-${e}-header`}),a=`${e}Title`;r||(t?.[a]?(j(n),this[`_${e}TitleElm`]=p("span",{className:"slick-menu-title",textContent:t[a]}),n.appendChild(this[`_${e}TitleElm`]),n.classList.add("with-title")):n.classList.add("no-title"),i.appendChild(n))}}populateSingleCommandOrOptionItem(e,t,i,o,r,n,a){let l=null;if(r&&o&&t){let d=r?.level||0,c=this._camelPluginName==="headerButtons"?"":"-item",h=`${this._menuCssPrefix}${c}`,u=!0,m=!0;if(typeof o=="object"&&(u=this.extensionUtility.runOverrideFunctionWhenExists(o.itemVisibilityOverride,r),m=this.extensionUtility.runOverrideFunctionWhenExists(o.itemUsabilityOverride,r)),!u)return null;if(typeof o=="object"&&o.itemUsabilityOverride&&(o.disabled=!m),l=p("li",{className:h,role:"menuitem"}),typeof o=="object"&&q(o[e])&&(l.dataset[e]=o?.[e]),i&&i.appendChild(l),typeof o=="object"&&o.divider||o==="divider")return l.classList.add(`${h}-divider`),l;if(o.disabled&&l.classList.add(`${h}-disabled`),(o.hidden||o.showOnHover)&&l.classList.add(`${h}-hidden`),o.cssClass&&l.classList.add(...ae(o.cssClass)),o.tooltip&&(l.title=o.tooltip),this._camelPluginName!=="headerButtons"){let f=p("div",{className:`${this._menuCssPrefix}-icon`});l.appendChild(f),o.iconCssClass?f.classList.add(...ae(o.iconCssClass)):!o.commandItems&&!o.optionItems&&(f.textContent="\u25E6");let b=p("span",{className:`${this._menuCssPrefix}-content`,textContent:typeof o=="object"&&o.title||""},l);o.textCssClass&&b.classList.add(...ae(o.textCssClass))}let g=d>0?"sub-menu":"parent-menu";if(this._bindEventService.bind(l,"click",f=>n.call(this,f,e,o,d,r?.column),void 0,g),this._addonOptions?.subMenuOpenByEvent==="mouseover"&&typeof a=="function"&&this._bindEventService.bind(l,"mouseover",f=>a.call(this,f,e,o,d,r?.column),void 0,g),o.commandItems||o.optionItems){let f=document.createElement("span");f.className="sub-item-chevron",this._addonOptions.subItemChevronClass?f.classList.add(...ae(this._addonOptions.subItemChevronClass)):f.textContent="\u2B9E",l.classList.add("slick-submenu-item"),l.appendChild(f)}}return l}repositionMenu(e,t,i,o){let r=e.target,n=e?.touches?.[0]??e,a=t.classList.contains("slick-submenu"),l=this.gridOptions.rowHeight||0,d=a?e.target.closest(".slick-menu-item"):this.pluginName==="CellMenu"||this.pluginName==="ContextMenu"?e.target.closest(".slick-cell"):n.target;if(t&&d){(this.pluginName==="CellMenu"||this.pluginName==="ContextMenu")&&(t.style.top="0px",t.style.left="0px");let c=this.sharedService.gridContainerElement.classList.contains("slickgrid-container")?this.sharedService.gridContainerElement:this.sharedService.gridContainerElement.querySelector(".slickgrid-container")??this.sharedService.gridContainerElement,h=Fn(c,r),u=t.offsetWidth,m=_e(d),g=0,f=0,b=0,v=0,k=0,C=0,{bottom:E,top:y}=Vn(d);if(this.pluginName==="GridMenu"&&i){if(!a){let V=getComputedStyle(i),M=parseInt(V?.width??o?.menuWidth,10),Y=o?.contentMinWidth??0,me=(Y>u?Y:u)||0;Y>0&&(t.style.minWidth=`${Y}px`);let re=_e(i),pe=re.right;f=re.top+i.offsetHeight,g=o?.dropSide==="right"?pe-M:pe-me}}else this.pluginName==="CellMenu"||this.pluginName==="ContextMenu"?(g=d&&this.pluginName==="CellMenu"?m.left:n.pageX,f=d&&this.pluginName==="CellMenu"?m.top:n.pageY,b=Number(o?.autoAdjustDropOffset||0),v=Number(o?.autoAlignSideOffset||0)):(g=a?m.left:h?.left??0,f=a?m.top:(h?.top??0)+(o?.menuOffsetTop??0)+r.clientHeight);(this.pluginName==="ContextMenu"||this.pluginName==="GridMenu")&&a&&(g=m.left,f=m.top);let S=t?.offsetHeight||0;if((this.pluginName==="GridMenu"||this.pluginName==="HeaderMenu")&&a?(k=E,C=y):(this.pluginName==="CellMenu"||this.pluginName==="ContextMenu"||o?.autoAdjustDrop||o?.dropDirection)&&(k=E+b-l,C=y-b+l),(k<S&&C>k?"top":"bottom")==="top"||o?.dropDirection==="top"?(t.classList.remove("dropdown"),t.classList.add("dropup"),a?f-=S-b-d.clientHeight:f-=S-b):(t.classList.remove("dropup"),t.classList.add("dropdown"),(this.pluginName==="CellMenu"||this.pluginName==="ContextMenu")&&(f=f+b,this.pluginName==="CellMenu"&&(a?f+=b:f+=l+b))),o?.autoAlign||o?.autoAlignSide||o?.dropSide==="left"){let V=g+Number(u);a&&(V+=d.clientWidth);let M=this.grid.getGridPosition(),Y=document.documentElement.clientWidth,me=V>=M.width||V>=Y?"left":"right",re=!1;if(me==="left"||!a&&o?.dropSide==="left")if(t.classList.remove("dropright"),t.classList.add("dropleft"),this.pluginName==="HeaderMenu")a?g-=u:re=!0;else if(this.pluginName==="CellMenu"&&!a){let pe=d.offsetWidth||0;g-=Number(u)-pe-v}else(this.pluginName!=="GridMenu"||this.pluginName==="GridMenu"&&a)&&(g-=Number(u)-v);else t.classList.remove("dropleft"),t.classList.add("dropright"),a?g+=v+d.offsetWidth:this.pluginName==="HeaderMenu"?re=!0:g+=v;re&&(g=h?.left??0,o?.autoAlign&&M?.width&&g+(t.clientWidth??0)>=M.width&&(g=g+r.clientWidth-t.clientWidth+(o?.autoAlignOffset||0)))}t.style.top=`${f}px`,t.style.left=`${g}px`,this.pluginName==="GridMenu"&&(t.style.opacity="1",t.style.display="block")}}};var uo=class extends Ft{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._currentCell=-1,this._currentRow=-1,this._lastMenuTypeClicked="",this._subMenuParentId=""}createParentMenu(e){this.menuElement?.remove(),this._menuElm=void 0;let t=this.grid.getCellFromEvent(e);if(t){this._currentCell=t.cell??0,this._currentRow=t.row??0;let i=this._addonOptions?.commandItems||[],o=this._addonOptions?.optionItems||[],r={cell:this._currentCell,row:this._currentRow,grid:this.grid};if(this.closeMenu(e,r),typeof e.stopPropagation=="function"&&(this.pubSubService.publish(`on${ri(this._camelPluginName)}BeforeMenuShow`,r),typeof this.addonOptions?.onBeforeMenuShow=="function"&&this.addonOptions.onBeforeMenuShow(e,r)===!1)||(this._menuElm=this.createMenu(i,o),this._menuElm&&(this._menuElm.style.top=`${(e.pageY||0)+5}px`,this._menuElm.style.left=`${e.pageX}px`,this._menuElm.style.display="block",document.body.appendChild(this._menuElm)),this.pubSubService.publish(`on${ri(this._camelPluginName)}AfterMenuShow`,r),typeof this.addonOptions?.onAfterMenuShow=="function"&&this.addonOptions.onAfterMenuShow(e,r)===!1))return}return this._menuElm}createMenu(e,t,i=0,o){let r=this.grid.getColumns()[this._currentCell],n=this.grid.getDataItem(this._currentRow),a=o?.command||o?.option,l=i===1&&a?String(a).replace(/\s/g,""):"";l&&(this._subMenuParentId=l),i>1&&(l=this._subMenuParentId);let d=!0,c=!0;if(this._camelPluginName==="contextMenu"){if(d=this.checkIsColumnAllowed(this._addonOptions?.optionShownOverColumnIds??[],r.id),c=this.checkIsColumnAllowed(this._addonOptions?.commandShownOverColumnIds??[],r.id),!r||(!c||!e.length)&&(!d||!t.length)){this.hideMenu();return}}else if(!r||!r.cellMenu||!e.length&&!t.length)return;let h=`${this.menuCssClass} slick-menu-level-${i} ${this.gridUid}`,u=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${i}${this.gridUidSelector}`);if(u){if(u.dataset.subMenuParent===l)return u;this.disposeSubMenus()}let m=document.createElement("div");m.className=h,i>0&&(m.classList.add("slick-submenu"),this.gridOptions?.darkMode&&m.classList.add("slick-dark-mode"),l&&(m.dataset.subMenuParent=l));let g=isNaN(this.addonOptions.maxHeight)?this.addonOptions.maxHeight:`${this.addonOptions.maxHeight??0}px`,f=isNaN(this.addonOptions.maxWidth)?this.addonOptions.maxWidth:`${this.addonOptions.maxWidth??0}px`;g&&(m.style.maxHeight=g),f&&(m.style.maxWidth=f),this.addonOptions?.width&&(m.style.width=pt(this.addonOptions?.width));let b=p("button",{ariaLabel:"Close",className:"close",type:"button",textContent:"\xD7",dataset:{dismiss:this._menuCssPrefix}});if(!this.addonOptions.hideOptionSection&&d&&t.length>0){let v=p("div",{className:`${this._menuCssPrefix}-option-list`,role:"menu"},m);this.populateCommandOrOptionTitle("option",this.addonOptions,v,i),!this.addonOptions.hideCloseButton&&i<1&&this.populateCommandOrOptionCloseBtn("option",b,v),o&&i>0&&this.addSubMenuTitleWhenExists(o,v),this.populateCommandOrOptionItems("option",this.addonOptions,v,t,{cell:this._currentCell,row:this._currentRow,column:r,dataContext:n,grid:this.grid,level:i},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}if(!this.addonOptions.hideCommandSection&&c&&e.length>0){let v=p("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},m);this.populateCommandOrOptionTitle("command",this.addonOptions,v,i),!this.addonOptions.hideCloseButton&&i<1&&(!d||t.length===0||this.addonOptions.hideOptionSection)&&this.populateCommandOrOptionCloseBtn("command",b,v),o&&i>0&&this.addSubMenuTitleWhenExists(o,v),this.populateCommandOrOptionItems("command",this.addonOptions,v,e,{cell:this._currentCell,row:this._currentRow,column:r,dataContext:n,grid:this.grid,level:i},this.handleMenuItemCommandClick,this.handleMenuItemMouseOver)}return i++,m}closeMenu(e,t){if(this.menuElement){if(typeof this.addonOptions?.onBeforeMenuClose=="function"&&this.addonOptions.onBeforeMenuClose(e,t)===!1)return;this.hideMenu()}}hideMenu(){this.menuElement?.remove(),this._menuElm=null,this.disposeSubMenus()}checkIsColumnAllowed(e,t){return e?.length>0?e.findIndex(i=>i===t)>=0:!0}handleBodyMouseDown(e){if(this.menuElement){let t=!1,i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this.menuElement!==e.target&&!t&&!e.defaultPrevented||e.target.className==="close"&&i)&&this.closeMenu(e,{cell:this._currentCell,row:this._currentRow,grid:this.grid})}}handleCloseButtonClicked(e){e.defaultPrevented||this.closeMenu(e,{cell:0,row:0,grid:this.grid})}handleMenuItemMouseOver(e,t,i,o=0){i?.[t]!==void 0&&i!=="divider"&&!i.disabled&&!i.divider&&(i.commandItems||i.optionItems?(this.repositionSubMenu(i,t,o,e),this._lastMenuTypeClicked=t):o===0&&this.disposeSubMenus())}handleMenuItemCommandClick(e,t,i,o=0){if(i?.[t]!==void 0&&i!=="divider"&&!i.disabled&&!i.divider&&this._currentCell!==void 0&&this._currentRow!==void 0){if(t==="option"&&!this.grid.getEditorLock().commitCurrentEdit())return;let r=this._currentCell,n=this._currentRow,a=this.grid.getColumns()[this._currentCell],l=this.grid.getDataItem(this._currentRow),d=i[t]!==void 0?i[t]:"";if(d!==void 0&&!i[`${t}Items`]){let c={cell:this._currentCell,row:this._currentRow,grid:this.grid,[t]:d,item:i,column:a,dataContext:l},h=t==="command"?"onCommand":"onOptionSelected",u=`${this._camelPluginName}:${h}`;this.pubSubService.publish(u,c),typeof this._addonOptions?.[h]=="function"&&this._addonOptions[h](e,c),typeof i.action=="function"&&i.action.call(this,e,c),e.defaultPrevented||this.closeMenu(e,{cell:r,row:n,grid:this.grid})}else(i.commandItems||i.optionItems)&&this.repositionSubMenu(i,t,o,e);this._lastMenuTypeClicked=t}}populateCommandOrOptionCloseBtn(e,t,i){this._bindEventService.bind(t,"click",r=>this.handleCloseButtonClicked(r),void 0,"parent-menu");let o=i.querySelector(`.slick-${e}-header`)??p("div",{className:`slick-${e}-header`});o?.appendChild(t),i.appendChild(o),o.classList.add("with-close")}repositionSubMenu(e,t,i,o){(o.target.classList.contains("slick-cell")||this._lastMenuTypeClicked!==t)&&this.disposeSubMenus();let r=this.createMenu(e?.commandItems||[],e?.optionItems||[],i+1,e);r&&(r.style.display="block",document.body.appendChild(r),this.repositionMenu(o,r,void 0,this._addonOptions))}};var br=class extends uo{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.pluginName="CellMenu",this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!0,subMenuOpenByEvent:"mouseover"},this._camelPluginName="cellMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-cell-menu",this.init(i.gridOptions.cellMenu)}init(e){this._addonOptions={...this._defaults,...e},this.sortMenuItems(this.sharedService.allColumns),this._eventHandler.subscribe(this.grid.onClick,this.handleCellClick.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateCellMenu(){let e=this.sharedService?.gridOptions,t=this.sharedService.allColumns;e?.enableTranslate&&Array.isArray(t)&&t.forEach(i=>{if(i?.cellMenu&&(Array.isArray(i.cellMenu.commandItems)||Array.isArray(i.cellMenu.optionItems))){let o=i.cellMenu.commandItems||[],r=i.cellMenu.optionItems||[];i.cellMenu.commandTitleKey&&(i.cellMenu.commandTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(i.cellMenu.commandTitleKey,"TEXT_COMMANDS")||i.cellMenu.commandTitle),i.cellMenu.optionTitleKey&&(i.cellMenu.optionTitle=this.extensionUtility.translateWhenEnabledAndServiceExist(i.cellMenu.optionTitleKey,"TEXT_OPTIONS")||i.cellMenu.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(o,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(r,"optionItems")}})}handleCellClick(e,t){this.disposeAllMenus();let i=this.grid.getCellFromEvent(e);if(i){let o=this.grid.getDataItem(i.row),r=this.grid.getColumns()[i.cell];r?.cellMenu&&!this.gridOptions.cellMenu?.activateCellOnMenuClick&&e.preventDefault(),this._addonOptions={...this._addonOptions,...r.cellMenu};let n=t||{};if(n.column=r,n.dataContext=o,n.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,n))return;this._menuElm=this.createParentMenu(e),this._menuElm&&(this.repositionMenu(e,this._menuElm,void 0,this._addonOptions),this._menuElm.ariaExpanded="true",this._menuElm.style.display="block",this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode")),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}sortMenuItems(e){e.forEach(t=>{t?.cellMenu?.commandItems&&this.extensionUtility.sortItems(t.cellMenu.commandItems||[],"positionOrder"),t?.cellMenu?.optionItems&&this.extensionUtility.sortItems(t.cellMenu.optionItems||[],"positionOrder")})}};var wr=class{constructor(e,t){this.grid=e,this.pluginName="CellRangeDecorator",this._defaults={selectionCssClass:"slick-range-decorator",selectionCss:{border:"2px dashed red",zIndex:"9999"},offset:{top:-1,left:-1,height:-2,width:-2}},this._options=Gt(this._defaults,t)}get addonOptions(){return this._options}get addonElement(){return this._elem}destroy(){this.hide()}init(){}hide(){this._elem?.remove(),this._elem=null}show(e){this._elem||(this._elem=p("div",{className:this._options.selectionCssClass}),Object.keys(this._options.selectionCss).forEach(o=>{this._elem.style[o]=this._options.selectionCss[o]}),this._elem.style.position="absolute",this.grid.getActiveCanvasNode()?.appendChild(this._elem));let t=this.grid.getCellNodeBox(e.fromRow,e.fromCell),i=this.grid.getCellNodeBox(e.toRow,e.toCell);return t&&i&&this._options?.offset&&(this._elem.style.top=`${t.top+this._options.offset.top}px`,this._elem.style.left=`${t.left+this._options.offset.left}px`,this._elem.style.height=`${i.bottom-t.top+this._options.offset.height}px`,this._elem.style.width=`${i.right-t.left+this._options.offset.width}px`),this._elem}};var Hi=class{constructor(e){this.pluginName="CellRangeSelector",this._currentlySelectedRange=null,this._canvas=null,this._dragging=!1,this._gridUid="",this._columnOffset=0,this._rowOffset=0,this._isRightCanvas=!1,this._isBottomCanvas=!1,this._xDelayForNextCell=0,this._yDelayForNextCell=0,this._viewportHeight=0,this._viewportWidth=0,this._isRowMoveRegistered=!1,this._scrollLeft=0,this._scrollTop=0,this._defaults={autoScroll:!0,minIntervalToShowNextCell:30,maxIntervalToShowNextCell:600,accelerateInterval:5,selectionCss:{border:"2px dashed blue"}},this.onBeforeCellRangeSelected=new R("onBeforeCellRangeSelected"),this.onCellRangeSelecting=new R("onCellRangeSelecting"),this.onCellRangeSelected=new R("onCellRangeSelected"),this._eventHandler=new G,this._options=Gt(this._defaults,e)}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridUid(){return this._gridUid||(this._grid?.getUID()??"")}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}init(e){this._grid=e,this._decorator=this._options.cellDecorator||new wr(e,this._options),this._canvas=e.getCanvasNode(),this._gridOptions=e.getOptions(),this._gridUid=e.getUID();let t=e.getPubSubService();t&&w.addSlickEventPubSubWhenDefined(t,this),this._eventHandler.subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this)).subscribe(this._grid.onScroll,this.handleScroll.bind(this))}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll(),j(this._activeCanvas),j(this._canvas),this._decorator?.destroy(),this.stopIntervalTimer()}getCellDecorator(){return this._decorator}getCurrentRange(){return this._currentlySelectedRange}getMouseOffsetViewport(e,t){let i=e?.touches?.[0]??e,o=this._activeViewport.scrollLeft,r=this._activeViewport.scrollTop,n=o+this._viewportWidth,a=r+this._viewportHeight,l=_e(this._activeViewport),d=l.left,c=l.top,h=d+this._viewportWidth,u=c+this._viewportHeight,m={e,dd:t,viewport:{left:o,top:r,right:n,bottom:a,offset:{left:d,top:c,right:h,bottom:u}},offset:{x:0,y:0},isOutsideViewport:!1};return i.pageX<d?m.offset.x=i.pageX-d:i.pageX>h&&(m.offset.x=i.pageX-h),i.pageY<c?m.offset.y=c-i.pageY:i.pageY>u&&(m.offset.y=u-i.pageY),m.isOutsideViewport=!!m.offset.x||!!m.offset.y,m}stopIntervalTimer(){this._autoScrollTimerId&&(clearInterval(this._autoScrollTimerId),this._autoScrollTimerId=void 0)}handleDrag(e,t){if(!this._dragging&&!this._gridOptions.enableRowMoveManager)return;this._gridOptions.enableRowMoveManager||e.stopImmediatePropagation();let i=e.getNativeEvent();if(this.addonOptions.autoScroll&&(this._draggingMouseOffset=this.getMouseOffsetViewport(i,t),this._draggingMouseOffset.isOutsideViewport))return this.handleDragOutsideViewport();this.stopIntervalTimer(),this.handleDragTo(i,t)}handleDragOutsideViewport(){if(this._xDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.x)*this.addonOptions.accelerateInterval,this._yDelayForNextCell=this.addonOptions.maxIntervalToShowNextCell-Math.abs(this._draggingMouseOffset.offset.y)*this.addonOptions.accelerateInterval,!this._autoScrollTimerId){let e=0,t=0;this._autoScrollTimerId=setInterval(()=>{let i=!1,o=!1;this._draggingMouseOffset.offset.x?(e+=this.addonOptions.minIntervalToShowNextCell,i=e>=this._xDelayForNextCell):e=0,this._draggingMouseOffset.offset.y?(t+=this.addonOptions.minIntervalToShowNextCell,o=t>=this._yDelayForNextCell):t=0,(i||o)&&(i&&(e=0),o&&(t=0),this.handleDragToNewPosition(i,o))},this.addonOptions.minIntervalToShowNextCell)}}handleDragToNewPosition(e,t){let i=this._draggingMouseOffset.e.pageX,o=this._draggingMouseOffset.e.pageY,r=this._draggingMouseOffset.offset.x,n=this._draggingMouseOffset.offset.y,a=this._draggingMouseOffset.viewport.offset;e&&r&&(r>0?i=a.right+this._moveDistanceForOneCell.x:i=a.left-this._moveDistanceForOneCell.x),t&&n&&(n>0?o=a.top-this._moveDistanceForOneCell.y:o=a.bottom+this._moveDistanceForOneCell.y),this.handleDragTo({pageX:i,pageY:o},this._draggingMouseOffset.dd)}handleDragTo(e,t){let i=e?.touches?.[0]??e,o=this._grid.getCellFromPoint(i.pageX-_e(this._activeCanvas).left+this._columnOffset,i.pageY-_e(this._activeCanvas).top+this._rowOffset);if(o!==void 0){if(this._gridOptions.frozenColumn>=0&&(!this._isRightCanvas&&o.cell>this._gridOptions.frozenColumn||this._isRightCanvas&&o.cell<=this._gridOptions.frozenColumn)||this._gridOptions.frozenRow>=0&&(!this._isBottomCanvas&&o.row>=this._gridOptions.frozenRow||this._isBottomCanvas&&o.row<this._gridOptions.frozenRow))return;if(this.addonOptions.autoScroll&&this._draggingMouseOffset){let r=this._grid.getCellNodeBox(o.row,o.cell);if(r){let n=this._draggingMouseOffset.viewport;(r.left<n.left||r.right>n.right||r.top<n.top||r.bottom>n.bottom)&&this._grid.scrollCellIntoView(o.row,o.cell)}}if(!this._grid.canCellBeSelected(o.row,o.cell))return;if(t?.range){t.range.end=o;let r=new Ne(t.range.start.row??0,t.range.start.cell??0,o.row,o.cell);this._decorator.show(r),this.onCellRangeSelecting.notify({range:r})}}}handleDragEnd(e,t){this._decorator.hide(),this._dragging&&t.range?(this._dragging=!1,e.stopImmediatePropagation(),this.stopIntervalTimer(),this.onCellRangeSelected.notify({range:new Ne(t.range.start.row??0,t.range.start.cell??0,t.range.end.row,t.range.end.cell)})):this._autoScrollTimerId&&this.stopIntervalTimer()}handleDragInit(e){this._activeCanvas=this._grid.getActiveCanvasNode(e),this._activeViewport=this._grid.getActiveViewportNode(e);let t=this._grid.getDisplayedScrollbarDimensions();if(this._viewportWidth=this._activeViewport.offsetWidth-t.width,this._viewportHeight=this._activeViewport.offsetHeight-t.height,this._moveDistanceForOneCell={x:this._grid.getAbsoluteColumnMinWidth()/2,y:this._gridOptions.rowHeight/2},this._rowOffset=0,this._columnOffset=0,this._isBottomCanvas=this._activeCanvas.classList.contains("grid-canvas-bottom"),this._gridOptions.frozenRow>-1&&this._isBottomCanvas){let r=`${this.gridUidSelector} .grid-canvas-${this._gridOptions.frozenBottom?"bottom":"top"}`;this._rowOffset=document.querySelector(r)?.clientHeight??0}this._isRightCanvas=this._activeCanvas.classList.contains("grid-canvas-right"),this._gridOptions.frozenColumn>-1&&this._isRightCanvas&&(this._columnOffset=document.querySelector(`${this.gridUidSelector} .grid-canvas-left`)?.clientWidth??0);let i=this._grid.getCellFromEvent(e),o=this._grid.getActiveCell();(!this._grid.getEditorLock().isActive()||!(o&&i&&o.row===i.row&&o.cell===i.cell))&&(e.stopImmediatePropagation(),e.preventDefault())}handleDragStart(e,t){let i=this._grid.getCellFromEvent(e);if(i&&this.onBeforeCellRangeSelected.notify(i).getReturnValue()!==!1&&this._grid.canCellBeSelected(i.row,i.cell)&&(this._dragging=!0,e.stopImmediatePropagation()),!this._dragging)return;this._grid.focus();let o=_e(this._canvas),r=t.startX-o.left;this._gridOptions.frozenColumn>=0&&this._isRightCanvas&&(r+=this._scrollLeft);let n=t.startY-o.top;this._gridOptions.frozenRow>=0&&this._isBottomCanvas&&(n+=this._scrollTop);let a=this._grid.getCellFromPoint(r,n);return t.range={start:a,end:{}},this._currentlySelectedRange=t.range,this._decorator.show(new Ne(a.row,a.cell))}handleScroll(e,t){this._scrollTop=t.scrollTop,this._scrollLeft=t.scrollLeft}};var fr=class{constructor(e){this.pluginName="CellSelectionModel",this._cachedPageRowCount=0,this._prevKeyDown="",this._ranges=[],this._defaults={selectActiveCell:!0},this.onSelectedRangesChanged=new R("onSelectedRangesChanged"),this._eventHandler=new G,this._selector=e===void 0||e.cellRangeSelector===void 0?new Hi({selectionCss:{border:"2px solid black"}}):e.cellRangeSelector,this._addonOptions=e}get addonOptions(){return this._addonOptions}get cellRangeSelector(){return this._selector}get eventHandler(){return this._eventHandler}init(e){this._grid=e,(this._addonOptions===void 0||this._addonOptions.cellRangeSelector===void 0)&&(this._selector=new Hi({selectionCss:{border:`2px solid ${this._grid.getOptions().darkMode?"white":"black"}`}})),e.hasDataView()&&(this._dataView=e.getData()),this._addonOptions={...this._defaults,...this._addonOptions};let t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)).subscribe(this._selector.onBeforeCellRangeSelected,this.handleBeforeCellRangeSelected.bind(this)).subscribe(this._selector.onCellRangeSelected,this.handleCellRangeSelected.bind(this)),e.registerPlugin(this._selector)}destroy(){this.dispose()}dispose(){this._selector&&(this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this))),this._eventHandler.unsubscribeAll(),this._grid?.unregisterPlugin(this._selector),this._selector?.dispose()}getSelectedRanges(){return this._ranges}rangesAreEqual(e,t){let i=e.length!==t.length;if(!i){for(let o=0;o<e.length;o++)if(e[o].fromCell!==t[o].fromCell||e[o].fromRow!==t[o].fromRow||e[o].toCell!==t[o].toCell||e[o].toRow!==t[o].toRow){i=!0;break}}return!i}refreshSelections(){this.setSelectedRanges(this.getSelectedRanges())}removeInvalidRanges(e){let t=[];for(let i=0;i<e.length;i++){let o=e[i];this._grid.canCellBeSelected(o.fromRow,o.fromCell)&&this._grid.canCellBeSelected(o.toRow,o.toCell)&&t.push(o)}return t}resetPageRowCount(){this._cachedPageRowCount=0}setSelectedRanges(e,t="SlickCellSelectionModel.setSelectedRanges"){if((!this._ranges||this._ranges.length===0)&&(!e||e.length===0))return;let i=!this.rangesAreEqual(this._ranges,e);if(this._ranges=this.removeInvalidRanges(e),i){let o=new U(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,o)}}handleActiveCellChange(e,t){this._prevSelectedRow=void 0;let i=q(t.cell),o=q(t.row);this._addonOptions?.selectActiveCell&&o&&i?this.setSelectedRanges([new Ne(t.row,t.cell)]):(!this._addonOptions?.selectActiveCell||!o&&!i)&&this.setSelectedRanges([])}handleBeforeCellRangeSelected(e){let t=this._grid.getCellFromEvent(e),i=this._grid.getActiveCell();if(this._grid.getEditorLock().isActive()&&i&&t&&i.row===t.row&&i.cell===t.cell)return e.stopPropagation(),!1}handleCellRangeSelected(e,t){this._grid.setActiveCell(t.range.fromRow,t.range.fromCell,!1,!1,!0),this.setSelectedRanges([t.range])}isKeyAllowed(e,t){return["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","PageDown","PageUp","Home","End",...t?[]:["a","A"]].some(i=>i===e)}handleKeyDown(e){let t,i,o=this._grid.getColumns().length,r=this._grid.getActiveCell(),n=0;if(this._dataView&&"getPagingInfo"in this._dataView?n=this._dataView?.getPagingInfo().pageSize||this._dataView.getLength():n=this._grid.getDataLength(),r&&(e.shiftKey||e.ctrlKey)&&!e.altKey&&this.isKeyAllowed(e.key,e.shiftKey)&&(t=this.getSelectedRanges().slice(),t.length||t.push(new Ne(r.row,r.cell)),i=t.pop(),typeof i?.contains=="function")){i.contains(r.row,r.cell)||(i=new Ne(r.row,r.cell));let a=i.toRow-i.fromRow,l=i.toCell-i.fromCell,d,c=0;e.ctrlKey&&e.key?.toLowerCase()==="a"&&(this._grid.setActiveCell(0,0,!1,!1,!0),r.row=0,r.cell=0,d=o-1,c=n-1);let h=r.row===i.fromRow?1:-1,u=r.cell===i.fromCell?1:-1,m=e.key.startsWith("Arrow");m&&!e.ctrlKey?(e.key==="ArrowLeft"?l-=u:e.key==="ArrowRight"?l+=u:e.key==="ArrowUp"?a-=h:e.key==="ArrowDown"&&(a+=h),c=r.row+h*a):(this._cachedPageRowCount<1&&(this._cachedPageRowCount=this._grid.getViewportRowCount()),this._prevSelectedRow===void 0&&(this._prevSelectedRow=r.row),!e.ctrlKey&&e.shiftKey&&e.key==="Home"||e.ctrlKey&&e.shiftKey&&e.key==="ArrowLeft"?(d=0,c=r.row):!e.ctrlKey&&e.shiftKey&&e.key==="End"||e.ctrlKey&&e.shiftKey&&e.key==="ArrowRight"?(d=o-1,c=r.row):e.ctrlKey&&e.shiftKey&&e.key==="ArrowUp"?c=0:e.ctrlKey&&e.shiftKey&&e.key==="ArrowDown"?c=n-1:e.ctrlKey&&e.shiftKey&&e.key==="Home"?(d=0,c=0):e.ctrlKey&&e.shiftKey&&e.key==="End"?(d=o-1,c=n-1):e.key==="PageUp"?(this._prevSelectedRow>=0&&(c=this._prevSelectedRow-this._cachedPageRowCount),c<0&&(c=0)):e.key==="PageDown"&&(this._prevSelectedRow<=n-1&&(c=this._prevSelectedRow+this._cachedPageRowCount),c>n-1&&(c=n-1)),this._prevSelectedRow=c),d??=r.cell+u*l;let g=new Ne(r.row,r.cell,c,d);if(this.removeInvalidRanges([g]).length){t.push(g);let f=h>0?g.toRow:g.fromRow,b=u>0?g.toCell:g.fromCell;m?(this._grid.scrollRowIntoView(f),this._grid.scrollCellIntoView(f,b,!1)):(this._grid.scrollRowIntoView(c),this._grid.scrollCellIntoView(c,b,!1))}else t.push(i);this.setSelectedRanges(t),e.preventDefault(),e.stopPropagation(),this._prevKeyDown=e.key}}};var Qt=class{constructor(e){this.pluginName="RowSelectionModel",this._inHandler=!1,this._ranges=[],this._defaults={autoScrollWhenDrag:!0,cellRangeSelector:void 0,dragToSelect:!1,selectActiveRow:!0},this.onSelectedRangesChanged=new R("onSelectedRangesChanged"),this._eventHandler=new G,this._options={...this._defaults,...e}}get addonOptions(){return this._options}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()}init(e){this._grid=e,this._options={...this._defaults,...this._options},this._selector=this.addonOptions.cellRangeSelector;let t=e.getPubSubService();t&&this.onSelectedRangesChanged.setPubSubService(t),!this._selector&&this._options.dragToSelect&&(this._selector=new Hi({selectionCss:{border:"none"},autoScroll:this._options.autoScrollWhenDrag}),this.addonOptions.cellRangeSelector=this._selector),this._eventHandler.subscribe(this._grid.onActiveCellChanged,this.handleActiveCellChange.bind(this)).subscribe(this._grid.onClick,this.handleClick.bind(this)).subscribe(this._grid.onKeyDown,this.handleKeyDown.bind(this)),this._selector&&(this._grid.registerPlugin(this._selector),this._selector.onCellRangeSelecting.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.subscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.subscribe(this.handleBeforeCellRangeSelected.bind(this)))}destroy(){this.dispose()}dispose(){this._eventHandler.unsubscribeAll(),this.disposeSelector()}disposeSelector(){this._selector&&(this._selector.onCellRangeSelecting.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onCellRangeSelected.unsubscribe(this.handleCellRangeSelected.bind(this)),this._selector.onBeforeCellRangeSelected.unsubscribe(this.handleBeforeCellRangeSelected.bind(this)),this._grid.unregisterPlugin(this._selector),this._selector?.destroy(),this._selector?.dispose())}getCellRangeSelector(){return this._selector}getSelectedRanges(){return this._ranges}getSelectedRows(){return this.rangesToRows(this._ranges)}refreshSelections(){this.setSelectedRows(this.getSelectedRows())}setSelectedRows(e){this.setSelectedRanges(this.rowsToRanges(e),"SlickRowSelectionModel.setSelectedRows")}setSelectedRanges(e,t="SlickRowSelectionModel.setSelectedRanges"){if((!this._ranges||this._ranges.length===0)&&(!e||e.length===0))return;this._ranges=e;let i=new U(new CustomEvent("click",{detail:{caller:t}}),this._ranges);this.onSelectedRangesChanged.notify(this._ranges,i)}getRowsRange(e,t){let i,o=[];for(i=e;i<=t;i++)o.push(i);for(i=t;i<e;i++)o.push(i);return o}handleBeforeCellRangeSelected(e,t){let i=!1;if(this.gridOptions.enableRowMoveManager&&(i=this.isHandlerColumn(t.cell)??!1),this._grid.getEditorLock().isActive()||i)return e.stopPropagation(),!1;this._grid.setActiveCell(t.row,t.cell)}handleCellRangeSelected(e,t){if(!this.gridOptions.multiSelect||!this.addonOptions.selectActiveRow)return!1;this.setSelectedRanges([new Ne(t.range.fromRow,0,t.range.toRow,this._grid.getColumns().length-1)])}handleActiveCellChange(e,t){this._options.selectActiveRow&&t.row!==null&&this.setSelectedRanges([new Ne(t.row,0,t.row,this._grid.getColumns().length-1)])}handleClick(e){let t=this._grid.getCellFromEvent(e);if(!t||!this._grid.canCellBeActive(t.row,t.cell)||!this.gridOptions.multiSelect||!e.ctrlKey&&!e.shiftKey&&!e.metaKey)return!1;let i=this.rangesToRows(this._ranges),o=i.indexOf(t.row);if(o===-1&&(e.ctrlKey||e.metaKey))i.push(t.row),this._grid.setActiveCell(t.row,t.cell);else if(o!==-1&&(e.ctrlKey||e.metaKey))i=i.filter(n=>n!==t.row),this._grid.setActiveCell(t.row,t.cell);else if(i.length&&e.shiftKey){let n=i.pop(),a=Math.min(t.row,n),l=Math.max(t.row,n);i=[];for(let d=a;d<=l;d++)d!==n&&i.push(d);i.push(n),this._grid.setActiveCell(t.row,t.cell)}let r=this.rowsToRanges(i);return this.setSelectedRanges(r),e.stopImmediatePropagation(),!0}handleKeyDown(e){let t=this._grid.getActiveCell();if(this.gridOptions.multiSelect&&t&&e.shiftKey&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&(e.key==="ArrowUp"||e.key==="ArrowDown")){let i=this.getSelectedRows();i.sort((a,l)=>a-l),i.length||(i=[t.row]);let o,r=i[0],n=i[i.length-1];if(e.key==="ArrowDown"?o=t.row<n||r===n?++n:++r:o=t.row<n?--n:--r,o>=0&&o<this._grid.getDataLength()){this._grid.scrollRowIntoView(o);let a=this.rowsToRanges(this.getRowsRange(r,n));this.setSelectedRanges(a)}e.preventDefault(),e.stopPropagation()}}isHandlerColumn(e){let i=this._grid.getColumns()[e].behavior||"";return/move|selectAndMove/.test(i)}rangesToRows(e){let t=[];for(let i=0;i<e.length;i++)for(let o=e[i].fromRow;o<=e[i].toRow;o++)t.push(o);return t}rowsToRanges(e){let t=[],i=this._grid.getColumns().length-1;return e.forEach(o=>t.push(new Ne(o,0,o,i))),t}};var gc="mdi-icon-check",fc="mdi-icon-uncheck",Uo=class{constructor(e,t){this.pubSubService=e,this.pluginName="CheckboxSelectColumn",this._defaults={columnId:"_checkbox_selector",cssClass:null,field:"_checkbox_selector",hideSelectAllCheckbox:!1,name:"",toolTip:"Select/Deselect All",width:30,reorderable:!1,applySelectOnAllPages:!0,hideInColumnTitleRow:!1,hideInFilterHeaderRow:!0},this._addonOptions=this._defaults,this._checkboxColumnCellIndex=null,this._isSelectAllChecked=!1,this._isUsingDataView=!1,this._selectedRowsLookup={},this._selectAll_UID=this.createUID(),this._bindEventService=new oe,this._eventHandler=new G,this._addonOptions={...this._defaults,...t}}get addonOptions(){return this._addonOptions}get headerRowNode(){return this._headerRowNode}get gridOptions(){return this._grid?.getOptions()??{}}get selectAllUid(){return this._selectAll_UID}set selectedRowsLookup(e){this._selectedRowsLookup=e}init(e){this._grid=e,this._isUsingDataView=!Array.isArray(e.getData()),this._isUsingDataView&&(this._dataView=e.getData()),this.gridOptions.backendServiceApi&&(this._addonOptions.applySelectOnAllPages=!1),this._eventHandler.subscribe(e.onSelectedRowsChanged,this.handleSelectedRowsChanged.bind(this)).subscribe(e.onClick,this.handleClick.bind(this)).subscribe(e.onKeyDown,this.handleKeyDown.bind(this)).subscribe(e.onAfterSetColumns,this.handleDataViewSelectedIdsChanged.bind(this)),this._isUsingDataView&&this._dataView&&this._addonOptions.applySelectOnAllPages&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,this.handleDataViewSelectedIdsChanged.bind(this)).subscribe(this._dataView.onPagingInfoChanged,this.handleDataViewSelectedIdsChanged.bind(this)),this._addonOptions.hideInFilterHeaderRow||this.addCheckboxToFilterHeaderRow(e),this._addonOptions.hideInColumnTitleRow||this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this)),(!this._rowSelectionModel||!this._grid.getSelectionModel())&&(this._rowSelectionModel=new Qt(this.gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionModel)),this.gridOptions.preselectedRows&&this._rowSelectionModel&&this._grid.getSelectionModel()&&setTimeout(()=>this.selectRows(this.gridOptions.preselectedRows||[])),typeof this._addonOptions.selectableOverride=="function"&&this.selectableOverride(this._addonOptions.selectableOverride)}dispose(){this._bindEventService.unbindAll(),this._eventHandler.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.checkboxSelector},Array.isArray(e)&&t){let i=this.getColumnDefinition();if(!e.some(o=>o.id===i.id)){let o=t?.checkboxSelector?.columnIndexPosition??0;o>0?e.splice(o,0,i):e.unshift(i),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getOptions(){return this._addonOptions}setOptions(e){if(this._addonOptions={...this._addonOptions,...e},this._addonOptions.hideSelectAllCheckbox)this.hideSelectAllFromColumnHeaderTitleRow(),this.hideSelectAllFromColumnHeaderFilterRow();else if(this._addonOptions.hideInColumnTitleRow?(this.hideSelectAllFromColumnHeaderTitleRow(),this._addonOptions.name&&this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name,"")):(this.renderSelectAllCheckbox(this._isSelectAllChecked),this._eventHandler.subscribe(this._grid.onHeaderClick,this.handleHeaderClick.bind(this))),this._addonOptions.hideInFilterHeaderRow)this.hideSelectAllFromColumnHeaderFilterRow();else{let t=this.headerRowNode?.querySelector("#filter-checkbox-selectall-container");if(t){t.style.display="flex",t.ariaChecked=String(this._isSelectAllChecked);let i=t.querySelector('input[type="checkbox"]');i&&(i.ariaChecked=String(this._isSelectAllChecked),i.checked=this._isSelectAllChecked)}}}deSelectRows(e){let t=[];for(let i of e)this._selectedRowsLookup[i]&&(t[t.length]=i);this._grid.setSelectedRows(this._grid.getSelectedRows().filter(i=>t.indexOf(i)<0),"SlickCheckboxSelectColumn.deSelectRows")}selectRows(e){let t=[];for(let o of e)this._selectedRowsLookup[o]&&(t[t.length]=o);let i=this._grid.getSelectedRows()?.concat(t);this._grid.setSelectedRows(i)}createCheckboxElement(e,t=!1){let i=St(this.gridOptions),o=p("label",{className:"checkbox-selector-label",htmlFor:e}),r=p("div",{className:"icon-checkbox-container"});return r.appendChild(p("input",{id:e,type:"checkbox",checked:t,ariaChecked:String(t)})),r.appendChild(p("div",{className:`mdi ${t?gc:fc}`})),o.appendChild(r),i.appendChild(o),i}getColumnDefinition(){let e=String(this._addonOptions?.columnId??this._defaults.columnId);return{id:e,name:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?this._addonOptions.name||"":this.createCheckboxElement(`header-selector${this._selectAll_UID}`),toolTip:this._addonOptions.hideSelectAllCheckbox||this._addonOptions.hideInColumnTitleRow?"":this._addonOptions.toolTip,field:e,cssClass:this._addonOptions.cssClass,excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,hideSelectAllCheckbox:this._addonOptions.hideSelectAllCheckbox,resizable:!1,reorderable:this._addonOptions.reorderable,sortable:!1,width:this._addonOptions.width||30,maxWidth:this._addonOptions.width||30,formatter:this.checkboxSelectionFormatter.bind(this)}}hideSelectAllFromColumnHeaderTitleRow(){this._grid.updateColumnHeader(this._addonOptions.columnId||"",this._addonOptions.name||"","")}hideSelectAllFromColumnHeaderFilterRow(){let e=this.headerRowNode?.querySelector("#filter-checkbox-selectall-container");e&&(e.style.display="none")}toggleRowSelection(e){this.toggleRowSelectionWithEvent(null,e)}toggleRowSelectionWithEvent(e,t){let i=this._grid.getDataItem(t);if(!this.checkSelectableOverride(t,i,this._grid))return;let o=this._grid.getSelectedRows();typeof this._addonOptions.onRowToggleStart=="function"&&this._addonOptions.onRowToggleStart(e,{row:t,previousSelectedRows:o});let r=this._selectedRowsLookup[t]?this._grid.getSelectedRows().filter(n=>n!==t):this._grid.getSelectedRows().concat(t);this._grid.setSelectedRows(r,"click.toggle"),this._grid.setActiveCell(t,this.getCheckboxColumnCellIndex()),this._addonOptions.onRowToggleEnd&&this._addonOptions.onRowToggleEnd(e,{row:t,previousSelectedRows:o})}selectableOverride(e){this._selectableOverride=e}addCheckboxToFilterHeaderRow(e){this._eventHandler.subscribe(e.onHeaderRowCellRendered,(t,i)=>{if(i.column.field===(this._addonOptions.field||"_checkbox_selector")){j(i.node);let o=`header-filter-selector${this._selectAll_UID}`,r=p("label",{id:"filter-checkbox-selectall-container",htmlFor:o}),n=p("div",{className:"icon-checkbox-container"});n.appendChild(p("input",{id:o,type:"checkbox",ariaChecked:"false"})),n.appendChild(p("div",{className:"mdi mdi-icon-uncheck"})),r.appendChild(n),i.node.appendChild(r),this._headerRowNode=i.node,this._headerRowNode.classList.add("checkbox-header"),this._bindEventService.bind(r,"click",a=>this.handleHeaderClick(a,i))}})}checkboxSelectionFormatter(e,t,i,o,r,n){if(r&&this.checkSelectableOverride(e,r,n)){let a=this.createUID()+e;return this.createCheckboxElement(`selector${a}`,!!this._selectedRowsLookup[e])}return null}checkSelectableOverride(e,t,i){return typeof this._selectableOverride=="function"?this._selectableOverride(e,t,i):!0}createUID(){return Math.round(1e7*Math.random())}getCheckboxColumnCellIndex(){if(this._checkboxColumnCellIndex===null){this._checkboxColumnCellIndex=0;let e=this._grid.getColumns();for(let t=0;t<e.length;t++)e[t].id===this._addonOptions.columnId&&(this._checkboxColumnCellIndex=t)}return this._checkboxColumnCellIndex}handleDataViewSelectedIdsChanged(){let e=this._dataView.getAllSelectedFilteredIds(),t=this._dataView.getFilteredItems(),i=0;if(typeof this._selectableOverride=="function"&&e.length>0)for(let o=0;o<this._dataView.getItemCount();o++){let r=this._dataView.getItemByIdx(o),n=this._dataView.getIdPropertyName(),a=r[n];t.findIndex(d=>d[n]===a)>=0&&!this.checkSelectableOverride(o,r,this._grid)&&i++}if(this._isSelectAllChecked=e.length+i>=t.length,!this._addonOptions.hideInColumnTitleRow&&!this._addonOptions.hideSelectAllCheckbox&&this.renderSelectAllCheckbox(this._isSelectAllChecked),!this._addonOptions.hideInFilterHeaderRow){let o=this.headerRowNode?.querySelector(`#header-filter-selector${this._selectAll_UID}`),r=this.headerRowNode?.querySelector(".icon-checkbox-container .mdi");o&&(o.ariaChecked=String(this._isSelectAllChecked),o.checked=this._isSelectAllChecked),r&&(r.className=`mdi ${this._isSelectAllChecked?gc:fc}`)}}handleClick(e,t){if(this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&e.target.type==="checkbox"){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit()){e.preventDefault(),e.stopImmediatePropagation();return}this.toggleRowSelectionWithEvent(e,t.row),e.stopPropagation(),e.stopImmediatePropagation()}}handleHeaderClick(e,t){if(t.column.id===this._addonOptions.columnId&&e.target.type==="checkbox"){if(e.target.ariaChecked=String(e.target.checked),this._grid.getEditorLock().isActive()&&!this._grid.getEditorLock().commitCurrentEdit()){e.preventDefault(),e.stopImmediatePropagation();return}let i=e.target.checked,o=i?"click.selectAll":"click.unselectAll",r=this._grid.getSelectedRows();this._addonOptions.onSelectAllToggleStart&&this._addonOptions.onSelectAllToggleStart(e,{previousSelectedRows:r,caller:o});let n=[];if(i){let a=[];for(let l=0;l<this._grid.getDataLength();l++){let d=this._grid.getDataItem(l);!d.__group&&!d.__groupTotals&&this.checkSelectableOverride(l,d,this._grid)&&a.push(l)}n=a,i=!0}if(this._isUsingDataView&&this._dataView&&this._addonOptions.applySelectOnAllPages){let a=[],l=this._dataView.getFilteredItems();for(let d=0;d<l.length;d++){let c=l[d];this.checkSelectableOverride(d,c,this._grid)&&a.push(c[this._dataView.getIdPropertyName()])}this._dataView.setSelectedIds(a,{isRowBeingAdded:i})}this._grid.setSelectedRows(n,o),this._addonOptions.onSelectAllToggleEnd&&this._addonOptions.onSelectAllToggleEnd(e,{rows:n,previousSelectedRows:r,caller:o}),e.stopPropagation(),e.stopImmediatePropagation()}}handleKeyDown(e,t){e.key===" "&&this._grid.getColumns()[t.cell].id===this._addonOptions.columnId&&((!this._grid.getEditorLock().isActive()||this._grid.getEditorLock().commitCurrentEdit())&&this.toggleRowSelectionWithEvent(e,t.row),e.preventDefault(),e.stopImmediatePropagation())}handleSelectedRowsChanged(){let e=this._grid.getSelectedRows(),t={},i=0,o=0,r=0,n=0;if(typeof this._selectableOverride=="function")for(r=0;r<this._grid.getDataLength();r++){let l=this._grid.getDataItem(r);this.checkSelectableOverride(o,l,this._grid)||n++}let a=[];for(o=0;o<e.length;o++){i=e[o];let l=this._grid.getDataItem(i);this.checkSelectableOverride(o,l,this._grid)?(t[i]=!0,t[i]!==this._selectedRowsLookup[i]&&(this._grid.invalidateRow(i),delete this._selectedRowsLookup[i])):a.push(i)}if(typeof this._selectedRowsLookup=="object"&&Object.keys(this._selectedRowsLookup).forEach(l=>{l!==void 0&&this._grid.invalidateRow(+l)}),this._selectedRowsLookup=t,this._grid.render(),this._isSelectAllChecked=(e?.length??0)+n>=this._grid.getDataLength(),(!this._isUsingDataView||!this._addonOptions.applySelectOnAllPages)&&(!this._addonOptions.hideInColumnTitleRow&&!this._addonOptions.hideSelectAllCheckbox&&this.renderSelectAllCheckbox(this._isSelectAllChecked),!this._addonOptions.hideInFilterHeaderRow)){let l=this.headerRowNode?.querySelector(`#header-filter-selector${this._selectAll_UID}`);l&&(l.ariaChecked=String(this._isSelectAllChecked),l.checked=this._isSelectAllChecked)}if(a.length>0){for(let l of a){let d=e.indexOf(l);e.splice(d,1)}this._grid.setSelectedRows(e,"click.toggle")}}renderSelectAllCheckbox(e){this._grid.updateColumnHeader(this._addonOptions.columnId||"",this.createCheckboxElement(`header-selector${this._selectAll_UID}`,!!e),this._addonOptions.toolTip)?.classList.add("header-checkbox-selectall")}};var mo=class extends Ft{constructor(e,t,i,o,r){super(e,i,o),this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=o,this.sortService=r,this._areVisibleColumnDifferent=!1,this._columns=[],this._columnCheckboxes=[],this._commandMenuElm=null,this._headerElm=null,this._isMenuOpen=!1,this._subMenuParentId="",this._defaults={autoAlignSide:!0,dropSide:"left",showButton:!0,hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",marginBottom:15,menuWidth:18,minHeight:150,contentMinWidth:0,resizeOnShowHeaderRow:!1,syncResizeTitle:"Synchronous resize",subMenuOpenByEvent:"mouseover",headerColumnValueExtractor:n=>wt(n.columnPickerLabel||n.name||"","innerHTML")},this.pluginName="GridMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-grid-menu",this._camelPluginName="gridMenu",this._columns=this.sharedService.allColumns??[],this._gridUid=this.grid?.getUID()??"",this.onAfterMenuShow=new R("onAfterMenuShow"),this.onBeforeMenuShow=new R("onBeforeMenuShow"),this.onMenuClose=new R("onMenuClose"),this.onCommand=new R("onCommand"),this.onColumnsChanged=new R("onColumnsChanged"),this.initEventHandlers(),this.init()}get addonOptions(){return this._addonOptions||{}}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.grid?.getOptions()||{}}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}initEventHandlers(){this._eventHandler.subscribe(this.grid.onColumnsReordered,po.bind(this)),this._eventHandler.subscribe(this.grid.onClick,e=>this.hideMenu(e)),this._eventHandler.subscribe(this.grid.onBeforeDestroy,this.dispose.bind(this)),this._eventHandler.subscribe(this.grid.onSetOptions,(e,t)=>{if(t&&t.optionsBefore&&t.optionsAfter){let i=t.optionsBefore.frozenColumn>=0&&t.optionsAfter.frozenColumn===-1,o=t.optionsBefore.frozenColumn===-1&&t.optionsAfter.frozenColumn>=0;(i||o)&&this.recreateGridMenu()}})}init(e=!0){this._gridUid=this.grid.getUID()??"",w.addSlickEventPubSubWhenDefined(this.pubSubService,this),e&&(this._originalGridMenu=fe(!0,{},this.sharedService.gridOptions.gridMenu)),this._userOriginalGridMenu={...this.sharedService.gridOptions.gridMenu},this._addonOptions={...this._defaults,...this.getDefaultGridMenuOptions(),...this.sharedService.gridOptions.gridMenu},this.sharedService.gridOptions.gridMenu=this._addonOptions;let t=this._userOriginalGridMenu.commandItems,i=this._userOriginalGridMenu&&Array.isArray(t)?t:[];this._addonOptions.commandItems=[...i,...this.addGridMenuCustomCommands(i)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this._addonOptions.commandItems,"positionOrder"),this.createGridMenu()}dispose(){this.deleteMenu(),super.dispose()}deleteMenu(){this._bindEventService.unbindAll(),this._menuElm?.remove(),this._menuElm=null,this._gridMenuButtonElm?.remove(),this._headerElm&&(this._headerElm.style.width="100%")}createColumnPickerContainer(){this._menuElm&&(Cr.call(this,this._menuElm),this._listElm=p("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(this._menuElm,"click",_r.bind(this),void 0,"parent-menu"))}createGridMenu(){let e=this._gridUid?`.${this._gridUid}`:"",t=this._addonOptions?.menuWidth||this._defaults.menuWidth,i=this.gridOptions.hasOwnProperty("frozenColumn")&&this.gridOptions.frozenColumn>=0?"right":"left",o=this.grid.getContainerNode();if(this._headerElm=o.querySelector(`.slick-header-${i}`),this._headerElm&&this._addonOptions){if(this._headerElm.style.width=`calc(100% - ${t}px)`,(this._addonOptions.resizeOnShowHeaderRow??this._defaults.resizeOnShowHeaderRow)&&this.gridOptions.showHeaderRow){let a=o.querySelector(`${e} .slick-headerrow`);a&&(a.style.width=`calc(100% - ${t}px)`)}if(this._addonOptions.showButton??this._defaults.showButton){this._gridMenuButtonElm=p("button",{className:"slick-grid-menu-button",ariaLabel:"Grid Menu"}),this._addonOptions?.iconCssClass&&this._gridMenuButtonElm.classList.add(...ae(this._addonOptions.iconCssClass));let a=this._addonOptions.iconButtonContainer==="preheader"?"firstChild":"lastChild";this._headerElm.parentElement.insertBefore(this._gridMenuButtonElm,this._headerElm.parentElement[a]),this._bindEventService.bind(this._gridMenuButtonElm,"click",this.showGridMenu.bind(this))}this.sharedService.gridOptions.gridMenu={...this._defaults,...this._addonOptions},this.translateTitleLabels(this._addonOptions),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this)),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this))}}createCommandMenu(e,t=0,i){let o=i?.command,r=t===1&&o?o.replace(/\s/g,""):"";r&&(this._subMenuParentId=r),t>1&&(r=this._subMenuParentId);let n=`${this.menuCssClass} slick-menu-level-${t} ${this._gridUid}`,a=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${t}${this.gridUidSelector}`);if(a){if(a.dataset.subMenuParent===r)return a;this.disposeSubMenus()}let l=p("div",{role:"menu",className:n,ariaLabel:t>1?"SubMenu":"Grid Menu"});t>0&&(l.classList.add("slick-submenu"),r&&(l.dataset.subMenuParent=r));let d={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns(),level:t};return this._commandMenuElm=this.recreateCommandList(e,l,d,i),t++,l}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}hideMenu(e){let t={grid:this.grid,menu:this._menuElm,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};if(this.pubSubService.publish("onGridMenuMenuClose",t),!(typeof this._addonOptions?.onMenuClose=="function"&&this._addonOptions.onMenuClose(e,t)===!1||this.onMenuClose.notify(t,null,this).getReturnValue()===!1)){if(this._isMenuOpen=!1,typeof this.grid?.autosizeColumns=="function"){let i=this.grid.getUID()||"";this._areVisibleColumnDifferent&&i&&document.querySelector(`.${i}`)!==null&&(this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this._areVisibleColumnDifferent=!1)}this.disposeSubMenus(),this._menuElm?.remove(),this._menuElm=null}}recreateGridMenu(){this.deleteMenu(),this.init(!1)}openGridMenu(){let e=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!1});Object.defineProperty(e,"target",{writable:!0,configurable:!0,value:p("button",{className:"slick-grid-menu-button"})}),this.showGridMenu(e)}showGridMenu(e,t){let i=e?.touches?.[0]??e;if(e.preventDefault(),j(this._menuElm),this._menuElm?.remove(),this._addonOptions){let o={grid:this.grid,menu:this._menuElm,columns:this.columns,allColumns:this.getAllColumns(),visibleColumns:this.getVisibleColumns()},r={...this._addonOptions,...t};if(r&&!this.extensionUtility.runOverrideFunctionWhenExists(r.menuUsabilityOverride,o)||typeof e.stopPropagation=="function"&&(this.pubSubService.publish("onGridMenuBeforeMenuShow",o),typeof r?.onBeforeMenuShow=="function"&&r.onBeforeMenuShow(e,o)===!1||this.onBeforeMenuShow.notify(o,null,this).getReturnValue()===!1))return;this._menuElm=this.createCommandMenu(this._addonOptions?.commandItems??[]),this.createColumnPickerContainer(),po.call(this),this._columnCheckboxes=[],xr.call(this,r),document.body.appendChild(this._menuElm),this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),this._menuElm.style.opacity="0";let n=(r?.marginBottom!==void 0?r.marginBottom:this._defaults.marginBottom)||0;this._menuElm.style.minHeight=pt(r?.minHeight,""),r?.height!==void 0?this._menuElm.style.height=pt(r.height,""):this._menuElm.style.maxHeight=pt(r?.maxHeight,`${window.innerHeight-i.clientY-n}px`);let a=e.target.nodeName==="BUTTON"?e.target:e.target.querySelector("button");a||(a=e.target.parentElement),this._menuElm.ariaExpanded="true",this._menuElm.appendChild(this._listElm),this.repositionMenu(e,this._menuElm,a,r),this._isMenuOpen=!0,this.pubSubService.publish("onGridMenuAfterMenuShow",o),typeof r?.onAfterMenuShow=="function"&&r.onAfterMenuShow(e,o),this.onAfterMenuShow.notify(o,null,this)}}translateGridMenu(){if(this.sharedService.gridOptions.gridMenu){this.sharedService.gridOptions.gridMenu.commandItems=[],this.sharedService.gridOptions.gridMenu.commandTitle=this._originalGridMenu.commandTitle||"",this.sharedService.gridOptions.gridMenu.columnTitle=this._originalGridMenu.columnTitle||"",this.sharedService.gridOptions.gridMenu.forceFitTitle=this._originalGridMenu.forceFitTitle||"",this.sharedService.gridOptions.gridMenu.syncResizeTitle=this._originalGridMenu.syncResizeTitle||"";let e=this._userOriginalGridMenu&&Array.isArray(this._userOriginalGridMenu.commandItems)?this._userOriginalGridMenu.commandItems:[];this.sharedService.gridOptions.gridMenu.commandItems=[...e,...this.addGridMenuCustomCommands(e)],this.extensionUtility.translateMenuItemsFromTitleKey(this._addonOptions?.commandItems||[],"commandItems"),this.extensionUtility.sortItems(this.sharedService.gridOptions.gridMenu.commandItems,"positionOrder"),this.translateTitleLabels(this.sharedService.gridOptions.gridMenu),this.translateTitleLabels(this._addonOptions),this.extensionUtility.translateItems(this._columns,"nameKey","name")}}translateTitleLabels(e){e&&(e.commandTitle=this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"),e.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),e.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),e.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"))}addGridMenuCustomCommands(e){let t=this.gridOptions.backendServiceApi||null,i=[],o=this.gridOptions,r=$e(o),n=this._addonOptions?.commandLabels,a=l=>e.some(d=>d!=="divider"&&"command"in d&&d.command===l);if(this._addonOptions&&this.gridOptions){if(!this._addonOptions.hideClearFrozenColumnsCommand){let d="clear-pinning";a(d)||i.push({iconCssClass:this._addonOptions.iconClearFrozenColumnsCommand||"mdi mdi-pin-off-outline",_orgTitle:n?.clearFrozenColumnsCommand||"",titleKey:`${r}${n?.clearFrozenColumnsCommandKey??"CLEAR_PINNING"}`,disabled:!1,command:d,positionOrder:52})}if(this.gridOptions.enableFiltering&&!this.sharedService.hideHeaderRowAfterPageLoad){if(!this._addonOptions.hideClearAllFiltersCommand){let d="clear-filter";a(d)||i.push({iconCssClass:this._addonOptions.iconClearAllFiltersCommand||"mdi mdi-filter-remove-outline",_orgTitle:n?.clearAllFiltersCommand||"",titleKey:`${r}${n?.clearAllFiltersCommandKey??"CLEAR_ALL_FILTERS"}`,disabled:!1,command:d,positionOrder:50})}if(!this._addonOptions.hideToggleFilterCommand){let d="toggle-filter";a(d)||i.push({iconCssClass:this._addonOptions.iconToggleFilterCommand||"mdi mdi-flip-vertical",_orgTitle:n?.toggleFilterCommand||"",titleKey:`${r}${n?.toggleFilterCommandKey??"TOGGLE_FILTER_ROW"}`,disabled:!1,command:d,positionOrder:53})}if(t&&!this._addonOptions.hideRefreshDatasetCommand){let d="refresh-dataset";a(d)||i.push({iconCssClass:this._addonOptions.iconRefreshDatasetCommand||"mdi mdi-sync",_orgTitle:n?.refreshDatasetCommand||"",titleKey:`${r}${n?.refreshDatasetCommandKey??"REFRESH_DATASET"}`,disabled:!1,command:d,positionOrder:58})}}if(!this._addonOptions.hideToggleDarkModeCommand){let d="toggle-dark-mode";a(d)||i.push({iconCssClass:this._addonOptions.iconToggleDarkModeCommand||"mdi mdi-brightness-4",_orgTitle:n?.toggleDarkModeCommand||"",titleKey:`${r}${n?.toggleDarkModeCommandKey??"TOGGLE_DARK_MODE"}`,disabled:!1,command:d,positionOrder:54})}if(this.gridOptions.showPreHeaderPanel&&!this._addonOptions.hideTogglePreHeaderCommand){let d="toggle-preheader";a(d)||i.push({iconCssClass:this._addonOptions.iconTogglePreHeaderCommand||"mdi mdi-flip-vertical",_orgTitle:n?.togglePreHeaderCommand||"",titleKey:`${r}${n?.togglePreHeaderCommandKey??"TOGGLE_PRE_HEADER_ROW"}`,disabled:!1,command:d,positionOrder:53})}if(this.gridOptions.enableSorting&&!this._addonOptions.hideClearAllSortingCommand){let d="clear-sorting";a(d)||i.push({iconCssClass:this._addonOptions.iconClearAllSortingCommand||"mdi mdi-sort-variant-off",_orgTitle:n?.clearAllSortingCommand||"",titleKey:`${r}${n?.clearAllSortingCommandKey??"CLEAR_ALL_SORTING"}`,disabled:!1,command:d,positionOrder:51})}if(this.gridOptions.enableTextExport&&!this._addonOptions.hideExportCsvCommand){let d="export-csv";a(d)||i.push({iconCssClass:this._addonOptions.iconExportCsvCommand||"mdi mdi-download",_orgTitle:n?.exportCsvCommand||"",titleKey:`${r}${n?.exportCsvCommandKey??"EXPORT_TO_CSV"}`,disabled:!1,command:d,positionOrder:55})}if(this.gridOptions.enableExcelExport&&!this._addonOptions.hideExportExcelCommand){let d="export-excel";a(d)||i.push({iconCssClass:this._addonOptions.iconExportExcelCommand||"mdi mdi-file-excel-outline text-success",_orgTitle:n?.exportExcelCommand||"",titleKey:`${r}${n?.exportExcelCommandKey??"EXPORT_TO_EXCEL"}`,disabled:!1,command:d,positionOrder:56})}if(this.gridOptions.enableTextExport&&!this._addonOptions.hideExportTextDelimitedCommand){let d="export-text-delimited";a(d)||i.push({iconCssClass:this._addonOptions.iconExportTextDelimitedCommand||"mdi mdi-download",_orgTitle:n?.exportTextDelimitedCommand||"",titleKey:`${r}${n?.exportTextDelimitedCommandKey??"EXPORT_TO_TAB_DELIMITED"}`,disabled:!1,command:d,positionOrder:57})}let l=this._addonOptions?.commandItems||[];(Array.isArray(i)&&i.length>0||Array.isArray(l)&&l.length>0)&&(this._addonOptions.commandTitle||=this.extensionUtility.getPickerTitleOutputString("commandTitle","gridMenu"))}return i}executeGridMenuInternalCustomCommands(e,t){let i=this.sharedService?.externalRegisteredResources||[];if(t?.command)switch(t.command){case"clear-pinning":let o=[...this.sharedService.visibleColumns],r={frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1};this.grid.setOptions(r),this.sharedService.gridOptions.frozenColumn=r.frozenColumn,this.sharedService.gridOptions.frozenRow=r.frozenRow,this.sharedService.gridOptions.frozenBottom=r.frozenBottom,this.sharedService.gridOptions.enableMouseWheelScrollHandler=r.enableMouseWheelScrollHandler,Array.isArray(o)&&this.grid.setColumns(o),this.gridOptions.enableAutoSizeColumns&&this.grid.autosizeColumns(),this.pubSubService.publish("onGridMenuClearAllPinning");break;case"clear-filter":this.filterService.clearFilters(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllFilters");break;case"clear-sorting":this.sortService.clearSorting(),this.sharedService.dataView.refresh(),this.pubSubService.publish("onGridMenuClearAllSorting");break;case"export-csv":let a=i.find(m=>m.className==="TextExportService");a?.exportToFile?a.exportToFile({delimiter:bt.comma,format:"csv"}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"export-excel":let l=i.find(m=>m.className==="ExcelExportService");l?.exportToExcel?l.exportToExcel():console.error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Grid Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };");break;case"export-text-delimited":let d=i.find(m=>m.className==="TextExportService");d?.exportToFile?d.exportToFile({delimiter:bt.tab,format:"txt"}):console.error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Grid Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };");break;case"toggle-dark-mode":let c=this.sharedService.gridOptions.darkMode;this.grid.setOptions({darkMode:!c}),this.sharedService.gridOptions.darkMode=!c;break;case"toggle-filter":let h=this.gridOptions?.showHeaderRow??!1;h=!h,this.grid.setHeaderRowVisibility(h),h===!0&&(this.grid.setColumns(this.sharedService.columnDefinitions),this.grid.scrollColumnIntoView(0));break;case"toggle-preheader":let u=this.gridOptions?.showPreHeaderPanel??!1;this.grid.setPreHeaderPanelVisibility(!u);break;case"refresh-dataset":this.extensionUtility.refreshBackendDataset();break;default:break}}getDefaultGridMenuOptions(){return{commandTitle:void 0,columnTitle:this.extensionUtility.getPickerTitleOutputString("columnTitle","gridMenu"),forceFitTitle:this.extensionUtility.getPickerTitleOutputString("forceFitTitle","gridMenu"),syncResizeTitle:this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","gridMenu"),iconCssClass:"mdi mdi-menu",menuWidth:18,commandItems:[],hideClearAllFiltersCommand:!1,hideRefreshDatasetCommand:!1,hideToggleFilterCommand:!1}}handleBodyMouseDown(e){if(this.menuElement){let t=!1,i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this._isMenuOpen&&this.menuElement!==e.target&&!t&&!e.defaultPrevented||e.target.className==="close"&&i)&&this.hideMenu(e)}}handleMenuItemCommandClick(e,t,i,o=0){if(i!=="divider"&&!i.disabled&&!i.divider)if((i.command||"")&&!i.commandItems){let n={grid:this.grid,command:i.command,item:i,allColumns:this.columns,visibleColumns:this.getVisibleColumns()};this.executeGridMenuInternalCustomCommands(e,n),this.pubSubService.publish("onGridMenuCommand",n),typeof this._addonOptions?.onCommand=="function"&&this._addonOptions.onCommand(e,n),this.onCommand.notify(n,null,this),typeof i.action=="function"&&i.action.call(this,e,n),!this._addonOptions?.leaveOpen&&!e.defaultPrevented&&this.hideMenu(e),e.preventDefault(),e.stopPropagation()}else i.commandItems&&this.repositionSubMenu(e,i,o)}handleMenuItemMouseOver(e,t,i,o=0){i!=="divider"&&!i.disabled&&!i.divider&&(i.commandItems?this.repositionSubMenu(e,i,o):o===0&&this.disposeSubMenus())}recreateCommandList(e,t,i,o){let r=i.level||0;if(e.length>0){let n=p("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},t);if(r===0){this.populateCommandOrOptionTitle("command",this.addonOptions,n,r);let a=t.querySelector(".slick-command-header")??p("div",{className:"slick-command-header"});a.classList.add("with-close"),kr.call(this,a),n.appendChild(a)}return o&&r>0&&this.addSubMenuTitleWhenExists(o,n),this.populateCommandOrOptionItems("command",this._addonOptions,n,e,i,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),n}return null}repositionSubMenu(e,t,i){let o=t?.commandItems||[],r=this.createCommandMenu(o,i+1,t);r.style.display="block",document.body.appendChild(r),this.repositionMenu(e,r,this._gridMenuButtonElm,this._addonOptions)}};var bc="mdi-icon-picker-check",wc="mdi-icon-picker-uncheck";function kr(s){let t=p("button",{type:"button",className:"close",ariaLabel:"Close",textContent:"\xD7",dataset:{dismiss:this instanceof Vi?"slick-column-picker":"slick-grid-menu"}});s.appendChild(t)}function Cr(s){let e=this;e.addonOptions?.columnTitle&&(e._columnTitleElm=p("div",{className:"slick-menu-title",textContent:e.addonOptions?.columnTitle??e._defaults.columnTitle},s))}function _r(s){let e=this,t=e instanceof Vi?"columnPicker":"gridMenu",o=s.target?.closest(".icon-checkbox-container")?.querySelector(".mdi"),r=!!s.target.checked;if(s.target.ariaChecked=String(r),vc(o,r),s.target.dataset.option==="autoresize"){let n=e.getVisibleColumns();e.grid.setOptions({forceFitColumns:r}),e.grid.setColumns(n);return}if(s.target.dataset.option==="syncresize"){e.grid.setOptions({syncColumnCellResize:r});return}if(s.target.type==="checkbox"){e._areVisibleColumnDifferent=!0;let n=s.target.dataset.columnid||"",a=[];if(e.columns.forEach(c=>{e._columnCheckboxes.find(u=>u.dataset.columnid===c.id.toString())?.checked&&a.push(c)}),!a.length){s.target.checked=!0,vc(o,!0);return}if(e.grid.setColumns(a),(!e.sharedService.visibleColumns||Array.isArray(a)&&a.length!==e.sharedService.visibleColumns.length)&&(e.sharedService.visibleColumns=a),e.gridOptions.enableRowSelection&&r){let c=e.grid.getSelectedRows();e.grid.setSelectedRows(c)}let l=e.gridOptions.frozenColumn??-1;l>=0&&e.extensionUtility.readjustFrozenColumnIndexWhenNeeded(l,e.columns,a);let d={columnId:n,showing:r,allColumns:e.columns,visibleColumns:a,columns:a,grid:e.grid};e.pubSubService.publish(`on${ri(t)}ColumnsChanged`,d),typeof e.addonOptions?.onColumnsChanged=="function"&&e.addonOptions.onColumnsChanged(s,d),e.onColumnsChanged.notify(d,null,e)}}function vc(s,e=!1){s&&(s.className=`mdi ${e?bc:wc}`)}function Da(s,e,t,i=!1){let o=p("label",{className:"checkbox-picker-label",htmlFor:e}),r=p("div",{className:"icon-checkbox-container"}),n=p("input",{id:e,type:"checkbox",dataset:t}),a=p("div",{className:`mdi ${i?bc:wc}`}),l=p("span",{className:"checkbox-label"});return r.appendChild(n),r.appendChild(a),o.appendChild(r),o.appendChild(l),s.appendChild(o),i&&(n.ariaChecked="true",n.checked=!0),{inputElm:n,labelElm:o,labelSpanElm:l}}function xr(s){let e=this,t=e instanceof mo,i=t?"gridmenu-":"",o=e.columns;typeof s?.columnSort=="function"&&(o=[...e.columns].sort(s.columnSort));for(let r of o){let n=r.id,a=document.createElement("li");(r.excludeFromColumnPicker&&!t||r.excludeFromGridMenu&&t)&&(a.className="hidden");let l=`${e._gridUid}-${i}colpicker-${n}`,d=e.grid.getColumnIndex(n)>=0,{inputElm:c,labelElm:h,labelSpanElm:u}=Da(a,l,{columnid:`${n}`},d);e._columnCheckboxes.push(c);let g=(typeof s?.headerColumnValueExtractor=="function"?s.headerColumnValueExtractor:e._defaults.headerColumnValueExtractor)(r,e.gridOptions);Se(u,g,this.gridOptions),a.appendChild(h),e._listElm.appendChild(a)}if((!s.hideForceFitButton||!s.hideSyncResizeButton)&&e._listElm.appendChild(document.createElement("hr")),!s?.hideForceFitButton){let r=document.createElement("li"),n=`${e._gridUid}-${i}colpicker-forcefit`,{labelSpanElm:a}=Da(r,n,{option:"autoresize"},e.gridOptions.forceFitColumns);a.textContent=s?.forceFitTitle??"",e._listElm.appendChild(r)}if(!s?.hideSyncResizeButton){let r=document.createElement("li"),n=`${e._gridUid}-${i}colpicker-syncresize`,{labelSpanElm:a}=Da(r,n,{option:"syncresize"},e.gridOptions.forceFitColumns);a.textContent=s?.syncResizeTitle??"",e._listElm.appendChild(r)}}function po(){let s=this,e=s.grid.getColumns().slice(0),t=new Array(s.columns.length);for(let i=0,o=t.length;i<o;i++)s.grid.getColumnIndex(s.columns[i].id)===void 0?t[i]=s.columns[i]:t[i]=e.shift();s._columns=t}var Vi=class{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._areVisibleColumnDifferent=!1,this._columns=[],this._gridUid="",this._menuElm=null,this._columnCheckboxes=[],this._defaults={hideForceFitButton:!1,hideSyncResizeButton:!1,forceFitTitle:"Force fit columns",minHeight:150,syncResizeTitle:"Synchronous resize",headerColumnValueExtractor:o=>wt(o.columnPickerLabel||o.name||"","innerHTML")},this._bindEventService=new oe,this.onColumnsChanged=new R("onColumnsChanged"),this._eventHandler=new G,this._columns=this.sharedService.allColumns??[],this._gridUid=this.grid?.getUID?.()??"",this.init()}get addonOptions(){return this.gridOptions.columnPicker||{}}get eventHandler(){return this._eventHandler}get columns(){return this._columns}set columns(e){this._columns=e}get gridOptions(){return this.sharedService.gridOptions??{}}get grid(){return this.sharedService.slickGrid}get menuElement(){return this._menuElm}init(){this._gridUid=this.grid.getUID()??"",this._originalPickerOptions=fe(!0,{},this.sharedService.gridOptions.columnPicker),this.gridOptions.columnPicker={...this._defaults,...this.gridOptions.columnPicker},this.onColumnsChanged.setPubSubService(this.pubSubService),this.translateColumnPickerTitles(),this._eventHandler.subscribe(this.grid.onPreHeaderContextMenu,e=>{["slick-column-name","slick-header-column"].some(t=>e.target?.classList.contains(t))&&this.handleHeaderContextMenu(e)}),this._eventHandler.subscribe(this.grid.onHeaderContextMenu,this.handleHeaderContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onColumnsReordered,po.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.disposeMenu.bind(this)),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this),void 0,"body"),this._bindEventService.bind(document.body,"beforeunload",this.dispose.bind(this),void 0,"body")}dispose(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this.disposeMenu()}disposeMenu(){this._bindEventService.unbindAll("parent-menu"),this._listElm?.remove(),this._menuElm?.remove(),this._menuElm=null}createPickerMenu(){let e=p("div",{ariaExpanded:"true",className:`slick-column-picker ${this._gridUid}`,role:"menu"});return po.call(this),Cr.call(this,e),kr.call(this,e),this._listElm=p("div",{className:"slick-column-picker-list",role:"menu"}),this._bindEventService.bind(e,"click",_r.bind(this),void 0,"parent-menu"),document.body.appendChild(e),e}getAllColumns(){return this._columns}getVisibleColumns(){return this.grid.getColumns()}translateColumnPicker(){this.translateColumnPickerTitles(),this.extensionUtility.translateItems(this._columns,"nameKey","name")}translateColumnPickerTitles(){this.addonOptions&&(this.addonOptions.columnTitle=this._originalPickerOptions.columnTitle||"",this.addonOptions.forceFitTitle=this._originalPickerOptions.forceFitTitle||"",this.addonOptions.syncResizeTitle=this._originalPickerOptions.syncResizeTitle||"",this.addonOptions.columnTitle=this.extensionUtility.getPickerTitleOutputString("columnTitle","columnPicker"),this.addonOptions.forceFitTitle=this.extensionUtility.getPickerTitleOutputString("forceFitTitle","columnPicker"),this.addonOptions.syncResizeTitle=this.extensionUtility.getPickerTitleOutputString("syncResizeTitle","columnPicker"))}handleBodyMouseDown(e){(this._menuElm!==e.target&&!this._menuElm?.contains(e.target)||e.target.className==="close"&&e.target.closest(".slick-column-picker"))&&this.disposeMenu()}handleHeaderContextMenu(e){e.preventDefault(),j(this._menuElm),this._columnCheckboxes=[],this._menuElm=this.createPickerMenu(),this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),xr.call(this,this.addonOptions),document.body.appendChild(this._menuElm),this.repositionMenu(e)}repositionMenu(e){let t=e?.touches?.[0]??e;if(this._menuElm){let i=this.grid.getGridPosition(),o=this._menuElm.clientWidth||0,r=t.pageX||0;i?.width&&r+o>=i.width&&(r=r-o),this._menuElm.style.top=`${t.pageY-10}px`,this._menuElm.style.left=`${r}px`,this._menuElm.style.minHeight=pt(this.addonOptions.minHeight,""),this._menuElm.style.maxHeight=pt(this.addonOptions.maxHeight,`${window.innerHeight-t.clientY}px`),this._menuElm.style.display="block",this._menuElm.ariaExpanded="true",this._menuElm.appendChild(this._listElm)}}};var yr=class extends uo{constructor(e,t,i,o){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.treeDataService=o,this._defaults={autoAdjustDrop:!0,autoAlignSide:!0,autoAdjustDropOffset:0,autoAlignSideOffset:0,hideMenuOnScroll:!1,optionShownOverColumnIds:[],commandShownOverColumnIds:[],subMenuOpenByEvent:"mouseover"},this.pluginName="ContextMenu",this._camelPluginName="contextMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-context-menu",this.init(i.gridOptions.contextMenu)}init(e){this._originalContextMenu=fe(!0,{},this.sharedService.gridOptions.contextMenu),this._addonOptions={...this._defaults,...e};let t=this._addonOptions&&Array.isArray(this._addonOptions.commandItems)?this._addonOptions.commandItems:[];this._addonOptions.commandItems=[...t,...this.addMenuCustomCommands(t)],this._addonOptions={...this._addonOptions},this.sharedService.gridOptions.contextMenu=this._addonOptions,this.sortMenuItems(),this._eventHandler.subscribe(this.grid.onContextMenu,this.handleOnContextMenu.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.hideMenu.bind(this)),this._addonOptions.hideMenuOnScroll&&this._eventHandler.subscribe(this.grid.onScroll,this.closeMenu.bind(this))}translateContextMenu(){let e=this.sharedService?.gridOptions??{},t=this.sharedService.gridOptions.contextMenu;if(t&&(t.commandTitle=this._originalContextMenu.commandTitle||"",t.optionTitle=this._originalContextMenu.optionTitle||""),t&&e?.enableTranslate){let i=t.commandItems||[],o=t.optionItems||[];t.commandTitleKey&&(t.commandTitle||=this.extensionUtility.translateWhenEnabledAndServiceExist(t.commandTitleKey,"TEXT_COMMANDS")||t.commandTitle),t.optionTitleKey&&(t.optionTitle||=this.extensionUtility.translateWhenEnabledAndServiceExist(t.optionTitleKey,"TEXT_OPTIONS")||t.optionTitle),this.extensionUtility.translateMenuItemsFromTitleKey(i,"commandItems"),this.extensionUtility.translateMenuItemsFromTitleKey(o,"optionItems")}}handleOnContextMenu(e,t){this.disposeAllMenus();let i=this.grid.getCellFromEvent(e);if(i){let o=this.grid.getDataItem(i.row),r=this.grid.getColumns()[i.cell],n=t||{};if(n.cell=i.cell,n.row=i.row,n.column=r,n.dataContext=o,n.grid=this.grid,!this.extensionUtility.runOverrideFunctionWhenExists(this._addonOptions.menuUsabilityOverride,n))return;this._menuElm=this.createParentMenu(e),this._menuElm&&e.preventDefault(),this._menuElm&&this.gridOptions.darkMode&&this._menuElm.classList.add("slick-dark-mode"),this._menuElm&&(this.repositionMenu(e,this._menuElm,void 0,this._addonOptions),this._menuElm.ariaExpanded="true",this._menuElm.style.display="block"),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}}addMenuCustomCommands(e){let t=[],i=this.sharedService&&this.sharedService.gridOptions||{},o=i?.contextMenu,r=this._addonOptions?.commandLabels,n=this.sharedService?.dataView,a=$e(i),l=d=>e.some(c=>c!=="divider"&&"command"in c&&c.command===d);if(o&&!o.hideCopyCellValueCommand){let d="copy";l(d)||t.push({_orgTitle:r?.copyCellValueCommand||"",iconCssClass:o.iconCopyCellValueCommand||"mdi mdi-content-copy",titleKey:`${a}COPY`,disabled:!1,command:d,positionOrder:50,action:(c,h)=>nr(h),itemUsabilityOverride:c=>{let h=c?.column,u=c?.dataContext;if(typeof h.queryFieldNameGetterFn=="function"){let m=$t(h,u,"");if(m!==""&&m!==void 0)return!0}else if(h&&u.hasOwnProperty(h.field))return u[h.field]!==""&&u[h.field]!==null&&u[h.field]!==void 0;return!1}})}if(i?.enableTextExport&&o&&!o.hideExportCsvCommand){let d="export-csv";l(d)||t.push({_orgTitle:r?.exportCsvCommand||"",iconCssClass:o.iconExportCsvCommand||"mdi mdi-download",titleKey:`${a}EXPORT_TO_CSV`,disabled:!1,command:d,positionOrder:51,action:()=>{let h=(this.sharedService?.externalRegisteredResources||[]).find(u=>u.className==="TextExportService");if(h?.exportToFile)h.exportToFile({delimiter:bt.comma,format:"csv"});else throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };")}})}if(i&&i.enableExcelExport&&o&&!o.hideExportExcelCommand){let d="export-excel";l(d)||t.push({_orgTitle:r?.exportExcelCommand||"",iconCssClass:o.iconExportExcelCommand||"mdi mdi-file-excel-outline text-success",titleKey:`${a}EXPORT_TO_EXCEL`,disabled:!1,command:d,positionOrder:52,action:()=>{let h=(this.sharedService?.externalRegisteredResources||[]).find(u=>u.className==="ExcelExportService");if(h?.exportToExcel)h.exportToExcel();else throw new Error("[Slickgrid-Universal] You must register the ExcelExportService to properly use Export to Excel in the Context Menu. Example:: this.gridOptions = { enableExcelExport: true, externalResources: [new ExcelExportService()] };")}})}if(i?.enableTextExport&&o&&!o.hideExportTextDelimitedCommand){let d="export-text-delimited";l(d)||t.push({_orgTitle:r?.exportTextDelimitedCommand||"",iconCssClass:o.iconExportTextDelimitedCommand||"mdi mdi-download",titleKey:`${a}EXPORT_TO_TAB_DELIMITED`,disabled:!1,command:d,positionOrder:53,action:()=>{let h=(this.sharedService?.externalRegisteredResources||[]).find(u=>u.className==="TextExportService");if(h?.exportToFile)h.exportToFile({delimiter:bt.tab,format:"txt"});else throw new Error("[Slickgrid-Universal] You must register the TextExportService to properly use Export to File in the Context Menu. Example:: this.gridOptions = { enableTextExport: true, externalResources: [new TextExportService()] };")}})}if(i&&(i.enableGrouping||i.enableDraggableGrouping||i.enableTreeData)){if(o&&!o.hideCopyCellValueCommand&&t.push({divider:!0,command:"",positionOrder:54}),i&&!i.enableTreeData&&o&&!o.hideClearAllGrouping){let d="clear-grouping";l(d)||t.push({_orgTitle:r?.clearGroupingCommand||"",iconCssClass:o.iconClearGroupingCommand||"mdi mdi-close",titleKey:`${a}CLEAR_ALL_GROUPING`,disabled:!1,command:d,positionOrder:55,action:()=>{n.setGrouping([]),this.pubSubService.publish("onContextMenuClearGrouping")},itemUsabilityOverride:()=>{let c=n&&n.getGrouping&&n.getGrouping();return Array.isArray(c)&&c.length>0}})}if(i&&o&&!o.hideCollapseAllGroups){let d="collapse-all-groups";l(d)||t.push({_orgTitle:r?.collapseAllGroupsCommand||"",iconCssClass:o.iconCollapseAllGroupsCommand||"mdi mdi-arrow-collapse",titleKey:`${a}COLLAPSE_ALL_GROUPS`,disabled:!1,command:d,positionOrder:56,action:()=>{i.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!0):n.collapseAllGroups(),this.pubSubService.publish("onContextMenuCollapseAllGroups")},itemUsabilityOverride:()=>{if(i.enableTreeData)return!0;let c=n&&n.getGrouping&&n.getGrouping();return Array.isArray(c)&&c.length>0}})}if(i&&o&&!o.hideExpandAllGroups){let d="expand-all-groups";l(d)||t.push({_orgTitle:r?.expandAllGroupsCommand||"",iconCssClass:o.iconExpandAllGroupsCommand||"mdi mdi-arrow-expand",titleKey:`${a}EXPAND_ALL_GROUPS`,disabled:!1,command:d,positionOrder:57,action:()=>{i.enableTreeData?this.treeDataService.toggleTreeDataCollapse(!1):n.expandAllGroups(),this.pubSubService.publish("onContextMenuExpandAllGroups")},itemUsabilityOverride:()=>{if(i.enableTreeData)return!0;let c=n&&n.getGrouping&&n.getGrouping();return Array.isArray(c)&&c.length>0}})}}return this.extensionUtility.translateMenuItemsFromTitleKey(t),t}sortMenuItems(){let e=this.sharedService?.gridOptions?.contextMenu;e&&(this.extensionUtility.sortItems(e.commandItems||[],"positionOrder"),this.extensionUtility.sortItems(e.optionItems||[],"positionOrder"))}};var Er=class{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this.columnsGroupBy=[],this.pluginName="DraggableGrouping",this._gridColumns=[],this._gridUid="",this._isInitialized=!1,this._reorderedColumns=[],this._subscriptions=[],this._defaults={dropPlaceHolderText:"Drop a column header here to group by the column",hideGroupSortIcons:!1,hideToggleAllButton:!1,toggleAllButtonText:"",toggleAllPlaceholderText:"Toggle all Groups"},this._bindingEventService=new oe,this.onGroupChanged=new R("onGroupChanged"),this._eventHandler=new G}get addonOptions(){return this._addonOptions}get dataView(){return this.grid?.getData()??{}}get dropboxElement(){return this._dropzoneElm}get droppableInstance(){return this._droppableInstance}get sortableLeftInstance(){return this._sortableLeftInstance}get sortableRightInstance(){return this._sortableRightInstance}get eventHandler(){return this._eventHandler}get grid(){return this._grid??this.sharedService.slickGrid??{}}get gridOptions(){return this.sharedService.gridOptions??{}}get gridUid(){return this._gridUid||(this.grid?.getUID()??"")}get gridContainer(){return this.grid.getContainerNode()}set isInitialized(e){this._isInitialized=e}init(e,t){if(this._addonOptions={...this._defaults,...t},this._grid=e,e){if(this._gridUid=e.getUID(),this._gridColumns=e.getColumns(),this._dropzoneElm=e.getTopHeaderPanel()||e.getPreHeaderPanel(),!this._dropzoneElm)throw new Error("[Slickgrid-Universal] Draggable Grouping requires the pre-header to be created and shown for the plugin to work correctly (use `createPreHeaderPanel` and `showPreHeaderPanel`).");if(this._dropzoneElm.classList.add("slick-dropzone"),this.onGroupChanged.setPubSubService(this.pubSubService),!this._addonOptions.hideToggleAllButton){this._groupToggler=p("div",{className:"slick-group-toggle-all",title:this._addonOptions.toggleAllPlaceholderText??"",style:{display:"none"}});let i=p("span",{className:"slick-group-toggle-all-icon"},this._groupToggler);this.gridOptions.enableTranslate&&this._addonOptions.toggleAllButtonTextKey&&(this._addonOptions.toggleAllButtonText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllButtonTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this.gridOptions.enableTranslate&&this._addonOptions.toggleAllPlaceholderTextKey&&(this._addonOptions.toggleAllPlaceholderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.toggleAllPlaceholderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._groupToggler.title=this._addonOptions.toggleAllPlaceholderText??"",this._addonOptions.toggleAllButtonText&&this._groupToggler.appendChild(p("span",{className:"slick-group-toggle-all-text",textContent:this._addonOptions.toggleAllButtonText||""})),this._dropzoneElm.appendChild(this._groupToggler),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuCollapseAllGroups",()=>this.toggleGroupToggler(i,!0,!1)),this.pubSubService.subscribe("onContextMenuExpandAllGroups",()=>this.toggleGroupToggler(i,!1,!1)))}this._dropzonePlaceholderElm=p("div",{className:"slick-draggable-dropzone-placeholder"},this._dropzoneElm),this.gridOptions.enableTranslate&&this._addonOptions?.dropPlaceHolderTextKey&&(this._addonOptions.dropPlaceHolderText=this.extensionUtility.translateWhenEnabledAndServiceExist(this._addonOptions.dropPlaceHolderTextKey,"TEXT_TOGGLE_ALL_GROUPS")),this._dropzonePlaceholderElm.textContent=this._addonOptions?.dropPlaceHolderText??this._defaults.dropPlaceHolderText??"",this.setupColumnDropbox(),this._eventHandler.subscribe(e.onHeaderCellRendered,(i,o)=>{let r=o.node;if(!us(o.column?.grouping)&&r&&(r.style.cursor="pointer",this._addonOptions.groupIconCssClass)){let n=p("span",{className:"slick-column-groupable"},r);this._addonOptions.groupIconCssClass&&n.classList.add(...ae(this._addonOptions.groupIconCssClass))}}),this._subscriptions.push(this.pubSubService.subscribe("onContextMenuClearGrouping",()=>this.clearDroppedGroups()));for(let i of this._gridColumns){let o=i.field;e.updateColumnHeader(o)}}return this}dispose(){this.destroySortableInstances(),this._droppableInstance?.el&&this._droppableInstance?.destroy(),this.onGroupChanged.unsubscribe(),this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingEventService.unbindAll(),j(this.gridContainer.querySelector(`.${this.gridUid} .slick-preheader-panel,.${this.gridUid} .slick-topheader-panel`))}clearDroppedGroups(){this.columnsGroupBy=[],this.updateGroupBy("clear-all");let e=this._dropzoneElm.querySelectorAll(".slick-dropped-grouping");for(let t of Array.from(e))this._dropzoneElm.querySelector(".slick-groupby-remove")?.remove(),t?.remove();this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")}destroySortableInstances(){this._sortableLeftInstance?.el&&this._sortableLeftInstance?.destroy(),this._sortableRightInstance?.el&&this._sortableRightInstance?.destroy()}setAddonOptions(e){this._addonOptions={...this._addonOptions,...e}}setColumns(e){this._gridColumns=e}setDroppedGroups(e){this._dropzonePlaceholderElm.style.display="none";let t=Array.isArray(e)?e:[e];for(let i of t){let o=this.grid.getHeaderColumn(i);this.handleGroupByDrop(this._dropzoneElm,o)}}setupColumnReorder(e,t,i,o,r,n,a,l,d){this.destroySortableInstances();let c=e.getTopHeaderPanel()||e.getPreHeaderPanel(),h=c.querySelector(".slick-draggable-dropzone-placeholder"),u=c.querySelector(".slick-group-toggle-all"),m={animation:50,ghostClass:"slick-sortable-placeholder",draggable:".slick-header-column",dataIdAttr:"data-id",group:{name:"shared",pull:"clone",put:!1},revertClone:!0,onStart:f=>{f.item.classList.add("slick-header-column-active"),h&&(h.style.display="inline-block"),c.querySelectorAll(".slick-dropped-grouping").forEach(v=>v.style.display="none"),u&&(u.style.display="none")},onEnd:f=>{f.item.classList.remove("slick-header-column-active"),c?.classList.remove("slick-dropzone-hover"),h?.parentElement?.classList.remove("slick-dropzone-placeholder-hover");let b=c.querySelectorAll(".slick-dropped-grouping");if(b.forEach(E=>E.style.display="flex"),b.length&&(h&&(h.style.display="none"),u&&(u.style.display="inline-flex")),!e.getEditorLock().commitCurrentEdit())return;let v=this.sortableLeftInstance?.toArray()??[];if(t.length>1){let E=this._sortableRightInstance?.toArray()??[];for(let y of E)v.push(y)}let k=[],C=e.getColumns();for(let E of v)k.push(C[a.call(e,E)]);o.call(e,k),d.call(e,e.onColumnsReordered,{grid:e,impactedColumns:k}),f.stopPropagation(),r.call(e)}};this._sortableLeftInstance=pi.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-left`),m),this._sortableRightInstance=pi.create(this.gridContainer.querySelector(`.${e.getUID()} .slick-header-columns.slick-header-columns-right`),m);let g=this._addonOptions.initialGroupBy??this.gridOptions.presets?.grouping;return g&&!this._isInitialized&&this.setDroppedGroups(g),this._isInitialized=!0,{sortableLeftInstance:this._sortableLeftInstance,sortableRightInstance:this._sortableRightInstance}}addColumnGroupBy(e){this.columnsGroupBy.push(e),this.updateGroupBy("add-group")}addGroupByRemoveClickHandler(e,t,i,o){this._bindingEventService.bind(t,"click",()=>{let r=this._bindingEventService.boundedEvents.filter(n=>n.element===t);for(let n of r)this._bindingEventService.unbind(n.element,"click",n.listener);this.removeGroupBy(e,i,o)})}addGroupSortClickHandler(e,t){let{grouping:i,type:o}=e;this._bindingEventService.bind(t,"click",()=>{if(this.toggleGroupAll(e,!1),i){let r=i.sortAsc?ce.desc:ce.asc;i.comparer=(n,a)=>jt(o||"text",n.value,a.value,r,e,this.gridOptions),this.getGroupBySortIcon(t,!i.sortAsc),this.updateGroupBy("sort-group"),i.sortAsc=!i.sortAsc,this.grid.invalidate()}})}getGroupBySortIcon(e,t=!0){t?this._addonOptions.sortAscIconCssClass?(e.classList.remove(...ae(this._addonOptions.sortDescIconCssClass)),e.classList.add(...ae(this._addonOptions.sortAscIconCssClass))):(e.classList.add("slick-groupby-sort-asc-icon"),e.classList.remove("slick-groupby-sort-desc-icon")):this._addonOptions.sortDescIconCssClass?(e.classList.remove(...ae(this._addonOptions.sortAscIconCssClass)),e.classList.add(...ae(this._addonOptions.sortDescIconCssClass))):this._addonOptions.sortDescIconCssClass||(e.classList.add("slick-groupby-sort-desc-icon"),e.classList.remove("slick-groupby-sort-asc-icon"))}handleGroupByDrop(e,t){let i=t.getAttribute("data-id")?.replace(this._gridUid,""),o=!0;for(let r of this.columnsGroupBy)r.id===i&&(o=!1);if(o){for(let r of this._gridColumns)if(r.id===i&&r.grouping&&!us(r.grouping)){let n=t.querySelector(".slick-column-name"),a=p("div",{id:`${this._gridUid}_${r.id}_entry`,className:"slick-dropped-grouping",dataset:{id:`${r.id}`}});p("div",{className:"slick-dropped-grouping-title",style:{display:"inline-flex"},textContent:n?n.textContent:t.textContent},a);let l=p("div",{className:"slick-groupby-remove"});this._addonOptions.deleteIconCssClass&&l.classList.add(...ae(this._addonOptions.deleteIconCssClass)),this._addonOptions.deleteIconCssClass||l.classList.add("slick-groupby-remove-icon");let d;this._addonOptions?.hideGroupSortIcons!==!0&&r.sortable&&(r.grouping?.sortAsc===void 0&&(r.grouping.sortAsc=!0),d=p("div",{className:"slick-groupby-sort"},a),this.getGroupBySortIcon(d,r.grouping.sortAsc)),a.appendChild(l),a.appendChild(document.createElement("div")),e.appendChild(a),this._groupToggler&&this.columnsGroupBy.length===0&&this.toggleGroupAll(r),this.addColumnGroupBy(r),this.addGroupByRemoveClickHandler(r.id,l,t,a),d&&this.addGroupSortClickHandler(r,d)}this._groupToggler&&this.columnsGroupBy.length>0&&(this._groupToggler.style.display="inline-flex")}}toggleGroupAll({grouping:e},t){let i=this._groupToggler?.querySelector(".slick-group-toggle-all-icon"),o=t===!0||e?.collapsed;i?.classList.toggle("collapsed",o),i?.classList.toggle("expanded",!o)}removeFromArray(e,t){if(Array.isArray(e)){let i=e.findIndex(o=>o.id===t.id);i>=0&&e.splice(i,1)}return e}removeGroupBy(e,t,i){i.remove();let o=[];this._gridColumns.forEach(r=>o[r.id]=r),this.removeFromArray(this.columnsGroupBy,o[e]),this.columnsGroupBy.length===0&&(this._dropzonePlaceholderElm.style.display="inline-block",this._groupToggler&&(this._groupToggler.style.display="none")),this.updateGroupBy("remove-group")}addDragOverDropzoneListeners(){let e=this._dropzoneElm.querySelector(".slick-draggable-dropzone-placeholder");e&&this._dropzoneElm&&(this._bindingEventService.bind(e,"dragover",t=>t.preventDefault()),this._bindingEventService.bind(e,"dragenter",()=>this._dropzoneElm.classList.add("slick-dropzone-hover")),this._bindingEventService.bind(e,"dragleave",()=>this._dropzoneElm.classList.remove("slick-dropzone-hover")))}setupColumnDropbox(){let e=this._dropzoneElm;this._droppableInstance=pi.create(e,{group:"shared",ghostClass:"slick-droppable-sortitem-hover",draggable:".slick-dropped-grouping",dragoverBubble:!0,onAdd:t=>{let i=t.item;i.getAttribute("id")?.replace(this._gridUid,"")&&this.handleGroupByDrop(e,pi.utils.clone(t.item)),i.parentNode?.removeChild(i)},onUpdate:()=>{let t=this._droppableInstance?.toArray()??[],i=[];for(let o of t)for(let r of this.columnsGroupBy)if(r.id===o){i.push(r);break}this.columnsGroupBy=i,this.updateGroupBy("sort-group")}}),this.addDragOverDropzoneListeners(),this._groupToggler&&this._bindingEventService.bind(this._groupToggler,"click",t=>{let i=t.target.classList.contains("slick-group-toggle-all-icon")?t.target:t.currentTarget.querySelector(".slick-group-toggle-all-icon");this.toggleGroupToggler(i,i?.classList.contains("expanded"))})}toggleGroupToggler(e,t=!0,i=!0){if(e){let o=t===!0;e.classList.toggle("collapsed",o),e.classList.toggle("expanded",!o),i&&(o?this.dataView.collapseAllGroups():this.dataView.expandAllGroups())}}updateGroupBy(e){if(this.columnsGroupBy.length===0){this.dataView.setGrouping([]),this._dropzonePlaceholderElm.style.display="inline-block",this.triggerOnGroupChangedEvent({caller:e,groupColumns:[]});return}let t=[];this.columnsGroupBy.forEach(i=>t.push(i.grouping)),this.dataView.setGrouping(t),this._dropzonePlaceholderElm.style.display="none",this.triggerOnGroupChangedEvent({caller:e,groupColumns:t})}triggerOnGroupChangedEvent(e){this._addonOptions&&typeof this._addonOptions.onGroupChanged=="function"&&this._addonOptions.onGroupChanged(new U,e),this.onGroupChanged.notify(e)}};var Sr=class extends Ft{constructor(e,t,i){super(e,t,i),this.extensionUtility=e,this.pubSubService=t,this.sharedService=i,this._buttonElms=[],this._defaults={buttonCssClass:"slick-header-button"},this.pluginName="HeaderButtons",this._menuCssPrefix="slick-header-button",this._camelPluginName="headerButtons",this._bindEventService=new oe,this._eventHandler=new G,this.init(i.gridOptions.headerButton)}get addonOptions(){return this._addonOptions}set addonOptions(e){this._addonOptions=e}get eventHandler(){return this._eventHandler}get grid(){return this.sharedService.slickGrid}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this.grid.setColumns(this.grid.getColumns())}dispose(){super.dispose(),this._buttonElms.forEach(e=>e.remove())}handleHeaderCellRendered(e,t){let i=t.column;if(i.header?.buttons&&Array.isArray(i.header.buttons)){let o=i.header.buttons.length;for(;o--;){let r=i.header.buttons[o],n=this.populateSingleCommandOrOptionItem("command",this.addonOptions,null,r,t,this.handleButtonClick.bind(this));n&&r.handler&&!r.disabled&&this._bindEventService.bind(n,"click",a=>r.handler.call(this,a)),n&&(this._buttonElms.push(n),t.node.appendChild(n))}}}handleBeforeHeaderCellDestroy(e,t){if(t.column.header?.buttons&&this._addonOptions?.buttonCssClass){let o=(this._addonOptions?.buttonCssClass||"").replace(/(\s+)/g,".");o&&t.node.querySelectorAll(`.${o}`).forEach(r=>r.remove())}}handleButtonClick(e,t,i,o,r){if(i.command&&!i.disabled){let n=i.command||"",a={grid:this.grid,column:r,button:i};n&&(a.command=n),typeof i.action=="function"&&!i.disabled&&i.action.call(this,e,a),n!==null&&!i.disabled&&this._addonOptions?.onCommand&&(this.pubSubService.publish("onHeaderButtonCommand",a),this._addonOptions.onCommand(e,a),r?.id&&this.grid.updateColumnHeader(r.id))}e.preventDefault(),e.stopPropagation()}};var Tr=class extends Ft{constructor(e,t,i,o,r){super(e,i,o),this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=o,this.sortService=r,this._subMenuParentId="",this._defaults={autoAlign:!0,autoAlignOffset:0,buttonCssClass:null,buttonImage:null,minWidth:100,hideColumnHideCommand:!1,hideSortCommands:!1,title:"",subMenuOpenByEvent:"mouseover"},this.pluginName="HeaderMenu",this._menuCssPrefix="slick-menu",this._menuPluginCssPrefix="slick-header-menu",this._camelPluginName="headerMenu",this.init(o.gridOptions.headerMenu)}init(e){this._addonOptions={...this._defaults,...e},this._eventHandler.subscribe(this.grid.onBeforeSetColumns,(t,i)=>{this.sharedService.gridOptions.headerMenu=this.addHeaderMenuCustomCommands(i.newColumns)}),this._eventHandler.subscribe(this.grid.onHeaderCellRendered,this.handleHeaderCellRendered.bind(this)),this._eventHandler.subscribe(this.grid.onBeforeHeaderCellDestroy,this.handleBeforeHeaderCellDestroy.bind(this)),this._eventHandler.subscribe(this.grid.onClick,this.hideMenu.bind(this)),this.grid.setColumns(this.grid.getColumns()),this._bindEventService.bind(document.body,"mousedown",this.handleBodyMouseDown.bind(this))}dispose(){super.dispose(),this._menuElm=this._menuElm||document.body.querySelector(`.slick-header-menu${this.gridUidSelector}`),this._menuElm?.remove(),this._activeHeaderColumnElm=void 0}hideColumn(e){if(this.sharedService?.slickGrid?.getColumnIndex){let t=this.sharedService.slickGrid.getColumnIndex(e.id),i=this.sharedService.slickGrid.getColumns(),o=this.sharedService.gridOptions.frozenColumn??-1;o>=0&&o>=t&&(this.sharedService.gridOptions.frozenColumn=o-1,this.sharedService.slickGrid.setOptions({frozenColumn:this.sharedService.gridOptions.frozenColumn}));let r=yo(i,t);this.sharedService.visibleColumns=r,this.sharedService.slickGrid.setColumns(r),this.pubSubService.publish("onHideColumns",{columns:r,hiddenColumn:e})}}hideMenu(){this.disposeSubMenus(),this._menuElm?.remove(),this._menuElm=void 0}repositionSubMenu(e,t,i,o){let r=this.createCommandMenu(t.commandItems||[],o,i+1,t);document.body.appendChild(r),this.repositionMenu(e,r,void 0,this.addonOptions)}translateHeaderMenu(){this.sharedService.gridOptions?.headerMenu&&this.resetHeaderMenuTranslations(this.sharedService.visibleColumns)}handleHeaderCellRendered(e,t){let o=t.column.header?.menu;if(o&&t.node){if(!this.extensionUtility.runOverrideFunctionWhenExists(this.addonOptions.menuUsabilityOverride,t))return;let r=p("div",{className:"slick-header-menu-button",ariaLabel:"Header Menu"},t.node);this.addonOptions.buttonCssClass&&r.classList.add(...ae(this.addonOptions.buttonCssClass)),this.addonOptions.tooltip&&(r.title=this.addonOptions.tooltip),this._bindEventService.bind(r,"click",n=>{this.disposeAllMenus(),this.createParentMenu(n,t.column,o)})}}handleBeforeHeaderCellDestroy(e,t){t.column.header?.menu&&t.node.querySelectorAll(".slick-header-menu-button").forEach(o=>o.remove())}handleBodyMouseDown(e){if(this.menuElement){let t=!1,i=e.target.closest(`.${this.menuCssClass}`);(this.menuElement.contains(e.target)||i)&&(t=!0),(this._menuElm!==e.target&&!t&&!e.defaultPrevented||e.target.className==="close"&&i)&&this.hideMenu()}}handleMenuItemCommandClick(e,t,i,o=0,r){if(i!=="divider"&&!i.disabled&&!i.divider)if((i.command||"")&&!i.commandItems){let a={grid:this.grid,command:i.command,column:r,item:i};this.executeHeaderMenuInternalCommands(e,a),this.pubSubService.publish("onHeaderMenuCommand",a),typeof this.addonOptions?.onCommand=="function"&&this.addonOptions.onCommand(e,a),typeof i.action=="function"&&i.action.call(this,e,a),e.defaultPrevented||this.hideMenu(),e.preventDefault(),e.stopPropagation()}else i.commandItems&&this.repositionSubMenu(e,i,o,r)}handleMenuItemMouseOver(e,t,i,o=0,r){i!=="divider"&&!i.disabled&&!i.divider&&(i.commandItems?this.repositionSubMenu(e,i,o,r):o===0&&this.disposeSubMenus())}addHeaderMenuCustomCommands(e){let t=this.sharedService.gridOptions,i=t.headerMenu||{},o=$e(t),r=this._addonOptions?.commandLabels;return Array.isArray(e)&&t.enableHeaderMenu&&e.forEach(n=>{if(n&&!n.excludeFromHeaderMenu){n.header?n.header.menu||(n.header.menu={commandItems:[]}):n.header={menu:{commandItems:[]}};let a=n?.header?.menu?.commandItems??[],l=m=>a.some(g=>g!=="divider"&&"command"in g&&g.command===m),d=!1;if(i&&!i.hideFreezeColumnsCommand)if(d=!0,t.frozenColumn===e.findIndex(m=>m.id===n.id)){this.removeCommandWhenFound(a,"freeze-columns");let m="unfreeze-columns";l(m)||a.push({_orgTitle:r?.unfreezeColumnsCommand||"",iconCssClass:i.iconUnfreezeColumns||"mdi mdi-pin-off-outline",titleKey:`${o}UNFREEZE_COLUMNS`,command:m,positionOrder:45})}else{this.removeCommandWhenFound(a,"unfreeze-columns");let m="freeze-columns";l(m)||a.push({_orgTitle:r?.freezeColumnsCommand||"",iconCssClass:i.iconFreezeColumns||"mdi mdi-pin-outline",titleKey:`${o}FREEZE_COLUMNS`,command:m,positionOrder:45})}if(i&&!i.hideColumnResizeByContentCommand&&this.sharedService.gridOptions.enableColumnResizeOnDoubleClick){d=!0;let m="column-resize-by-content";l(m)||a.push({_orgTitle:r?.columnResizeByContentCommand||"",iconCssClass:i.iconColumnResizeByContentCommand||"mdi mdi-arrow-expand-horizontal",titleKey:`${o}COLUMN_RESIZE_BY_CONTENT`,command:m,positionOrder:47})}if(d&&!a.some(m=>m!=="divider"&&m.positionOrder===48)&&a.push({divider:!0,command:"",positionOrder:48}),t.enableSorting&&n.sortable&&i&&!i.hideSortCommands){let m="sort-asc",g="sort-desc";l(m)||a.push({_orgTitle:r?.sortAscCommand||"",iconCssClass:i.iconSortAscCommand||"mdi mdi-sort-ascending",titleKey:`${o}SORT_ASCENDING`,command:m,positionOrder:50}),l(g)||a.push({_orgTitle:r?.sortDescCommand||"",iconCssClass:i.iconSortDescCommand||"mdi mdi-sort-descending",titleKey:`${o}SORT_DESCENDING`,command:g,positionOrder:51}),a.some(b=>b!=="divider"&&b.positionOrder===52)||a.push({divider:!0,command:"",positionOrder:52});let f="clear-sort";!i.hideClearSortCommand&&!l(f)&&a.push({_orgTitle:r?.clearSortCommand||"",iconCssClass:i.iconClearSortCommand||"mdi mdi-sort-variant-off",titleKey:`${o}REMOVE_SORT`,command:f,positionOrder:58})}let c="filter-shortcuts-root-menu";if(n.filter?.filterShortcuts&&!l(c)){let m=[];n.filter.filterShortcuts.forEach(f=>{let b=f.title?Mt(f.title):(f.titleKey||"").toLowerCase().replaceAll("_","-");m.push({...f,command:b,action:(v,k)=>{this.filterService.getFiltersMetadata().find(E=>E.columnDef.id===k.column.id)?.setValues(f.searchTerms,f.operator,!0)}})});let g=i.filterShortcutsPositionOrder??55;a.push({_orgTitle:r?.filterShortcutsCommand||"",iconCssClass:i.iconFilterShortcutSubMenu||"mdi mdi-filter-outline",titleKey:`${o}FILTER_SHORTCUTS`,command:c,positionOrder:g,commandItems:m}),d&&!a.some(f=>f!=="divider"&&f.positionOrder===g+1)&&a.push({divider:!0,command:"",positionOrder:g+1})}let h="clear-filter";t.enableFiltering&&n.filterable&&i&&!i.hideFilterCommand&&!i.hideClearFilterCommand&&!l(h)&&a.push({_orgTitle:r?.clearFilterCommand||"",iconCssClass:i.iconClearFilterCommand||"mdi mdi-filter-remove-outline",titleKey:`${o}REMOVE_FILTER`,command:h,positionOrder:57});let u="hide-column";i&&!i.hideColumnHideCommand&&!l(u)&&a.push({_orgTitle:r?.hideColumnCommand||"",iconCssClass:i.iconColumnHideCommand||"mdi mdi-close",titleKey:`${o}HIDE_COLUMN`,command:u,positionOrder:59}),this.extensionUtility.translateMenuItemsFromTitleKey(a),this.extensionUtility.sortItems(a,"positionOrder")}}),i}clearColumnFilter(e,t){t?.column&&this.filterService.clearFilterByColumnId(e,t.column.id)}clearColumnSort(e,t){t?.column&&this.sharedService&&this.sortService.clearSortByColumnId(e,t.column.id)}removeCommandWhenFound(e,t){let i=e.findIndex(o=>o!=="divider"&&o?.command===t);i>=0&&e.splice(i,1)}freezeOrUnfreezeColumns(e,t){let i=[...this.sharedService.visibleColumns],o=i.findIndex(c=>c.id===e.id),r={frozenColumn:t==="unfreeze-columns"?-1:o,enableMouseWheelScrollHandler:!0},n=e?.header?.menu?.commandItems??[];this.removeCommandWhenFound(n,t);let a=this.sharedService.slickGrid.getColumns();this.sharedService.slickGrid.setOptions(r,!1,!0),this.sharedService.gridOptions.frozenColumn=r.frozenColumn,this.sharedService.gridOptions.enableMouseWheelScrollHandler=r.enableMouseWheelScrollHandler,this.sharedService.frozenVisibleColumnId=e.id;let l=[];t==="freeze-columns"?this.sharedService.hasColumnsReordered||Array.isArray(i)&&Array.isArray(this.sharedService.allColumns)&&i.length!==this.sharedService.allColumns.length?l=i:l=a:l=i,this.sharedService.slickGrid.setColumns(l),this.sharedService.slickGrid.getOptions().enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns()}executeHeaderMenuInternalCommands(e,t){if(t?.command)switch(t.command){case"hide-column":this.hideColumn(t.column),this.sharedService.gridOptions?.enableAutoSizeColumns&&this.sharedService.slickGrid.autosizeColumns();break;case"clear-filter":this.clearColumnFilter(e,t);break;case"clear-sort":this.clearColumnSort(e,t);break;case"column-resize-by-content":this.pubSubService.publish("onHeaderMenuColumnResizeByContent",{columnId:t.column.id});break;case"freeze-columns":this.freezeOrUnfreezeColumns(t.column,t.command);break;case"unfreeze-columns":this.freezeOrUnfreezeColumns(t.column,t.command);break;case"sort-asc":case"sort-desc":let i=t.command==="sort-asc";this.sortColumn(e,t,i);break;default:break}}createParentMenu(e,t,i){let o={grid:this.grid,column:t,menu:i};typeof e.stopPropagation=="function"&&(this.pubSubService.publish("onHeaderMenuBeforeMenuShow",o),typeof this.addonOptions?.onBeforeMenuShow=="function"&&this.addonOptions?.onBeforeMenuShow(e,o)===!1)||(this._menuElm=this.createCommandMenu(i.commandItems,t),this.grid.getContainerNode()?.appendChild(this._menuElm),this.repositionMenu(e,this._menuElm,void 0,this.addonOptions),this.pubSubService.publish("onHeaderMenuAfterMenuShow",o),!(typeof this.addonOptions?.onAfterMenuShow=="function"&&this.addonOptions?.onAfterMenuShow(e,o)===!1)&&(e.preventDefault(),e.stopPropagation()))}createCommandMenu(e,t,i=0,o){let r=o?.command,n=i===1&&r?r.replace(/\s/g,""):"";n&&(this._subMenuParentId=n),i>1&&(n=this._subMenuParentId);let a=`${this.menuCssClass} slick-menu-level-${i} ${this.gridUid}`,l=document.body.querySelector(`.${this.menuCssClass}.slick-menu-level-${i}${this.gridUidSelector}`);if(l){if(l.dataset.subMenuParent===n)return l;this.disposeSubMenus()}let d=p("div",{ariaExpanded:"true",ariaLabel:i>1?"SubMenu":"Header Menu",role:"menu",className:a,style:{minWidth:`${this.addonOptions.minWidth}px`}});i>0&&(d.classList.add("slick-submenu"),n&&(d.dataset.subMenuParent=n),this.gridOptions?.darkMode&&d.classList.add("slick-dark-mode"));let c=p("div",{className:`${this._menuCssPrefix}-command-list`,role:"menu"},d),h={grid:this.grid,column:t,level:i,menu:{commandItems:e}};return o&&i>0&&this.addSubMenuTitleWhenExists(o,c),this.populateCommandOrOptionItems("command",this.addonOptions,c,e,h,this.handleMenuItemCommandClick,this.handleMenuItemMouseOver),i++,d}resetHeaderMenuTranslations(e){e.forEach(t=>{if(t?.header?.menu?.commandItems&&!t.excludeFromHeaderMenu){let i=t.header.menu.commandItems||[];this.extensionUtility.translateMenuItemsFromTitleKey(i)}})}sortColumn(e,t,i=!0){if(t?.column){let o=t.column,r=this.sharedService.gridOptions.multiColumnSort?this.sortService.getCurrentColumnSorts(o.id+""):[],n="local";r.push({columnId:o.id,sortCol:o,sortAsc:i}),this.sharedService.gridOptions.backendServiceApi?(this.sortService.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:r,grid:this.sharedService.slickGrid}),n="remote"):this.sharedService.dataView?(this.sortService.onLocalSortChanged(this.sharedService.slickGrid,r),n="local"):t.grid.onSort.notify(r);let a=r.map(l=>({columnId:l?.sortCol?.id??"",sortAsc:l?.sortAsc??!0}));if(this.sharedService.slickGrid.setSortColumns(a),n){let l=[];a.forEach(d=>{l.push({columnId:`${d.columnId}`,direction:d.sortAsc?"ASC":"DESC"})}),this.sortService.emitSortChanged(n,l)}}}};var Or="slick-rbe-editmode",Km="slick-rbe-unsaved-cell",kc="slick-rbe-unsaved-highlight",Ma="action-btns--delete",Pa="action-btns--edit",Ha="action-btns--update",Va="action-btns--cancel",jo=class{constructor(e,t,i){this.extensionUtility=e,this.pubSubService=t,this.pluginName="RowBasedEdit",this._defaults={actionsColumnLabel:"Actions",allowMultipleRows:!1,columnId:"_slick_rowbasededit_action",columnIndexPosition:-1,reorderable:!1},this._editedRows=new Map,this._currentLang="en",this._translations={},this.onBeforeEditCellHandler=(o,r)=>this._editedRows.has(r.item?.[this.gridOptions.datasetIdPropertyName??"id"]),this._eventHandler=new G,this._addonOptions=i}get addonOptions(){return this._addonOptions}get gridOptions(){return this._grid.getOptions()||{}}get eventHandler(){return this._eventHandler}init(e,t){this._grid=e,this._gridService=t,this._addonOptions={...this._defaults,...this.addonOptions};let i=this._grid.getData();if(this._eventHandler.subscribe(this._grid.onBeforeEditCell,this.onBeforeEditCellHandler),this.checkOptionsRequirements(this.gridOptions),this.gridOptions.autoEdit||(this._grid.setOptions({autoEdit:!0}),console.warn('[Slickgrid-Universal] The Row Based Edit Plugin works best with the gridOption "autoEdit" enabled, the option has now been set automatically for you.')),this._existingEditCommandHandler=this.gridOptions.editCommandHandler,this._grid.setOptions({editCommandHandler:this.rowBasedEditCommandHandler.bind(this)}),this.gridOptions.enableExcelCopyBuffer===!0){let r=this.gridOptions.excelCopyBufferOptions?.onBeforePasteCell;this._grid.setOptions({excelCopyBufferOptions:{...this.gridOptions.excelCopyBufferOptions,onBeforePasteCell:(n,a)=>{let l=!0;if(r&&(l=r(n,a),l===!1))return!1;let d=i.getItem(a.row),c=this.gridOptions.datasetIdPropertyName??"id";return!!(this._editedRows.has(d[c])&&l===!0)}}})}let o=i.getItemMetadata;i.getItemMetadata=this.updateItemMetadata(o?.bind?.(i)),this._eventHandler.subscribe(this._grid.onSetOptions,this.optionsUpdatedHandler.bind(this)),this._eventHandler.subscribe(i.onRowsOrCountChanged,this.handleAllRowRerender.bind(this)),this.translate()}destroy(){this.dispose()}dispose(){this._eventHandler?.unsubscribeAll(),this.pubSubService?.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.rowBasedEditOptions},Array.isArray(e)&&t){let i=this.getColumnDefinition();if(!e.some(o=>o.id===i.id)){let o=t?.rowBasedEditOptions?.columnIndexPosition??-1;o===-1?e.push(i):o>0&&o<e.length?e.splice(o,0,i):e.unshift(i),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){return{id:String(this._addonOptions?.columnId??this._defaults.columnId),name:this._addonOptions?.actionsColumnLabel,field:"action",minWidth:70,width:75,maxWidth:75,excludeFromExport:!0,reorderable:this._addonOptions?.reorderable,formatter:this.actionColumnFormatter.bind(this),onCellClick:this.onCellClickHandler.bind(this),...this._addonOptions?.actionColumnConfig??{}}}rowBasedEditCommandHandler(e,t,i){this._existingEditCommandHandler&&this._existingEditCommandHandler(e,t,i);let o=Array.isArray(i.prevSerializedValue)?i.prevSerializedValue:[i.prevSerializedValue],r=Array.isArray(i.serializedValue)?i.serializedValue:[i.serializedValue],n=this._gridService?.getAllColumnDefinitions().filter(h=>h.editor!==void 0),a=[],l=this.gridOptions.datasetIdPropertyName??"id";o.forEach((h,u)=>{let m=o[u],g=r[u];if(m!==g||g===""){let f=Array.isArray(i.prevSerializedValue)?n?.[u]:t;if(!f)return;this._grid.invalidate(),i.execute(),this.renderUnsavedCellStyling(e[l],f),a.push(f)}});let d=this._editedRows.get(e[l]),c=[...d?.editCommands||[]];a.length>0&&c.push(i),this._editedRows.set(e[l],{columns:[...d?.columns||[],...a],editCommands:c,cssStyleKeys:d?.cssStyleKeys||[]})}translate(e=!1){return this._currentLang=this.extensionUtility.translaterService?.getCurrentLanguage()??"en",(!this._translations[this._currentLang]||e)&&(this._translations[this._currentLang]={btnUpdateTitle:this.getTitleOrDefault("updateButtonTitle","Update the row"),btnEditTitle:this.getTitleOrDefault("editButtonTitle","Edit the Row"),btnDeleteTitle:this.getTitleOrDefault("deleteButtonTitle","Delete the Row"),btnCancelTitle:this.getTitleOrDefault("cancelButtonTitle","Cancel changes of the Row")}),this._translations[this._currentLang]}checkOptionsRequirements(e){if(!e?.enableCellNavigation)throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption cell navigation (enableCellNavigation = true)");if(!e?.editable)throw new Error("[Slickgrid-Universal] Row Based Edit Plugin requires the gridOption editable (editable = true)")}undoRowEdit(e){let t=this.gridOptions.datasetIdPropertyName??"id",i=this._editedRows.get(e[t]),o=this._grid.getData().getRowByItem(e);if(o!==void 0&&i?.editCommands&&i.editCommands.length||Li.cancelCurrentEdit()){for(;i.editCommands.length>0;){let r=i.editCommands.pop();r&&r.undo()}i.columns.forEach(r=>{this.removeUnsavedStylingFromCell(r,o)}),i.columns=[],this._grid.invalidate()}}renderUnsavedCellStyling(e,t){if(t){let i=this._grid.getData()?.getRowById(e);if(i!==void 0&&i>=0){let o={[i]:{[t.id]:Km}},r=`${kc}_${[t.id]}${i}`;this._grid.setCellCssStyles(r,o),this._editedRows.get(e)?.cssStyleKeys.push(r)}}}handleAllRowRerender(e,t){this._editedRows.forEach((i,o)=>{i.cssStyleKeys.forEach(r=>{this._grid.removeCellCssStyles(r)}),i.cssStyleKeys=[],i.columns.forEach(r=>{this.renderUnsavedCellStyling(o,r)})})}removeUnsavedStylingFromCell(e,t){let i=`${kc}_${[e.id]}${t}`;this._grid.removeCellCssStyles(i)}removeUnsavedStylingFromRow(e){this._grid.getColumns().forEach(t=>{this.removeUnsavedStylingFromCell(t,e)})}optionsUpdatedHandler(e,t){this._addonOptions={...this._defaults,...t.optionsAfter.rowBasedEditOptions}}async onCellClickHandler(e,t){let i=t.dataContext,o=e.target,r=this.gridOptions.datasetIdPropertyName??"id",n=this._editedRows.get(i[r]);if((o.classList.contains(Ma)||o.parentElement?.classList.contains(Ma))&&this._gridService){if(this._addonOptions?.actionButtons?.deleteButtonPrompt&&!window.confirm(this._addonOptions.actionButtons.deleteButtonPrompt))return;this.toggleEditmode(i,!1),this._gridService.deleteItem(i)}else if(o.classList.contains(Pa)||o.parentElement?.classList.contains(Pa)){if(!this._addonOptions?.allowMultipleRows&&this._editedRows.size>0)return;typeof this._addonOptions?.onBeforeEditMode=="function"&&this._addonOptions.onBeforeEditMode(t),this.toggleEditmode(i,!0)}else if(o.classList.contains(Ha)||o.parentElement?.classList.contains(Ha)){if(this._addonOptions?.actionButtons?.updateButtonPrompt&&(n?.editCommands.length||0)>0&&!window.confirm(this._addonOptions.actionButtons.updateButtonPrompt)||(this._grid.getCellEditor()&&this._grid.getActiveCell()?.row===t.row&&this._grid.getEditController()?.commitCurrentEdit(),this._addonOptions?.onBeforeRowUpdated&&await this._addonOptions.onBeforeRowUpdated(t)!==!0))return;this.removeUnsavedStylingFromRow(t.row),this.toggleEditmode(i,!1)}else if(o.classList.contains(Va)||o.parentElement?.classList.contains(Va)){if(this._addonOptions?.actionButtons?.cancelButtonPrompt&&(n?.editCommands.length||0)>0&&!window.confirm(this._addonOptions.actionButtons.cancelButtonPrompt))return;this.undoRowEdit(i),this.toggleEditmode(i,!1)}}actionColumnFormatter(e,t,i,o,r){let n=this.gridOptions,a=this._editedRows.has(r?.[n.datasetIdPropertyName??"id"]),l=this._translations[this._currentLang]??this.translate(),d=document.createDocumentFragment();return d.appendChild(p("span",{className:`${n.rowBasedEditOptions?.actionButtons?.editButtonClassName||"button-style padding-1px mr-2"} action-btns `+Pa,title:l.btnEditTitle,style:{display:a?"none":""}})).appendChild(p("span",{className:n.rowBasedEditOptions?.actionButtons?.iconEditButtonClassName||"mdi mdi-table-edit color-primary"})),d.appendChild(p("span",{className:`${n.rowBasedEditOptions?.actionButtons?.deleteButtonClassName||"button-style padding-1px"} action-btns `+Ma,title:l.btnDeleteTitle,style:{display:a?"none":""}})).appendChild(p("span",{className:n.rowBasedEditOptions?.actionButtons?.iconDeleteButtonClassName||"mdi mdi-close color-danger"})),d.appendChild(p("span",{className:`${n.rowBasedEditOptions?.actionButtons?.updateButtonClassName||"button-style padding-1px mr-2"} action-btns `+Ha,title:l.btnUpdateTitle,style:{display:a?"":"none"}})).appendChild(p("span",{className:n.rowBasedEditOptions?.actionButtons?.iconUpdateButtonClassName||"mdi mdi-check-bold color-success"})),d.appendChild(p("span",{className:`${n.rowBasedEditOptions?.actionButtons?.cancelButtonClassName||"button-style padding-1px"} action-btns `+Va,title:l.btnCancelTitle,style:{display:a?"":"none"}})).appendChild(p("span",{className:n.rowBasedEditOptions?.actionButtons?.iconCancelButtonClassName||"mdi mdi-cancel color-danger"})),d}toggleEditmode(e,t){let i=this.gridOptions.datasetIdPropertyName??"id";t?this._editedRows.set(e[i],{columns:[],editCommands:[],cssStyleKeys:[]}):this._editedRows.delete(e[i]),this._grid.invalidate()}updateItemMetadata(e){return t=>{let i=this._grid.getData().getItem(t),o={cssClasses:""};if(typeof e=="function"){let r=e(t);r&&(o=r)}if(o&&i){let r=this.gridOptions.datasetIdPropertyName??"id";this._editedRows.has(i[r])&&!o.cssClasses.includes(Or)?o.cssClasses=(o.cssClasses||"")+" "+Or:!this._editedRows.has(i[r])&&o.cssClasses.includes(Or)&&(o.cssClasses=o.cssClasses.replace(Or,""))}return o}}getTitleOrDefault(e,t){let i=this.gridOptions.rowBasedEditOptions?.actionButtons;return i?.[e+"Key"]&&this.extensionUtility.translaterService?.translate?.(i?.[e+"Key"]||"")||i?.[e]||t}};var Yo=class{constructor(e){this.pubSubService=e,this.pluginName="RowMoveManager",this._dragging=!1,this._defaults={autoScroll:!0,columnId:"_move",cssClass:"slick-row-move-column",cancelEditOnDrag:!1,disableRowSelection:!1,hideRowMoveShadow:!0,reorderable:!1,rowMoveShadowMarginTop:0,rowMoveShadowMarginLeft:0,rowMoveShadowOpacity:.9,rowMoveShadowScale:.75,singleRowMove:!1,width:44},this.onBeforeMoveRows=new R("onBeforeMoveRows"),this.onMoveRows=new R("onMoveRows"),this._eventHandler=new G}get addonOptions(){return this._addonOptions}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}init(e,t){this._addonOptions={...this._defaults,...t},this._grid=e,this._canvas=this._grid.getCanvasNode(),w.addSlickEventPubSubWhenDefined(this.pubSubService,this),typeof this._addonOptions?.usabilityOverride=="function"&&this.usabilityOverride(this._addonOptions.usabilityOverride),this._eventHandler.subscribe(this._grid.onDragInit,this.handleDragInit.bind(this)).subscribe(this._grid.onDragStart,this.handleDragStart.bind(this)).subscribe(this._grid.onDrag,this.handleDrag.bind(this)).subscribe(this._grid.onDragEnd,this.handleDragEnd.bind(this))}dispose(){this._eventHandler?.unsubscribeAll()}create(e,t){if(this._addonOptions={...this._defaults,...t.rowMoveManager},Array.isArray(e)&&t){let i=this.getColumnDefinition();if(!e.some(o=>o.id===i.id)){let o=Array.isArray(e)&&e.find(a=>a?.behavior==="selectAndMove"),r=o||i,n=t?.rowMoveManager?.columnIndexPosition??0;n>0?e.splice(n,0,r):e.unshift(r),this.pubSubService.publish("onPluginColumnsChanged",{columns:e,pluginName:this.pluginName})}}return this}getColumnDefinition(){let e=String(this._addonOptions?.columnId??this._defaults.columnId),t=this._addonOptions.width||this._defaults.width;return{id:e,name:"",behavior:"selectAndMove",excludeFromExport:!0,excludeFromColumnPicker:!0,excludeFromGridMenu:!0,excludeFromQuery:!0,excludeFromHeaderMenu:!0,field:e,reorderable:this._addonOptions.reorderable,resizable:!1,width:t,minWidth:t,maxWidth:t,formatter:this.moveIconFormatter.bind(this)}}usabilityOverride(e){this._usabilityOverride=e}setOptions(e){this._addonOptions={...this._addonOptions,...e}}handleDragInit(e){e.stopImmediatePropagation()}handleDragEnd(e,t){if(this._dragging&&(this._dragging=!1,e.stopImmediatePropagation(),t.guide?.remove(),t.selectionProxy?.remove(),t.clonedSlickRow?.remove(),t.canMove)){let i={grid:this._grid,rows:t.selectedRows,insertBefore:t.insertBefore};typeof this._addonOptions.onMoveRows=="function"&&this._addonOptions.onMoveRows(e instanceof U?e.getNativeEvent():e,i),this.onMoveRows.notify(i)}}handleDrag(e,t){if(this._dragging){e.stopImmediatePropagation();let i=e.getNativeEvent(),r=(i?.touches?.[0]??i).pageY-_e(this._canvas).top;t.selectionProxy.style.top=`${r-5}px`,t.selectionProxy.style.display="block",t.clonedSlickRow&&(t.clonedSlickRow.style.top=`${r-6}px`,t.clonedSlickRow.style.display="block");let n=Math.max(0,Math.min(Math.round(r/(this.gridOptions.rowHeight||0)),this._grid.getDataLength()));if(n!==t.insertBefore){let a={grid:this._grid,rows:t.selectedRows,insertBefore:n};if(t.canMove=!(this._addonOptions?.onBeforeMoveRows?.(i,a)===!1||this.onBeforeMoveRows.notify(a).getReturnValue()===!1),this._usabilityOverride&&t.canMove){let l=this._grid.getDataItem(n);t.canMove=this.checkUsabilityOverride(n,l,this._grid)}t.canMove?t.guide.style.top=`${n*(this.gridOptions.rowHeight||0)}px`:t.guide.style.top="-1000px",t.insertBefore=n}}}handleDragStart(e,t){let i=this._grid.getCellFromEvent(e)||{cell:-1,row:-1},o=i.row,r=this._grid.getDataItem(o);if(this.checkUsabilityOverride(o,r,this._grid)){if(this._addonOptions.cancelEditOnDrag&&this._grid.getEditorLock().isActive()&&this._grid.getEditorLock().cancelCurrentEdit(),this._grid.getEditorLock().isActive()||!/move|selectAndMove/.test(this._grid.getColumns()[i.cell].behavior||""))return!1;if(this._dragging=!0,e.stopImmediatePropagation(),!this.addonOptions.hideRowMoveShadow){let l=this._grid.getCellNode(i.row,i.cell)?.closest(".slick-row");l&&(t.clonedSlickRow=l.cloneNode(!0),t.clonedSlickRow.classList.add("slick-reorder-shadow-row"),t.clonedSlickRow.style.display="none",t.clonedSlickRow.style.marginLeft=pt(this._addonOptions?.rowMoveShadowMarginLeft,"0px"),t.clonedSlickRow.style.marginTop=pt(this._addonOptions?.rowMoveShadowMarginTop,"0px"),t.clonedSlickRow.style.opacity=`${this._addonOptions?.rowMoveShadowOpacity??.95}`,t.clonedSlickRow.style.transform=`scale(${this.addonOptions?.rowMoveShadowScale??.75})`,this._canvas.appendChild(t.clonedSlickRow))}let n=this._addonOptions.singleRowMove?[i.row]:this._grid.getSelectedRows();(n.length===0||!n.some(l=>l===i.row))&&(n=[i.row],this._addonOptions.disableRowSelection||this._grid.setSelectedRows(n));let a=this.gridOptions.rowHeight;t.selectedRows=n,t.selectionProxy=p("div",{className:"slick-reorder-proxy",style:{display:"none",position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,height:`${a*n.length}px`}},this._canvas),t.guide=p("div",{className:"slick-reorder-guide",style:{position:"absolute",zIndex:"99999",width:`${this._canvas.clientWidth}px`,top:"-1000px"}},this._canvas),t.insertBefore=-1}}checkUsabilityOverride(e,t,i){return typeof this._usabilityOverride=="function"?this._usabilityOverride(e,t,i):!0}moveIconFormatter(e,t,i,o,r,n){return this.checkUsabilityOverride(e,r,n)?{addClasses:"cell-reorder dnd",html:p("div",{className:this._addonOptions.cssClass||""})}:""}};var Rr=class{get extensionList(){return this._extensionList}get gridOptions(){return this.sharedService.gridOptions||{}}constructor(e,t,i,o,r,n,a,l){this.extensionUtility=e,this.filterService=t,this.pubSubService=i,this.sharedService=o,this.sortService=r,this.treeDataService=n,this.translaterService=a,this.lazyGridService=l,this._extensionCreatedList={},this._extensionList={},this._requireInitExternalExtensions=[]}dispose(){if(this.sharedService.visibleColumns=[],typeof this._extensionList=="object"){let e=Object.keys(this._extensionList);e.forEach(t=>{if(this._extensionList.hasOwnProperty(t)){let i=this._extensionList[t];typeof i?.instance?.dispose=="function"&&i.instance.dispose()}}),e.forEach(t=>{delete this._extensionList[t]})}this._cellMenuPlugin=null,this._cellExcelCopyManagerPlugin=null,this._checkboxSelectColumn=null,this._contextMenuPlugin=null,this._columnPickerControl=null,this._draggleGroupingPlugin=null,this._gridMenuControl=null,this._groupItemMetadataProviderService=null,this._headerMenuPlugin=null,this._rowMoveManagerPlugin=null,this._rowSelectionModel=null,this._extensionCreatedList=null,this._extensionList={}}addExtensionToList(e,t){this._extensionList[e]=t}getAllColumns(){return this.sharedService.allColumns||[]}getVisibleColumns(){return this.sharedService.visibleColumns||[]}getCreatedExtensionByName(e){if(this._extensionCreatedList?.hasOwnProperty(e))return this._extensionCreatedList[e]}getExtensionByName(e){return this._extensionList?.[e]}getExtensionInstanceByName(e){return this.getExtensionByName(e)?.instance}autoResizeColumns(){this.sharedService.slickGrid.autosizeColumns()}bindDifferentExtensions(){if(this.gridOptions){if(this.gridOptions.enableTranslate&&this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.gridOptions.enableRowBasedEdit){this._rowBasedEdit=this._rowBasedEdit||new jo(this.extensionUtility,this.pubSubService,this.gridOptions.rowBasedEditOptions);let e=this.lazyGridService?.();if(!e)throw new Error("[Slickgrid-Universal] the RowBasedEdit Plugin requires a GridService to be configured and available");this._rowBasedEdit.init(this.sharedService.slickGrid,e),this.gridOptions.rowBasedEditOptions?.onExtensionRegistered&&this.gridOptions.rowBasedEditOptions.onExtensionRegistered(this._rowBasedEdit),this._extensionList[Q.rowBasedEdit]={name:Q.rowBasedEdit,instance:this._rowBasedEdit}}if(this.gridOptions.enableAutoTooltip){let e=new mr(this.gridOptions?.autoTooltipOptions);this.sharedService.slickGrid.registerPlugin(e),this._extensionList[Q.autoTooltip]={name:Q.autoTooltip,instance:e}}if(this.gridOptions.enableExcelCopyBuffer&&(this._cellExcelCopyManagerPlugin=new pr,this._cellExcelCopyManagerPlugin.init(this.sharedService.slickGrid,this.sharedService.gridOptions.excelCopyBufferOptions),this.gridOptions.excelCopyBufferOptions?.onExtensionRegistered&&this.gridOptions.excelCopyBufferOptions.onExtensionRegistered(this._cellExcelCopyManagerPlugin),this._extensionList[Q.cellExternalCopyManager]={name:Q.cellExternalCopyManager,instance:this._cellExcelCopyManagerPlugin}),this.gridOptions.enableCellMenu&&(this._cellMenuPlugin=new br(this.extensionUtility,this.pubSubService,this.sharedService),this.gridOptions.cellMenu?.onExtensionRegistered&&this.gridOptions.cellMenu.onExtensionRegistered(this._cellMenuPlugin),this._extensionList[Q.cellMenu]={name:Q.cellMenu,instance:this._cellMenuPlugin}),!this._rowSelectionModel&&(this.gridOptions.enableRowSelection||this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowDetailView||this.gridOptions.enableRowMoveManager)){if(!this._rowSelectionModel||!this.sharedService.slickGrid.getSelectionModel()){let e=this.gridOptions.rowSelectionOptions??{};this.gridOptions.enableRowMoveManager&&this.gridOptions.rowMoveManager?.dragToSelect!==!1&&(e.dragToSelect=!0),this._rowSelectionModel=new Qt(e),this.sharedService.slickGrid.setSelectionModel(this._rowSelectionModel)}this._extensionList[Q.rowSelection]={name:Q.rowSelection,instance:this._rowSelectionModel}}if(this.gridOptions.enableCheckboxSelector){this._checkboxSelectColumn=this._checkboxSelectColumn||new Uo(this.pubSubService,this.gridOptions.checkboxSelector),this._checkboxSelectColumn.init(this.sharedService.slickGrid);let t=this.getCreatedExtensionByName(Q.checkboxSelector)?.instance;t&&(this.gridOptions.checkboxSelector?.onExtensionRegistered&&this.gridOptions.checkboxSelector.onExtensionRegistered(t),this._extensionList[Q.checkboxSelector]={name:Q.checkboxSelector,instance:this._checkboxSelectColumn})}if(this.gridOptions.enableColumnPicker&&(this._columnPickerControl=new Vi(this.extensionUtility,this.pubSubService,this.sharedService),this.gridOptions.columnPicker?.onExtensionRegistered&&this.gridOptions.columnPicker.onExtensionRegistered(this._columnPickerControl),this._extensionList[Q.columnPicker]={name:Q.columnPicker,instance:this._columnPickerControl}),this.gridOptions.enableContextMenu&&(this._contextMenuPlugin=new yr(this.extensionUtility,this.pubSubService,this.sharedService,this.treeDataService),this.gridOptions.contextMenu?.onExtensionRegistered&&this.gridOptions.contextMenu.onExtensionRegistered(this._contextMenuPlugin),this._extensionList[Q.contextMenu]={name:Q.contextMenu,instance:this._contextMenuPlugin}),this.gridOptions.enableDraggableGrouping&&(this._draggleGroupingPlugin&&(this._draggleGroupingPlugin.init(this.sharedService.slickGrid,this.gridOptions.draggableGrouping),this.gridOptions.draggableGrouping?.onExtensionRegistered&&this.gridOptions.draggableGrouping.onExtensionRegistered(this._draggleGroupingPlugin),this._extensionList[Q.contextMenu]={name:Q.contextMenu,instance:this._draggleGroupingPlugin}),this._extensionList[Q.draggableGrouping]={name:Q.draggableGrouping,instance:this._draggleGroupingPlugin}),this.gridOptions.enableGridMenu&&(this._gridMenuControl=new mo(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),this.gridOptions.gridMenu?.onExtensionRegistered&&this.gridOptions.gridMenu.onExtensionRegistered(this._gridMenuControl),this._extensionList[Q.gridMenu]={name:Q.gridMenu,instance:this._gridMenuControl}),this.gridOptions.enableHeaderButton){let e=new Sr(this.extensionUtility,this.pubSubService,this.sharedService);this.gridOptions.headerButton?.onExtensionRegistered&&this.gridOptions.headerButton.onExtensionRegistered(e),this._extensionList[Q.headerButton]={name:Q.headerButton,instance:e}}this.gridOptions.enableHeaderMenu&&(this._headerMenuPlugin=new Tr(this.extensionUtility,this.filterService,this.pubSubService,this.sharedService,this.sortService),this.gridOptions.headerMenu?.onExtensionRegistered&&this.gridOptions.headerMenu.onExtensionRegistered(this._headerMenuPlugin),this._extensionList[Q.headerMenu]={name:Q.headerMenu,instance:this._headerMenuPlugin}),this.gridOptions.enableRowMoveManager&&(this._rowMoveManagerPlugin=this._rowMoveManagerPlugin||new Yo(this.pubSubService),this._rowMoveManagerPlugin.init(this.sharedService.slickGrid,this.gridOptions.rowMoveManager),this.getCreatedExtensionByName(Q.rowMoveManager)?.instance&&(this._extensionList[Q.rowMoveManager]={name:Q.rowMoveManager,instance:this._rowMoveManagerPlugin})),this._requireInitExternalExtensions.length&&this._requireInitExternalExtensions.forEach(e=>{e.instance.init(this.sharedService.slickGrid,void 0)})}}createExtensionsBeforeGridCreation(e,t){let i=[];t.enableCheckboxSelector&&(this.getCreatedExtensionByName(Q.checkboxSelector)||(this._checkboxSelectColumn=new Uo(this.pubSubService,this.sharedService.gridOptions.checkboxSelector),i.push({name:Q.checkboxSelector,instance:this._checkboxSelectColumn,columnIndexPosition:t?.checkboxSelector?.columnIndexPosition??i.length}))),t.enableRowMoveManager&&(this.getCreatedExtensionByName(Q.rowMoveManager)||(this._rowMoveManagerPlugin=new Yo(this.pubSubService),i.push({name:Q.rowMoveManager,instance:this._rowMoveManagerPlugin,columnIndexPosition:t?.rowMoveManager?.columnIndexPosition??i.length}))),t.enableRowBasedEdit&&(this.getCreatedExtensionByName(Q.rowBasedEdit)||(this._rowBasedEdit=new jo(this.extensionUtility,this.pubSubService),i.push({name:Q.rowBasedEdit,instance:this._rowBasedEdit,columnIndexPosition:t?.rowMoveManager?.columnIndexPosition??i.length}))),t.preRegisterExternalExtensions&&t.preRegisterExternalExtensions(this.pubSubService).forEach(r=>{i.push(r),this._requireInitExternalExtensions.push(r),this._extensionList[r.name]||this.addExtensionToList(r.name,r)}),this.createExtensionByTheirColumnIndex(i,e,t),t.enableDraggableGrouping&&(this.getCreatedExtensionByName(Q.draggableGrouping)||(this._draggleGroupingPlugin=new Er(this.extensionUtility,this.pubSubService,this.sharedService),this._draggleGroupingPlugin&&(t.enableColumnReorder=this._draggleGroupingPlugin.setupColumnReorder.bind(this._draggleGroupingPlugin),this._extensionCreatedList[Q.draggableGrouping]={name:Q.draggableGrouping,instance:this._draggleGroupingPlugin})))}hideColumn(e){if(typeof this.sharedService?.slickGrid?.getColumns=="function"){let t=this.sharedService.slickGrid.getColumnIndex(e.id);this.sharedService.visibleColumns=this.removeColumnByIndex(this.sharedService.slickGrid.getColumns(),t),this.sharedService.slickGrid.setColumns(this.sharedService.visibleColumns)}}refreshBackendDataset(e){this.extensionUtility.refreshBackendDataset(e)}removeColumnByIndex(e,t){return Array.isArray(e)?e.filter((i,o)=>t!==o):e}translateAllExtensions(e){this.translateCellMenu(),this.translateContextMenu(),this.translateHeaderMenu(),this.translateRowEditPlugin(),this.translateColumnHeaders(e)}translateCellMenu(){this._cellMenuPlugin?.translateCellMenu()}translateColumnPicker(){this._columnPickerControl?.translateColumnPicker()}translateContextMenu(){this._contextMenuPlugin?.translateContextMenu()}translateGridMenu(){this._gridMenuControl?.translateGridMenu()}translateHeaderMenu(){this._headerMenuPlugin?.translateHeaderMenu()}translateRowEditPlugin(){this._rowBasedEdit?.translate()}translateColumnHeaders(e,t){if(this.sharedService&&this.gridOptions&&this.gridOptions.enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');e&&this.translaterService?.use&&this.translaterService.getCurrentLanguage()!==e&&this.translaterService.use(e);let i=t;i||(i=this.sharedService.columnDefinitions),this.translateItems(i,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"nameKey","name"),this.translateItems(this.sharedService.allColumns,"columnGroupKey","columnGroup"),this.renderColumnHeaders(i,Array.isArray(t))}renderColumnHeaders(e,t=!1){let i=e;i||(i=this.sharedService.columnDefinitions),Array.isArray(i)&&this.sharedService.slickGrid?.setColumns&&((i.length>this.sharedService.allColumns.length||t)&&(this.sharedService.allColumns=i),this.sharedService.slickGrid.setColumns(i)),this.gridOptions.enableColumnPicker&&this._columnPickerControl&&(this._columnPickerControl.columns=this.sharedService.allColumns,this._columnPickerControl.translateColumnPicker()),this.gridOptions.enableGridMenu&&this._gridMenuControl&&(this._gridMenuControl.columns=this.sharedService.allColumns??[],this._gridMenuControl.recreateGridMenu(),this._gridMenuControl.translateGridMenu())}createExtensionByTheirColumnIndex(e,t,i){e.sort((o,r)=>(o?.columnIndexPosition??0)-(r?.columnIndexPosition??0)),e.forEach(o=>{let r=o.instance.create(t,i);r&&(this._extensionCreatedList[o.name]={name:o.name,instance:r})})}translateItems(e,t,i){if(this.gridOptions?.enableTranslate&&!this.translaterService?.translate)throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.extensionUtility.translateItems(e,t,i)}};var Cc=Object.prototype.hasOwnProperty;function lt(s,e){var t,i;if(s===e)return!0;if(s&&e&&(t=s.constructor)===e.constructor){if(t===Date)return s.getTime()===e.getTime();if(t===RegExp)return s.toString()===e.toString();if(t===Array){if((i=s.length)===e.length)for(;i--&&lt(s[i],e[i]););return i===-1}if(!t||typeof s=="object"){i=0;for(t in s)if(Cc.call(s,t)&&++i&&!Cc.call(e,t)||!(t in e)||!lt(s[t],e[t]))return!1;return Object.keys(e).length===i}}return s!==s&&e!==e}function Fa(s,e,t){if(t&&(s?.hasOwnProperty(t)||e?.hasOwnProperty(t)))return s[t]===e||s===e[t]||s[t]===e[t];if(typeof s=="object"&&typeof e=="object"&&Object.keys(s).length!==Object.keys(e).length)return!1;for(let i in s)if(s.hasOwnProperty(i)&&s[i]!==e[i])return!1;return!0}function _c(s){switch(s?.toUpperCase()||""){case"IN":case"NIN":case"NOT_IN":case"IN_CONTAINS":case"NIN_CONTAINS":case"NOT_IN_CONTAINS":case"IN_COLLECTION":case"NOT_IN_COLLECTION":return!0;default:return!1}}var xt=(s,e,t)=>{switch(s.toUpperCase()){case"<":case"LT":return e<t;case"<=":case"LE":return e<=t;case">":case"GT":return e>t;case">=":case"GE":return e>=t;case"!=":case"<>":case"NE":return e!==t;case"=":case"==":case"EQ":return e===t;case"IN":return t&&Array.isArray(t)?t.includes(e):!1;case"NIN":case"NOT_IN":return t&&Array.isArray(t)?!t.includes(e):!1;case"IN_CONTAINS":return t&&Array.isArray(t)&&typeof e=="string"?t.some(i=>e.split(/[,]+/).map(o=>o.trim()).includes(i)):!1;case"NIN_CONTAINS":case"NOT_IN_CONTAINS":return t&&Array.isArray(t)&&typeof e=="string"?!t.some(i=>e.split(/[,]+/).map(o=>o.trim()).includes(i)):!1;case"IN_COLLECTION":return e&&t&&Array.isArray(e)&&Array.isArray(t)?t.some(i=>e.includes(i)):!1;case"NOT_IN_COLLECTION":return e&&t&&Array.isArray(e)&&Array.isArray(t)?!t.some(i=>e.includes(i)):!1}return!0};var za=(s,e)=>{let[t,i]=e;if(t===void 0&&!s.operator)return!0;s.cellValue=s.cellValue===void 0||s.cellValue===null?"":s.cellValue.toString();let o=s?.ignoreAccentOnStringFilterAndSort?si(s.cellValue,!0):s.cellValue.toLowerCase();if(typeof t=="string"&&(t=s?.ignoreAccentOnStringFilterAndSort?si(t,!0):t.toLowerCase()),typeof i=="string"&&(i=s?.ignoreAccentOnStringFilterAndSort?si(i,!0):i.toLowerCase()),s.operator===N.startsWithEndsWith&&t!==void 0&&i!==void 0)return Xm(o,[t,i]);if(t!==void 0&&i!==void 0){let n=s?.operator??s.defaultFilterRangeOperator;n!==N.rangeInclusive&&n!==N.rangeExclusive&&(n=s.defaultFilterRangeOperator);let a=n===N.rangeInclusive,l=Na(a?">=":">",o,t,s.searchInputLastChar),d=Na(a?"<=":"<",o,i,s.searchInputLastChar);return l&&d}return Na(s.operator,o,t,s.searchInputLastChar)};function xc(s){let t=Array.isArray(s)&&s||[""],i=[],o,r;if(t.length===1&&typeof t[0]=="string"){let n=t[0];n.indexOf("..")>0?t=n.split(".."):n.indexOf("*")>0&&n.indexOf("*")<n.length-1&&(t=n.split("*"))}if(t.length===2)o=`${t[0]}`,r=`${t[1]}`;else{let n=Array.isArray(s)&&s.length>0?s[0]:"";o=n==null?"":`${n}`}return o!==void 0&&r!==void 0?i.push(o,r):o!==void 0&&i.push(o),i}function Na(s,e,t,i){return s==="*"||s===N.endsWith||s==="*z"?e.endsWith(t):s===""&&i==="*"||s===N.startsWith||s==="a*"?e.startsWith(t):s===""||s===N.contains?e.indexOf(t)>-1:s==="<>"||s===N.notContains?e.indexOf(t)===-1:xt(s||"==",e,t)}function Xm(s,[e,t]){return s.startsWith(e)&&s.endsWith(t)}var yc=(s,e)=>{if(e===void 0&&!s.operator)return!0;switch((s.operator||"").toUpperCase()){case"!=":case"<>":case"NE":return!Fa(s.cellValue,e,s.dataKey);case"=":case"==":case"EQ":default:return Fa(s.cellValue,e,s.dataKey)}};function Ec(s){return(Array.isArray(s)&&s.length>0?s[0]:"")||""}var Ba=(s,e)=>{let t=parseFloat(s.cellValue),[i,o]=e;if(i===void 0&&!s.operator)return!0;if(i!==void 0&&o!==void 0){let r=s?.operator??s.defaultFilterRangeOperator;r!==N.rangeInclusive&&r!==N.rangeExclusive&&(r=s.defaultFilterRangeOperator);let n=r===N.rangeInclusive,a=xt(n?">=":">",t,+i),l=xt(n?"<=":"<",t,+o);return a&&l}return xt(s.operator||"==",t,+i)};function Sc(s){let t=Array.isArray(s)&&s||[0],i=[],o,r;if(t.length===2||typeof t[0]=="string"&&t[0].indexOf("..")>0){let n=t.length===2?t:t[0].split("..");o=parseFloat(Array.isArray(n)?n[0]:""),r=parseFloat(Array.isArray(n)?n[1]:"")}else o=parseFloat(t[0]);return Z(o,!0)&&Z(r,!0)?i.push(o,r):Z(o,!0)&&i.push(o),i}var $a=(s,e)=>So(s.cellValue)===So(e);function Tc(s){let e=Array.isArray(s)&&s[0]||!1;return So(e)}var Wa=s=>{let e=s.operator,t;return Array.isArray(s.cellValue)&&(e==="IN_COLLECTION"||e==="NOT_IN_COLLECTION")?t=s.cellValue.length?s.cellValue.map(i=>`${i}`):[]:t=s.cellValue===void 0||s.cellValue===null?"":`${s.cellValue}`,xt(e||"IN",t,s.searchTerms||[])};function Oc(s,e){let t=s&&(s.filterSearchType||s.fieldType)||_.dateIso,i=Le(t),[o,r]=e,n=nt(s.cellValue,i,!0);if(!o&&!r||!n)return!1;let a=i==="ISO8601"||i.toLowerCase().includes("h")?n.valueOf():Es(new Date(n)).valueOf();if(o&&r){let d=s?.operator??s.defaultFilterRangeOperator;d!==N.rangeInclusive&&d!==N.rangeExclusive&&(d=s.defaultFilterRangeOperator);let c=d===N.rangeInclusive,h=xt(c?">=":">",a,o.valueOf()),u=xt(c?"<=":"<",a,r.valueOf());return h&&u}let l=i==="ISO8601"||i.toLowerCase().includes("h")?o.valueOf():Es(new Date(o)).valueOf();return xt(s.operator||"==",a,l)}function Rc(s,e){let t=Array.isArray(s)&&s||[],i=e||_.dateIso,o=Le(i),r=[];if(t.length===2||typeof t[0]=="string"&&t[0].indexOf("..")>0){let n=t.length===2?t:t[0].split(".."),a=Array.isArray(n)&&n[0]||"",l=Array.isArray(n)&&n[1]||"",d=nt(a,o,!0),c=nt(l,o,!0);if(!d||!c)return[];r.push(d,c)}else{let n=nt(t[0],o,!0);if(!n)return[];r.push(n)}return r}function qo(s,e){let t=Ga(e),i;switch(t){case"boolean":i=Tc(s);break;case"date":i=Rc(s,e);break;case"number":i=Sc(s);break;case"object":i=Ec(s);break;case"string":i=xc(s);break}return i}function Ga(s){if(ut(s))return"date";switch(s){case _.boolean:return"boolean";case _.integer:case _.float:case _.number:return"number";case _.object:return"object";case _.string:case _.text:case _.password:case _.readonly:default:return"string"}}var Zm=(s,e)=>{if(_c(s.operator))return Wa(s);switch(Ga(s.filterSearchType||s.fieldType)){case"boolean":return $a(s,e);case"date":return Oc(s,e||[]);case"number":return Ba(s,e||[]);case"object":return yc(s,e);case"string":default:return za(s,e||[])}},Ua={executeFilterConditionTest:Zm,booleanFilter:$a,collectionSearchFilter:Wa,numberFilter:Ba,stringFilter:za};var Ar=class{constructor(e,t,i,o){this.config=e,this.translaterService=t,this.collectionService=i,this.rxjs=o,this._options=this.config?.options??{}}addRxJsResource(e){this.rxjs=e}createFilter(e){let t;return e?.model&&(t=typeof e.model=="function"?new e.model(this.translaterService,this.collectionService,this.rxjs):e.model),!t&&this._options.defaultFilter&&(t=new this._options.defaultFilter(this.translaterService,this.collectionService,this.rxjs)),t}};var Lr=class{constructor(e,t,i,o,r){this.filterFactory=e,this.pubSubService=t,this.sharedService=i,this.backendUtilities=o,this.rxjs=r,this._isFilterFirstRender=!0,this._firstColumnIdRendered="",this._filtersMetadata=[],this._columnFilters={},this._isTreePresetExecuted=!1,this._previousFilters=[],this._onSearchChange=new R,this._eventHandler=new G,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get isFilterFirstRender(){return this._isFilterFirstRender}get onSearchChange(){return this._onSearchChange}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}get _dataView(){return this._grid?.getData()??{}}addRxJsResource(e){this.rxjs=e}init(e){this._grid=e,this._gridOptions&&this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions&&this._grid.setSortColumns([{columnId:this._gridOptions.treeDataOptions.columnId,sortAsc:!0}])}dispose(){this._eventHandler.unsubscribeAll(),this.httpCancelRequests$&&this.rxjs?.isObservable(this.httpCancelRequests$)&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete()),this.disposeColumnFilters(),this._onSearchChange=null}disposeColumnFilters(){if(this.removeAllColumnFiltersProperties(),Array.isArray(this._filtersMetadata)){let e=this._filtersMetadata.pop();for(;e;)typeof e?.destroy=="function"&&e.destroy(),e=this._filtersMetadata.pop()}}bindBackendOnFilter(e){this._filtersMetadata=[],this._eventHandler.subscribe(e.onHeaderRowCellRendered,(t,i)=>{i.column.id===this._firstColumnIdRendered&&(this._isFilterFirstRender=!1),this.addFilterTemplateToHeaderRow(i,this._isFilterFirstRender),this._firstColumnIdRendered===""&&(this._firstColumnIdRendered=i.column.id)}),this.subscribeToOnHeaderRowCellRendered(e),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,this.onBackendFilterChange.bind(this))}bindLocalOnFilter(e){this._filtersMetadata=[],this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid,dataView:this._dataView}),this._dataView.setFilter(this.customLocalFilter.bind(this)),this._onSearchChange&&this._eventHandler.subscribe(this._onSearchChange,async(t,i)=>{let o=i?.clearFilterTriggered??!1;o||await this.emitFilterChanged("local",!0),this._gridOptions.enableTreeData===!0&&(this._tmpPreFilteredData=this.preFilterTreeData(this._dataView.getItems(),this._columnFilters)),o||await this.emitFilterChanged("local"),i.columnId!==null&&this._dataView.refresh(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)}),this._eventHandler.subscribe(e.onHeaderRowCellRendered,(t,i)=>{this.addFilterTemplateToHeaderRow(i)}),this.subscribeToOnHeaderRowCellRendered(e)}async clearFilterByColumnId(e,t){await this.pubSubService.publish("onBeforeFilterClear",{columnId:t},0);let i=this._gridOptions.backendServiceApi??!1,o=i?"remote":"local",r=Object.keys(this._columnFilters),n;Array.isArray(r)&&(n=r.find(l=>l===`${t}`));let a=this._filtersMetadata.find(l=>l.columnDef.id===t);return a?.clear&&a.clear(!0),i&&n!==void 0&&this.onBackendFilterChange(e,{grid:this._grid,columnFilters:this._columnFilters}),await this.emitFilterChanged(o),!0}async clearFilters(e=!0){e&&await this.pubSubService.publish("onBeforeFilterClear",!0,0),this._filtersMetadata.forEach(i=>{i?.clear&&i.clear(!1)}),this.removeAllColumnFiltersProperties(),Array.isArray(this._columnDefinitions)&&this._columnDefinitions.forEach(i=>{i.filter?.searchTerms&&delete i.filter.searchTerms}),this._dataView&&this._grid&&(this._dataView.refresh(),this._grid.invalidate());let t=this._gridOptions.backendServiceApi;if(t&&e){let i={clearFilterTriggered:!0,shouldTriggerQuery:e,grid:this._grid,columnFilters:this._columnFilters},r=t.service.processOnFilterChanged(void 0,i),n=this._gridOptions.pagination?.totalItems??0;this.backendUtilities?.executeBackendCallback(t,r,i,new Date,n,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:a=>this._previousFilters=this.extractBasicFilterDetails(a.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this)})}else this._previousFilters=this.extractBasicFilterDetails(this._columnFilters);e&&this.pubSubService.publish("onFilterCleared",!0)}customLocalFilter(e,t){let i=t?.grid,o=t?.columnFilters??{},r=this._gridOptions.enableTreeData??!1,n=this._gridOptions.treeDataOptions;if(r&&n){let a=n.collapsedPropName??x.treeDataProperties.COLLAPSED_PROP,l=n.parentPropName??x.treeDataProperties.PARENT_PROP,d=n?.childrenPropName??x.treeDataProperties.CHILDREN_PROP,c=this._gridOptions.datasetIdPropertyName??"id",h=n.autoRecalcTotalsOnFilterChange??!1,u=!1;if(e[l]!==null){let m=this._dataView.getItemById(e[l]);for(;m;){if(m[a])if(h)u=!0;else return!1;m=this._dataView.getItemById(m[l])}}if(this._tmpPreFilteredData instanceof Set){let m=this._tmpPreFilteredData.has(e[c]);if(h){let g=Ci(this.sharedService.hierarchicalDataset,f=>f[c]===e[c],d);if(g&&(g.__filteredOut=!m),u)return!1}return m}}else if(typeof o=="object")for(let a of Object.keys(o)){let l=o[a],d=l.columnDef,c=d?.filter;if(typeof c?.filterPredicate=="function"){if(!c.filterPredicate(e,l))return!1}else{let h=this.preProcessFilterConditionOnDataContext(e,l,i);if(typeof h=="boolean")return h;let u=l?.parsedSearchTerms;if(u===void 0&&(u=qo(l.searchTerms,d.type||_.string),u!==void 0&&(l.parsedSearchTerms=u)),!Ua.executeFilterConditionTest(h,u))return!1}}return!0}parseFormInputFilterConditions(e,t){let i=ei(e)||[],o=Array.isArray(i)&&i.length===1?i[0]:"",r=t.columnDef,n=r.filter?.type??r.type??_.string,a=null;n!==_.object&&(o=o==null?"":`${o}`,a=(r.autoParseInputFilterOperator??this._gridOptions.autoParseInputFilterOperator)!==!1?o.match(/^((.*[^\\*\r\n])[*]{1}(.*[^*\r\n]))|^([<>!=*]{0,2})(.*[^<>!=*])?([*])*$/)||[]:[o,"","","","",o,""]);let l=a?.[2]||"",d=a?.[3]||"",c=a?.[4]||t.operator,h=a?.[1]||a?.[5]||"",u=a?.[6]||(c==="*z"?"*":"");return typeof o=="string"&&(o=o.replace("'","''"),l&&d?(h=o,c=N.startsWithEndsWith):c==="*"||c==="*z"?c=N.endsWith:(c==="a*"||u==="*")&&(c=N.startsWith)),Array.isArray(a)&&a.length>=1&&Array.isArray(i)&&i.length===1&&(i[0]=h.length>0&&h.substring(0,1)===" "?h.substring(1):h),{dataKey:r.dataKey,fieldType:n,searchTerms:i||[],operator:c,searchInputLastChar:u,filterSearchType:r.filterSearchType,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preProcessFilterConditionOnDataContext(e,t,i){let o=t.columnDef,r=t.columnId,n=i.getColumnIndex(r);if(!o&&this.sharedService&&Array.isArray(this.sharedService.allColumns)&&(n=this.sharedService.allColumns.findIndex(u=>u.field===r)),!o)return!0;if(this._gridOptions.enableRowDetailView){let u=this._gridOptions.rowDetailView?.keyPrefix||"__";e[`${u}isPadding`]&&e[`${u}parent`]&&(e=e[`${u}parent`])}let a=o.filter?.queryField||o.queryFieldFilter||o.queryField||o.field||"";typeof o.queryFieldNameGetterFn=="function"&&(a=o.queryFieldNameGetterFn(e));let l=o.filter?.type??o.type??_.string,d=e[a];a?.indexOf(".")>=0&&(d=ge(e,a));let c=t.operator,h=t.searchTerms||[];if(!h||Array.isArray(h)&&(h.length===0||h.length===1&&c===h[0]))return!0;if(h&&Array.isArray(h)&&l!==_.object)for(let u=0,m=h.length;u<m;u++)h[u]=(h[u]===void 0||h[u]===null?"":h[u])+"";if(o?.params?.useFormatterOuputToFilter===!0){let u=this._gridOptions.datasetIdPropertyName||"id",m=this._dataView&&typeof this._dataView.getIdxById=="function"?this._dataView.getIdxById(e[u]):0,g=o&&typeof o.formatter=="function"?o.formatter(m||0,n,d,o,e,this._grid):"";d=Ze(g)}return typeof d=="number"&&(d=d.toString()),{dataKey:o.dataKey,fieldType:l,searchTerms:h,cellValue:d,operator:c,searchInputLastChar:t.searchInputLastChar,filterSearchType:o.filterSearchType,ignoreAccentOnStringFilterAndSort:this._gridOptions.ignoreAccentOnStringFilterAndSort??!1,defaultFilterRangeOperator:this._gridOptions.defaultFilterRangeOperator}}preFilterTreeData(e,t){let i=this._gridOptions.treeDataOptions,o=i?.collapsedPropName??x.treeDataProperties.COLLAPSED_PROP,r=i?.parentPropName??x.treeDataProperties.PARENT_PROP,n=i?.hasChildrenPropName??x.treeDataProperties.HAS_CHILDREN_PROP,a=this._gridOptions.datasetIdPropertyName??"id",l=this._gridOptions.presets?.treeData?.toggledItems,d=this._gridOptions.treeDataOptions?.initiallyCollapsed??!1,c=this._gridOptions.treeDataOptions?.columnId,h=this._gridOptions.treeDataOptions?.excludeChildrenWhenFilteringTree,u=!h&&this._gridOptions.treeDataOptions?.autoApproveParentItemWhenTreeColumnIsValid===!0,m={},g=new Set,f=new Map;return Array.isArray(e)&&(e.forEach(b=>{m[b[a]]=b,delete m[b[a]].__used}),typeof t=="object"&&Object.keys(t).forEach(b=>{let v=t[b],k=v?.searchTerms?ei(v.searchTerms):[],C=this.parseFormInputFilterConditions(k,v),E=v.columnDef,y=E?.filter?.type??E?.type??_.string,S=qo(C.searchTerms,y);S!==void 0&&(v.parsedSearchTerms=S)}),e.forEach(b=>{let v=b[n],k=!0;for(let C of Object.keys(t)){let E=t[C],y=this.preProcessFilterConditionOnDataContext(b,E,this._grid);if(y){let S=E?.parsedSearchTerms,F=typeof y=="boolean"?y:Ua.executeFilterConditionTest(y,S);if(F&&u&&v&&E.columnId===c){f.set(b[a],!0);break}if(F||!h&&f.get(b[r])===!0){if(v&&E.columnId===c&&f.set(b[a],!0),F||!h&&E.columnId===c)continue}else v&&f.get(b[r])!==!0&&E.columnId!==c&&f.set(b[a],!1)}k=!1}if(k){g.add(b[a]);let C=m[b[r]]??!1,E=!d;for(!this._isTreePresetExecuted&&Array.isArray(l)&&l.some(y=>y.itemId===C.id&&y.isCollapsed===E)&&(C[o]=E);C;)C.__used??g.add(C[a]),m[C[a]].__used=!0,C=m[C[r]]??!1}})),this._isTreePresetExecuted=!0,g}getColumnFilters(){return this._columnFilters}getPreviousFilters(){return this._previousFilters}getFiltersMetadata(){return this._filtersMetadata}getCurrentLocalFilters(){let e=[];if(this._columnFilters)for(let t of Object.keys(this._columnFilters)){let i=this._columnFilters[t],o={columnId:t||""};i?.searchTerms&&(o.searchTerms=i.searchTerms),i.operator&&(o.operator=i.operator),i.targetSelector&&(o.targetSelector=i.targetSelector),Array.isArray(o.searchTerms)&&o.searchTerms.length>0&&e.push(o)}return e}emitFilterChanged(e,t=!1){let i=t?"onBeforeFilterChange":"onFilterChanged";if(e==="remote"&&this._gridOptions.backendServiceApi){let o=[],r=this._gridOptions.backendServiceApi.service;return r?.getCurrentFilters&&(o=r.getCurrentFilters()),this.pubSubService.publish(i,o)}else if(e==="local")return this.pubSubService.publish(i,this.getCurrentLocalFilters())}async onBackendFilterChange(e,t){let i=t?.shouldTriggerQuery;if(i&&await this.emitFilterChanged("remote",!0),!t?.grid)throw new Error('Something went wrong when trying to bind the "onBackendFilterChange(event, args)" function, it seems that "args" is not populated correctly');let o=this._gridOptions.backendServiceApi;if(!o||!o.process||!o.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');let r=new Date;if(o.preProcess?.(),i){let n=await o.service.processOnFilterChanged(e,t),a=this._gridOptions.pagination?.totalItems??0;this.backendUtilities?.executeBackendCallback(o,n,t,r,a,{errorCallback:this.resetToPreviousSearchFilters.bind(this),successCallback:l=>this._previousFilters=this.extractBasicFilterDetails(l.columnFilters),emitActionChangedCallback:this.emitFilterChanged.bind(this),httpCancelRequestSubject:this.httpCancelRequests$})}}populateColumnFilterSearchTermPresets(e){return Array.isArray(e)&&(this._columnDefinitions.forEach(t=>{t.filter?.searchTerms&&delete t.filter.searchTerms;let i=e.find(o=>o.columnId===t.id);i&&Array.isArray(i?.searchTerms)&&(t.filter=t.filter||{},t.filter.operator=i.operator||t.filter.operator||"",t.filter.searchTerms=i.searchTerms)}),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._previousFilters=this.extractBasicFilterDetails(this._columnFilters)),this._columnDefinitions}refreshTreeDataFilters(e){let t=e??this._dataView?.getItems()??[];this._dataView&&this._gridOptions.enableTreeData&&t.length>0?(this._tmpPreFilteredData=this.preFilterTreeData(t,this._columnFilters),this._dataView.refresh()):t.length===0&&Array.isArray(this.sharedService.hierarchicalDataset)&&this.sharedService.hierarchicalDataset.length>0&&oi(()=>this.refreshTreeDataFilters())}disableFilterFunctionality(e=!0,t=!0){let o=!this._gridOptions.enableFiltering;o!==e&&(t&&e&&this.clearFilters(),this.disableAllFilteringCommands(e),this._grid.setOptions({enableFiltering:o},!1,!0),this._grid.setHeaderRowVisibility(o),this._gridOptions.enableFiltering=!e,this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(this.sharedService.columnDefinitions))}resetToPreviousSearchFilters(){this.updateFilters(this._previousFilters,!1,!1,!1)}toggleFilterFunctionality(e=!0){let t=this._gridOptions.enableFiltering;this.disableFilterFunctionality(t,e)}toggleHeaderFilterRow(){let e=this._gridOptions.showHeaderRow??!1;e=!e,this._grid.setHeaderRowVisibility(e),e===!0&&this._grid.setColumns(this.sharedService.columnDefinitions)}setSortColumnIcons(e){this._grid&&Array.isArray(e)&&this._grid.setSortColumns(e)}async updateFilters(e,t=!0,i=!0,o=!1){if(!this._filtersMetadata||this._filtersMetadata.length===0||!this._gridOptions||!this._gridOptions.enableFiltering)throw new Error('[Slickgrid-Universal] in order to use "updateFilters" method, you need to have Filterable Columns defined in your grid and "enableFiltering" set in your Grid Options');if(Array.isArray(e)){this.clearFilters(!1),e.forEach(a=>{let l=this._filtersMetadata.find(d=>a.columnId===d.columnDef.id);if(a&&l){let d=a.operator||l.defaultOperator;this.updateColumnFilters(a.searchTerms,l.columnDef,d),l.setValues(a.searchTerms||[],d),(o||this._gridOptions.enableTreeData)&&this.callbackSearchEvent(void 0,{columnDef:l.columnDef,operator:d,searchTerms:a.searchTerms,shouldTriggerQuery:!0,forceOnSearchChangeEvent:!0})}});let r=this._gridOptions.backendServiceApi,n=r?"remote":"local";if(t&&await this.emitFilterChanged(n,!0),this._dataView.refresh(),r){let a=r?.service;a?.updateFilters&&(a.updateFilters(e,!0),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}t&&await this.emitFilterChanged(n)}return!0}async updateSingleFilter(e,t=!0,i=!0){let o=this.sharedService.allColumns.find(r=>r.id===e.columnId);if(o&&e.columnId){this._columnFilters={};let r=o.filter?.emptySearchTermReturnAllValues??!0;Array.isArray(e.searchTerms)&&(e.searchTerms.length>1||e.searchTerms.length===1&&(!r||e.searchTerms[0]!==""))&&(this._columnFilters[e.columnId]={columnId:e.columnId,operator:e.operator,searchTerms:e.searchTerms,columnDef:o,type:o.type??_.string});let n=this._gridOptions.backendServiceApi,a=n?"remote":"local";if(t&&await this.emitFilterChanged(a,!0),n){let l=n?.service;l?.updateFilters&&(l.updateFilters(this._columnFilters,!0),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}else this._dataView.setFilterArgs({columnFilters:this._columnFilters,grid:this._grid}),this._gridOptions.enableTreeData&&this.refreshTreeDataFilters(),this._dataView.refresh();t&&await this.emitFilterChanged(a)}return!0}drawFilterTemplate(e,t){let i;if(typeof t=="string"){if(i=document.querySelector(t),i===null)return null}else i=t;let o=typeof e=="string"?this.sharedService.allColumns.find(n=>n.id===e):e;if((o?.id??"")!=="selector"&&o?.filterable){let n,a,l=this.filterFactory.createFilter(o.filter);a=o&&o.filter&&o.filter.operator||l&&l.operator,this._columnFilters[o.id]?(n=this._columnFilters[o.id].searchTerms||void 0,a=this._columnFilters[o.id].operator||void 0):o.filter&&(n=o.filter.searchTerms||void 0,this.updateColumnFilters(n,o,a));let d={grid:this._grid,operator:a,searchTerms:n,columnDef:o,filterContainerElm:i,callback:this.callbackSearchEvent.bind(this)};return l&&(l.init(d),n&&l.setValues&&l.setValues(n,a)),l}return null}addFilterTemplateToHeaderRow(e,t=!0){let i=e.column;if((i?.id??"")!=="selector"&&i?.filterable&&!i?.hidden){let r,n,a=this.filterFactory.createFilter(i.filter);n=i&&i.filter&&i.filter.operator||a&&a.operator,this._columnFilters[i.id]?(r=this._columnFilters[i.id].searchTerms||void 0,n=this._columnFilters[i.id].operator||void 0):i.filter&&(r=i.filter.searchTerms||void 0,this.updateColumnFilters(r,i,n));let l={grid:this._grid,operator:n,searchTerms:r,columnDef:i,filterContainerElm:e.node,callback:this.callbackSearchEvent.bind(this)};if(a&&l.filterContainerElm){a.init(l,t);let d=this._filtersMetadata.findIndex(c=>a.columnDef.id===c.columnDef.id);d===-1?this._filtersMetadata.push(a):this._filtersMetadata[d]=a,r&&a.setValues&&a.setValues(r,n)}}}callbackSearchEvent(e,t){if(t){let i=e?.target?e.target.value:void 0,o=t.searchTerms&&Array.isArray(t.searchTerms)?t.searchTerms:i?[i]:void 0,r=t.columnDef||null,n=r?.id??"",a=r?.filter?.type??r?.type??_.string,l=t.operator||void 0,d=o&&Array.isArray(o),c=d&&o&&o.length,h={...this._columnFilters},u=r.filter?.emptySearchTermReturnAllValues??!0,m;if(r&&n)if(!d||c===0||c===1&&Array.isArray(o)&&u&&o[0]==="")delete this._columnFilters[n];else{let b=`${n}`,v={columnId:b,columnDef:r,parsedSearchTerms:[],type:a,targetSelector:this.getSelectorStringFromElement(e?.target)},k=this.parseFormInputFilterConditions(o,v);v.operator=l||k.operator||ds(a),m=qo(k.searchTerms,a),m!==void 0&&(v.parsedSearchTerms=m),v.searchTerms=k.searchTerms||[],this._columnFilters[b]=v}let g=e&&typeof e.isPropagationStopped!="function"?fe({},new U,e):e,f=e?.key;if(this._onSearchChange&&(t.forceOnSearchChangeEvent||f==="Enter"||!lt(h,this._columnFilters))){let b={clearFilterTriggered:t.clearFilterTriggered,shouldTriggerQuery:t.shouldTriggerQuery,columnId:n,columnDef:r,columnFilters:this._columnFilters,operator:l||ds(a),searchTerms:o,parsedSearchTerms:m,grid:this._grid,target:e?.target};this.pubSubService.publish("onBeforeSearchChange",b)===!1?this._gridOptions.resetFilterSearchValueAfterOnBeforeCancellation&&this.resetToPreviousSearchFilters():this._onSearchChange.notify(b,g)}}}disableAllFilteringCommands(e=!0){let t=this._grid.getColumns();t.forEach(o=>{o?.header?.menu&&o.header.menu.commandItems?.forEach(r=>{r&&typeof r!="string"&&r.command==="clear-filter"&&(r.hidden=e)})});let i=this._gridOptions.gridMenu?.commandItems;return i&&i.forEach(o=>{if(o&&typeof o!="string"){let r=o.command;(r==="clear-filter"||r==="toggle-filter")&&(o.hidden=e)}}),t}extractBasicFilterDetails(e){let t=[];if(e&&typeof e=="object")for(let i of Object.keys(e)){let{operator:o,searchTerms:r}=e[`${i}`];t.push({columnId:i,operator:o,searchTerms:r})}return t}getSelectorStringFromElement(e){return e?.localName?e?.className?`${e.localName}.${Array.from(e.classList).join(".")}`:e.localName:""}removeAllColumnFiltersProperties(){typeof this._columnFilters=="object"&&Object.keys(this._columnFilters).forEach(e=>{e&&this._columnFilters[e]&&delete this._columnFilters[e]})}subscribeToOnHeaderRowCellRendered(e){this._eventHandler.subscribe(e.onBeforeHeaderRowCellDestroy,(t,i)=>{this._filtersMetadata.find(r=>r.columnDef.id===i.column.id)?.destroy?.()})}updateColumnFilters(e,t,i){let o=t.filter?.type??t.type??_.string,r=qo(e,o);e&&t&&(this._columnFilters[t.id]={columnId:t.id,columnDef:t,searchTerms:e,operator:i,parsedSearchTerms:r,type:o})}};var Ir={skipError:!1,triggerEvent:!0},Ko={highlightRow:!0,resortGrid:!1,selectRow:!1,scrollRowIntoView:!0,skipError:!1,triggerEvent:!0},ja={highlightRow:!1,selectRow:!1,scrollRowIntoView:!1,skipError:!1,triggerEvent:!0},Ac={applySetColumns:!0,autoResizeColumns:!0,triggerEvent:!0,hideFromColumnPicker:!1,hideFromGridMenu:!1},Qm={autoResizeColumns:!0,triggerEvent:!0},Dr=class{constructor(e,t,i,o,r,n,a){this.gridStateService=e,this.filterService=t,this.pubSubService=i,this.paginationService=o,this.sharedService=r,this.sortService=n,this.treeDataService=a}get _dataView(){return this._grid?.getData()}get _gridOptions(){return this._grid?.getOptions()??{}}dispose(){this._rowSelectionPlugin?.dispose()}init(e){this._grid=e}clearAllFiltersAndSorts(){this.sortService?.clearSorting(!1),this.filterService?.clearFilters()}clearPinning(e=!0){let t=[...this.sharedService.visibleColumns];this.sharedService.slickGrid.setOptions({frozenColumn:-1,frozenRow:-1,frozenBottom:!1,enableMouseWheelScrollHandler:!1}),e&&Array.isArray(t)&&this.sharedService.slickGrid.setColumns(t)}setPinning(e,t=!0,i=!1,o=!0,r=!1){Eo(e)?this.clearPinning():(e.frozenColumn!==void 0&&(this.sharedService.frozenVisibleColumnId=this._grid.getColumns()[e.frozenColumn]?.id||""),this.sharedService.slickGrid.setOptions(e,i,o),this.sharedService.gridOptions={...this.sharedService.gridOptions,...e}),t&&this.sharedService.slickGrid.autosizeColumns(),r||this._grid.updateColumns()}getAllColumnDefinitions(){return this.sharedService.allColumns}getVisibleColumnDefinitions(){return this.sharedService.visibleColumns}getColumnFromEventArguments(e){if(!e?.grid||!e.grid.getColumns||!e.grid.getDataItem)throw new Error("[Slickgrid-Universal] To get the column definition and data, we need to have these arguments passed as objects (row, cell, grid)");return{row:e.row,cell:e.cell,columnDef:e.grid.getColumns()[e.cell],dataContext:e.grid.getDataItem(e.row),dataView:this._dataView,grid:this._grid}}getDataItemByRowNumber(e){if(!this._grid||typeof this._grid.getDataItem!="function")throw new Error(`[Slickgrid-Universal] We could not find SlickGrid Grid object or it's "getDataItem" method`);return this._grid.getDataItem(e)}getDataItemByRowIndex(e){if(!this._grid||typeof this._grid.getDataItem!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');return this._grid.getDataItem(e)}getDataItemByRowIndexes(e){if(!this._grid||typeof this._grid.getDataItem!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getDataItem" method');let t=[];return Array.isArray(e)&&e.forEach(i=>{t.push(this._grid.getDataItem(i))}),t}getSelectedRows(){if(!this._grid||typeof this._grid.getSelectedRows!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');return this._grid.getSelectedRows()}getSelectedRowsDataItem(){if(!this._grid||typeof this._grid.getSelectedRows!="function")throw new Error('[Slickgrid-Universal] We could not find SlickGrid Grid object and/or "getSelectedRows" method');let e=this._grid.getSelectedRows();return this.getDataItemByRowIndexes(e)}hideColumnById(e,t){if(this._grid){t={...Ac,...t};let i=this._grid.getColumns(),o=i.findIndex(r=>r.id===e);if(o>=0){let r=yo(i,o);t?.applySetColumns&&(this.sharedService.visibleColumns=r,this._grid.setColumns(r));let n=this.sharedService.allColumns.findIndex(a=>a.id===e);return n&&(t?.hideFromColumnPicker&&(this.sharedService.allColumns[n].excludeFromColumnPicker=!0),t?.hideFromGridMenu&&(this.sharedService.allColumns[n].excludeFromGridMenu=!0)),this.executeVisibilityCommands(t,["onHideColumns"],r),o}}return-1}hideColumnByIds(e,t){if(Array.isArray(e)){let i=this._grid.getColumns().filter(o=>!e.includes(o.id));t={...Ac,...t};for(let o of e)this.hideColumnById(o,{...t,triggerEvent:!1,applySetColumns:!1,autoResizeColumns:!1});this.sharedService.visibleColumns=i,this._grid.setColumns(i),this.executeVisibilityCommands(t,["onHideColumns"],i)}}showColumnByIds(e,t){if(this._grid){t={...Qm,...t};let i=this.sharedService.allColumns.filter(o=>e.includes(o.id));this._grid.setColumns(i),this.sharedService.visibleColumns=i,this.executeVisibilityCommands(t,["onShowColumns"],this.sharedService.visibleColumns)}}executeVisibilityCommands(e,t,i){e?.autoResizeColumns&&this._grid.autosizeColumns(),e?.triggerEvent&&t.forEach(o=>this.pubSubService.publish(o,{columns:i}))}highlightRow(e,t){this._grid.getSelectionModel()||(this._rowSelectionPlugin=new Qt(this._gridOptions.rowSelectionOptions),this._grid.setSelectionModel(this._rowSelectionPlugin)),t||=this._gridOptions.rowHighlightDuration,Array.isArray(e)?e.forEach(i=>this._grid.highlightRow(i)):this._grid.highlightRow(e,t)}setSelectedRow(e){this._grid?.setSelectedRows([e])}setSelectedRows(e){this._grid?.setSelectedRows(e)}renderGrid(){this._grid?.invalidate()}resetGrid(e){if(this.clearPinning(!1),this._grid){let t=this.sharedService.allColumns||[];Array.isArray(t)&&t.length>0&&(this._grid.setColumns(t),this._gridOptions?.enableAutoSizeColumns&&this._grid.autosizeColumns(),this.gridStateService.resetColumns(e))}typeof this.filterService?.clearFilters=="function"&&this.filterService.clearFilters(),typeof this.sortService?.clearSorting=="function"&&this.sortService.clearSorting()}addItem(e,t){let i={...Ko,...t};if(!i?.skipError&&(!this._grid||!this._gridOptions||!this._dataView))throw new Error("[Slickgrid-Universal] We could not find SlickGrid Grid, DataView objects");let o=this._gridOptions.datasetIdPropertyName||"id";if(!i?.skipError&&(!e||!e.hasOwnProperty(o)))throw new Error(`[Slickgrid-Universal] Adding an item requires the item to include an "${o}" property`);if(this._gridOptions?.enableTreeData&&t?.position==="top")throw new Error('[Slickgrid-Universal] Please note that `addItem({ position: "top" })` is not supported when used with Tree Data because of the extra complexity.');let r=i?.position;r==="bottom"||this._gridOptions?.enableTreeData?this._dataView.addItem(e):this._dataView.insertItem(0,e);let n=0,a=e?.[o]??"";return this._gridOptions?.enableTreeData?(this.invalidateHierarchicalDataset(),n=this._dataView.getRowById(a),i.scrollRowIntoView&&this._grid.scrollRowIntoView(n??0,!1)):i.resortGrid?(this._dataView.reSort(),n=this._dataView.getRowById(a)):(n=r==="bottom"?this._dataView.getRowById(a):0,i.scrollRowIntoView&&this._grid.scrollRowIntoView(n??0)),i.highlightRow&&n!==void 0&&this.highlightRow(n),n!==void 0&&i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(n),i.triggerEvent&&this.pubSubService.publish("onItemsAdded",[e]),!this._gridOptions?.backendServiceApi&&this._gridOptions.enablePagination&&(r==="bottom"?this.paginationService.goToLastPage():this.paginationService.goToFirstPage()),n}addItems(e,t){let i={...Ko,...t},o=this._gridOptions.datasetIdPropertyName||"id",r=i?.position,n=[];if(Array.isArray(e))this._dataView.beginUpdate(!0),r==="bottom"||this._gridOptions?.enableTreeData?this._dataView.addItems(e):this._dataView.insertItems(0,e),this._dataView.endUpdate();else return[this.addItem(e,i)||0];if(this._gridOptions?.enableTreeData){this.invalidateHierarchicalDataset();let a=e[0]?.[o]??"",l=this._dataView.getRowById(a);i.scrollRowIntoView&&this._grid.scrollRowIntoView(l??0,!1)}else i.resortGrid&&this._dataView.reSort();return r&&i.scrollRowIntoView&&!this._gridOptions?.enableTreeData&&(r==="bottom"?this._grid.navigateBottom():this._grid.navigateTop()),e.forEach(a=>n.push(this._dataView.getRowById(a[o]))),i.highlightRow&&this.highlightRow(n),i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(n),i.triggerEvent&&this.pubSubService.publish("onItemsAdded",e),n}deleteItem(e,t){t={...Ir,...t};let i=this._gridOptions.datasetIdPropertyName||"id";if(!t?.skipError&&(!e||!e.hasOwnProperty(i)))throw new Error(`[Slickgrid-Universal] Deleting an item requires the item to include an "${i}" property`);return this.deleteItemById(e[i],t)}deleteItems(e,t){t={...Ir,...t};let i=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return this.deleteItem(e,t),[e[i]];this._dataView.beginUpdate(!0);let o=[];return e.forEach(r=>{r?.[i]!==void 0&&o.push(r[i])}),this._dataView.deleteItems(o),this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemsDeleted",e),o}deleteItemById(e,t){if(t={...Ir,...t},!t?.skipError&&e==null)throw new Error('[Slickgrid-Universal] Cannot delete a row without a valid "id"');return!(this.gridStateService&&this.gridStateService.needToPreserveRowSelection()||!1)&&this._grid&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows([]),this._dataView.deleteItem(e),t.triggerEvent&&this.pubSubService.publish("onItemsDeleted",[e]),e}deleteItemByIds(e,t){if(t={...Ir,...t},Array.isArray(e)){this._dataView.beginUpdate(!0);for(let i=0;i<e.length;i++)e[i]!==null&&this.deleteItemById(e[i],{triggerEvent:!1});return this._dataView.endUpdate(),t.triggerEvent&&this.pubSubService.publish("onItemsDeleted",e),e}return[]}updateItem(e,t){t={...ja,...t};let i=this._gridOptions.datasetIdPropertyName||"id",o=!e||!e.hasOwnProperty(i)?void 0:e[i];if(!t?.skipError&&o===void 0)throw new Error(`[Slickgrid-Universal] Calling Update of an item requires the item to include an "${i}" property`);return this.updateItemById(o,e,t)}updateItems(e,t){t={...ja,...t};let i=this._gridOptions.datasetIdPropertyName||"id";if(!Array.isArray(e))return[this.updateItem(e,t)];this._dataView.beginUpdate(!0);let o=[],r=[];return e.forEach(n=>{let a=!n||!n.hasOwnProperty(i)?void 0:n[i];if(r.push(a),this._dataView.getIdxById(a)!==void 0){let l=this._dataView.getRowById(a);l!==void 0&&(o.push(l),this._grid.updateRow(l))}}),this._dataView.updateItems(r,e),this._dataView.endUpdate(),this._gridOptions?.enableTreeData&&this.invalidateHierarchicalDataset(),t.highlightRow&&this.highlightRow(o),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(o),t.triggerEvent&&this.pubSubService.publish("onItemsUpdated",e),o}updateItemById(e,t,i){if(i={...ja,...i},!i?.skipError&&e===void 0)throw new Error('[Slickgrid-Universal] Cannot update a row without a valid "id"');let o=this._dataView.getRowById(e);if(!i?.skipError&&!t&&!this._gridOptions.enablePagination)throw new Error(`[Slickgrid-Universal] The item to update in the grid was not found with id: ${e}`);return this._dataView.getIdxById(e)!==void 0&&(this._dataView.updateItem(e,t),o!==void 0&&this._grid.updateRow(o),this._gridOptions?.enableTreeData&&this.invalidateHierarchicalDataset(),i.scrollRowIntoView&&o!==void 0&&this._grid.scrollRowIntoView(o),i.highlightRow&&o!==void 0&&this.highlightRow(o),o!==void 0&&i.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRow(o),i.triggerEvent&&this.pubSubService.publish("onItemsUpdated",[t])),o}upsertItem(e,t){t={...Ko,...t};let i=this._gridOptions.datasetIdPropertyName||"id",o=!e||!e.hasOwnProperty(i)?void 0:e[i];if(!t?.skipError&&o===void 0)throw new Error(`[Slickgrid-Universal] Calling Upsert of an item requires the item to include an "${i}" property`);return this.upsertItemById(o,e,t)}upsertItems(e,t){if(t={...Ko,...t},!Array.isArray(e))return[this.upsertItem(e,t)];this._dataView.beginUpdate(!0);let i=[];e.forEach(r=>{i.push(this.upsertItem(r,{...t,highlightRow:!1,resortGrid:!1,selectRow:!1,triggerEvent:!1}))}),this._dataView.endUpdate();let o=i.map(r=>r.added!==void 0?r.added:r.updated);if(t.highlightRow&&this.highlightRow(o),t.selectRow&&this._gridOptions&&(this._gridOptions.enableCheckboxSelector||this._gridOptions.enableRowSelection)&&this.setSelectedRows(o),t.triggerEvent){this.pubSubService.publish("onItemsUpserted",e);let r=i.filter(a=>a.added!==void 0);Array.isArray(r)&&r.length>0&&this.pubSubService.publish("onItemsAdded",r);let n=i.filter(a=>a.updated!==void 0);Array.isArray(n)&&n.length>0&&this.pubSubService.publish("onItemsUpdated",n)}return i}upsertItemById(e,t,i){let o=!1;if(i={...Ko,...i},!i?.skipError&&e===void 0&&!this.hasRowSelectionEnabled())throw new Error('[Slickgrid-Universal] Calling Upsert of an item requires the item to include a valid and unique "id" property');let r,n;return this._dataView.getRowById(e)===void 0?(r=this.addItem(t,i),o=!0):(n=this.updateItem(t,{highlightRow:i.highlightRow,selectRow:i.selectRow,triggerEvent:i.triggerEvent}),o=!1),i.triggerEvent&&(this.pubSubService.publish("onItemsUpserted",[t]),this.pubSubService.publish(o?"onItemsAdded":"onItemsUpdated",[t])),{added:r,updated:n}}invalidateHierarchicalDataset(e){if(this._gridOptions?.enableTreeData&&this.treeDataService){let t=e??this._dataView.getItems(),i=this.sortService.getCurrentColumnSorts(),o=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(t||[],this.sharedService.allColumns,this._gridOptions,i);this.sharedService.hierarchicalDataset=o.hierarchical,this.filterService.refreshTreeDataFilters(e),this._dataView.setItems(o.flat),this._grid.invalidate()}}hasRowSelectionEnabled(){let e=this._grid.getSelectionModel();return!!(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&!!e}};var Mr=class{get eventHandler(){return this._eventHandler}constructor(){this._eventHandler=new G}dispose(){this._eventHandler.unsubscribeAll()}bindOnBeforeEditCell(e){let t=e?.getData();this._eventHandler.subscribe(e.onBeforeEditCell,(i,o)=>{if(!i||!o||!e||o.cell===void 0||!e.getColumns||!e.getDataItem)return;let r=e.getColumns()[o.cell];if(typeof r.onBeforeEditCell=="function"){let n={row:o.row,cell:o.cell,dataView:t,grid:e,columnDef:r,dataContext:e.getDataItem(o.row)};r.onBeforeEditCell(i instanceof U?i.getNativeEvent():i,n)}})}bindOnCellChange(e){let t=e?.getData();this._eventHandler.subscribe(e.onCellChange,(i,o)=>{if(!i||!o||!e||o.cell===void 0||!e.getColumns||!e.getDataItem)return;let r=e.getColumns()[o.cell];if(typeof r.onCellChange=="function"){let n={row:o.row,cell:o.cell,dataView:t,grid:e,columnDef:r,dataContext:e.getDataItem(o.row)};r.onCellChange(i instanceof U?i.getNativeEvent():i,n)}})}bindOnClick(e){let t=e?.getData();this._eventHandler.subscribe(e.onClick,(i,o)=>{if(!i||!o||!e||o.cell===void 0||!e.getColumns||!e.getDataItem)return;let r=e.getColumns()[o.cell];if(typeof r.onCellClick=="function"){let n={row:o.row,cell:o.cell,dataView:t,grid:e,columnDef:r,dataContext:e.getDataItem(o.row)};r.onCellClick(i instanceof U?i.getNativeEvent():i,n)}})}};var Pr=class{constructor(e,t,i,o,r,n){this.extensionService=e,this.filterService=t,this.pubSubService=i,this.sharedService=o,this.sortService=r,this.treeDataService=n,this._columns=[],this._subscriptions=[],this._selectedRowIndexes=[],this._selectedRowDataContextIds=[],this._wasRecheckedAfterPageChange=!0,this._eventHandler=new G}get _dataView(){return this._grid?.getData()??{}}get _gridOptions(){return this._grid?.getOptions()??{}}get selectedRowDataContextIds(){return this._selectedRowDataContextIds}set selectedRowDataContextIds(e){this._selectedRowDataContextIds=e}init(e){this._grid=e,this.subscribeToAllGridChanges(e)}dispose(){this._columns=[],this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}changeColumnsArrangement(e,t=!0,i=!1){if(Array.isArray(e)&&e.length>0){let o=this.getAssociatedGridColumns(this._grid,e);if(o&&Array.isArray(o)&&o.length>0){if(Array.isArray(this.sharedService.allColumns)){let r=[];if(this._gridOptions.enableCheckboxSelector){let n=this._gridOptions?.checkboxSelector?.columnIndexPosition??0;r.push({columnId:"_checkbox_selector",columnIndexPosition:n})}if(this._gridOptions.enableRowDetailView){let n=this._gridOptions?.rowDetailView?.columnIndexPosition??0;r.push({columnId:"_detail_selector",columnIndexPosition:n})}if(this._gridOptions.enableRowMoveManager){let n=this._gridOptions?.rowMoveManager?.columnIndexPosition??0;r.push({columnId:"_move",columnIndexPosition:n})}this.addColumnDynamicWhenFeatureEnabled(r,this.sharedService.allColumns,o)}o.forEach(r=>r.originalWidth=r.width||r.originalWidth),this._grid.setColumns(o),this.sharedService.visibleColumns=o,t?this._grid.autosizeColumns():(i||this._gridOptions.enableAutoResizeColumnsByCellContent&&!this._gridOptions.autosizeColumnsByCellContentOnFirstLoad)&&this.pubSubService.publish("onFullResizeByContentRequested",{caller:"GridStateService"})}}}getCurrentGridState(){let{frozenColumn:e,frozenRow:t,frozenBottom:i}=this.sharedService.gridOptions,o={columns:this.getCurrentColumns(),filters:this.getCurrentFilters(),sorters:this.getCurrentSorters(),pinning:{frozenColumn:e,frozenRow:t,frozenBottom:i}},r=this.getCurrentGrouping();r&&(o.grouping=r);let n=this.getCurrentPagination();if(n&&(o.pagination=n),this.hasRowSelectionEnabled()){let a=this.getCurrentRowSelections();a&&(o.rowSelection=a)}if(this._gridOptions?.enableTreeData){let a=this.getCurrentTreeDataToggleState();a&&(o.treeData=a)}return o}getColumns(){return this._columns}getAssociatedCurrentColumns(e){let t=[];return e&&Array.isArray(e)&&e.forEach(i=>{i?.id&&t.push({columnId:i.id,cssClass:i.cssClass||"",headerCssClass:i.headerCssClass||"",width:i.width||0})}),t}getAssociatedGridColumns(e,t){let i=[],o=this.sharedService.allColumns||e.getColumns();return t&&Array.isArray(t)&&t.forEach(r=>{let n=o.find(a=>a.id===r.columnId);n?.id&&i.push({...n,cssClass:r.cssClass||n.cssClass,headerCssClass:r.headerCssClass||n.headerCssClass,width:r.width})}),this._columns=i,i}getCurrentColumns(){return this.getAssociatedCurrentColumns(this._grid.getColumns()||[])}getCurrentFilters(){if(this._gridOptions?.backendServiceApi){let e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentFilters)return e.getCurrentFilters()}else if(this.filterService?.getCurrentLocalFilters)return this.filterService.getCurrentLocalFilters();return null}getCurrentGrouping(){return this._gridOptions?.enableGrouping||this._gridOptions.enableDraggableGrouping?this._dataView.getGrouping().map(e=>e.getter?.toString()||""):null}getCurrentPagination(){if(this._gridOptions?.enablePagination){if(this._gridOptions.backendServiceApi){let e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentPagination)return e.getCurrentPagination()}return this.sharedService.currentPagination}return null}getCurrentRowSelections(){return this._grid&&this._dataView&&this.hasRowSelectionEnabled()?{gridRowIndexes:this._grid.getSelectedRows()||[],dataContextIds:this._dataView.getAllSelectedIds()||[],filteredDataContextIds:this._dataView.getAllSelectedFilteredIds()||[]}:null}getCurrentSorters(){if(this._gridOptions?.backendServiceApi){let e=this._gridOptions.backendServiceApi.service;if(e?.getCurrentSorters)return e.getCurrentSorters()}else if(this.sortService?.getCurrentLocalSorters)return this.sortService.getCurrentLocalSorters();return null}getCurrentTreeDataToggleState(){return this._gridOptions?.enableTreeData&&this.treeDataService?this.treeDataService.getCurrentToggleState():null}needToPreserveRowSelection(){let e=!1;if(this._gridOptions?.dataView&&this._gridOptions.dataView.hasOwnProperty("syncGridSelection")){let t=this._gridOptions.dataView.syncGridSelection;typeof t=="boolean"?e=this._gridOptions.dataView.syncGridSelection:typeof t=="object"&&(e=t.preserveHidden||t.preserveHiddenOnSelectionChange),e&&this._gridOptions.backendServiceApi&&this._gridOptions.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(e=this._gridOptions.dataView.syncGridSelectionWithBackendService)}return e}resetColumns(e){let t=e||this._columns,i=this.getAssociatedCurrentColumns(t);this.pubSubService.publish("onGridStateChanged",{change:{newValues:i,type:"columns"},gridState:this.getCurrentGridState()})}resetToOriginalColumns(e=!0){this._grid.setColumns(this.sharedService.allColumns),this.sharedService.visibleColumns=this.sharedService.allColumns,e&&this._grid.autosizeColumns()}resetRowSelectionWhenRequired(){!this.needToPreserveRowSelection()&&(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&this.extensionService?.getExtensionByName?.(Q.rowSelection)?.instance&&this._grid.setSelectedRows([])}subscribeToAllGridChanges(e){this._subscriptions.push(this.pubSubService.subscribe("onFilterChanged",t=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:"filter"},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onFilterCleared",()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:"filter"},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",t=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:"sorter"},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onSortCleared",()=>{this.resetRowSelectionWhenRequired(),this.pubSubService.publish("onGridStateChanged",{change:{newValues:[],type:"sorter"},gridState:this.getCurrentGridState()})})),this.bindExtensionAddonEventToGridStateChange(Q.columnPicker,"onColumnsChanged"),this.bindExtensionAddonEventToGridStateChange(Q.gridMenu,"onColumnsChanged"),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsReordered",e),this.bindSlickGridColumnChangeEventToGridStateChange("onColumnsResized",e),this.bindSlickGridOnSetOptionsEventToGridStateChange(e),(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&this._eventHandler.subscribe(this._dataView.onSelectedRowIdsChanged,(t,i)=>{let o=(this._selectedRowIndexes||[]).slice(),r=(this.selectedRowDataContextIds||[]).slice();if(this.selectedRowDataContextIds=i.filteredIds,this._selectedRowIndexes=i.rows,!lt(this.selectedRowDataContextIds,r)||!lt(this._selectedRowIndexes,o)){let n={gridRowIndexes:this._selectedRowIndexes||[],dataContextIds:i.selectedRowIds,filteredDataContextIds:i.filteredIds};this.pubSubService.publish("onGridStateChanged",{change:{newValues:n,type:"rowSelection"},gridState:this.getCurrentGridState()})}}),this._subscriptions.push(this.pubSubService.subscribe(["onHideColumns","onShowColumns"],t=>{let i=this.getAssociatedCurrentColumns(t.columns);this.pubSubService.publish("onGridStateChanged",{change:{newValues:i,type:"columns"},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onTreeItemToggled",t=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:"treeData"},gridState:this.getCurrentGridState()})})),this._subscriptions.push(this.pubSubService.subscribe("onTreeFullToggleEnd",t=>{this.pubSubService.publish("onGridStateChanged",{change:{newValues:t,type:"treeData"},gridState:this.getCurrentGridState()})}))}addColumnDynamicWhenFeatureEnabled(e,t,i){e.sort((o,r)=>o.columnIndexPosition-r.columnIndexPosition),e.forEach(o=>{let r=t.findIndex(a=>a.id===o.columnId),n=i.findIndex(a=>a.id===o.columnId);if(r>=0&&n===-1){let a=t[r];r===0?i.unshift(a):i.splice(r,0,a)}})}bindExtensionAddonEventToGridStateChange(e,t){let o=this.extensionService?.getExtensionByName?.(e)?.instance?.[t];o&&typeof o.subscribe=="function"&&this._eventHandler.subscribe(o,(r,n)=>{let a=n?.columns,l=this.getAssociatedCurrentColumns(a);this.pubSubService.publish("onGridStateChanged",{change:{newValues:l,type:"columns"},gridState:this.getCurrentGridState()})})}bindSlickGridColumnChangeEventToGridStateChange(e,t){let i=t?.[e];i&&typeof i.subscribe=="function"&&this._eventHandler.subscribe(i,()=>{let o=t.getColumns(),r=this.getAssociatedCurrentColumns(o);this.pubSubService.publish("onGridStateChanged",{change:{newValues:r,type:"columns"},gridState:this.getCurrentGridState()})})}bindSlickGridOnSetOptionsEventToGridStateChange(e){let t=e.onSetOptions;this._eventHandler.subscribe(t,(i,o)=>{let{frozenBottom:r,frozenColumn:n,frozenRow:a}=o.optionsBefore,{frozenBottom:l,frozenColumn:d,frozenRow:c}=o.optionsAfter;if(r!==l||n!==d||a!==c){let h={frozenBottom:l,frozenColumn:d,frozenRow:c},u=this.getCurrentGridState();this.pubSubService.publish("onGridStateChanged",{change:{newValues:h,type:"pinning"},gridState:u})}})}hasRowSelectionEnabled(){let e=this._grid.getSelectionModel();return!!(this._gridOptions.enableRowSelection||this._gridOptions.enableCheckboxSelector)&&!!e}};var Hr=class{constructor(e){this.extensionUtility=e,this._subscriptions=[],this._eventHandler=new G}get _dataView(){return this._grid?.getData()??{}}get eventHandler(){return this._eventHandler}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}init(e){this._grid=e,e&&this._gridOptions&&this._gridOptions.createPreHeaderPanel&&(this._gridOptions.enableTranslate&&this.translateHeaderGrouping(),this._eventHandler.subscribe(e.onColumnsReordered,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onRendered,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(e.onAutosizeColumns,()=>this.renderPreHeaderRowGroupingTitles()),this._eventHandler.subscribe(this._dataView.onRowCountChanged,()=>this.delayRenderPreHeaderRowGroupingTitles(0)),this._eventHandler.subscribe(e.onSetOptions,(t,i)=>{i?.optionsBefore?.frozenColumn!==i?.optionsAfter?.frozenColumn&&this.delayRenderPreHeaderRowGroupingTitles(0)}),this.delayRenderPreHeaderRowGroupingTitles(75))}dispose(){this._eventHandler.unsubscribeAll()}delayRenderPreHeaderRowGroupingTitles(e=0){setTimeout(()=>this.renderPreHeaderRowGroupingTitles(),e)}renderPreHeaderRowGroupingTitles(){let e=this._columnDefinitions.length;if(this._gridOptions?.frozenColumn!==void 0&&this._gridOptions.frozenColumn>=0){let t=this._gridOptions.frozenColumn;this.renderHeaderGroups(this._grid.getPreHeaderPanelLeft(),0,t+1),this.renderHeaderGroups(this._grid.getPreHeaderPanelRight(),t+1,e)}else this.renderHeaderGroups(this._grid.getPreHeaderPanel(),0,e)}renderHeaderGroups(e,t,i){j(e),e.className="slick-header-columns",e.style.left="-1000px",e.style.width=`${this._grid.getHeadersWidth()}px`,e.parentElement?.classList.add("slick-header");let o=this._grid.getHeaderColumnWidthDiff(),r,n=null,a="",l=0,d=this._gridOptions?.frozenHeaderWidthCalcDifferential??0,c=this._gridOptions?.frozenColumn!==void 0&&this._gridOptions.frozenColumn>=0;for(let h=t;h<i;h++)r=this._columnDefinitions[h],r&&(a===r.columnGroup&&h>0?(l+=r.width||0,n?.style&&(n.style.width=`${l-o-d}px`)):(l=r.width||0,n=p("div",{className:`slick-state-default slick-header-column ${c?"frozen":""}`,dataset:{group:r.columnGroup},style:{width:`${l-o}px`}}),p("span",{className:"slick-column-name",textContent:r.columnGroup||""},n),e.appendChild(n)),a=r.columnGroup||"")}translateHeaderGrouping(){let e=this._grid.getColumns();this.extensionUtility.translateItems(e,"columnGroupKey","columnGroup"),this._grid.setColumns(e),this.renderPreHeaderRowGroupingTitles()}};var Vr=class{constructor(e,t,i,o){this.pubSubService=e,this.sharedService=t,this.backendUtilities=i,this.rxjs=o,this._initialized=!1,this._isLocalGrid=!0,this._dataFrom=1,this._dataTo=1,this._itemsPerPage=0,this._pageCount=1,this._pageNumber=1,this._totalItems=0,this._availablePageSizes=[],this._subscriptions=[],this._isCursorBased=!1,this._eventHandler=new G}get dataView(){return this.grid?.getData()??{}}set paginationOptions(e){this._paginationOptions=e}get paginationOptions(){return this._paginationOptions}get availablePageSizes(){return this._availablePageSizes}get dataFrom(){return this._dataFrom}get dataTo(){return this._dataTo}get itemsPerPage(){return this._itemsPerPage}get pageCount(){return this._pageCount}get pageNumber(){return this._pageNumber}get totalItems(){return this._totalItems}set totalItems(e){this._totalItems=e,this._initialized&&this.refreshPagination()}get isCursorBased(){return this._isCursorBased}addRxJsResource(e){this.rxjs=e}init(e,t,i){if(this._availablePageSizes=t.pageSizes||[],this.grid=e,this._backendServiceApi=i,this._paginationOptions=t,this._isLocalGrid=!i,this._pageNumber=t.pageNumber||1,this._isCursorBased=i?.options?.useCursor??!1,i&&(!i.service||!i.process))throw new Error('BackendServiceApi requires the following 2 properties "process" and "service" to be defined.');this._isLocalGrid&&this.dataView&&(this._eventHandler.subscribe(this.dataView.onPagingInfoChanged,(r,n)=>{this._totalItems!==n.totalRows&&(this.updateTotalItems(n.totalRows),this._previousPagination={pageNumber:n.pageNum,pageSize:n.pageSize,pageSizes:this.availablePageSizes,totalItems:n.totalRows})}),oi(()=>{this.dataView&&(this.dataView.setRefreshHints({isFilterUnchanged:!0}),this.dataView.setPagingOptions({pageSize:this.paginationOptions.pageSize,pageNum:this._pageNumber-1}))})),this._subscriptions.push(this.pubSubService.subscribe(["onFilterChanged","onFilterCleared"],()=>this.resetPagination())),i?.options?.infiniteScroll&&this._subscriptions.push(this.pubSubService.subscribe("onSortChanged",()=>this.resetPagination())),this.dataView&&(this._subscriptions.push(this.pubSubService.subscribe("onItemsAdded",r=>this.processOnItemsAddedOrRemoved(r,!0))),this._subscriptions.push(this.pubSubService.subscribe("onItemsDeleted",r=>this.processOnItemsAddedOrRemoved(r,!1)))),this.refreshPagination(!1,!1,!0);let o=this.getFullPagination();this._previousPagination={pageNumber:o.pageNumber,pageSize:o.pageSize,pageSizes:o.pageSizes,totalItems:this.totalItems},this._initialized=!0,wi(t,"totalItems",r=>this._totalItems=r)}dispose(){this._initialized=!1,this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}getCurrentPagination(){return{pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes}}getFullPagination(){return{pageCount:this._pageCount,pageNumber:this._pageNumber,pageSize:this._itemsPerPage,pageSizes:this._availablePageSizes,totalItems:this._totalItems,dataFrom:this._dataFrom,dataTo:this._dataTo}}getCurrentPageNumber(){return this._pageNumber}getCurrentItemPerPage(){return this._itemsPerPage}changeItemPerPage(e,t,i=!0){return this._pageNumber=1,this._pageCount=Math.ceil(this._totalItems/e),this._itemsPerPage=e,i?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination())}goToFirstPage(e,t=!0){return this._pageNumber=1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToLastPage(e,t=!0){return this._pageNumber=this._pageCount||1,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())}goToNextPage(e,t=!0){return this._pageNumber<this._pageCount?(this._pageNumber++,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,first:this._itemsPerPage,after:this._cursorPageInfo.endCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}goToPageNumber(e,t,i=!0){if(this.isCursorBased)return console.assert(!0,"Cursor based navigation cannot navigate to arbitrary page"),Promise.resolve(!1);let o=this._pageNumber;return e<1?this._pageNumber=1:e>this._pageCount?this._pageNumber=this._pageCount:this._pageNumber=e,this._pageNumber!==o?i?this.processOnPageChanged(this._pageNumber,t):Promise.resolve(this.getFullPagination()):Promise.resolve(!1)}goToPreviousPage(e,t=!0){return this._pageNumber>1?(this._pageNumber--,t?this.isCursorBased&&this._cursorPageInfo?this.processOnPageChanged(this._pageNumber,e,{newPage:this._pageNumber,pageSize:this._itemsPerPage,last:this._itemsPerPage,before:this._cursorPageInfo.startCursor}):this.processOnPageChanged(this._pageNumber,e):Promise.resolve(this.getFullPagination())):Promise.resolve(!1)}refreshPagination(e=!1,t=!0,i=!1){let o={...this.getFullPagination()};if(this._paginationOptions){let n=this._paginationOptions;this._itemsPerPage||(this._isLocalGrid?this._itemsPerPage=n.pageSize:this._itemsPerPage=+(this._backendServiceApi?.options?.paginationOptions?.first?this._backendServiceApi.options.paginationOptions.first:n.pageSize)),(e||this._totalItems!==n.totalItems)&&(e?(this._pageNumber=1,this.paginationOptions.pageNumber=1):!this._initialized&&n.pageNumber&&n.pageNumber>1&&(this._pageNumber=n.pageNumber||1),this._pageNumber===1&&this._backendServiceApi&&this._backendServiceApi.service.resetPaginationOptions()),this._availablePageSizes=n.pageSizes||[],!this._totalItems&&n.totalItems&&(this._totalItems=n.totalItems),this.recalculateFromToIndexes()}this._pageCount=Math.ceil(this._totalItems/this._itemsPerPage),this.sharedService.currentPagination=this.getCurrentPagination(),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),t&&!lt(o,this.getFullPagination())&&this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),i&&!lt(o,this.getFullPagination())&&this.pubSubService.publish("onPaginationPresetsInitialized",this.getFullPagination());let r=this.getFullPagination();this._previousPagination={pageNumber:r.pageNumber,pageSize:r.pageSize,pageSizes:r.pageSizes,totalItems:this.totalItems}}resetPagination(e=!0,t=!0){this._isLocalGrid&&this.dataView&&this.sharedService?.gridOptions?.enablePagination&&this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:0}),this._cursorPageInfo=void 0,this.refreshPagination(!0,e),t&&this.grid.scrollTo(0)}togglePaginationVisibility(e){if(this.grid&&this.sharedService?.gridOptions){let t=e!==void 0?e:!this.sharedService.gridOptions.enablePagination;if(t&&this.goToFirstPage(),this._isLocalGrid&&this.dataView){let i=e?this._itemsPerPage:0;this.dataView.setPagingOptions({pageSize:i,pageNum:0})}this.sharedService.gridOptions.enablePagination=t,this.pubSubService.publish("onPaginationVisibilityChanged",{visible:t})}}processOnPageChanged(e,t,i){return console.assert(!this.isCursorBased||i,"Configured for cursor based pagination - cursorArgs expected"),this.pubSubService.publish("onBeforePaginationChange",this.getFullPagination())===!1?(this.resetToPreviousPagination(),Promise.resolve(this.getFullPagination())):new Promise((o,r)=>{if(this.recalculateFromToIndexes(),this._isLocalGrid&&this.dataView)this.dataView.setPagingOptions({pageSize:this._itemsPerPage,pageNum:e-1}),this.pubSubService.publish("onPaginationChanged",this.getFullPagination()),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),o(this.getFullPagination());else{let n=+this._itemsPerPage,a=new Date;if(this._backendServiceApi?.preProcess&&this._backendServiceApi.preProcess(),this._backendServiceApi?.process){let l=this.isCursorBased&&i?this._backendServiceApi.service.processOnPaginationChanged(t,i):this._backendServiceApi.service.processOnPaginationChanged(t,{newPage:e,pageSize:n}),d=this._backendServiceApi.process(l);d instanceof Promise?d.then(c=>{this.backendUtilities?.executeBackendProcessesCallback(a,c,this._backendServiceApi,this._totalItems);let h=this.getFullPagination();this._previousPagination={pageNumber:h.pageNumber,pageSize:h.pageSize,pageSizes:h.pageSizes,totalItems:this.totalItems},o(this.getFullPagination())}).catch(c=>{this.resetToPreviousPagination(),this.backendUtilities?.onBackendError(c,this._backendServiceApi),(!this._backendServiceApi?.onError||!this.backendUtilities?.onBackendError)&&r(d)}):this.rxjs?.isObservable(d)&&this._subscriptions.push(d.subscribe(c=>{let h=this.getFullPagination();this._previousPagination={pageNumber:h.pageNumber,pageSize:h.pageSize,pageSizes:h.pageSizes,totalItems:this.totalItems},o(this.backendUtilities?.executeBackendProcessesCallback(a,c,this._backendServiceApi,this._totalItems))},c=>{this.resetToPreviousPagination(),this.backendUtilities?.onBackendError(c,this._backendServiceApi),(!this._backendServiceApi?.onError||!this.backendUtilities?.onBackendError)&&r(d)})),this.pubSubService.publish("onPaginationRefreshed",this.getFullPagination()),this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}})}recalculateFromToIndexes(){((this._pageNumber-1)*this._itemsPerPage>this._totalItems||this._totalItems>0&&this._pageNumber===0)&&(this._pageNumber=1),this._totalItems===0?(this._dataFrom=0,this._dataTo=1,this._pageNumber=0):(this._dataFrom=this._pageNumber>1?this._pageNumber*this._itemsPerPage-this._itemsPerPage+1:1,this._dataTo=this._totalItems<this._itemsPerPage?this._totalItems:(this._pageNumber||1)*this._itemsPerPage,this._dataTo>this._totalItems&&(this._dataTo=this._totalItems)),this._dataTo>this._totalItems?this._dataTo=this._totalItems:this._totalItems<this._itemsPerPage&&(this._dataTo=this._totalItems)}resetToPreviousPagination(){let e=this._previousPagination?.pageNumber!==this.getFullPagination().pageNumber,t=this._previousPagination?.pageSize!==this.getFullPagination().pageSize;t&&this.changeItemPerPage(this._previousPagination?.pageSize??0,null,!1),e&&this.goToPageNumber(this._previousPagination?.pageNumber??0,null,!1),(e||t)&&(this.refreshPagination(),this._backendServiceApi?.service?.updatePagination?.(this._previousPagination?.pageNumber??0,this._previousPagination?.pageSize??0))}setCursorBased(e){this._isCursorBased=e,e&&this.setCursorPageInfo({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1}),this.goToFirstPage(),this.pubSubService.publish("onPaginationSetCursorBased",{isCursorBased:e})}setCursorPageInfo(e){this._cursorPageInfo=e}updateTotalItems(e,t=!1){this._totalItems=e,this._paginationOptions&&(this._paginationOptions.totalItems=e,this.refreshPagination(!1,t))}processOnItemsAddedOrRemoved(e,t=!0){if(Array.isArray(e)&&e.length>0){let i=this._dataTo,o=e.length,r=t?+o:-o;this._totalItems+=r,this.recalculateFromToIndexes(),this._dataTo=i+r,this.pubSubService.publish("onPaginationChanged",this.getFullPagination())}}};var Jm=20,ep=25,tp=35,ip=180,op=300,sp=200,Fr=class{get autoHeightRecalcRow(){return this._autoHeightRecalcRow||100}get isAutoHeightEnabled(){return!!(this.gridOptions.enableAutoResize&&this.gridOptions.autoResize?.autoHeight)}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}get dataView(){return this._grid?.getData()}get gridUid(){return this._grid?.getUID()??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get intervalRetryDelay(){return this._intervalRetryDelay}set intervalRetryDelay(e){this._intervalRetryDelay=e}get resizeByContentOptions(){return this.gridOptions?.resizeByContentOptions??{}}constructor(e){this.pubSubService=e,this._allHeaderHeight=0,this._autoHeightRecalcRow=0,this._intervalRetryDelay=sp,this._isStopResizeIntervalRequested=!1,this._hasResizedByContentAtLeastOnce=!1,this._totalColumnsWidthByContent=0,this._resizePaused=!1,this._subscriptions=[],this._singleCharWidth=0,this._eventHandler=new G,this._bindingEventService=new oe}dispose(){this._eventHandler?.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),clearInterval(this._intervalId),clearTimeout(this._timer),this.gridOptions.autoResize?.resizeDetection==="container"&&this._resizeObserver&&this._resizeObserver.disconnect(),this._bindingEventService.unbindAll()}init(e,t){if(!e||!this.gridOptions||!t)throw new Error(`
      [Slickgrid-Universal] Resizer Service requires a valid Grid object and DOM Element Container to be provided.
      You can fix this by setting your gridOption to use "enableAutoResize" or create an instance of the ResizerService by calling bindAutoResizeDataGrid() once.`);this._grid=e,this._gridContainerElm=t;let i=this.gridOptions?.gridHeight||this.gridOptions?.gridWidth?{height:this.gridOptions?.gridHeight,width:this.gridOptions?.gridWidth}:void 0;this._autoResizeOptions=this.gridOptions?.autoResize??{container:"grid1",bottomPadding:0},i?.width&&t?.style&&(t.style.width=typeof i.width=="string"?i.width:`${i.width}px`),this._gridDomElm=e.getContainerNode(),typeof this._autoResizeOptions.container=="string"?this._pageContainerElm=typeof this._autoResizeOptions.container=="string"?document.querySelector(this._autoResizeOptions.container):this._autoResizeOptions.container:this._pageContainerElm=this._autoResizeOptions.container,i&&(this._fixedHeight=i.height,this._fixedWidth=i.width),this.gridOptions.enableAutoResize&&(this._autoHeightRecalcRow=this.gridOptions.autoResize?.autoHeightRecalcRow??100,this.bindAutoResizeDataGrid()),this.gridOptions.autoResize&&this._subscriptions.push(this.pubSubService.subscribe("onFullResizeByContentRequested",()=>this.resizeColumnsByCellContent(!0))),this._eventHandler.subscribe(this._grid.onAutosizeColumns,()=>{this.cacheHeaderHeightTotal()}),this.gridOptions.enableColumnResizeOnDoubleClick&&(this._subscriptions.push(this.pubSubService.subscribe("onHeaderMenuColumnResizeByContent",o=>{this.handleSingleColumnResizeByContent(o.columnId)})),this._eventHandler.subscribe(this._grid.onColumnsResizeDblClick,(o,r)=>{this.handleSingleColumnResizeByContent(r.triggeredByColumn)}))}bindAutoResizeDataGrid(e){if(this.gridOptions.autoResize?.resizeDetection==="container"){if(!this._pageContainerElm||!this._pageContainerElm)throw new Error(`
          [Slickgrid-Universal] Resizer Service requires a container when gridOption.autoResize.resizeDetection="container"
          You can fix this by setting your gridOption.autoResize.container`);this._resizeObserver||(this._resizeObserver=new ResizeObserver(()=>this.resizeObserverCallback())),this._resizeObserver.observe(this._pageContainerElm)}else{if(this._gridDomElm===void 0)return null;this.resizeGrid().then(()=>this.resizeGridWhenStylingIsBrokenUntilCorrected()).catch(t=>console.log("Error:",t)),this.resizeGrid(10,e),this._bindingEventService.bind(window,"resize",()=>{this.handleResizeGrid(e)})}}handleResizeGrid(e){this.pubSubService.publish("onGridBeforeResize"),this._resizePaused||(this.resizeGrid(0,e),this.resizeGrid(0,e))}resizeObserverCallback(){this._resizePaused||this.resizeGrid()}cacheHeaderHeightTotal(){let e=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-topheader-panel`),t=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-pane-header`),i=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-headerrow`);this._allHeaderHeight=(e?.offsetHeight||0)+(t?.offsetHeight||0)+(i?.offsetHeight||0)}calculateGridNewDimensions(e){let t=e?.autoResize??{},i=_e(this._gridDomElm);if(!window||!this._gridDomElm)return null;let o=t?.bottomPadding??Jm;if(o&&e.enablePagination&&(o+=tp),o&&e.showCustomFooter){let f=this.gridOptions?.customFooterOptions?.footerHeight??ep;o+=parseInt(`${f}`,10)}let r=0,n=0;t.calculateAvailableSizeBy==="container"?r=Gi(this._pageContainerElm,"height")||0:(r=window.innerHeight||0,n=i.top);let a=r-n-o,l=Gi(this._pageContainerElm,"width")||window.innerWidth||0,d=t?.maxHeight,c=t?.minHeight??ip,h=t?.maxWidth,u=t?.minWidth??op,m=a,g=t?.rightPadding?l-t.rightPadding:l;if(e.enableAutoResize&&this.isAutoHeightEnabled){let f=this.dataView.getLength();if(f<this.autoHeightRecalcRow){this._allHeaderHeight||this.cacheHeaderHeightTotal();let b=f*e.rowHeight,v=this._allHeaderHeight+b;v<m&&(m=v)}}return m<c&&(m=c),d&&m>d&&(m=d),g<u&&(g=u),h&&g>h&&(g=h),{height:this._fixedHeight||m,width:this._fixedWidth||g}}getLastResizeDimensions(){return this._lastDimensions}pauseResizer(e){this._resizePaused=e}resizeGrid(e,t){return new Promise(i=>{e=e||0,e>0?(clearTimeout(this._timer),this._timer=setTimeout(()=>i(this.resizeGridCallback(t)),e)):i(this.resizeGridCallback(t))})}resizeGridCallback(e){let t=this.resizeGridWithDimensions(e);return this.pubSubService.publish("onGridAfterResize",t),this.gridOptions.enableAutoResizeColumnsByCellContent&&(!this._lastDimensions?.width||t?.width!==this._lastDimensions?.width)&&this.resizeColumnsByCellContent(!1),this._lastDimensions=t,t}resizeGridWithDimensions(e){let t=this.calculateGridNewDimensions(this.gridOptions);if((e||t)&&this._gridDomElm){let i=e?.height?e.height:t?.height,o=e?.width?e.width:t?.width;this.gridOptions.autoHeight||(this._gridDomElm.style.height=`${i}px`),this._gridDomElm.style.width=typeof o=="string"?o:`${o||1}px`,this._gridContainerElm&&(this._gridContainerElm.style.width=typeof o=="string"?o:`${o}px`),this._grid?.resizeCanvas&&this._gridContainerElm&&this._grid.resizeCanvas(),this._grid&&this.gridOptions?.enableAutoSizeColumns?this.gridUid&&document.querySelector(this.gridUidSelector)&&(!this._lastDimensions||this._lastDimensions.height!==i||this._lastDimensions.width!==o)&&this._grid.autosizeColumns():this.gridOptions.enableAutoResizeColumnsByCellContent&&(!this._lastDimensions?.width||o!==this._lastDimensions?.width)&&this.resizeColumnsByCellContent(!1),this._gridDomElm.style.width=typeof o=="string"?o:`${(o||1)+.2}px`,this._lastDimensions={height:i||0,width:o||0}}return this._lastDimensions}requestStopOfAutoFixResizeGrid(e=!0){this._isStopResizeIntervalRequested=e}resizeColumnsByCellContent(e=!1){let t=this._grid.getColumns(),i=this.dataView.getItems(),o={},r=!1,n=0,a=this._gridContainerElm?.offsetWidth??0;if(!Array.isArray(i)||i.length===0||!e&&this._totalColumnsWidthByContent>0&&this._totalColumnsWidthByContent<a){this._grid.autosizeColumns();return}if(this._hasResizedByContentAtLeastOnce&&this.gridOptions?.resizeByContentOnlyOnFirstLoad&&!e)return;if(this.pubSubService.publish("onBeforeResizeByContent",void 0,0),this._totalColumnsWidthByContent===0||e){for(let c of t)o[c.id]=c.originalWidth??c.minWidth??0;n=this.calculateCellWidthByReadingDataset(t,o,this.resizeByContentOptions.maxItemToInspectCellContentWidth);let d=0;for(let c of t){let h=c.resizeAlwaysRecalculateWidth??this.resizeByContentOptions.alwaysRecalculateColumnWidth??!1;c.originalWidth&&!h?c.width=c.originalWidth:o[c.id]!==void 0&&(c.rerenderOnResize&&(r=!0),this.applyNewCalculatedColumnWidthByReference(c,o[c.id])),d+=c.width||0,this._totalColumnsWidthByContent=d}}this._grid.setColumns(t),this._hasResizedByContentAtLeastOnce=!0;let l={};for(let d of t)l[d.id]=d.width;this._totalColumnsWidthByContent>a?this._grid.reRenderColumns(r):this._grid.autosizeColumns(),this.pubSubService.publish("onAfterResizeByContent",{readItemCount:n,calculateColumnWidths:l})}calculateCellWidthByReadingDataset(e,t,i=1e3,o){let r=Array.isArray(e)?e:[e],n=this.dataView.getItems();this._singleCharWidth||(this._singleCharWidth=this.getAverageCharWidthByFont());let a=0,l={};for(let[d,c]of n.entries()){if(d>i)break;r.forEach((h,u)=>{let m=Pi(h?.formatter,d,o??u,h,c,this._grid),g=Dt(m)?Ze(m):"";(!l[h.id]||g.length>l[h.id].length)&&(l[h.id]=g)}),a=d+1}return r.forEach(d=>{let c=this.resizeByContentOptions.cellCharWidthInPx??this._singleCharWidth,h=d?.resizeCharWidthInPx??c,u=l[d.id]||"",m=Math.ceil(u.length*h),g=d.resizeMaxWidthThreshold,f=m;g!==void 0&&m>g?f=g:d.maxWidth!==void 0&&m>d.maxWidth&&(f=d.maxWidth),d.minWidth!==void 0&&f<d.minWidth&&(f=d.minWidth),t[d.id]=f}),a}getAverageCharWidthByFont(){let e=0,t=this._gridContainerElm.querySelector(".grid-canvas");if(t){let i=!1,o=t.querySelector(".slick-cell");if(!o){let r=p("div",{className:"slick-row"});o=p("div",{className:"slick-cell"}),r.appendChild(o),t.appendChild(r),i=!0}if(o){let{fontFamily:r,fontSize:n}=getComputedStyle(o),a=this.getBrowserCanvas();a.font=`${n} ${r}`;let l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-={}:<>?,./ ";e=a.measureText(l).width/l.length,i&&t.querySelector(".slick-row")?.remove()}}return e}getBrowserCanvas(){return document.createElement("canvas").getContext("2d")}applyNewCalculatedColumnWidthByReference(e,t){let i=this.resizeByContentOptions.cellPaddingWidthInPx??6,o=this.resizeByContentOptions.formatterPaddingWidthInPx??6,r=e?.filter?.type??e?.type??_.string,n=t,a=e?.resizeCalcWidthRatio??this.resizeByContentOptions.defaultRatioForStringType??.9;n*=r==="string"?a:1,n+=i,e.resizeExtraWidthPadding&&(n+=e.resizeExtraWidthPadding),e.editor&&this.gridOptions.editable&&(n+=o),e.maxWidth!==void 0&&n>e.maxWidth&&(n=e.maxWidth),e.resizeMaxWidthThreshold!==void 0&&n>e.resizeMaxWidthThreshold&&(n=e.resizeMaxWidthThreshold),n=Math.ceil(n),(e.originalWidth===void 0||e.resizeAlwaysRecalculateWidth===!0||this.resizeByContentOptions.alwaysRecalculateColumnWidth===!0)&&(e.width=this.readjustNewColumnWidthWhenOverLimit(e,n))}handleSingleColumnResizeByContent(e){let t=this._grid.getColumns(),i=t.findIndex(o=>o.id===e);if(i>=0){let o=t[i],r={[e]:o.originalWidth??o.minWidth??0};o.originalWidth=void 0,this.calculateCellWidthByReadingDataset(o,r,this.resizeByContentOptions.maxItemToInspectSingleColumnWidthByContent,i),this.applyNewCalculatedColumnWidthByReference(o,r[e]),this._grid.reRenderColumns(o?.rerenderOnResize??!1)}}readjustNewColumnWidthWhenOverLimit(e,t){let i=this.gridOptions.frozenColumn??-1,o=this._grid.getColumns().findIndex(n=>n.id===e.id)??0,r=t;if(i>=0&&o<=i){let n=Array.from(this._grid.getViewports());if(n){let a=n.find(u=>u.classList.contains("slick-viewport-left"))?.clientWidth??0,l=n.find(u=>u.classList.contains("slick-viewport-right"))?.clientWidth??0,d=a+l,c=a-(e.width??0);if(c+t>d){let u=this.resizeByContentOptions.widthToRemoveFromExceededWidthReadjustment??50;r=a-c+l-u}}}return Math.ceil(r)}checkIsGridShown(){return!!(document.querySelector(`${this.gridUidSelector}`)?.offsetParent??!1)}resizeGridWhenStylingIsBrokenUntilCorrected(){let e=this.gridOptions?.autoFixResizeTimeout??18e3,t=this.gridOptions?.autoFixResizeRequiredGoodCount??5,i=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-header`),o=this._gridContainerElm.querySelector(`${this.gridUidSelector} .slick-viewport`),r=0,n=0;if(i&&o&&this.gridOptions.autoFixResizeWhenBrokenStyleDetected){let a=this.dataView.getItemCount(),l=this._grid.getColumns()||[];this._intervalId=setInterval(async()=>{let c=_e(i),h=c.top;this.gridOptions?.enableFiltering&&this.gridOptions.headerRowHeight&&(h+=this.gridOptions.headerRowHeight),this.gridOptions?.createPreHeaderPanel&&this.gridOptions.showPreHeaderPanel&&this.gridOptions.preHeaderPanelHeight&&(h+=this.gridOptions.preHeaderPanelHeight),h+=44;let m=_e(o).top,g=_e(this._gridContainerElm),f=c?.top===0||h-m>2||g.left===0&&g.top===0,b=this._grid.getRenderedRange()?.rightPx??0;!f&&a>0&&b===0&&l.length>1&&(f=!0),this._isStopResizeIntervalRequested&&(f=!1,r=e),this.checkIsGridShown()&&(f||g.left===0||g.top===0)&&(await this.resizeGrid(),n<5&&this._grid.updateColumns(),this.checkIsGridShown()&&(f=!1)),this.checkIsGridShown()&&n++,this.checkIsGridShown()&&!f&&(n>=t||r++>=e)&&clearInterval(this._intervalId)},this.intervalRetryDelay)}}};var go=class{constructor(){this.currentPagination=null,this.isItemsDateParsed=!1,this.frozenVisibleColumnId="",this.hasColumnsReordered=!1,this.hideHeaderRowAfterPageLoad=!1}get allColumns(){return this._allColumns}set allColumns(e){this._allColumns=e}get columnDefinitions(){return this.slickGrid?.getColumns()??[]}get gridOptions(){return this._gridOptions||this.slickGrid?.getOptions()||{}}set gridOptions(e){this._gridOptions=e}get externalRegisteredResources(){return this._externalRegisteredResources}set externalRegisteredResources(e){this._externalRegisteredResources=e}get visibleColumns(){return this._visibleColumns}set visibleColumns(e){this._visibleColumns=e}get hierarchicalDataset(){return this._hierarchicalDataset}set hierarchicalDataset(e){this._hierarchicalDataset=e}};var Nr=class{constructor(e,t,i,o,r){this.collectionService=e,this.sharedService=t,this.pubSubService=i,this.backendUtilities=o,this.rxjs=r,this._currentLocalSorters=[],this._isBackendGrid=!1,this._eventHandler=new G,this.rxjs&&(this.httpCancelRequests$=this.rxjs.createSubject())}get eventHandler(){return this._eventHandler}get _gridOptions(){return this._grid?.getOptions()??{}}get _columnDefinitions(){return this._grid?.getColumns()??[]}dispose(){this._eventHandler?.unsubscribeAll(),this.httpCancelRequests$&&this.rxjs?.isObservable(this.httpCancelRequests$)&&(this.httpCancelRequests$.next(),this.httpCancelRequests$.complete())}addRxJsResource(e){this.rxjs=e}bindBackendOnSort(e){this._isBackendGrid=!0,this._grid=e,this._dataView=e?.getData(),this._eventHandler.subscribe(e.onSort,this.onBackendSortChanged.bind(this))}bindLocalOnSort(e){this._isBackendGrid=!1,this._grid=e,this._dataView=e?.getData(),this.processTreeDataInitialSort(),this._eventHandler.subscribe(e.onSort,this.handleLocalOnSort.bind(this)),this._gridOptions.preParseDateColumns&&(this._eventHandler.subscribe(e.onCellChange,(t,i)=>this.preParseSingleDateItem(i.item)),this.pubSubService.subscribe(["onItemsAdded","onItemsUpdated"],t=>this.preParseSingleDateItem(t)))}preParseSingleDateItem(e){this._gridOptions.preParseDateColumns&&(Array.isArray(e)?e:[e]).forEach(i=>this.collectionService.parseSingleDateItem(i,this._grid,this._gridOptions.preParseDateColumns))}preParseAllDateItems(){if(this._gridOptions.preParseDateColumns){let e=this._dataView?.getItems()||[];this.collectionService.preParseByMutationDateItems(e,this._grid,this._gridOptions.preParseDateColumns),this.sharedService.isItemsDateParsed=!0}}handleLocalOnSort(e,t){let i=t.multiColumnSort?t.sortCols:new Array({columnId:t.sortCol?.id??"",sortAsc:t.sortAsc,sortCol:t.sortCol});this._currentLocalSorters=[],Array.isArray(i)&&i.forEach(o=>{o.sortCol&&this._currentLocalSorters.push({columnId:o.sortCol.id,direction:o.sortAsc?Et.ASC:Et.DESC})}),this.onLocalSortChanged(this._grid,i),this.emitSortChanged("local")}clearSortByColumnId(e,t){let i=this.getCurrentColumnSorts(),o=this.getCurrentColumnSorts(`${t}`);if(Array.isArray(i)&&Array.isArray(o)&&i.length!==o.length){if(this._gridOptions.backendServiceApi)this.onBackendSortChanged(e,{multiColumnSort:!0,sortCols:o,grid:this._grid});else if(this._dataView)this.onLocalSortChanged(this._grid,o,!0,!0);else{let a=this._gridOptions.multiColumnSort||!1?o:o[0];this._grid.onSort.notify(a)}let r=o.map(n=>({columnId:n?.sortCol?.id??"",sortAsc:n?.sortAsc,sortCol:n?.sortCol}));this._grid.setSortColumns(r)}Array.isArray(o)&&o.length===0&&this.sortLocalGridByDefaultSortFieldId()}clearSorting(e=!0){if(this._grid&&this._gridOptions&&this._dataView){if(this._grid.setSortColumns([]),e)this._isBackendGrid?this.onBackendSortChanged(void 0,{grid:this._grid,multiColumnSort:!0,sortCols:[],clearSortTriggered:!0}):this._columnDefinitions&&Array.isArray(this._columnDefinitions)&&this._columnDefinitions.length>0&&this.sortLocalGridByDefaultSortFieldId();else if(this._isBackendGrid){let t=this._gridOptions.backendServiceApi?.service;t?.clearSorters&&t.clearSorters()}}this._currentLocalSorters=[],this.pubSubService.publish("onSortCleared",!0)}disableSortFunctionality(e=!0,t=!0){let o=!this._gridOptions.enableSorting;this._gridOptions.enableSorting=o;let r;e?(t&&this.clearSorting(),this._eventHandler.unsubscribeAll(),r=this.disableAllSortingCommands(!0)):(r=this.disableAllSortingCommands(!1),this._eventHandler.subscribe(this._grid.onSort,(n,a)=>this.handleLocalOnSort(n,a))),this._grid.setOptions({enableSorting:this._gridOptions.enableSorting},!1,!0),this.sharedService.gridOptions=this._gridOptions,this._grid.setColumns(r)}toggleSortFunctionality(e=!0){let t=this._gridOptions.enableSorting;this.disableSortFunctionality(t,e)}emitSortChanged(e,t){if(e==="remote"&&this._gridOptions.backendServiceApi){let i=[],o=this._gridOptions.backendServiceApi.service;o?.getCurrentSorters&&(i=o.getCurrentSorters()),this.pubSubService.publish("onSortChanged",i)}else e==="local"&&(t&&(this._currentLocalSorters=t),this.pubSubService.publish("onSortChanged",this.getCurrentLocalSorters()))}getCurrentLocalSorters(){return this._currentLocalSorters}getCurrentColumnSorts(e){if(this._grid){let t=this._grid.getSortColumns();if(Array.isArray(t))return t.reduce((o,r)=>(r&&(!e||r.columnId!==e)&&o.push({columnId:r.columnId||"",sortCol:this._columnDefinitions[this._grid.getColumnIndex(r.columnId||"")],sortAsc:r.sortAsc}),o),[])}return[]}loadGridSorters(e){this._currentLocalSorters=[];let t=[];return Array.isArray(e)&&((this._gridOptions.multiColumnSort?e:e.slice(0,1)).forEach(o=>{let r=this._columnDefinitions.find(n=>n.id===o.columnId);if(r){if(!r.sortable){let n="[Slickgrid-Universal] Cannot add sort icon to a column that is not sortable, please add `sortable: true` to your column or remove it from your list of columns to sort.";throw this._gridOptions.enableTreeData&&(n+=" Also note that TreeData feature requires the column holding the tree (expand/collapse icons) to be sortable."),new Error(n)}t.push({columnId:r.id,sortAsc:o.direction.toUpperCase()===Et.ASC,sortCol:r}),this._currentLocalSorters.push({columnId:String(r.id),direction:o.direction.toUpperCase()})}}),this.onLocalSortChanged(this._grid,t),this._grid.setSortColumns(t.map(o=>({columnId:o.columnId,sortAsc:o.sortAsc})))),t}processTreeDataInitialSort(){if(this._gridOptions.enableTreeData&&this._gridOptions.treeDataOptions){let e=this._gridOptions.treeDataOptions,t=this._columnDefinitions.find(i=>i.id===e.columnId);if(t){let i=Et.ASC,o={columnId:e.columnId,sortCol:t,sortAsc:!0};if(e?.initialSort?.columnId){let r=e.initialSort.columnId,n=this._columnDefinitions.find(a=>a.id===r);i=(e.initialSort.direction||Et.ASC).toUpperCase(),o={columnId:r,sortCol:n,sortAsc:i===Et.ASC}}o?.columnId&&this.sharedService?.hierarchicalDataset&&this.updateSorting([{columnId:o.columnId||"",direction:i}])}}}onBackendSortChanged(e,t){if(!t?.grid)throw new Error('Something went wrong when trying to bind the "onBackendSortChanged(event, args)" function, it seems that "args" is not populated correctly');let i=t.grid?.getOptions()??{},o=i.backendServiceApi;if(!o||!o.process||!o.service)throw new Error('BackendServiceApi requires at least a "process" function and a "service" defined');let r=new Date;o.preProcess?.();let n=o.service.processOnSortChanged(e,t),a=i?.pagination?.totalItems||0;this.backendUtilities?.executeBackendCallback(o,n,t,r,a,{emitActionChangedCallback:this.emitSortChanged.bind(this),errorCallback:()=>{this._grid.setSortColumns(t.previousSortColumns||[]);let l=t.previousSortColumns?.map(d=>({columnId:d.columnId,sortAsc:d.sortAsc,sortCol:this._columnDefinitions.find(c=>c.id===d.columnId)}));o?.service?.updateSorters?.(l||[])},httpCancelRequestSubject:this.httpCancelRequests$})}async onLocalSortChanged(e,t,i=!1,o=!1){let r=this._gridOptions.datasetIdPropertyName||"id",n=this._gridOptions.enableTreeData||!1,a=e.getData();if(await this.pubSubService.publish("onBeforeSortChange",{sortColumns:t},0),e&&a){if(this._gridOptions.preParseDateColumns&&!this.sharedService.isItemsDateParsed&&t.some(l=>ut(l.sortCol?.type))&&this.preParseAllDateItems(),i&&!n&&a.reSort(),n&&this._dataView&&this.sharedService&&Array.isArray(this.sharedService.hierarchicalDataset)){let l=this.sortHierarchicalDataset(this.sharedService.hierarchicalDataset,t);this._dataView.setItems(l.flat,r),this._dataView.onRowCountChanged.notify({previous:this._dataView.getFilteredItemCount(),current:this._dataView.getLength(),itemCount:this._dataView.getItemCount(),dataView:this._dataView,callingOnRowsChanged:!0})}else a.sort(this.sortComparers.bind(this,t));e.invalidate(),o&&this.emitSortChanged("local",t.map(l=>({columnId:l.sortCol?.id??"id",direction:l.sortAsc?Et.ASC:Et.DESC})))}}sortHierarchicalDataset(e,t,i=!1){this.sortTreeData(e,t);let o=this._gridOptions.datasetIdPropertyName||"id",r=this._gridOptions.treeDataOptions||{columnId:""},n={...r,identifierPropName:r.identifierPropName??o,shouldAddTreeLevelNumber:!0},a=In(e,n);if(i){this._currentLocalSorters=[],t.forEach(d=>{this._currentLocalSorters.push({columnId:d.columnId,direction:d.sortAsc?"ASC":"DESC"})});let l=this._gridOptions.backendServiceApi?"remote":"local";this.emitSortChanged(l)}return{hierarchical:e,flat:a}}sortLocalGridByDefaultSortFieldId(){let e=this._gridOptions&&this._gridOptions.defaultColumnSortFieldId||this._gridOptions.datasetIdPropertyName||"id",t={id:e,field:e};this.onLocalSortChanged(this._grid,new Array({columnId:t.id,sortAsc:!0,sortCol:t,clearSortTriggered:!0}),!1,!0)}sortComparers(e,t,i){if(Array.isArray(e))for(let o of e){let r=this.sortComparer(o,t,i);if(r!==void 0)return r}return ce.neutral}sortComparer(e,t,i,o){if(e?.sortCol){let r=e.sortCol,n=r.type||_.string,a=e.sortAsc?ce.asc:ce.desc,l=o||r.queryFieldSorter||r.queryField||r.field;this._gridOptions.preParseDateColumns&&ut(n)&&e?.columnId&&(l=typeof this._gridOptions.preParseDateColumns=="string"?`${this._gridOptions.preParseDateColumns}${e.columnId}`:`${e.columnId}`);let d=l;typeof r.queryFieldNameGetterFn=="function"&&(l=r.queryFieldNameGetterFn(t),d=r.queryFieldNameGetterFn(i));let c=t[l],h=i[d];if(l?.indexOf(".")>=0&&(c=ge(t,l)),d?.indexOf(".")>=0&&(h=ge(i,d)),r.sortComparer){let u=r.sortComparer(c,h,a,r,this._gridOptions);if(u!==ce.neutral)return u}else{let u=jt(n,c,h,a,r,this._gridOptions);if(u!==ce.neutral)return u}}}sortTreeData(e,t){Array.isArray(t)&&t.forEach(i=>{this.sortTreeChildren(e,i,0)})}sortTreeChildren(e,t,i){let o=this._gridOptions.treeDataOptions?.childrenPropName??"children";e.sort((r,n)=>this.sortComparer(t,r,n)??ce.neutral),e.forEach(r=>{r&&r.hasOwnProperty(o)&&Array.isArray(r[o])&&(i++,this.sortTreeChildren(r[o],t,i),i--)})}updateSorting(e,t=!0,i=!0){if(!this._gridOptions||!this._gridOptions.enableSorting)throw new Error('[Slickgrid-Universal] in order to use "updateSorting" method, you need to have Sortable Columns defined in your grid and "enableSorting" set in your Grid Options');if(Array.isArray(e)){let o=this._gridOptions.backendServiceApi;if(o){let r=o?.service;r?.updateSorters&&(r.updateSorters(void 0,e),i&&this.backendUtilities?.refreshBackendDataset(this._gridOptions))}else this.loadGridSorters(e);if(t){let r=o?"remote":"local";this.emitSortChanged(r)}}}disableAllSortingCommands(e=!0){let t=this._grid.getColumns();t.forEach(o=>{o.sortable!==void 0&&(o.sortable=!e),o?.header?.menu&&o.header.menu.commandItems?.forEach(r=>{if(r&&typeof r!="string"){let n=r.command;(n==="sort-asc"||n==="sort-desc"||n==="clear-sort")&&(r.hidden=e)}})});let i=this._gridOptions.gridMenu?.commandItems;return i&&i.forEach(o=>{o&&typeof o!="string"&&o.command==="clear-sorting"&&(o.hidden=e)}),t}};var zr=class{constructor(e,t,i,o){this.pubSubService=e,this.filterService=t,this.sharedService=i,this.sortService=o,this._currentToggledItems=[],this._isLastFullToggleCollapsed=!1,this._isOneCpuCyclePassed=!1,this._isTreeDataEnabled=!1,this._subscriptions=[],this._treeDataRecalcHandler=null,this._eventHandler=new G,setTimeout(()=>this._isOneCpuCyclePassed=!0)}set currentToggledItems(e){this._currentToggledItems=e}get dataset(){return this.dataView?.getItems()}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}get dataView(){return this._grid?.getData()}get eventHandler(){return this._eventHandler}get gridOptions(){return this._grid?.getOptions()??{}}get datasetIdPropName(){return this.gridOptions.datasetIdPropertyName||"id"}get treeDataOptions(){return this.gridOptions.treeDataOptions}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions)}init(e){if(this._grid=e,this._isTreeDataEnabled=this.gridOptions?.enableTreeData??!1,this._isLastFullToggleCollapsed=this.treeDataOptions?.initiallyCollapsed??!1,this._currentToggledItems=this.gridOptions.presets?.treeData?.toggledItems??[],this._lastToggleStateChange={type:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this._isTreeDataEnabled){if(this.gridOptions?.multiColumnSort)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data with multi-column sorting, unfortunately it is not supported because of its complexity, you can disable it via "multiColumnSort: false" grid option and/or help in providing support for this feature.');if(!this.gridOptions?.enableFiltering)throw new Error('[Slickgrid-Universal] It looks like you are trying to use Tree Data without using the filtering option, unfortunately that is not possible with Tree Data since it relies heavily on the filters to expand/collapse the tree. You need to enable it via "enableFiltering: true"');if(this.gridOptions?.backendServiceApi||this.gridOptions?.enablePagination)throw new Error("[Slickgrid-Universal] It looks like you are trying to use Tree Data with Pagination and/or a Backend Service (OData, GraphQL) but unfortunately that is simply not supported because of its complexity.");if(!this.gridOptions.treeDataOptions||!this.gridOptions.treeDataOptions.columnId)throw new Error('[Slickgrid-Universal] When enabling tree data, you must also provide the "treeDataOption" property in your Grid Options with "childrenPropName" or "parentPropName" (depending if your array is hierarchical or flat) for the Tree Data to work properly.')}this.initHierarchicalTree(),this._eventHandler.subscribe(e.onClick,this.handleOnCellClick.bind(this)),this._subscriptions.push(this.pubSubService.subscribe("onGridMenuClearAllSorting",this.clearSorting.bind(this))),this._treeDataRecalcHandler=this.setAutoRecalcTotalsCallbackWhenFeatEnabled(this.gridOptions),this._eventHandler.subscribe(this.dataView.onRowCountChanged,()=>{typeof this._treeDataRecalcHandler=="function"&&this._isOneCpuCyclePassed&&(clearTimeout(this._timer),this._timer=setTimeout(()=>this._treeDataRecalcHandler?.(),this.treeDataOptions?.autoRecalcTotalsDebounce??0))})}initHierarchicalTree(){this.gridOptions?.treeDataOptions?.initiallyCollapsed&&this.toggleAllHierarchicalTree(this.datasetHierarchical||[],!0,he(this.treeDataOptions,"childrenPropName"),he(this.treeDataOptions,"collapsedPropName"),he(this.treeDataOptions,"lazyLoadingPropName"))}applyToggledItemStateChanges(e,t,i=!0,o=!1){if(Array.isArray(e)){let r=he(this.treeDataOptions,"collapsedPropName"),n=he(this.treeDataOptions,"hasChildrenPropName");this.dataView.beginUpdate(!0);let l=(t??this._lastToggleStateChange.previousFullToggleType)==="full-collapse";t&&(this._lastToggleStateChange.previousFullToggleType=t),i&&(this.dataView.getItems()||[]).forEach(d=>{d[n]&&(d[r]=l)}),this.dynamicallyToggleItemState(e,o)}}dynamicallyToggleItemState(e,t=!0){Array.isArray(e)&&(this.dataView.beginUpdate(!0),e.forEach(i=>{let o=this.dataView.getItemById(i.itemId);if(this.updateToggledItem(o,i.isCollapsed,!0),t){let r=this._currentToggledItems.findIndex(n=>n.itemId===i.itemId);r>=0?this._currentToggledItems[r].isCollapsed=i.isCollapsed:this._currentToggledItems.push({itemId:i.itemId,isCollapsed:i.isCollapsed}),this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:i.itemId,toggledItems:this._currentToggledItems,type:i.isCollapsed?"toggle-collapse":"toggle-expand"})}}),this.dataView.endUpdate(),this.dataView.refresh())}getCurrentToggleState(){return this._lastToggleStateChange}getInitialSort(e,t){let i=t?.treeDataOptions,o=i?.initialSort??{columnId:i?.columnId??"",direction:"ASC"},r=e.find(n=>n.id===o.columnId);return{columnId:o.columnId,sortAsc:o?.direction?.toUpperCase()!=="DESC",sortCol:r}}getItemCount(e){if(e!==void 0){let t=he(this.treeDataOptions,"levelPropName");return this.dataView.getItems().filter(i=>i[t]===e).length}return this.dataView.getItemCount()}getToggledItems(){return this._currentToggledItems}clearSorting(){let e=this.getInitialSort(this.sharedService.columnDefinitions,this.sharedService.gridOptions);this.sortService.loadGridSorters([{columnId:e.columnId,direction:e.sortAsc?"ASC":"DESC"}])}convertFlatParentChildToTreeDatasetAndSort(e,t,i,o){let r=this.convertFlatParentChildToTreeDataset(e,i),n=Array.isArray(o)&&o.length?o[0]:this.getInitialSort(t,i),a=this.sortService.sortHierarchicalDataset(r,[n],!0);return this._grid?.setSortColumns([n]),a}convertFlatParentChildToTreeDataset(e,t){let i=t?.treeDataOptions??{columnId:"id"},o={...i,identifierPropName:i.identifierPropName??this.datasetIdPropName,initiallyCollapsed:this._isLastFullToggleCollapsed};return Dn(e,o)}enableAutoRecalcTotalsFeature(e=!0){e&&this._isTreeDataEnabled?this._treeDataRecalcHandler=this.recalculateTreeTotals.bind(this,this.gridOptions):this._treeDataRecalcHandler=null}recalculateTreeTotals(e){let t=e.treeDataOptions,i=he(this.treeDataOptions,"childrenPropName"),o=he(this.treeDataOptions,"levelPropName");t?.aggregators&&(t.aggregators.forEach(r=>{Bi(this.sharedService.hierarchicalDataset||[],{childrenPropName:i,levelPropName:o,aggregator:r})}),this._grid.invalidate())}sortHierarchicalDataset(e,t){let i=t??this.getInitialSort(this.sharedService.allColumns,this.gridOptions),o=Array.isArray(i)?i:[i];return this.sortService.sortHierarchicalDataset(e,o)}async toggleTreeDataCollapse(e,t=!0){if(this.gridOptions?.enableTreeData){let o=he(this.treeDataOptions,"collapsedPropName"),r=he(this.treeDataOptions,"childrenPropName"),n=he(this.treeDataOptions,"hasChildrenPropName"),a=he(this.treeDataOptions,"lazyLoadingPropName");t&&await this.pubSubService.publish("onTreeFullToggleStart",{collapsing:e}),this.dataView.beginUpdate(!0),this.toggleAllHierarchicalTree(this.sharedService.hierarchicalDataset||[],e,r,o,a),this.toggleAllFlatDataItems(e,n,a),this.dataView.endUpdate(),this.dataView.refresh(),this._isLastFullToggleCollapsed=e}let i=e?"full-collapse":"full-expand";this._lastToggleStateChange={type:i,previousFullToggleType:i,toggledItems:null},t&&this.pubSubService.publish("onTreeFullToggleEnd",this._lastToggleStateChange)}checkIsLazyParentLoaded(e,t,i){return t||!this.treeDataOptions?.lazy||!t&&!(this.treeDataOptions.lazy&&!e[i])}handleOnCellClick(e,t){if(e&&t){let i=e.target||{},o=he(this.treeDataOptions,"collapsedPropName"),r=he(this.treeDataOptions,"childrenPropName"),n=he(this.treeDataOptions,"hasChildrenPropName"),a=he(this.treeDataOptions,"lazyLoadingPropName");if(typeof i?.className=="string"&&(i.className.indexOf("toggle")>=0||!1)){let d=this.dataView.getItem(t.row);if(d){d[o]=!d[o];let c=d[o],h=d[this.datasetIdPropName],u=this._currentToggledItems.findIndex(f=>f.itemId===h);u>=0?this._currentToggledItems[u].isCollapsed=c:this._currentToggledItems.push({itemId:h,isCollapsed:c}),this.dataView.updateItem(h,d);let m=f=>f[this.datasetIdPropName]===h,g=Ci(this.sharedService.hierarchicalDataset||[],m,r);if(g){if(!this.treeDataOptions?.lazy)g[o]=c;else if(typeof this.treeDataOptions.onLazyLoad=="function"&&!c&&(!g?.[a]||g[a]==="load-fail")){this.dataView?.updateItem(g[this.datasetIdPropName],{...g,[a]:"loading",[o]:!0,[n]:!0});let f=this.filterService.getPreviousFilters();this.treeDataOptions.onLazyLoad(g,b=>{if(g[o]=!1,b.length){b.forEach(C=>{C[r]&&(C[o]=!0)}),g[r]??=[],g[r].push(...b),g[a]="done";let v=this.sortService.getCurrentColumnSorts(),k=this.sortService.sortHierarchicalDataset(this.sharedService.hierarchicalDataset||[],v);this.dataView?.setItems(k.flat,this.datasetIdPropName)}else this.dataView?.updateItem(g[this.datasetIdPropName],{...g,[a]:"done",[n]:!0});f.length?this.filterService.updateFilters(f):this.filterService.refreshTreeDataFilters()},()=>{this.dataView?.updateItem(g[this.datasetIdPropName],{...g,[a]:"load-fail",[n]:!0})})}}this._grid.invalidate(),this._lastToggleStateChange={type:c?"toggle-collapse":"toggle-expand",previousFullToggleType:this._isLastFullToggleCollapsed?"full-collapse":"full-expand",toggledItems:this._currentToggledItems},this.pubSubService.publish("onTreeItemToggled",{...this._lastToggleStateChange,fromItemId:h})}e.stopImmediatePropagation()}}}updateToggledItem(e,t,i){let o=he(this.treeDataOptions,"childrenPropName"),r=he(this.treeDataOptions,"collapsedPropName");if(e&&(e[r]=t,this.dataView.updateItem(e[this.datasetIdPropName],e),i)){let n=l=>l[this.datasetIdPropName]===e[this.datasetIdPropName],a=Ci(this.sharedService.hierarchicalDataset||[],n,o);a&&(a[r]=t)}}setAutoRecalcTotalsCallbackWhenFeatEnabled(e){return e?.enableTreeData&&e?.treeDataOptions?.autoRecalcTotalsOnFilterChange&&e?.treeDataOptions?.aggregators?this.recalculateTreeTotals.bind(this,e):null}toggleAllHierarchicalTree(e,t,i,o,r){e.forEach(n=>{i in n&&this.checkIsLazyParentLoaded(n,t,r)&&(n[o]=t,this.toggleAllHierarchicalTree(n[i],t,i,o,r))})}toggleAllFlatDataItems(e,t,i){(this.dataView.getItems()||[]).forEach(r=>{r[t]&&this.checkIsLazyParentLoaded(r,e,i)&&this.updateToggledItem(r,e,!1)})}};var et=class{constructor(e){this.translaterService=e,this._debounceTypingDelay=0,this._shouldTriggerQuery=!0,this._inputType="text",this.inputFilterType="single",this.searchTerms=[],this._bindEventService=new oe}get columnFilter(){return this.columnDef?.filter??{}}get defaultOperator(){return N.empty}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}get gridOptions(){return this.grid?.getOptions()??{}}get isCompoundFilter(){return this.inputFilterType==="compound"}init(e){this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.isCompoundFilter&&(this.operator=e.operator||""),this.searchTerms=e?.searchTerms??[],this._cellContainerElm=e.filterContainerElm;let t=this.gridOptions?.backendServiceApi;this._debounceTypingDelay=(t?t?.filterTypingDebounce??this.gridOptions?.defaultBackendServiceFilterTypingDebounce:this.gridOptions?.filterTypingDebounce)??0;let i=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.columnDef.filter??={},this.columnDef.filter.emptySearchTermReturnAllValues??=!1,this.createDomFilterElement(i),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this)),this._bindEventService.bind(this._filterInputElm,"wheel",this.onTriggerEvent.bind(this),{passive:!0}),this.isCompoundFilter&&this._selectOperatorElm&&this._bindEventService.bind(this._selectOperatorElm,"change",this.onTriggerEvent.bind(this))}clear(e=!0){this._filterInputElm&&(this._shouldTriggerQuery=e,this.searchTerms=[],this._filterInputElm.value="",this._currentValue=void 0,this.updateFilterStyle(!1),this.isCompoundFilter&&this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this.onTriggerEvent(void 0,!0))}destroy(){this._bindEventService.unbindAll(),this._selectOperatorElm?.remove?.(),this._filterInputElm?.remove?.()}getValues(){return this._filterInputElm.value}setValues(e,t,i=!1){let o=Array.isArray(e)?e:[e],r="";for(let n of o)this.isCompoundFilter?r=`${n}`:r=t?this.addOptionalOperatorIntoSearchString(n,t):n,this._filterInputElm.value=`${r??""}`,this._currentValue=this._filterInputElm.value;if(this.updateFilterStyle(this.getValues()!==""),this.operator=t||this.defaultOperator,t&&this._selectOperatorElm){let n=Wt(this.operator);this._selectOperatorElm.value=n}i&&this.onTriggerEvent(void 0,!1)}addOptionalOperatorIntoSearchString(e,t){let i="",o="",r=e==null?"":`${e}`;if(t){switch(t){case"<>":case"!=":case"=":case"==":case">":case">=":case"<":case"<=":i=t;break;case"EQ":i="=";break;case"GE":i=">=";break;case"GT":i=">";break;case"NE":i="!=";break;case"LE":i="<=";break;case"LT":i="<";break;case"EndsWith":case"*z":i="*";break;case"StartsWith":case"a*":o="*";break}r=`${i}${this.trimValueWhenEnabled(r)}${o}`}return r}getCompoundOperatorOptionValues(){let e=this.columnDef.type&&this.columnDef.type?this.columnDef.type:_.string,t,i="text";if(this.columnFilter?.compoundOperatorList)t=this.columnFilter.compoundOperatorList;else switch(e){case _.string:case _.text:case _.readonly:case _.password:i="text",t=Vd(this.gridOptions,this.translaterService);break;default:i="numeric",t=Ji(this.gridOptions,this.translaterService);break}return eo(this.gridOptions,t,i),t}createDomFilterElement(e){let t=this.columnDef?.id??"";j(this._cellContainerElm);let i=this.gridOptions?.defaultFilterPlaceholder??"";this.columnFilter?.placeholder&&(i=this.columnFilter.placeholder);let o=`${e??""}`;if(this.isCompoundFilter||(o=this.addOptionalOperatorIntoSearchString(o,this.operator)),this._filterInputElm=p("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",placeholder:i,ariaLabel:this.columnFilter?.ariaLabel??`${Xe(t+"")} Search Filter`,className:`form-control filter-${t}`,value:o,dataset:{columnid:`${t}`}}),this.updateFilterStyle(!!e),e!==void 0&&(this._currentValue=o),!this.isCompoundFilter)this._filterContainerElm=this._filterInputElm,this._filterInputElm.classList.add("search-filter","slick-filter"),this._cellContainerElm.appendChild(this._filterInputElm),this._cellContainerElm.appendChild(document.createElement("span"));else{this._filterInputElm.classList.add("compound-input"),this._selectOperatorElm=Qi(this.getCompoundOperatorOptionValues(),this.grid),this._filterContainerElm=p("div",{className:`form-group search-filter slick-filter filter-${t}`});let r=p("div",{className:"input-group"},this._filterContainerElm);p("div",{className:"input-group-addon input-group-prepend operator"},r).appendChild(this._selectOperatorElm),r.appendChild(this._filterInputElm),r.appendChild(p("span")),this.operator&&(this._selectOperatorElm.value=Wt(this.operator)),this._filterContainerElm&&this._cellContainerElm.appendChild(this._filterContainerElm)}}trimValueWhenEnabled(e){let t=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;return typeof e=="string"&&t?e.trim():e}onTriggerEvent(e,t=!1){if(t)this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this.updateFilterStyle(!1);else{let i=e?.type||"",o=this._selectOperatorElm?.value??(this.isCompoundFilter?this.operator:""),r=this.trimValueWhenEnabled(this._filterInputElm.value);e?.target?.tagName.toLowerCase()!=="select"&&(this._currentValue=r),this.updateFilterStyle(r!=="");let n={columnDef:this.columnDef,operator:o,searchTerms:r?[r]:null,shouldTriggerQuery:this._shouldTriggerQuery},a=i==="keyup"&&e?.key!=="Enter"?this._debounceTypingDelay:0,l=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput,d=l&&q(this._currentValue)||this._currentValue===""&&q(this._lastSearchValue);(!this.isCompoundFilter||!l||d)&&(a>0?(clearTimeout(this._timer),this._timer=setTimeout(()=>this.callback(e,n),a)):this.callback(e,n)),this._lastSearchValue=r}this._shouldTriggerQuery=!0}updateFilterStyle(e){this._filterContainerElm?.classList.toggle("filled",e),this._filterInputElm.classList.toggle("filled",e)}};var Xo=class extends et{constructor(e){super(e),this.translaterService=e,this.inputType="text",this.inputFilterType="compound"}};var Br=class extends et{constructor(e){super(e),this.translaterService=e,this.inputType="number",this.inputFilterType="compound"}};var $r=class extends et{constructor(e){super(e),this.translaterService=e,this.inputType="password",this.inputFilterType="compound"}};var Ya="#86bff8",Wr=0,rp=20,gi=class{constructor(e){this.translaterService=e,this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this._sliderTrackFilledColor=Ya,this.sliderType="double",this.searchTerms=[],this._bindEventService=new oe}get columnFilter(){return this.columnDef?.filter??{}}get currentValue(){return this._currentValue}get currentValues(){return this._currentValues}get defaultOperator(){return this.sliderType==="compound"?N.empty:this.sliderType==="single"?N.greaterThanOrEqual:this.gridOptions.defaultFilterRangeOperator||N.rangeInclusive}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.slider,...this.columnFilter?.filterOptions,...this.columnFilter?.options}}get gridOptions(){return this.grid?.getOptions()??{}}get sliderOptions(){return this._sliderOptions}get operator(){return this._operator||(this.columnFilter.operator??this.defaultOperator)}set operator(e){this._operator=e}init(e){this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.operator=e.operator||"",this.searchTerms=e?.searchTerms??[],this._argFilterContainerElm=e.filterContainerElm,this._sliderTrackFilledColor=getComputedStyle(document.documentElement).getPropertyValue("--slick-slider-filter-filled-track-color")||Ya,this._filterElm=this.createDomFilterElement(this.searchTerms)}clear(e=!0){if(this._filterElm){this._clearFilterTriggered=!0,this._shouldTriggerQuery=e,this.searchTerms=[];let t=+(this.filterOptions?.sliderStartValue??x.SLIDER_DEFAULT_MIN_VALUE),i=+(this.filterOptions?.sliderEndValue??x.SLIDER_DEFAULT_MAX_VALUE);this.sliderType==="double"?(this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=`${t}`),this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${i}`),this._currentValues=[t,i],this._sliderLeftInputElm?.dispatchEvent(new Event("change")),this._sliderRightInputElm?.dispatchEvent(new Event("change"))):(this._sliderRightInputElm&&(this._sliderRightInputElm.value=`${t}`),this._selectOperatorElm&&(this._selectOperatorElm.selectedIndex=0),this._currentValue=t,this._sliderRightInputElm?.dispatchEvent(new Event("change"))),(this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers)||(this.sliderType==="double"?this.renderSliderValues(t,i):this.renderSliderValues(void 0,t)),this.updateFilterStyle(!1),this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:e,searchTerms:[]})}}destroy(){this._bindEventService.unbindAll(),this._sliderTrackElm?.remove(),this._sliderLeftInputElm?.remove(),this._sliderRightInputElm?.remove()}renderSliderValues(e,t,i=!0){let o=e?.toString()||"",r=t?.toString()||"";this._leftSliderNumberElm?.textContent&&(this._leftSliderNumberElm.textContent=o),this._rightSliderNumberElm?.textContent&&(this._rightSliderNumberElm.textContent=r),this._sliderRangeContainElm.title=this.sliderType==="double"?`${o} - ${r}`:`${r}`,i&&this.grid.onHeaderRowMouseLeave.notify({column:this.columnDef,grid:this.grid})}getValues(){return this.sliderType==="double"?this._currentValues:this._currentValue}setValues(e,t,i=!1){if(e){let n=[],a=Array.isArray(e)?e?.[0]:e;if(Array.isArray(e)&&e.length===2?n=e:typeof a=="string"&&a.indexOf("..")>0?(n=a.split(".."),this._currentValue=+(n?.[0]??0)):(q(a)||a==="")&&(this._currentValue=a===null?void 0:+a,n=[a]),this.sliderType!=="double"&&this._sliderRightInputElm)this._sliderRightInputElm.value=typeof e=="string"?e:`${a}`,this.renderSliderValues(void 0,this._sliderRightInputElm.value);else if(Array.isArray(n)&&n.length===2&&!this.filterOptions?.hideSliderNumbers){let[l,d]=n;this._sliderLeftInputElm&&(this._sliderLeftInputElm.value=String(l??x.SLIDER_DEFAULT_MIN_VALUE)),this._sliderRightInputElm&&(this._sliderRightInputElm.value=String(d??x.SLIDER_DEFAULT_MAX_VALUE)),this.renderSliderValues(...n)}}else this._currentValue=void 0,this._currentValues=void 0;let o=this.getValues(),r=o===void 0?[]:Array.isArray(o)?o:[o];if(this.updateFilterStyle(r.length>0),t!==void 0&&(this.operator=t),this.operator&&this._selectOperatorElm){let n=Wt(this.operator);this._selectOperatorElm.value=n}i&&this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:r,shouldTriggerQuery:!0})}createDomFilterElement(e){let t=this.columnDef?.id??"",i=+(this.columnFilter.minValue??x.SLIDER_DEFAULT_MIN_VALUE),o=+(this.columnFilter.maxValue??x.SLIDER_DEFAULT_MAX_VALUE),r=+(this.columnFilter.valueStep??x.SLIDER_DEFAULT_STEP);j(this._argFilterContainerElm);let n=+((Array.isArray(e)&&e?.[0])??this.filterOptions?.sliderStartValue??i),a=+((Array.isArray(e)&&e?.[1])??this.filterOptions?.sliderEndValue??o);if(this._sliderRangeContainElm=p("div",{className:`filter-input filter-${t} slider-input-container slider-values`,title:this.sliderType==="double"?`${n} - ${a}`:`${n}`}),this._sliderTrackElm=p("div",{className:"slider-track"}),this.sliderType==="compound"){let h=p("span",{className:"input-group-addon input-group-prepend operator"});this._selectOperatorElm=Qi(this.getOperatorOptionValues(),this.grid),h.appendChild(this._selectOperatorElm)}this.sliderType==="double"&&(this._sliderLeftInputElm=p("input",{type:"range",className:"slider-filter-input form-control",ariaLabel:this.columnFilter.ariaLabel??`${Xe(t+"")} Search Filter`,defaultValue:`${n}`,value:`${n}`,min:`${i}`,max:`${o}`,step:`${r}`}));let l=this.sliderType==="double"?a:n;this._sliderRightInputElm=p("input",{type:"range",className:"slider-filter-input form-control compound-input",ariaLabel:this.columnFilter.ariaLabel??`${Xe(t+"")} Search Filter`,defaultValue:`${l}`,value:`${l}`,min:`${i}`,max:`${o}`,step:`${r}`});let d=this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers,c=d?"":"input-group";if(this._divContainerFilterElm=p("div",{className:`${c} search-filter slick-filter slider-container slider-values filter-${t}`.trim()}),this._sliderRangeContainElm.appendChild(this._sliderTrackElm),this.sliderType==="double"&&this._sliderLeftInputElm&&this._sliderRangeContainElm.appendChild(this._sliderLeftInputElm),this._sliderRangeContainElm.appendChild(this._sliderRightInputElm),d)this._divContainerFilterElm.appendChild(this._sliderRangeContainElm);else{let h;this.sliderType==="compound"&&this._selectOperatorElm?(h=p("span",{className:"input-group-addon input-group-prepend operator"}),h.appendChild(this._selectOperatorElm)):this.sliderType==="double"&&(h=p("div",{className:"input-group-addon input-group-prepend slider-range-value"}),this._leftSliderNumberElm=p("span",{className:`input-group-text lowest-range-${t}`,textContent:`${n}`}),h.appendChild(this._leftSliderNumberElm));let u=p("div",{className:"input-group-addon input-group-append slider-range-value"});this._rightSliderNumberElm=p("span",{className:`input-group-text highest-range-${t}`,textContent:`${l}`},u),h&&this._divContainerFilterElm.appendChild(h),this._divContainerFilterElm.appendChild(this._sliderRangeContainElm),this._divContainerFilterElm.appendChild(u)}return this._sliderOptions={minValue:i,maxValue:o,step:r},this._currentValues=[n,a],Array.isArray(e)&&e.length>0&&e[0]!==""&&(this.updateFilterStyle(!0),this._currentValue=n),(this.filterOptions.sliderStartValue!==void 0||this.columnFilter.minValue!==void 0)&&(this._currentValue=n),this._argFilterContainerElm.appendChild(this._divContainerFilterElm),this.updateTrackFilledColorWhenEnabled(),this._bindEventService.bind(this._sliderTrackElm,"click",this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["input","change"],this.slideRightInputChanged.bind(this)),this._bindEventService.bind(this._sliderRightInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this)),this.sliderType==="compound"&&this._selectOperatorElm?this._bindEventService.bind(this._selectOperatorElm,["change"],this.onValueChanged.bind(this)):this.sliderType==="double"&&this._sliderLeftInputElm&&(this._bindEventService.bind(this._sliderLeftInputElm,["input","change"],this.slideLeftInputChanged.bind(this)),this._bindEventService.bind(this._sliderLeftInputElm,["change","mouseup","touchend"],this.onValueChanged.bind(this))),this._divContainerFilterElm}getOperatorOptionValues(){let e;return this.columnFilter.compoundOperatorList?e=this.columnFilter.compoundOperatorList:e=Ji(this.gridOptions,this.translaterService),eo(this.gridOptions,e,"numeric"),e}onValueChanged(e){let t=parseInt(this._sliderRightInputElm?.value??"",10),i,o;if(this.sliderType==="compound"||this.sliderType==="single")e?.target?.tagName?.toLowerCase()!=="select"&&(this._currentValue=+t),i=this._currentValue,o=[i||"0"];else if(this.sliderType==="double"){let n=[parseInt(this._sliderLeftInputElm?.value??"",10),t];i=n.join(".."),o=n}if(this._clearFilterTriggered)this.updateFilterStyle(!1),this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:this._clearFilterTriggered,searchTerms:[],shouldTriggerQuery:this._shouldTriggerQuery});else{let r=this._selectOperatorElm?.value??this.operator;this.updateFilterStyle(i!=="");let n=this.columnFilter.skipCompoundOperatorFilterWithNullInput??this.gridOptions.skipCompoundOperatorFilterWithNullInput,a=n&&q(this._currentValue)||!q(this._currentValue)&&q(this._lastSearchValue);(this.sliderType!=="compound"||!n||a)&&this.callback(e,{columnDef:this.columnDef,operator:r||"",searchTerms:o,shouldTriggerQuery:this._shouldTriggerQuery})}this._clearFilterTriggered=!1,this._shouldTriggerQuery=!0,this.changeBothSliderFocuses(!1),this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new U(e)),this._lastSearchValue=i}changeBothSliderFocuses(e){let t=e?"add":"remove";this._sliderLeftInputElm?.classList[t]("focus"),this._sliderRightInputElm?.classList[t]("focus")}slideLeftInputChanged(e){let t=parseInt(this._sliderLeftInputElm?.value??"",10),i=parseInt(this._sliderRightInputElm?.value??"",10);this._sliderLeftInputElm&&i-t<=(this.filterOptions?.stopGapBetweenSliderHandles??Wr)&&(this._sliderLeftInputElm.value=String(t-(this.filterOptions?.stopGapBetweenSliderHandles??Wr))),this._sliderLeftInputElm&&this._sliderRightInputElm&&(+this._sliderLeftInputElm.value>=+this._sliderRightInputElm.value-rp?(this._sliderLeftInputElm.style.zIndex="1",this._sliderRightInputElm.style.zIndex="0"):(this._sliderLeftInputElm.style.zIndex="0",this._sliderRightInputElm.style.zIndex="1")),this.sliderLeftOrRightChanged(e,"left",t,i)}slideRightInputChanged(e){let t=parseInt(this._sliderLeftInputElm?.value??"",10),i=parseInt(this._sliderRightInputElm?.value??"",10);this.sliderType==="double"&&this._sliderRightInputElm&&i-t<=(this.filterOptions?.stopGapBetweenSliderHandles??Wr)&&(this._sliderRightInputElm.value=String(t+(this.filterOptions?.stopGapBetweenSliderHandles??Wr))),this.sliderLeftOrRightChanged(e,"right",t,i)}sliderLeftOrRightChanged(e,t,i,o){let r=!0;this.updateTrackFilledColorWhenEnabled(),this.changeBothSliderFocuses(!0),this._sliderRangeContainElm.title=this.sliderType==="double"?`${i} - ${o}`:`${o}`,this.sliderType==="double"&&this._sliderLeftInputElm&&this._sliderRightInputElm&&(t==="left"&&i>o?(this._sliderLeftInputElm.value=`${o}`,r=!1):t==="right"&&i>o&&(this._sliderRightInputElm.value=`${i}`,r=!1)),(this.filterOptions?.hideSliderNumber??this.filterOptions?.hideSliderNumbers)||(this._leftSliderNumberElm?.textContent&&(this._leftSliderNumberElm.textContent=this._sliderLeftInputElm?.value??""),this._rightSliderNumberElm?.textContent&&(this._rightSliderNumberElm.textContent=this._sliderRightInputElm?.value??"")),r&&this.grid.onHeaderRowMouseEnter.notify({column:this.columnDef,grid:this.grid},new U(e))}sliderTrackClicked(e){e.preventDefault();let t=e.offsetX,i=this._sliderTrackElm.offsetWidth,o=(t+0)*100/i;this._sliderRightInputElm&&this.sliderType!=="double"?(this._sliderRightInputElm.value=`${o}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))):this._sliderLeftInputElm&&this._sliderRightInputElm&&(o<=50?(this._sliderLeftInputElm.value=`${o}`,this._sliderLeftInputElm.dispatchEvent(new Event("change"))):(this._sliderRightInputElm.value=`${o}`,this._sliderRightInputElm.dispatchEvent(new Event("change"))))}updateTrackFilledColorWhenEnabled(){if(this.filterOptions?.enableSliderTrackColoring&&this._sliderRightInputElm){let e=0;this._sliderLeftInputElm&&(e=(+this._sliderLeftInputElm.value-+this._sliderLeftInputElm.min)/(this.sliderOptions?.maxValue??0-+this._sliderLeftInputElm.min)*100);let t=(+this._sliderRightInputElm.value-+this._sliderRightInputElm.min)/(this.sliderOptions?.maxValue??0-+this._sliderRightInputElm.min)*100,i="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,this.filterOptions?.sliderTrackFilledColor||this._sliderTrackFilledColor||Ya).replace(/%p1/g,`${e}%`).replace(/%p2/g,`${t}%`);this._sliderTrackElm.style.background=i,this._sliderOptions.sliderTrackBackground=i}}updateFilterStyle(e){this._divContainerFilterElm.classList.toggle("filled",e),this._filterElm?.classList.toggle("filled",e)}};var Gr=class extends gi{constructor(e){super(e),this.translaterService=e,this.sliderType="compound"}};var Ur=class extends co{constructor(e){super(e),this.translaterService=e,this.inputFilterType="range"}};var jr=class extends et{constructor(e){super(e),this.translaterService=e,this._inputMask="",this.inputType="text"}get inputMask(){return this._inputMask}init(e){if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this._cellContainerElm=e.filterContainerElm,this.columnDef?.params?.mask?this._inputMask=this.columnDef.params.mask:this.columnFilter?.params?.mask&&(this._inputMask=this.columnFilter.params.mask),!this._inputMask)throw new Error(`[Slickgrid-Universal] The Filters.inputMask requires the mask to be passed in the filter params or the column definition params
        for example:: this.columnDefinitions: [{ id: 'phone', field: 'phone', filter: { model: Filters.inputMask, params: { mask: '000-000-0000' }}}]`);let t=Array.isArray(this.searchTerms)&&this.searchTerms.length>=0?this.searchTerms[0]:"";this.createDomFilterElement(t),this._bindEventService.bind(this._filterInputElm,["keyup","blur","change"],this.onTriggerEvent.bind(this))}onTriggerEvent(e,t=!1){let i="";if(e?.target?.value){let o=e?.target?.value??"",r=this.gridOptions.enableFilterTrimWhiteSpace||this.columnFilter.enableTrimWhiteSpace;typeof o=="string"&&r&&(o=o.trim());let n=this.unmaskValue(o),a=this.maskValue(n);i=n,e?.keyCode>=48&&(this._filterInputElm.value=a,e.preventDefault())}t?(this.callback(e,{columnDef:this.columnDef,clearFilterTriggered:t,shouldTriggerQuery:this._shouldTriggerQuery}),this._filterInputElm.classList.remove("filled")):(this._filterInputElm.classList.add("filled"),this.callback(e,{columnDef:this.columnDef,operator:this.operator,searchTerms:[i],shouldTriggerQuery:this._shouldTriggerQuery})),this._shouldTriggerQuery=!0}maskValue(e){let t=0,i="";return this._inputMask&&(i=this._inputMask.replace(/[09A]/gi,o=>((o==="0"||o==="9")&&/\d+/g.test(e[t])||o.toUpperCase()==="A"&&/[^\d]+/gi.test(e[t]))&&e[t++]||"")),i}unmaskValue(e){let t=e.replace(/[^0-9a-z]*/gi,""),i=this._inputMask.replace(/[^0-9a-z]*/gi,""),o="";for(let r=0;r<i.length;r++)t[r]&&((i[r]==="0"||i[r]==="9")&&/\d+/g.test(t[r])||i[r].toUpperCase()==="A"&&/[^\d]+/gi.test(t[r]))&&(o+=t[r]);return o}};var Yr=class extends et{constructor(e){super(e),this.translaterService=e,this.inputType="number"}};var qr=class extends et{constructor(e){super(e),this.translaterService=e,this.inputType="password"}};var np=Object.defineProperty,ap=(s,e,t)=>e in s?np(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,$=(s,e,t)=>ap(s,typeof e!="symbol"?e+"":e,t),Dc=typeof window<"u"&&window.multipleSelect!==void 0?window.multipleSelect:{locales:{}},lp={formatSelectAll(){return"[Select all]"},formatAllSelected(){return"All selected"},formatCountSelected(s,e){return`${s} of ${e} selected`},formatNoMatchesFound(){return"No matches found"},formatOkButton(){return"OK"},formatLazyLoading(){return"Loading..."}};Dc.locales["en-US"]=lp;var Mc=Dc.locales,dp=50,cp=4,tt=()=>!1,hp=()=>!0,Pc={name:"",placeholder:"",classes:"",classPrefix:"",data:void 0,locale:void 0,selectAll:!0,single:void 0,singleRadio:!1,multiple:!1,hideOptgroupCheckboxes:!1,multipleWidth:80,width:void 0,dropWidth:void 0,maxHeight:250,maxHeightUnit:"px",position:"bottom",displayValues:!1,displayTitle:!1,displayDelimiter:", ",minimumCountSelected:3,ellipsis:!1,isOpen:!1,keepOpen:!1,openOnHover:!1,container:null,filter:!1,filterGroup:!1,filterPlaceholder:"",filterAcceptOnEnter:!1,filterByDataLength:void 0,customFilter(s){let{text:e,label:t,search:i}=s;return(t||e||"").includes(i)},showClear:!1,autoAdjustDropHeight:!1,autoAdjustDropPosition:!1,autoAdjustDropWidthByTextSize:!1,adjustedHeightPadding:10,useSelectOptionLabel:!1,useSelectOptionLabelToHtml:!1,navigationHighlight:!0,infiniteScroll:!1,virtualScroll:!0,cssStyler:()=>null,textTemplate:s=>s.innerHTML.trim(),labelTemplate:s=>s.label,onBeforeOpen:tt,onChange:tt,onOpen:tt,onClose:tt,onCheckAll:tt,onUncheckAll:tt,onFocus:tt,onBlur:tt,onOptgroupClick:tt,onBeforeClick:hp,onClick:tt,onFilter:tt,onFilterClear:tt,onClear:tt,onAfterCreate:tt,onDestroy:tt,onAfterDestroy:tt,onDestroyed:tt},up=["init","getOptions","refreshOptions","getSelects","setSelects","enable","disable","open","close","check","uncheck","checkAll","uncheckAll","checkInvert","focus","blur","refresh","destroy"];Object.assign(Pc,Mc["en-US"]);var mp={BLOCK_ROWS:dp,CLUSTER_BLOCKS:cp,DEFAULTS:Pc,METHODS:up},Rt=mp,pp=class{constructor(s){$(this,"_distinctEvent"),$(this,"_boundedEvents",[]),this._distinctEvent=s?.distinctEvent??!1}get boundedEvents(){return this._boundedEvents}dispose(){this.unbindAll(),this._boundedEvents=[]}bind(s,e,t,i,o=""){let r=Array.isArray(e)?e:[e];typeof s?.forEach=="function"?s.forEach(n=>this.bindElementEvents(n,r,t,i,o)):this.bindElementEvents(s,r,t,i,o)}hasBinding(s,e){return this._boundedEvents.some(t=>t.element===s&&(!e||t.eventName===e))}unbind(s,e,t){if(s){let i=Array.isArray(s)?s:[s],o=Array.isArray(e)?e:[e||""];for(let r of i){t||(t=this._boundedEvents.find(n=>{if(n.element===r&&(!e||n.eventName===e))return n.listener}));for(let n of o)r?.removeEventListener?.(n,t)}}}unbindAll(s){if(s){let e=Array.isArray(s)?s:[s];for(let t=this._boundedEvents.length-1;t>=0;--t){let i=this._boundedEvents[t];if(e.some(o=>o===i.groupName)){let{element:o,eventName:r,listener:n}=i;this.unbind(o,r,n),this._boundedEvents.splice(t,1)}}}else for(;this._boundedEvents.length>0;){let{element:e,eventName:t,listener:i}=this._boundedEvents.pop();this.unbind(e,t,i)}}bindElementEvents(s,e,t,i,o=""){for(let r of e)(!this._distinctEvent||this._distinctEvent&&!this.hasBinding(s,r))&&(s.addEventListener(r,t,i),this._boundedEvents.push({element:s,eventName:r,listener:t,groupName:o}))}};function gp(s,e,t=!1){let i=Object.keys(s),o=Object.keys(e);if(t&&i.length!==o.length)return!1;for(let r of i)if(o.includes(r)&&s[r]!==e[r])return!1;return!0}function Ja(s){return typeof s!="object"||s===null?s:Array.isArray(s)?s.map(Ja):typeof s=="function"?s:Object.fromEntries(Object.entries(s).map(([e,t])=>[e,Ja(t)]))}function Jo(s){return s!=null&&s!==""}function fp(s,e){return typeof s=="object"?Object.fromEntries(e?Object.entries(s).filter(([t,i])=>!Jo(i)&&!e.includes(t)||Jo(i)):Object.entries(s).filter(([t,i])=>Jo(i))):s}function vp(s){let e=0;return s.forEach((t,i)=>{t.type==="optgroup"?(t._key=`group_${i}`,t.visible=typeof t.visible>"u"?!0:t.visible,t.children.forEach((o,r)=>{o&&(o.visible=typeof o?.visible>"u"?!0:o.visible,o.divider||(o._key=`option_${i}_${r}`,e+=1))})):(t.visible=typeof t.visible>"u"?!0:t.visible,t.divider||(t._key=`option_${i}`,e+=1))}),e}function Kr(s,e,t){if(Array.isArray(s))for(let i of s){if(i[e]===t||i[e]===`${+i[e]}`&&+i[e]===t)return i;if(i.type==="optgroup"){for(let o of i.children)if(o&&(o[e]===t||o[e]===`${+o[e]}`&&+o[e]===t))return o}}}function bp(s){return s.replace(/(\b)(on[a-z]+)(\s*)=([^>]*)|javascript:([^>]*)[^>]*|(<\s*)(\/*)script([<>]*).*(<\s*)(\/*)script(>*)|(&lt;|&#60;)(\/*)(script|script defer)(.*)(&#62;|&gt;|&gt;">)/gi,"")}function qa(s){return Object.keys(s).forEach(e=>Jo(s[e])?"":delete s[e]),s}function fo(s,e){if(typeof s!="string")return s;if(typeof e=="function")return e(s);if(typeof s.normalize=="function")return s.normalize("NFD").replace(/[\u0300-\u036F]/g,"");throw new Error("[Multiple-Select-Vanilla] `normalize()` function is not defined, you can optionally provide a custom parser via the `diacriticParser` option.")}function Ka(s){let{innerHeight:e=0,innerWidth:t=0}=window,{top:i,left:o}=_p(),{top:r=0,left:n=0}=tl(s)||{};return{top:r-i,bottom:e-(r-i),left:n-o,right:t-(n-o)}}function Xa(s=""){return s.split(" ").filter(e=>e)}function Oe(s,e,t){let i=document.createElement(s);return e&&Object.keys(e).forEach(o=>{let r=e[o];typeof r=="object"?Object.assign(i[o],r):i[o]=e[o]}),t?.appendChild(i),i}function Hc(s,e,t){let i=s.props?.innerHTML?Cp(s.props,"innerHTML"):s.props,o=Oe(s.tagName,fp(i,["className","title","style"]),e),r=t;if(r||(r=o),s.props.innerHTML&&(o.innerHTML=s.props.innerHTML),s.attrs)for(let n of Object.keys(s.attrs))o.setAttribute(n,s.attrs[n]);if(s.children)for(let n of s.children)Hc(n,o,r);return e?.appendChild(o),o}function el(s){return s.hasOwnProperty("tagName")?Hc(s):document.createElement("li")}function Xr(s){for(;s?.firstChild;)s.lastChild&&s.removeChild(s.lastChild);return s}function tl(s){if(s){let{top:e,left:t,bottom:i,right:o}=s.getBoundingClientRect();return{top:e+window.pageYOffset,left:t+window.pageXOffset,bottom:i,right:o}}}function Za(s,e,t){if(!s)return 0;let i=Number.parseFloat(s.style[t]);if(!i||Number.isNaN(i)){let o=t==="height"?"Height":"Width";switch(e){case"outer":i=s[`offset${o}`];break;case"scroll":i=s[`scroll${o}`];break;case"inner":default:i=s[`client${o}`];break}i=s.getBoundingClientRect()[t]}if(!i||Number.isNaN(i)){let o=s.style.display,r=s.style.position;s.style.display="block",s.style.position="absolute",i=Qo(s,t),s.style.display=o,s.style.position=r}return i||0}function Qo(s,e){let t=window.getComputedStyle(s)[e],i=Number.parseFloat(t);return Number.isNaN(i)&&(i=0),i}function Lc(s,e){let t=null,i=s?.parentElement;for(;i;){let[o,r,n,a]=e.match(/^([a-z]*)([#.]{1})([a-z-]+)$/i)||[];if(n&&a)for(let l of a.replace(n,"").split(" "))i.classList.contains(l)&&(r?i?.tagName.toLowerCase()===r&&(t=i):t=i);i=i.parentElement}return t}function wp(s){if(Jo(s)){let e=document.createElement("textarea");return e.innerHTML=s.toString().replace(/&#(\d+);/g,(t,i)=>String.fromCharCode(i)),e.value}return""}function kp(s,e){s.parentNode?.insertBefore(e,s.nextSibling)}function Cp(s,e){let{[e]:t,...i}=s;return i}function Ic(s,e){s?.style&&(s.style.display=s.style.display==="none"&&e!==!1||e===!0?"block":"none")}function _p(){return{left:window.pageXOffset||document.documentElement.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||0}}var xp=class{constructor(s){$(this,"clusterRows"),$(this,"cache"),$(this,"scrollEl"),$(this,"blockHeight"),$(this,"clusterHeight"),$(this,"contentEl"),$(this,"parentEl"),$(this,"itemHeight"),$(this,"lastCluster"),$(this,"scrollTop"),$(this,"dataStart"),$(this,"dataEnd"),$(this,"rows"),$(this,"destroy"),$(this,"callback"),$(this,"sanitizer"),this.rows=s.rows,this.scrollEl=s.scrollEl,this.contentEl=s.contentEl,this.parentEl=s.contentEl?.parentElement,this.callback=s.callback,this.cache={},this.scrollTop=this.scrollEl.scrollTop,this.initDOM(this.rows),this.scrollEl.scrollTop=this.scrollTop,this.lastCluster=0;let e=()=>{this.lastCluster!==(this.lastCluster=this.getNum())&&(this.initDOM(this.rows),this.callback())};this.scrollEl.addEventListener("scroll",e,!1),this.destroy=()=>{this.scrollEl.removeEventListener("scroll",e,!1),Xr(this.contentEl)}}reset(s){this.lastCluster=0,this.cache={},Xr(this.contentEl),this.initDOM(s)}initDOM(s){if(typeof this.clusterHeight>"u"){this.cache.scrollTop=this.scrollEl.scrollTop;let r=el(s[0]);this.contentEl.appendChild(r),this.contentEl.appendChild(r),this.contentEl.appendChild(r),this.cache.data=[s[0]],this.getRowsHeight()}let e=this.initData(s,this.getNum()),t=this.checkChanges("data",e.rows),i=this.checkChanges("top",e.topOffset),o=this.checkChanges("bottom",e.bottomOffset);Xr(this.contentEl),t&&i?(e.topOffset&&this.contentEl.appendChild(this.getExtra("top",e.topOffset)),e.rows.forEach(r=>this.contentEl.appendChild(el(r))),e.bottomOffset&&this.contentEl.appendChild(this.getExtra("bottom",e.bottomOffset))):o&&this.contentEl.lastChild&&(this.contentEl.lastChild.style.height=`${e.bottomOffset}px`)}getRowsHeight(){if(typeof this.itemHeight>"u"){let s=this.parentEl?.style.display||"";this.parentEl&&(s===""||s==="none")&&(this.parentEl.style.display="block");let e=this.contentEl.children,t=e[Math.floor(e.length/2)];this.itemHeight=t.offsetHeight,this.parentEl&&(this.parentEl.style.display=s)}this.blockHeight=this.itemHeight*Rt.BLOCK_ROWS,this.clusterRows=Rt.BLOCK_ROWS*Rt.CLUSTER_BLOCKS,this.clusterHeight=this.blockHeight*Rt.CLUSTER_BLOCKS}getNum(){this.scrollTop=this.scrollEl.scrollTop;let s=(this.clusterHeight||0)-(this.blockHeight||0);return s&&Math.floor(this.scrollTop/s)||0}initData(s,e){if(s.length<Rt.BLOCK_ROWS)return{topOffset:0,bottomOffset:0,rowsAbove:0,rows:s};let t=Math.max((this.clusterRows-Rt.BLOCK_ROWS)*e,0),i=t+this.clusterRows,o=Math.max(t*this.itemHeight,0),r=Math.max((s.length-i)*this.itemHeight,0),n=[],a=t;o<1&&a++;for(let l=t;l<i;l++)s[l]&&n.push(s[l]);return this.dataStart=t,this.dataEnd=i,{topOffset:o,bottomOffset:r,rowsAbove:a,rows:n}}checkChanges(s,e){let t=e!==this.cache[s];return this.cache[s]=e,t}getExtra(s,e){let t=Oe("li",{className:`virtual-scroll-${s}`});return e&&(t.style.height=`${e}px`),t}},Zo=".ms-select-all, ul li[data-key]",yp=".ms-select-all.highlighted, ul li[data-key].highlighted",Ep=class{constructor(s,e){this.elm=s,$(this,"_bindEventService"),$(this,"isAllSelected",!1),$(this,"isPartiallyAllSelected",!1),$(this,"fromHtml",!1),$(this,"choiceElm"),$(this,"selectClearElm"),$(this,"closeElm"),$(this,"clearSearchIconElm"),$(this,"filterText",""),$(this,"updateData",[]),$(this,"data",[]),$(this,"dataTotal"),$(this,"dropElm"),$(this,"okButtonElm"),$(this,"filterParentElm"),$(this,"lastFocusedItemKey",""),$(this,"lastMouseOverPosition",""),$(this,"ulElm"),$(this,"parentElm"),$(this,"labelElm"),$(this,"selectAllParentElm"),$(this,"selectAllElm"),$(this,"searchInputElm"),$(this,"selectGroupElms"),$(this,"selectCheckboxElms"),$(this,"noResultsElm"),$(this,"options"),$(this,"selectAllName",""),$(this,"selectGroupName",""),$(this,"selectItemName",""),$(this,"scrolledByMouse",!1),$(this,"openDelayTimer"),$(this,"updateDataStart"),$(this,"updateDataEnd"),$(this,"virtualScroll"),$(this,"_currentHighlightIndex",-1),$(this,"_currentSelectedElm"),$(this,"_isLazyLoaded",!1),$(this,"isMoveUpRecalcRequired",!1),$(this,"locales",{}),this.options=Object.assign({},Rt.DEFAULTS,this.elm.dataset,e),this._bindEventService=new pp({distinctEvent:!0})}get isRenderAsHtml(){return this.options.renderOptionLabelAsHtml||this.options.useSelectOptionLabelToHtml}init(){this.initLocale(),this.initContainer(),this.initData(),this.initSelected(!0),this.initFilter(),this.initDrop(),this.initView(),this.options.onAfterCreate()}destroy(s=!0){this.elm&&this.parentElm&&(this.options.onDestroy({hardDestroy:s}),s&&this.options.onHardDestroy(),this.elm.parentElement&&this.parentElm.parentElement&&this.elm.parentElement.insertBefore(this.elm,this.parentElm.parentElement.firstChild),this.elm.classList.remove("ms-offscreen"),this._bindEventService.unbindAll(),this.virtualScroll?.destroy(),this.dropElm?.remove(),this.dropElm=void 0,this.parentElm.parentNode?.removeChild(this.parentElm),this.fromHtml&&(delete this.options.data,this.fromHtml=!1),this.options.onAfterDestroy({hardDestroy:s}),s&&(this.options.onAfterHardDestroy?.(),Object.keys(this.options).forEach(e=>delete this[e])))}initLocale(){if(this.options.locale){if(typeof this.options.locale=="object"){Object.assign(this.options,this.options.locale);return}let s=window.multipleSelect.locales,e=this.options.locale.split(/-|_/);if(e[0]=e[0].toLowerCase(),e[1]&&(e[1]=e[1].toUpperCase()),s[this.options.locale])Object.assign(this.options,s[this.options.locale]);else if(s[e.join("-")])Object.assign(this.options,s[e.join("-")]);else if(s[e[0]])Object.assign(this.options,s[e[0]]);else throw new Error(`[multiple-select-vanilla] invalid locales "${this.options.locale}", make sure to import it before using it`)}}initContainer(){let s=this.elm.getAttribute("name")||this.options.name||"";this.options.classes&&this.elm.classList.add(this.options.classes),this.options.classPrefix&&(this.elm.classList.add(this.options.classPrefix),this.options.size&&this.elm.classList.add(`${this.options.classPrefix}-${this.options.size}`)),this.elm.style.display="none",this.labelElm=this.elm.closest("label"),!this.labelElm&&this.elm.id&&(this.labelElm=Oe("label",{htmlFor:this.elm.id})),this.labelElm?.querySelector("input")&&(this.labelElm=null),this.options.single===void 0&&(this.options.single=!this.elm.multiple),this.parentElm=Oe("div",{className:Xa(`ms-parent ${this.elm.className||""} ${this.options.classes}`).join(" "),dataset:{test:"sel"}}),this.options.darkMode&&this.parentElm.classList.add("ms-dark-mode");let e=this.elm.getAttribute("title")||"";e&&(this.parentElm.title=e),this.options.placeholder=this.options.placeholder||this.elm.getAttribute("placeholder")||"",this.choiceElm=Oe("button",{className:"ms-choice",type:"button"},this.parentElm),this.options.labelId&&(this.choiceElm.id=this.options.labelId,this.choiceElm.setAttribute("aria-labelledby",this.options.labelId)),this.choiceElm.appendChild(Oe("span",{className:"ms-placeholder",textContent:this.options.placeholder})),this.options.showClear&&(this.selectClearElm=Oe("div",{className:"ms-icon ms-icon-close"}),this.selectClearElm.style.display="none",this.choiceElm.appendChild(this.selectClearElm)),this.choiceElm.appendChild(Oe("div",{className:"ms-icon ms-icon-caret"})),this.dropElm=Oe("div",{className:`ms-drop ${this.options.position}`,ariaExpanded:"false"},this.parentElm),this.options.darkMode&&this.dropElm.classList.add("ms-dark-mode"),s&&(this.dropElm.dataset.name=s);let t=this.elm.getAttribute("data-test")||this.options.dataTest;t&&(this.parentElm.dataset.test=t,this.dropElm.dataset.test=t),this.closeElm=this.choiceElm.querySelector(".ms-icon-close");let i=["minWidth","maxWidth","width","dropWidth"];for(let o of i)if(this.options[o]){let r=o==="dropWidth"?"width":o;this.dropElm.style[r]=typeof this.options[o]=="string"?this.options[o]:`${this.options[o]}px`}kp(this.elm,this.parentElm),this.elm.disabled&&(this.choiceElm.classList.add("disabled"),this.choiceElm.disabled=!0),this.selectAllName=`selectAll${s}`,this.selectGroupName=`selectGroup${s}`,this.selectItemName=`selectItem${s}`,this.options.keepOpen||(this._bindEventService.unbindAll("body-click"),this._bindEventService.bind(document.body,"click",o=>{this.getEventTarget(o)===this.choiceElm||Lc(this.getEventTarget(o),".ms-choice")===this.choiceElm||(this.getEventTarget(o)===this.dropElm||Lc(this.getEventTarget(o),".ms-drop")!==this.dropElm&&this.getEventTarget(o)!==this.elm)&&this.options.isOpen&&this.close("body.click")},void 0,"body-click"))}initData(){let s=[];if(this.options.data){if(Array.isArray(this.options.data))this.data=this.options.data.map(e=>typeof e=="string"||typeof e=="number"?{text:e,value:e}:e);else if(typeof this.options.data=="object"){for(let[e,t]of Object.entries(this.options.data))s.push({value:e,text:`${t}`});this.data=s}}else this.elm.childNodes.forEach(e=>{let t=this.initRow(e);t&&s.push(t)}),this.options.data=s,this.data=s,this.fromHtml=!0;this.data&&this.options.preFilter&&(this.data=this.data.filter(this.options.preFilter)),this.data&&this.options.preSort&&(this.data=this.data.sort(this.options.preSort)),this.dataTotal=vp(this.data||[])}initRow(s,e){let t={};return s.tagName?.toLowerCase()==="option"?(t.type="option",t.text=this.options.textTemplate(s),t.value=s.value,t.visible=!0,t.selected=!!s.selected,t.disabled=e||s.disabled,t.classes=s.getAttribute("class")||"",t.title=s.getAttribute("title")||"",s.dataset.value&&(t._value=s.dataset.value),Object.keys(s.dataset).length&&(t._data=s.dataset,t._data.divider&&(t.divider=t._data.divider)),t):s.tagName?.toLowerCase()==="optgroup"?(t.type="optgroup",t.label=this.options.labelTemplate(s),t.visible=!0,t.selected=!!s.selected,t.disabled=s.disabled,t.children=[],Object.keys(s.dataset).length&&(t._data=s.dataset),s.childNodes.forEach(i=>{t.children.push(this.initRow(i,t.disabled))}),t):null}initDrop(){this.initList(!this.options.lazyData),this.update(!0),this.options.isOpen&&this.open(0),this.options.openOnHover&&this.parentElm&&(this._bindEventService.bind(this.parentElm,"mouseover",()=>this.open(null)),this._bindEventService.bind(this.parentElm,"mouseout",()=>this.close("hover.mouseout")))}initFilter(){if(this.filterText="",this.options.filter||!this.options.filterByDataLength)return;let s=0;for(let e of this.data||[])e.type==="optgroup"?s+=e.children.length:s+=1;this.options.filter=s>this.options.filterByDataLength}initList(s=!0){if(s&&(this.options.filter&&(this.filterParentElm=Oe("div",{className:"ms-search"},this.dropElm),this.filterParentElm.appendChild(Oe("input",{autocomplete:"off",autocapitalize:"off",spellcheck:!1,type:"text",placeholder:this.options.filterPlaceholder||"\u{1F50E}\uFE0E"})),this.options.showSearchClear&&this.filterParentElm.appendChild(Oe("span",{className:"ms-icon ms-icon-close"}))),this.options.selectAll&&!this.options.single)){let e=this.elm.getAttribute("name")||this.options.name||"";this.selectAllParentElm=Oe("div",{className:"ms-select-all",dataset:{key:"select_all"}});let t=document.createElement("label"),i=`ms-icon ${this.isAllSelected?"ms-icon-check":this.isPartiallyAllSelected?"ms-icon-minus":"ms-icon-uncheck"}`,o=Oe("div",{className:"icon-checkbox-container"},t);Oe("input",{type:"checkbox",ariaChecked:String(this.isAllSelected),checked:this.isAllSelected,dataset:{name:`selectAll${e}`}},o),Oe("div",{className:i},o),t.appendChild(Oe("span",{textContent:this.formatSelectAll()})),this.selectAllParentElm.appendChild(t),this.dropElm?.appendChild(this.selectAllParentElm)}this.ulElm=Oe("ul",{className:"ms-list",role:"listbox",ariaExpanded:"false",ariaMultiSelectable:String(!this.options.single)}),this.dropElm?.appendChild(this.ulElm),s&&this.options.showOkButton&&!this.options.single&&(this.okButtonElm=Oe("button",{className:"ms-ok-button",type:"button",textContent:this.formatOkButton()},this.dropElm)),this.initListItems()}initListItems(){let s=0,e=this.getListRows();if(this.options.selectAll&&!this.options.single&&(s=-1),e.length>Rt.BLOCK_ROWS*Rt.CLUSTER_BLOCKS){let t=this.dropElm&&this.dropElm?.style.display!=="none";!t&&this.dropElm&&(this.dropElm.style.left="-10000",this.dropElm.style.display="block",this.dropElm.ariaExpanded="true");let i=()=>{if(this.virtualScroll){this._currentHighlightIndex=0,this.updateDataStart=this.virtualScroll.dataStart+s,this.updateDataEnd=this.virtualScroll.dataEnd+s,this.updateDataStart<0&&(this.updateDataStart=0,this._currentHighlightIndex=0);let o=this.getDataLength();this.updateDataEnd>o&&(this.updateDataEnd=o),this.ulElm&&(this.isMoveUpRecalcRequired?this.recalculateArrowMove("up"):this.virtualScroll.dataStart>this.updateDataStart&&this.recalculateArrowMove("down"))}};this.ulElm&&(this.virtualScroll?this.virtualScroll.reset(e):this.virtualScroll=new xp({rows:e,scrollEl:this.ulElm,contentEl:this.ulElm,sanitizer:this.options.sanitizer,callback:()=>{i(),this.events()}})),i(),!t&&this.dropElm&&(this.dropElm.style.left="0",this.dropElm.style.display="none",this.dropElm.ariaExpanded="false")}else this.ulElm&&(Xr(this.ulElm),e.forEach(t=>this.ulElm.appendChild(el(t)))),this.updateDataStart=0,this.updateDataEnd=this.updateData.length;return this.events(),e}getEventTarget(s){try{return s.composedPath?.()[0]||s.path?.[0]||s.target}catch{return s.target}}getListRows(){let s=[];return this.updateData=[],this.data?.forEach(e=>s.push(...this.initListItem(e))),this.options.infiniteScroll&&s.push({tagName:"li",props:{className:"ms-infinite-option",role:"option"}}),s.push({tagName:"li",props:{className:"ms-no-results",textContent:this.formatNoMatchesFound()}}),s}initListItem(s,e=0){let t=s?.title||"",i=this.options.multiple?"multiple":"",o=this.options.single?"radio":"checkbox",r=!!s?.selected,n=this.options.single&&!this.options.singleRadio,a="";if(!s?.visible)return[];if(this.updateData.push(s),n&&(a="hide-radio "),s.selected&&(a+="selected "),s.type==="optgroup"){let f=[],b;if(this.options.hideOptgroupCheckboxes||this.options.single)b={tagName:"span",props:{dataset:{name:this.selectGroupName,key:s._key}}};else{let E={tagName:"input",props:{type:"checkbox",dataset:{name:this.selectGroupName,key:s._key},checked:r,disabled:s.disabled}};n?b=E:b={tagName:"div",props:{className:`icon-checkbox-container${o==="radio"?" radio":""}`},children:[E,{tagName:"div",props:{className:`ms-icon ${r?o==="radio"?"ms-icon-radio":"ms-icon-check":"ms-icon-uncheck"}`}}]}}!a.includes("hide-radio")&&(this.options.hideOptgroupCheckboxes||this.options.single)&&(a+="hide-radio ");let v={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(v.props,s.label);let k={tagName:"li",props:{className:Xa(`group${this.options.single||s.disabled?" disabled":""} ${a}`).join(" "),role:"option",ariaSelected:String(r),dataset:{key:s._key}},children:[{tagName:"label",props:{className:Xa(`optgroup${this.options.single||s.disabled?" disabled":""}`).join(" ")},children:[b,v]}]},C=this.options.cssStyler(s);return C&&(k.props.style=C),f.push(k),s.children.forEach(E=>f.push(...this.initListItem(E,1))),f}if(a+=s.classes||"",e&&this.options.single&&(a+=`option-level-${e} `),s.divider)return[{tagName:"li",props:{className:"option-divider"}}];let l=i||a?(i+a).trim():"";s.disabled&&(l+=" disabled");let d=`${s.disabled?"disabled":""}`,c={tagName:"span",props:{}};this.applyAsTextOrHtmlWhenEnabled(c.props,s.text);let h={tagName:"input",props:{type:o,value:encodeURI(s.value),dataset:{key:s._key,name:this.selectItemName},checked:r,disabled:!!s.disabled}};s.selected&&(h.attrs={checked:"checked"});let u={tagName:"div",props:{className:`icon-checkbox-container${o==="radio"?" radio":""}`},children:[h,{tagName:"div",props:{className:`ms-icon ${h.props.checked?o==="radio"?"ms-icon-radio":"ms-icon-check":"ms-icon-uncheck"}`}}]},m={tagName:"li",props:{role:"option",title:t,ariaSelected:String(r),dataset:{key:s._key}},children:[{tagName:"label",props:{className:d},children:[n?h:u,c]}]};l&&(m.props.className=l);let g=this.options.cssStyler(s);return g&&(m.props.style=g),[m]}initSelected(s=!1){let e=0;for(let t of this.data||[])if(t.type==="optgroup"){let i=t.children.filter(o=>o?.selected&&!o.disabled&&o.visible).length;t.children.length&&(t.selected=!this.options.single&&i&&i===t.children.filter(o=>o&&!o.disabled&&o.visible&&!o.divider).length),e+=i}else e+=t.selected&&!t.disabled&&t.visible?1:0;if(this.isAllSelected=this.data?.filter(t=>t.selected&&!t.disabled&&t.visible).length===this.data?.filter(t=>!t.disabled&&t.visible&&!t.divider).length,this.isPartiallyAllSelected=!this.isAllSelected&&e>0,!s){let t="";this.isAllSelected?t="onCheckAll":e===0&&(t="onUncheckAll"),t&&(this.options[t](),this.handleOnChange(t))}}initView(){let s;window.getComputedStyle?(s=window.getComputedStyle(this.elm).width,s==="auto"&&(s=Za(this.dropElm,"outer","width")+20)):s=Za(this.elm,"outer","width")+20,this.parentElm.style.width=`${this.options.width||s}px`,this.elm.classList.add("ms-offscreen")}events(){this._bindEventService.unbindAll(["ok-button","search-input","select-all-checkbox","input-checkbox-list","group-checkbox-list","hover-highlight","arrow-highlight","option-list-scroll"]),this.clearSearchIconElm=this.filterParentElm?.querySelector(".ms-icon-close"),this.searchInputElm=this.dropElm?.querySelector(".ms-search input"),this.selectAllElm=this.dropElm?.querySelector(`input[data-name="${this.selectAllName}"]`),this.selectGroupElms=this.dropElm?.querySelectorAll(`input[data-name="${this.selectGroupName}"],span[data-name="${this.selectGroupName}"]`),this.selectCheckboxElms=this.dropElm?.querySelectorAll(`input[data-name="${this.selectItemName}"]:enabled`),this.noResultsElm=this.dropElm?.querySelector(".ms-no-results");let s=e=>{e.preventDefault(),!this.getEventTarget(e).classList.contains("ms-icon-close")&&(this.options.isOpen?this.close("toggle.close"):this.open())};this.labelElm&&this._bindEventService.bind(this.labelElm,"click",e=>{this.getEventTarget(e).nodeName.toLowerCase()==="label"&&(s(e),(!this.options.filter||!this.options.isOpen)&&this.focus(),e.stopPropagation())}),this._bindEventService.bind(this.choiceElm,"click",s),this.options.onFocus&&this._bindEventService.bind(this.choiceElm,"focus",this.options.onFocus),this.options.onBlur&&this._bindEventService.bind(this.choiceElm,"blur",this.options.onBlur),this._bindEventService.bind(this.parentElm,"keydown",e=>{e.code==="Escape"&&this.handleEscapeKey()}),this.closeElm&&this._bindEventService.bind(this.closeElm,"click",e=>{e.preventDefault(),this._checkAll(!1,!0),this.initSelected(!1),this.updateSelected(),this.update(),this.options.onClear()}),this.clearSearchIconElm&&this._bindEventService.bind(this.clearSearchIconElm,"click",e=>{e.preventDefault(),this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this._currentHighlightIndex=-1,this.moveHighlightDown(),this.filter(),this.options.onFilterClear()}),this.searchInputElm&&(this._bindEventService.bind(this.searchInputElm,"keydown",e=>{e.code==="Tab"&&e.shiftKey&&this.close("key.shift+tab")},void 0,"search-input"),this._bindEventService.bind(this.searchInputElm,"keyup",e=>{if(this.options.filterAcceptOnEnter&&["Enter","Space"].includes(e.code)&&this.searchInputElm?.value){if(this.options.single){let t=[];this.selectCheckboxElms?.forEach(i=>{i.closest("li")?.style.display!=="none"&&t.push(i)}),t.length&&t[0].hasAttribute("data-name")&&this.setSelects([t[0].value])}else this.selectAllElm?.click();this.close(`key.${e.code.toLowerCase()}`),this.focus();return}this.filter()},void 0,"search-input")),this.selectAllElm&&this._bindEventService.bind(this.selectAllElm,"click",e=>this._checkAll(e.currentTarget?.checked),void 0,"select-all-checkbox"),this.okButtonElm&&this._bindEventService.bind(this.okButtonElm,"click",e=>{s(e),e.stopPropagation()},void 0,"ok-button"),this.selectGroupElms&&this._bindEventService.bind(this.selectGroupElms,"click",e=>{let t=e.currentTarget,i=t.checked,o=Kr(this.data,"_key",t.dataset.key);this._checkGroup(o,i),this.options.onOptgroupClick(qa({label:o.label,selected:!!o.selected,data:o._data,children:o.children.filter(r=>r).map(r=>qa({label:r.text,value:r.value,selected:r.selected,disabled:r.disabled,data:r._data}))})),this.handleOnChange("onOptgroupClick",{label:o.label,selected:!!o.selected,type:o.type})},void 0,"group-checkbox-list"),this.selectCheckboxElms&&this._bindEventService.bind(this.selectCheckboxElms,"click",e=>{let t=e.currentTarget,i=t.checked,o=Kr(this.data,"_key",t.dataset.key),r=()=>{this.options.single&&this.options.isOpen&&!this.options.keepOpen&&this.close("selection")};if(this.options.onBeforeClick(o)===!1){r();return}this._check(o,i),this.options.onClick(qa({label:o.text,value:o.value,selected:o.selected,data:o._data})),this.handleOnChange("onClick",{label:o.text,value:o.value,selected:o.selected,type:o.type}),r()},void 0,"input-checkbox-list"),this.lastFocusedItemKey&&this.dropElm&&this.dropElm.querySelector(`li[data-key=${this.lastFocusedItemKey}]`)?.focus(),this.options.navigationHighlight&&this.dropElm&&(this._bindEventService.bind(this.dropElm,"mouseover",e=>{let t=this.getEventTarget(e).closest(".ms-select-all")||this.getEventTarget(e).closest("li");if(this.dropElm?.contains(t)&&this.lastMouseOverPosition!==`${e.clientX}:${e.clientY}`){let i=this.dropElm?.querySelectorAll(Zo)||[],o=Array.from(i).findIndex(r=>r.dataset.key===t.dataset.key);this._currentHighlightIndex!==o&&!t.classList.contains("disabled")&&(this._currentSelectedElm=t,this._currentHighlightIndex=o,this.changeCurrentOptionHighlight(t))}this.lastMouseOverPosition=`${e.clientX}:${e.clientY}`},void 0,"hover-highlight"),this._bindEventService.bind(this.dropElm,"keydown",e=>{switch(e.key){case"ArrowUp":e.preventDefault(),this.moveHighlightUp();break;case"ArrowDown":e.preventDefault(),this.moveHighlightDown();break;case"Escape":this.handleEscapeKey();break;case"Enter":case" ":{if(document.activeElement!==this.okButtonElm){let t=this.getEventTarget(e).closest(".ms-select-all")||this.getEventTarget(e).closest("li");if(e.key===" "&&this.options.filter||this.options.filterAcceptOnEnter&&!t)return;e.preventDefault(),this._currentSelectedElm?.querySelector("input")?.click(),this.options.single&&(this.choiceElm.focus(),this.lastFocusedItemKey=this.choiceElm?.dataset.key||"")}break}case"Tab":{e.preventDefault();let t=!this.options.single&&this.options.showOkButton;t&&e.shiftKey&&document.activeElement===this.okButtonElm?(this.focusSelectAllOrList(),this.highlightCurrentOption(),this.filterParentElm?.querySelector("input")?.focus()):t&&!e.shiftKey&&document.activeElement!==this.okButtonElm?(this.changeCurrentOptionHighlight(),this.okButtonElm?.focus()):(this.options.onBlur(e),this.options.isOpen&&this.options.closeOnTab&&this.close("blur"));break}}},void 0,"arrow-highlight")),this.ulElm&&this.options.infiniteScroll&&this._bindEventService.bind(this.ulElm,"scroll",this.infiniteScrollHandler.bind(this),void 0,"option-list-scroll")}handleOnChange(s,e){this.options.onChange({eventName:s,item:e,selection:{labels:this.getSelects("text"),values:this.getSelects("value")}})}handleEscapeKey(){this.options.keepOpen||(this.close("key.escape"),this.choiceElm.focus())}infiniteScrollHandler(s,e,t){let i=!1;s&&this.getEventTarget(s)&&this.ulElm&&this.scrolledByMouse?this.getEventTarget(s).scrollTop+this.getEventTarget(s).clientHeight===this.ulElm.scrollHeight&&(i=!0):e!==void 0&&e+1===t&&(i=!0),i&&this.ulElm&&(this.virtualScroll?this.initListItems():this.ulElm.scrollTop=0,this._currentHighlightIndex=0,this.highlightCurrentOption())}open(s=0){return new Promise(e=>{s!==null&&s>=0?(window.clearTimeout(this.openDelayTimer),this.openDelayTimer=window.setTimeout(()=>{this.openDrop(),e()},s)):(this.openDrop(),e())})}openDrop(){if(!this.dropElm||this.choiceElm?.classList.contains("disabled"))return;this.options.onBeforeOpen();let s=!1;if(this.options.lazyData&&!this._isLazyLoaded&&(s=!0,this.dropElm?.querySelector("ul.ms-list")?.remove(),this.options.lazyData().then(e=>{this.options.data=e,this._isLazyLoaded=!0,this.dropElm?.querySelector(".ms-loading")?.remove(),this.initData(),this.initList(!0),this.update(),this.adjustDropSizeAndPosition()})),this.options.isOpen=!0,this.parentElm.classList.add("ms-parent-open"),this.choiceElm?.querySelector("div.ms-icon-caret")?.classList.add("open"),this.dropElm.style.display="block",this.dropElm.ariaExpanded="true",this.selectAllElm?.parentElement&&(this.selectAllElm.parentElement.style.display="inline-flex"),this.noResultsElm&&(this.noResultsElm.style.display="none"),!this.getDataLength())if(this.selectAllElm?.parentElement&&(this.selectAllElm.parentElement.style.display="none"),s&&!this._isLazyLoaded&&!this.dropElm.querySelector(".ms-loading")){let e=Oe("div",{className:"ms-loading"});e.appendChild(Oe("div",{className:"ms-icon ms-icon-loading ms-spin"})),e.appendChild(Oe("span",{textContent:this.formatLazyLoading()})),this.dropElm.appendChild(e)}else this.noResultsElm&&(this.noResultsElm.style.display="block");this.adjustDropSizeAndPosition(),(!s||this._isLazyLoaded)&&(this.getDataLength()&&this.options.filter?(this.searchInputElm&&(this.searchInputElm.value="",this.searchInputElm.focus()),this.filter(!0)):this.focusSelectAllOrList()),this._currentHighlightIndex<0?this.moveHighlightDown():this.highlightCurrentOption(),this.options.onOpen()}adjustDropSizeAndPosition(){if(this.dropElm){if(this.options.container){let i;this.options.container instanceof Node?i=this.options.container:typeof this.options.container=="string"&&(i=this.options.container==="body"?document.body:document.querySelector(this.options.container)),i.appendChild(this.dropElm);let{top:o=0,left:r=0}=tl(this.parentElm)||{};this.dropElm.style.top=`${o+this.parentElm.offsetHeight}px`,this.dropElm.style.left=`${r}px`,this.dropElm.style.width=`${this.parentElm.offsetWidth}px`,this.dropElm.style.minWidth="auto"}let s=this.options.minHeight,e=this.options.maxHeight;this.options.maxHeightUnit==="row"&&(e=Za(this.dropElm.querySelector("ul>li"),"outer","height")*this.options.maxHeight),this.ulElm??=this.dropElm.querySelector("ul"),this.ulElm&&(s&&(!this.options.lazyData||this._isLazyLoaded)&&(this.ulElm.style.minHeight=`${s}px`),this.ulElm.style.maxHeight=`${e}px`),this.dropElm.querySelectorAll(".multiple").forEach(i=>{i.style.width=`${this.options.multipleWidth}px`}),this.options.autoAdjustDropWidthByTextSize&&this.adjustDropWidthByText();let t=this.options.position;if(this.options.autoAdjustDropHeight){if(this.options.autoAdjustDropPosition){let{bottom:i,top:o}=Ka(this.dropElm),r=this.dropElm.getBoundingClientRect().height;t=i<r&&o>i?"top":"bottom"}this.adjustDropHeight(t)}this.options.autoAdjustDropPosition&&this.adjustDropPosition(!0)}}focusSelectAllOrList(){this.selectAllElm?this.selectAllElm.focus():this.ulElm&&(this.ulElm.tabIndex=0,this.ulElm.focus())}highlightCurrentOption(){let s=this.dropElm?.querySelectorAll(Zo)||[];if(this._currentHighlightIndex<=s.length){let e=s[this._currentHighlightIndex];e&&(this.lastFocusedItemKey=e.dataset.key||"",this._currentSelectedElm=e,this.scrolledByMouse=!1,e.scrollIntoView({block:"nearest"}),this.changeCurrentOptionHighlight(e),window.setTimeout(()=>this.scrolledByMouse=!0,10))}}changeCurrentOptionHighlight(s){s?.classList.add("highlighted"),(this.dropElm?.querySelectorAll(yp)||[]).forEach(e=>{e!==s&&e.classList.remove("highlighted")})}moveHighlightDown(){let s=this.dropElm?.querySelectorAll(Zo)||[],e=s.length;this._currentHighlightIndex<e-1?(this._currentHighlightIndex++,s[this._currentHighlightIndex]?.classList.contains("disabled")&&this.moveHighlightDown()):this.options.infiniteScroll&&this.infiniteScrollHandler(null,this._currentHighlightIndex,e),this.highlightCurrentOption()}moveHighlightUp(){let s=this.dropElm?.querySelectorAll(Zo)||[],e=this.options.single?0:1;if(this.virtualScroll&&this._currentHighlightIndex<=e&&this.updateDataStart>0&&this.ulElm){let t=s[this._currentHighlightIndex+(this.options.single?0:1)],i=t?.dataset.key;this.lastFocusedItemKey=i,this.ulElm.scrollTop=this.ulElm.scrollTop-t?.getBoundingClientRect().height||10,this.isMoveUpRecalcRequired=!0;return}this._currentHighlightIndex>0&&(this._currentHighlightIndex--,s[this._currentHighlightIndex]?.classList.contains("disabled")&&this.moveHighlightUp()),this.highlightCurrentOption()}recalculateArrowMove(s){let e=this.dropElm?.querySelectorAll(Zo)||[],t=Array.from(e).findIndex(i=>i.dataset.key===this.lastFocusedItemKey);this._currentHighlightIndex=t-1,s==="down"?this.moveHighlightDown():s==="up"&&(this.moveHighlightUp(),this.isMoveUpRecalcRequired=!1)}close(s){this.options.isOpen=!1,this.parentElm.classList.remove("ms-parent-open"),this.choiceElm?.querySelector("div.ms-icon-caret")?.classList.remove("open"),this.dropElm&&(this.dropElm.style.display="none",this.dropElm.ariaExpanded="false",this.options.container&&(this.parentElm.appendChild(this.dropElm),this.dropElm.style.top="auto",this.dropElm.style.left="auto")),this.options.onClose(s)}applyAsTextOrHtmlWhenEnabled(s,e){s||(s={}),this.isRenderAsHtml?s.innerHTML=typeof this.options.sanitizer=="function"?this.options.sanitizer(e):e:s.textContent=wp(e)}update(s=!1){let e=this.getSelects(),t=this.getSelects("text");this.options.displayValues&&(t=e);let i=this.choiceElm?.querySelector("span"),o=e.length,r=null,n=()=>{if(this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml){let l=e.join(this.options.displayDelimiter);return this.options.useSelectOptionLabelToHtml?bp(l):l}return t.join(this.options.displayDelimiter)};if(i){if(o===0){let l=this.options.placeholder||"";i.classList.add("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(i,l)}else o<this.options.minimumCountSelected?r=n():this.formatAllSelected()&&o===this.dataTotal?r=this.formatAllSelected():this.options.ellipsis&&o>this.options.minimumCountSelected?r=`${t.slice(0,this.options.minimumCountSelected).join(this.options.displayDelimiter)}...`:this.formatCountSelected(o,this.dataTotal)&&o>this.options.minimumCountSelected?r=this.formatCountSelected(o,this.dataTotal):r=n();if(r!==null&&(i?.classList.remove("ms-placeholder"),this.applyAsTextOrHtmlWhenEnabled(i,r)),this.options.showClear&&this.selectClearElm){let l=r?"block":"none";this.selectClearElm.style.display=l}if(this.options.displayTitle){let l=this.options.useSelectOptionLabel||this.options.useSelectOptionLabelToHtml?"value":"text";i.title=this.getSelects(l).join(this.options.displayDelimiter)}}let a=this.getSelects();this.options.single?this.elm.value=a.length?a[0]:"":Array.from(this.elm.options).forEach(l=>{l.selected=a.some(d=>d===l.value)}),s||this.elm.dispatchEvent(new Event("change"))}updateSelected(s){for(let t=this.updateDataStart;t<this.updateDataEnd;t++){let i=this.updateData[t],o=this.dropElm?.querySelector(`input[data-key=${i._key}]`);if(o){o.checked=i.selected;let r=o.closest("li"),n=r?.querySelector(".icon-checkbox-container div");r&&(i.selected&&!r.classList.contains("selected")?(r.classList.add("selected"),r.ariaSelected="true",n&&(n.className=`ms-icon ms-icon-${o.type==="radio"?"radio":"check"}`)):i.selected||(r.classList.remove("selected"),r.ariaSelected="false",n&&(n.className="ms-icon ms-icon-uncheck")))}}let e=!this.data?.some(t=>t.visible);if(this.selectAllElm){this.selectAllElm.ariaChecked=String(this.isAllSelected);let t=this.dropElm?.querySelector(".ms-select-all .icon-checkbox-container div");if(t){let i="";this.isAllSelected?i="ms-icon-check":this.isPartiallyAllSelected?i="ms-icon-minus":i="ms-icon-uncheck",t.className=`ms-icon ${i}`}this.selectAllElm.checked=this.isAllSelected,Ic(this.selectAllElm.closest("li"),!e)}Ic(this.noResultsElm,e),this.virtualScroll&&(this.virtualScroll.rows=s??this.getListRows())}getData(){return this.options.data}getDataLength(){return this.data?.length??0}getOptions(s=!0){let e=Object.assign({},this.options);return delete e.data,s?Ja(e):this.options}refreshOptions(s){gp(this.options,s,!0)||(this.options=Object.assign(this.options,s),this.destroy(!1),this.init())}getDropElement(){return this.dropElm}getParentElement(){return this.parentElm}getSelects(s="value"){let e=[];for(let t of this.data||[])if(t.type==="optgroup"){let i=t.children.filter(o=>o?.selected);if(!i.length)continue;if(s==="value"||this.options.single)e.push(...i.map(o=>s==="value"&&o._value||o[s]));else{let o=[];o.push("["),o.push(t.label),o.push(`: ${i.map(r=>r[s]).join(", ")}`),o.push("]"),e.push(o.join(""))}}else t.selected&&e.push(s==="value"&&t._value||t[s]);return e}setSelects(s,e="value",t=!1){let i=!1,o=r=>{for(let n of r){let a=!1;if(e==="text"){let l=document.createElement("div");this.applyAsTextOrHtmlWhenEnabled(l,n.text),a=s.includes(l.textContent?.trim()??"")}else a=s.includes(n._value||n.value),!a&&n.value===`${+n.value}`&&(a=s.includes(+n.value));n.selected!==a&&(i=!0),n.selected=a}};for(let r of this.data||[])r.type==="optgroup"?o(r.children):o([r]);i&&(this.initSelected(t),this.updateSelected(),this.update(t))}enable(){this.choiceElm&&(this.choiceElm.classList.remove("disabled"),this.choiceElm.disabled=!1)}disable(){this.choiceElm&&(this.choiceElm?.classList.add("disabled"),this.choiceElm.disabled=!0)}check(s){let e=Kr(this.data,"value",s);e&&this._check(e,!0)}uncheck(s){let e=Kr(this.data,"value",s);e&&this._check(e,!1)}_check(s,e){this.options.single&&this._checkAll(!1,!0),s.selected=e,this.initSelected(),this.updateSelected(),this.update()}checkAll(){this._checkAll(!0)}uncheckAll(){this._checkAll(!1)}_checkAll(s,e){for(let t of this.data||[])t.type==="optgroup"?this._checkGroup(t,s,!0):!t.disabled&&!t.divider&&(e||t.visible)&&(t.selected=s);e||(this.initSelected(),this.updateSelected(),this.update())}_checkGroup(s,e,t){s.selected=e,s.children.forEach(i=>{i&&!i.disabled&&!i.divider&&(t||i.visible)&&(i.selected=e)}),t||(this.initSelected(),this.updateSelected(),this.update())}checkInvert(){if(!this.options.single){for(let s of this.data||[])if(s.type==="optgroup")for(let e of s.children)e&&(e.divider||(e.selected=!e.selected));else s&&!s.divider&&(s.selected=!s.selected);this.initSelected(),this.updateSelected(),this.update()}}focus(){this.choiceElm?.focus(),this.options.onFocus()}blur(){this.choiceElm?.blur(),this.options.onBlur()}refresh(){this.destroy(!1),this.init()}filter(s){let e=this.searchInputElm?.value.trim()??"",t=e.toLowerCase();if(this.filterText===t)return;this.filterText=t;for(let o of this.data||[])if(o.type==="optgroup")if(this.options.filterGroup){let r=`${o?.label??""}`;if(o!=null){let n=this.options.customFilter({label:fo(r.toString().toLowerCase(),this.options.diacriticParser),search:fo(t,this.options.diacriticParser),originalLabel:r,originalSearch:e,row:o});o.visible=n;for(let a of o.children)a&&(a.visible=n)}}else{for(let r of o.children)if(r!=null){let n=`${r?.text??""}`;r.visible=this.options.customFilter({text:fo(n.toString().toLowerCase(),this.options.diacriticParser),search:fo(t,this.options.diacriticParser),originalText:n,originalSearch:e,row:r,parent:o})}o.visible=o.children.some(r=>r?.visible)}else{let r=`${o?.text??""}`;o.visible=this.options.customFilter({text:fo(r.toString().toLowerCase(),this.options.diacriticParser),search:fo(t,this.options.diacriticParser),originalText:r,originalSearch:e,row:o})}let i=this.initListItems();this.initSelected(s),this.updateSelected(i),s||this.options.onFilter(e)}adjustDropHeight(s){let e=s!=="top",t=this.filterParentElm?.getBoundingClientRect().height??0,i=this.okButtonElm?.getBoundingClientRect().height??0,o=this.options.single?0:this.selectAllParentElm?.getBoundingClientRect().height??0,r=t+i+o+5,{bottom:n,top:a}=Ka(this.parentElm),l=this.options.maxHeight;if(e?l=n-r-this.options.adjustedHeightPadding:l=a-r-this.options.adjustedHeightPadding,!this.options.maxHeight||this.options.maxHeight&&l<this.options.maxHeight){let d=this.dropElm?.querySelector("ul");return d&&(d.style.maxHeight=`${l}px`),!0}return!1}adjustDropPosition(s){let e="bottom";if(this.dropElm&&this.parentElm){let{bottom:t,top:i}=Ka(this.dropElm),{top:o,left:r}=tl(this.parentElm),n=this.dropElm.getBoundingClientRect().height,a=this.dropElm.getBoundingClientRect().width,l=document.body.offsetWidth||window.innerWidth,d=this.parentElm.getBoundingClientRect().width;if(t>n)e="bottom";else if(n>t&&i>t){if(this.options.container){let c=o-n;c<0&&(c=0),(c>0||s)&&(e="top",this.dropElm.style.top=`${c<0?0:c}px`)}else e="top",this.dropElm.classList.add(e);this.dropElm.classList.remove("bottom")}l-a<r&&(this.dropElm.style.left=`${r-(a-d)}px`)}return e}adjustDropWidthByText(){if(this.dropElm){let s=this.parentElm.scrollWidth;(this.options.dropWidth||this.options.width)&&(s=this.options.dropWidth||this.options.width||0);let e=this.dropElm.querySelector(".ms-select-all span"),t=this.dropElm.querySelector("ul");if(t){let i=0,o=0,r=(e?.clientWidth??0)+o,n=t.scrollHeight>t.clientHeight?this.getScrollbarWidth():0;o+=Qo(t,"paddingLeft")*2;let a=!1;for(let l of Array.from(t.querySelectorAll("li"))){let d=l.querySelector("label"),c=l.querySelector(".icon-checkbox-container"),h=l.querySelector("span");d&&h?.textContent&&(a||(o+=Qo(l,"paddingLeft")*2,o+=Qo(d,"paddingLeft")*2,o+=Qo(h,"paddingLeft"),o+=c?.offsetWidth??0,a=!0),h.offsetWidth>i&&(i=h.offsetWidth))}i+=o+n,i<r&&(i=r),this.options.maxWidth&&i>this.options.maxWidth&&(i=this.options.maxWidth),this.options.minWidth&&i<this.options.minWidth&&(i=this.options.minWidth),(s==="100%"||+s<i)&&(this.dropElm.style.minWidth="auto",this.dropElm.style.width=`${i}px`)}}}getScrollbarWidth(){let s=Oe("div",{style:{visibility:"hidden",width:"100px"}});document.body.appendChild(s);let e=s.offsetWidth;s.style.overflow="scroll";let t=Oe("div",{style:{width:"100%"}});s.appendChild(t);let i=t.offsetWidth;return s.parentNode?.removeChild(s),e-i}formatAllSelected(){return this.options.allSelectedText||this.options.formatAllSelected()}formatCountSelected(s,e){return this.options.countSelectedText?this.options.countSelectedText.replace("#",`${s}`).replace("%",`${e}`):this.options.formatCountSelected(s,e)}formatNoMatchesFound(){return this.options.noMatchesFoundText||this.options.formatNoMatchesFound()}formatOkButton(){return this.options.okButtonText||this.options.formatOkButton()}formatLazyLoading(){return this.options.lazyLoadingText||this.options.formatLazyLoading()}formatSelectAll(){return this.options.selectAllText||this.options.formatSelectAll()}},fi=(s,e)=>typeof s=="string"?Qa(document.querySelectorAll(s),e):s instanceof Node?Qa([s],e):Qa(s,e);function Qa(s,e){let t=Array.from(s),i=[];for(let o=0;o<t.length;o++){let r=t[o];try{r._multipleSelect!==void 0&&(r._multipleSelect.destroy(),delete r._multipleSelect),r._multipleSelect=new Ep(r,e||{}),r._multipleSelect.init();let n=r._multipleSelect.getOptions(!1);n.onHardDestroy=()=>delete r._multipleSelect,n.onAfterHardDestroy=()=>i[o]=null,i.push(r._multipleSelect)}catch(n){console.error(n)}}return i.length===1?i[0]:i}fi.defaults=Rt.DEFAULTS;fi.locales={...Mc};fi.methods=Rt.METHODS;window!==void 0&&(window.multipleSelect=fi);var vo=class{constructor(e,t,i,o=!0){this.translaterService=e,this.collectionService=t,this.rxjs=i,this._isMultipleSelect=!0,this._collectionLength=0,this._collectionObservers=[],this._shouldTriggerQuery=!0,this._isLazyDataLoaded=!1,this.isFilled=!1,this.enableTranslateLabel=!1,this.subscriptions=[],this._isMultipleSelect=o}get collectionOptions(){return this.columnDef?.filter?.collectionOptions??{}}get columnId(){return this.columnDef?.id??""}get columnFilter(){return this.columnDef?.filter??{}}get customStructure(){return this.columnDef?.filter?.customStructure}get gridOptions(){return this.grid?.getOptions()??{}}get defaultOperator(){return this.isMultipleSelect?N.in:N.equal}get filterOptions(){return{...this.gridOptions.defaultFilterOptions?.select,...this.columnFilter?.filterOptions,...this.columnFilter?.options}}get isMultipleSelect(){return this._isMultipleSelect}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get operator(){return this.columnFilter?.operator??this.defaultOperator}set operator(e){this.columnFilter&&(this.columnFilter.operator=e)}init(e){if(this.grid=e.grid,this.callback=e.callback,this.columnDef=e.columnDef,this.searchTerms=(e.hasOwnProperty("searchTerms")?e.searchTerms:[])||[],this.filterContainerElm=e.filterContainerElm,!this.grid||!this.columnDef||!this.columnFilter||!this.columnFilter.collection&&!this.columnFilter.collectionAsync&&!this.columnFilter.collectionLazy)throw new Error(`[Slickgrid-Universal] You need to pass a "collection" (or "collectionAsync") for the MultipleSelect/SingleSelect Filter to work correctly. Also each option should include a value/label pair (or value/labelKey when using Locale). For example:: { filter: model: Filters.multipleSelect, collection: [{ value: true, label: 'True' }, { value: false, label: 'False'}] }`);if(this.enableTranslateLabel=this.columnFilter?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this.optionLabel=this.customStructure?.optionLabel??"value",this.valueName=this.customStructure?.value??"value",this.enableTranslateLabel&&(!this.translaterService||typeof this.translaterService.translate!="function"))throw new Error('[select-filter] The Translate Service is required for the Select Filter to work correctly when "enableTranslateLabel" is set.');this._locales=this.gridOptions?.locales??x.locales,this.initMultipleSelectTemplate();let t=this.gridOptions?.defaultFilterPlaceholder||"";this.columnFilter?.placeholder&&(t=this.columnFilter.placeholder),this.defaultOptions.placeholder=t||"",this._isMultipleSelect&&this.columnDef?.filter&&(this.columnDef.filter.emptySearchTermReturnAllValues??=!1);let i=this.columnFilter.collection||[];return new Promise(async(o,r)=>{try{let n;this.columnFilter.collectionAsync&&!this.columnFilter.collection?(n=Ns(this.columnFilter.collectionAsync,this.columnDef,this.renderDomElement.bind(this),this.rxjs,this.subscriptions),o(n)):(n=i,this.renderDomElement(i),o(i)),(this.columnFilter.collectionAsync||this.columnFilter.enableCollectionWatch)&&(await(n??this.columnFilter.collectionAsync),this.watchCollectionChanges())}catch(n){r(n)}})}clear(e=!0){this._msInstance&&this._collectionLength>0&&(this._msInstance.setSelects([]),this.updateFilterStyle(!1),this.searchTerms=[],this._shouldTriggerQuery=e,this.callback(void 0,{columnDef:this.columnDef,clearFilterTriggered:!0,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0)}destroy(){typeof this._msInstance?.destroy=="function"&&this._msInstance.destroy(),this.filterElm?.remove(),Wi(this.subscriptions)}getValues(){return this._msInstance?.getSelects()??[]}setValues(e,t,i=!1){e!==void 0&&this._msInstance&&(e=Array.isArray(e)?e.every(o=>ii(o))?e.map(String):e:[e],this._msInstance.setSelects(e)),this.updateFilterStyle(this.getValues().length>0),this.operator=t||this.defaultOperator,i&&this.onTriggerEvent()}watchCollectionChanges(){this.columnFilter?.collection&&(this._collectionObservers.push(Bt(this.columnFilter.collection,this.watchCallback.bind(this))),wi(this.columnFilter,"collection",this.propertyObserverCallback.bind(this)))}propertyObserverCallback(e){this.renderDomElement(e||[]),this.columnFilter.collection&&this._collectionObservers.push(Bt(this.columnFilter.collection,this.watchCallback.bind(this)))}watchCallback(e){this.renderDomElement(this.columnFilter.collection||e||[])}renderDomElement(e){if(e=Ht(e,this.columnFilter),!Array.isArray(e))throw new Error('The "collection" passed to the Select Filter is not a valid array.');let t=[];if(e.length>0&&(t=[...e]),this.collectionOptions?.addBlankEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==""&&t.unshift(No(this.labelName,this.valueName,this.labelPrefixName,this.labelSuffixName)),this.collectionOptions?.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&t.unshift(this.collectionOptions.addCustomFirstEntry),this.collectionOptions?.addCustomLastEntry&&Array.isArray(t)&&t.length>0){let n=t.length-1;t[n][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry)}let{dataCollection:i,hasFoundSearchTerm:o,selectElement:r}=this.filterSortAndParseCollection(t);this.isFilled=o,this.createFilterElement(r,i),this._collectionLength=i.length}createFilterElement(e,t){this.elementName=`filter-${this.columnId}`,this.defaultOptions.name=this.elementName,j(this.filterContainerElm),this.filterElm=e,this.filterElm.dataset.columnId=`${this.columnId}`,this.updateFilterStyle(this.isFilled),this.filterContainerElm.appendChild(e),this.filterElmOptions={...this.defaultOptions,...this.filterOptions,data:t},this._msInstance=fi(e,this.filterElmOptions),this.columnFilter.onInstantiated?.(this._msInstance)}filterSortAndParseCollection(e){return e=Xi(e,this.collectionService,this.columnFilter?.collectionFilterBy,this.collectionOptions),e=Zi(e,this.columnDef,this.collectionService,this.columnFilter?.collectionSortBy,this.enableTranslateLabel),hr("filter",e,this.columnDef,this.grid,this.isMultipleSelect,this.translaterService,this.searchTerms||[])}initMultipleSelectTemplate(){let e={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,name:`${this.columnId}`,container:"body",closeOnTab:!0,darkMode:!!this.gridOptions.darkMode,filter:!1,maxHeight:275,single:!0,singleRadio:!0,showSearchClear:!0,renderOptionLabelAsHtml:this.columnFilter?.enableRenderHtml??!1,sanitizer:t=>this.grid.sanitizeHtmlString(t),onClose:()=>this.onTriggerEvent(),onClear:()=>this.clear()};if(this.columnFilter.collectionLazy&&(e.lazyData=()=>{let t=this.columnFilter.collectionLazy?.(this.columnDef);return new Promise(i=>xo(t,this.rxjs).then(o=>{o=Ht(o,this.columnFilter);let{dataCollection:r}=this.filterSortAndParseCollection(o);i(r||[])}))}),this._isMultipleSelect){e.single=!1,e.singleRadio=!1,e.showOkButton=!0,e.displayTitle=!0;let t=$e(this.gridOptions);e.countSelectedText=this.translateOrDefault(`${t}X_OF_Y_SELECTED`,this._locales?.TEXT_X_OF_Y_SELECTED),e.allSelectedText=this.translateOrDefault(`${t}ALL_SELECTED`,this._locales?.TEXT_ALL_SELECTED),e.noMatchesFoundText=this.translateOrDefault(`${t}NO_MATCHES_FOUND`,this._locales?.TEXT_NO_MATCHES_FOUND),e.okButtonText=this.translateOrDefault(`${t}OK`,this._locales?.TEXT_OK),e.selectAllText=this.translateOrDefault(`${t}SELECT_ALL`,this._locales?.TEXT_SELECT_ALL),e.lazyLoadingText=this.translateOrDefault(`${t}LOADING`,this._locales?.TEXT_LOADING)}this.defaultOptions=e}onTriggerEvent(){if(this._msInstance){let e=this.getValues();this.updateFilterStyle(Array.isArray(e)&&e.length>1||e.length===1&&e[0]!==""),this.searchTerms=e,this.callback(void 0,{columnDef:this.columnDef,operator:this.operator,searchTerms:e,shouldTriggerQuery:this._shouldTriggerQuery}),this._shouldTriggerQuery=!0}}updateFilterStyle(e){this.isFilled=e,this.filterElm?.classList.toggle("filled",e),this._msInstance?.getParentElement()?.classList.toggle("filled",e)}translateOrDefault(e,t=""){return(this.gridOptions?.enableTranslate??!1)&&this.translaterService?.translate?this.translaterService.translate(e):t}};var Zr=class extends vo{constructor(e,t,i){super(e,t,i,!0),this.translaterService=e,this.collectionService=t,this.rxjs=i}};var Qr=class extends vo{constructor(e,t,i){super(e,t,i,!1),this.translaterService=e,this.collectionService=t,this.rxjs=i}};var Jr=class extends gi{constructor(e){super(e),this.translaterService=e,this.sliderType="single"}};var en=class extends gi{constructor(e){super(e),this.translaterService=e,this.sliderType="double"}};var tn={autocompleter:lr,compoundDate:dr,compoundInput:Xo,compoundInputNumber:Br,compoundInputPassword:$r,compoundInputText:Xo,compoundSlider:Gr,dateRange:Ur,input:et,inputMask:jr,inputNumber:Yr,inputPassword:qr,inputText:et,multipleSelect:Zr,singleSelect:Qr,slider:Jr,sliderRange:en};var Fc={alwaysShowVerticalScroll:!0,autoEdit:!1,asyncEditorLoading:!1,autoFitColumnsOnFirstLoad:!0,autoFixResizeTimeout:5*60*5,autoFixResizeRequiredGoodCount:2,autoFixResizeWhenBrokenStyleDetected:!1,autoParseInputFilterOperator:!0,autoResize:{applyResizeToContainer:!0,autoHeight:!0,autoHeightRecalcRow:100,calculateAvailableSizeBy:"window",bottomPadding:20,minHeight:250,minWidth:300,rightPadding:0},cellHighlightCssClass:"slick-cell-modified",checkboxSelector:{cssClass:"slick-cell-checkboxsel",width:40},columnGroupSeparator:" - ",columnPicker:{hideForceFitButton:!1,hideSyncResizeButton:!0,headerColumnValueExtractor:Vc},cellMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideCommandSection:!1,hideOptionSection:!1,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},compositeEditorOptions:{labels:{cancelButtonKey:"CANCEL",cloneButtonKey:"CLONE",resetEditorButtonTooltipKey:"RESET_INPUT_VALUE",resetFormButtonKey:"RESET_FORM",massSelectionButtonKey:"APPLY_TO_SELECTION",massSelectionStatusKey:"X_OF_Y_MASS_SELECTED",massUpdateButtonKey:"APPLY_MASS_UPDATE",massUpdateStatusKey:"ALL_X_RECORDS_SELECTED",saveButtonKey:"SAVE"}},contextMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideClearAllGrouping:!1,hideCollapseAllGroups:!1,hideCommandSection:!1,hideCopyCellValueCommand:!1,hideExpandAllGroups:!1,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideMenuOnScroll:!0,hideOptionSection:!1,iconCollapseAllGroupsCommand:"mdi mdi-arrow-collapse",iconExpandAllGroupsCommand:"mdi mdi-arrow-expand",iconClearGroupingCommand:"mdi mdi-close",iconCopyCellValueCommand:"mdi mdi-content-copy",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},customFooterOptions:{dateFormat:"YYYY-MM-DD, hh:mm a",hideRowSelectionCount:!1,hideTotalItemCount:!1,hideLastUpdateTimestamp:!0,footerHeight:25,leftContainerClass:"col-xs-12 col-sm-5",rightContainerClass:"col-xs-6 col-sm-7",metricSeparator:"|",metricTexts:{itemsKey:"ITEMS",ofKey:"OF",itemsSelectedKey:"ITEMS_SELECTED"}},customTooltip:{tooltipTextMaxLength:700,maxWidth:500},dataView:{syncGridSelection:{preserveHidden:!1,preserveHiddenOnSelectionChange:!0},syncGridSelectionWithBackendService:!1},datasetIdPropertyName:"id",defaultFilter:tn.input,defaultBackendServiceFilterTypingDebounce:500,enableFilterTrimWhiteSpace:!1,defaultFilterPlaceholder:"\u{1F50E}\uFE0E",defaultFilterRangeOperator:"RangeInclusive",defaultColumnSortFieldId:"id",draggableGrouping:{hideToggleAllButton:!1,toggleAllButtonText:"",dropPlaceHolderTextKey:"DROP_COLUMN_HEADER_TO_GROUP_BY"},editable:!1,editorTypingDebounce:450,filterTypingDebounce:0,enableEmptyDataWarningMessage:!0,emptyDataWarning:{className:"slick-empty-data-warning",messageKey:"EMPTY_DATA_WARNING_MESSAGE",hideFrozenLeftWarning:!1,hideFrozenRightWarning:!1,leftViewportMarginLeft:"40%",rightViewportMarginLeft:"40%",frozenLeftViewportMarginLeft:"0px",frozenRightViewportMarginLeft:"40%"},enableAutoResize:!0,enableAutoSizeColumns:!0,enableCellNavigation:!1,enableColumnPicker:!0,enableColumnReorder:!0,enableColumnResizeOnDoubleClick:!0,enableContextMenu:!0,enableExcelExport:!1,enableTextExport:!1,enableGridMenu:!0,enableHeaderMenu:!0,enableMouseHoverHighlightRow:!0,enableSorting:!0,enableTextSelectionOnCells:!0,explicitInitialization:!0,excelExportOptions:{addGroupIndentation:!0,autoDetectCellFormat:!0,exportWithFormatter:!1,filename:"export",format:"xlsx",groupingColumnHeaderTitle:"Group By",groupCollapsedSymbol:"\u2B9E",groupExpandedSymbol:"\u2B9F",groupingAggregatorRowText:"",sanitizeDataExport:!0},textExportOptions:{delimiter:bt.comma,exportWithFormatter:!1,filename:"export",format:"csv",groupingColumnHeaderTitle:"Group By",groupingAggregatorRowText:"",sanitizeDataExport:!0,useUtf8WithBom:!0},eventNamingStyle:We.lowerCase,forceFitColumns:!1,frozenHeaderWidthCalcDifferential:1,gridMenu:{dropSide:"left",commandLabels:{clearAllFiltersCommandKey:"CLEAR_ALL_FILTERS",clearAllSortingCommandKey:"CLEAR_ALL_SORTING",clearFrozenColumnsCommandKey:"CLEAR_PINNING",exportCsvCommandKey:"EXPORT_TO_CSV",exportExcelCommandKey:"EXPORT_TO_EXCEL",exportTextDelimitedCommandKey:"EXPORT_TO_TAB_DELIMITED",refreshDatasetCommandKey:"REFRESH_DATASET",toggleDarkModeCommandKey:"TOGGLE_DARK_MODE",toggleFilterCommandKey:"TOGGLE_FILTER_ROW",togglePreHeaderCommandKey:"TOGGLE_PRE_HEADER_ROW"},hideClearAllFiltersCommand:!1,hideClearAllSortingCommand:!1,hideClearFrozenColumnsCommand:!0,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideForceFitButton:!1,hideRefreshDatasetCommand:!1,hideSyncResizeButton:!0,hideToggleFilterCommand:!1,hideToggleDarkModeCommand:!0,hideTogglePreHeaderCommand:!1,iconCssClass:"mdi mdi-menu",iconClearAllFiltersCommand:"mdi mdi-filter-remove-outline",iconClearAllSortingCommand:"mdi mdi-sort-variant-off",iconClearFrozenColumnsCommand:"mdi mdi-pin-off-outline",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",iconRefreshDatasetCommand:"mdi mdi-sync",iconToggleDarkModeCommand:"mdi mdi-brightness-4",iconToggleFilterCommand:"mdi mdi-flip-vertical",iconTogglePreHeaderCommand:"mdi mdi-flip-vertical",menuWidth:16,resizeOnShowHeaderRow:!0,showBulletWhenIconMissing:!0,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270",headerColumnValueExtractor:Vc},headerMenu:{autoAlign:!0,autoAlignOffset:4,minWidth:140,iconClearFilterCommand:"mdi mdi-filter-remove-outline",iconClearSortCommand:"mdi mdi-sort-variant-off",iconFilterShortcutSubMenu:"mdi mdi-filter-outline",iconFreezeColumns:"mdi mdi-pin-outline",iconUnfreezeColumns:"mdi mdi-pin-off-outline",iconSortAscCommand:"mdi mdi-sort-ascending",iconSortDescCommand:"mdi mdi-sort-descending",iconColumnHideCommand:"mdi mdi-close",iconColumnResizeByContentCommand:"mdi mdi-arrow-expand-horizontal",hideColumnResizeByContentCommand:!1,hideColumnHideCommand:!1,hideClearFilterCommand:!1,hideClearSortCommand:!1,hideFreezeColumnsCommand:!0,hideSortCommands:!1,subItemChevronClass:"mdi mdi-chevron-down mdi-rotate-270"},ignoreAccentOnStringFilterAndSort:!1,multiColumnSort:!0,numberedMultiColumnSort:!0,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!0,suppressActiveCellChangeOnEdit:!1,pagination:{pageSizes:[10,15,20,25,30,40,50,75,100],pageSize:25,totalItems:0},rowDetailView:{collapseAllOnSort:!0,cssClass:"detail-view-toggle",panelRows:1,keyPrefix:"__",useRowClick:!1,saveDetailViewOnScroll:!1},headerRowHeight:35,rowHeight:35,topPanelHeight:30,translationNamespaceSeparator:":",resetFilterSearchValueAfterOnBeforeCancellation:!0,resizeByContentOnlyOnFirstLoad:!0,resizeByContentOptions:{alwaysRecalculateColumnWidth:!1,cellPaddingWidthInPx:14,defaultRatioForStringType:.88,formatterPaddingWidthInPx:0,maxItemToInspectCellContentWidth:1e3,maxItemToInspectSingleColumnWidthByContent:5e3,widthToRemoveFromExceededWidthReadjustment:50},rowTopOffsetRenderType:"transform",treeDataOptions:{exportIndentMarginLeft:5,exportIndentationLeadingChar:"\u034F\u034F\u034F\u034F\u034F\u034F\u034F\u034F\u034F\xB7"}};function Vc(s,e){let t=s?.columnPickerLabel??s?.name??"";(t instanceof HTMLElement||t instanceof DocumentFragment)&&(t=t.textContent||"");let i=s?.columnGroup||"",o=e?.columnGroupSeparator??" - ";return i?i+o+t:t}function vi(s,e){let t=e.errorMessage,i=e.required,o=e.minLength,r=e.maxLength,n=e.operatorConditionalType||"inclusive",a={"{{minLength}}":o,"{{maxLength}}":r},l=!0,d="",c=s?.length??0;if(e.validator)return e.validator(s,e.editorArgs);if(i&&s==="")l=!1,d=t||x.VALIDATION_REQUIRED_FIELD;else if(o!==void 0&&r!==void 0&&(n==="exclusive"&&(c<=o||c>=r)||n==="inclusive"&&(c<o||c>r)))l=!1,d=t||x.VALIDATION_EDITOR_TEXT_LENGTH_BETWEEN.replace(/{{minLength}}|{{maxLength}}/gi,h=>a[h]);else if(o!==void 0&&c!==null&&(n==="exclusive"&&c<=o||n==="inclusive"&&c!==null&&c<o)){l=!1;let h=n==="inclusive"?x.VALIDATION_EDITOR_TEXT_MIN_LENGTH_INCLUSIVE:x.VALIDATION_EDITOR_TEXT_MIN_LENGTH;d=t||h.replace(/{{minLength}}/gi,u=>a[u])}else if(r!==void 0&&c!==null&&(n==="exclusive"&&c>=r||n==="inclusive"&&c!==null&&c>r)){l=!1;let h=n==="inclusive"?x.VALIDATION_EDITOR_TEXT_MAX_LENGTH_INCLUSIVE:x.VALIDATION_EDITOR_TEXT_MAX_LENGTH;d=t||h.replace(/{{maxLength}}/gi,u=>a[u])}return{valid:l,msg:d}}var Sp=3,on=class{constructor(e){this.args=e,this._isValueTouched=!1,this._lastTriggeredByClearInput=!1,this.disabled=!1,this.forceUserInput=!1,this.finalCollection=[],this.grid=e.grid,this._bindEventService=new oe,this.gridOptions?.translater&&(this._translater=this.gridOptions.translater),this._locales=this.gridOptions?.locales||x.locales,this.init()}get autocompleterOptions(){return this._autocompleterOptions||{}}get collection(){return this.columnEditor?.collection??[]}get editorDomElement(){return this._inputElm}get elementCollection(){return this._elementCollection}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get customStructure(){let e=this.columnEditor?.customStructure,t=this.columnEditor?.type??this.columnDef?.type;return!e&&t===_.object&&this.columnDef?.dataKey&&this.columnDef?.labelKey&&(e={label:this.columnDef.labelKey,value:this.columnDef.dataKey}),e}get dataContext(){return this.args.item}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.autocompleter,...this.columnEditor?.editorOptions,...this.columnEditor?.options}}get gridOptions(){return this.grid?.getOptions()??{}}get instance(){return this._instance}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){this.labelName=this.customStructure?.label??"label",this.valueName=this.customStructure?.value??"value",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix";let e=this.columnEditor.collection;this.columnEditor?.collectionAsync&&!e&&(e=[]),this.renderDomElement(e),(this.disabled||this.columnEditor?.collectionAsync&&Array.isArray(e)&&e.length===0)&&this.disable(!0)}destroy(){this._bindEventService.unbindAll(),typeof this._instance?.destroy=="function"&&this._instance.destroy(),this._inputElm?.remove?.(),this._elementCollection=null}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;let i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&i!==""&&this.clear(!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm&&(this._inputElm.focus(),this._inputElm.select())}show(){!!this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,i=!0){if(this._inputElm.value=e?.hasOwnProperty(this.labelName)?e[this.labelName]:e,t){this._currentValue=e,this._defaultTextValue=typeof e=="string"?e:e?.[this.labelName]??"",this.applyValue(this.args.item,this.serializeValue());let o=this.args.compositeEditorOptions;o&&i&&this.handleChangeOnCompositeEditor(null,o,"system")}}applyValue(e,t){let i=t,o=this.columnDef?.field;if(o!==void 0){Array.isArray(this.collection)&&this.collection.length>0&&(i=mt(this.collection,a=>a&&It(t)&&a.hasOwnProperty(this.valueName)?a[this.valueName].toString()===(t.hasOwnProperty(this.valueName)&&t[this.valueName].toString()):a&&typeof t=="string"&&a.hasOwnProperty(this.valueName)?a[this.valueName].toString()===t:a?.toString()===t,""));let r=o?.indexOf(".")>0;if(i=this.validate(null,i)?.valid?i:"",r){let a=this.columnEditor?.complexObjectPath??o??"";Ae(e,a,i)}else e[o]=i}}isValueChanged(){let e=this._inputElm.value,t=this._lastInputKeyEvent?.key;if(this.columnEditor?.alwaysSaveOnEnterKey&&t==="Enter")return!0;let i=!(e===""&&(this._defaultTextValue===null||this._defaultTextValue===void 0))&&e!==this._defaultTextValue;return this._lastTriggeredByClearInput||i}isValueTouched(){return this._isValueTouched}loadValue(e){let t=this.columnDef?.field;if(e&&t!==void 0){let o=t?.indexOf(".")>0?ge(e,t):e[t];this._currentValue=o,this._originalValue=o,this._defaultTextValue=typeof o=="string"?o:o?.[this.labelName]??"",this._inputElm.value=this._defaultTextValue,this._inputElm.select()}}clear(e=!1){this._inputElm&&(this._currentValue="",this._defaultTextValue="",this.setValue("",!0)),this._isValueTouched=!0,this._lastTriggeredByClearInput=!0;let t=this.args.compositeEditorOptions;if(t){let i=!e;this.handleChangeOnCompositeEditor(null,t,"user",i)}else this.save()}reset(e,t=!0,i=!1){let o=e??this._originalValue??"";this._inputElm&&(this._currentValue=o,this._defaultTextValue=typeof o=="string"?o:o?.[this.labelName]??"",this._inputElm.value=this._defaultTextValue),this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(null,r,"user",n)}}save(){let t=this.validate()?.valid??!1;if(this.hasAutoCommitEdit&&t)this.grid.getEditorLock().commitCurrentEdit();else{let i=this._lastInputKeyEvent?.key!=="Enter";this.args.commitChanges(i)}}serializeValue(){if(this._inputElm&&this.editorOptions.forceUserInput){let e=this.editorOptions?.minLength??Sp;this._currentValue=this._inputElm.value.length>e?this._inputElm.value:this._currentValue}return this.customStructure&&this._currentValue&&this._currentValue.hasOwnProperty(this.valueName)&&this.columnDef?.type!==_.object&&this.columnEditor?.type!==_.object?this._currentValue[this.valueName]:this._currentValue&&this._currentValue.value!==void 0?this.columnDef?.type===_.object||this.columnEditor?.type===_.object?{[this.labelName]:this._currentValue.label,[this.valueName]:this._currentValue.value}:this._currentValue.value:this._currentValue}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};let i=t!==void 0?t:this._inputElm?.value;return vi(i,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:this.args?.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,i="user",o=!1){let r=this.grid.getActiveCell(),n=this.args.column,a=this.columnDef?.id??"",l=this.dataContext,d=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);let h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(o||this.disabled&&h&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],d.onCompositeEditorChange.notify({...r,item:l,grid:d,column:n,formValues:t.formValues,editors:t.editors,triggeredBy:i},new U(e))}handleSelect(e){if(e!==void 0){let t=e;this._currentValue=t,this._isValueTouched=!0;let i=this.args.compositeEditorOptions,o=this.editorOptions?.renderItem??!1,r=typeof t=="string"?t:o?t[this.labelName]:t.label;if(this.setValue(r),i?this.handleChangeOnCompositeEditor(null,i):this.save(),typeof this.editorOptions.onSelectItem=="function"){let{row:n,cell:a}=this.grid.getActiveCell()||{};this.editorOptions.onSelectItem(e,n,a,this.args.column,this.args.item)}setTimeout(()=>this._lastTriggeredByClearInput=!1)}return!1}renderRegularItem(e){let t=typeof e=="string"?e:e?.label??"";return p("div",{textContent:t||""})}renderCustomItem(e){let t=this._autocompleterOptions?.renderItem?.templateCallback(e)??"",i=document.createElement("div");return Se(i,t,this.gridOptions),i}renderCollectionItem(e){let t=this.columnEditor?.enableRenderHtml??!1,i=e.labelPrefix||"",o=e.label||"",r=e.labelSuffix||"",n=i+o+r,a=this.grid.sanitizeHtmlString(n)||"",l=document.createElement("div");return l[t?"innerHTML":"textContent"]=a,l}renderDomElement(e){let t=this.columnDef?.id??"",i=this.columnEditor?.placeholder??"",o=this.columnEditor?.title??"";this._editorInputGroupElm=p("div",{className:"autocomplete-container input-group"});let r=p("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=p("button",{type:"button",className:"btn btn-default btn-clear"}),this._clearButtonElm.appendChild(p("i",{className:"icon-clear"})),this._inputElm=p("input",{type:"text",placeholder:i,title:o,autocomplete:"off",ariaAutoComplete:"none",className:`autocomplete form-control editor-text input-group-editor editor-${t}`,dataset:{input:""}},this._editorInputGroupElm),this._editorInputGroupElm.appendChild(document.createElement("span")),this.editorOptions?.hideClearButton||(r.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(r),this._bindEventService.bind(this._clearButtonElm,"click",()=>this.clear())),this._bindEventService.bind(this._inputElm,"focus",()=>this._inputElm?.select()),this._bindEventService.bind(this._inputElm,"keydown",a=>{this._lastInputKeyEvent=a,(a.key==="ArrowLeft"||a.key==="ArrowRight"||a.key==="Home"||a.key==="End")&&a.stopImmediatePropagation(),a.key==="Enter"&&a.target.value===""&&this.columnEditor.alwaysSaveOnEnterKey&&(this._currentValue=null)});let n=e;if(n&&this.columnEditor?.collectionOverride){let a={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){let{formValues:l,modalType:d}=this.args.compositeEditorOptions;a.compositeEditorOptions={formValues:l,modalType:d}}n=this.columnEditor.collectionOverride(n,a)}n&&(this.finalCollection=n),Array.isArray(n)&&(this.collection.every(a=>ii(a))?n=n.map(a=>({label:a,value:a})):n=n.map(a=>({label:a?.[this.labelName],value:a?.[this.valueName],labelPrefix:a?.[this.labelPrefixName]??"",labelSuffix:a?.[this.labelSuffixName]??""})),this._elementCollection=n),this._autocompleterOptions={input:this._inputElm,debounceWaitMs:200,className:`slick-autocomplete ${this.editorOptions?.className??""}`.trim(),emptyMsg:this.gridOptions.enableTranslate&&this._translater?.translate?this._translater.translate("NO_ELEMENTS_FOUND"):this._locales?.TEXT_NO_ELEMENTS_FOUND??"No elements found",customize:(a,l,d)=>{d.style.width=""},onSelect:this.handleSelect.bind(this),...this.editorOptions},this.gridOptions?.darkMode&&(this._autocompleterOptions.className+=" slick-dark-mode"),this.autocompleterOptions.className=ae(this.autocompleterOptions.className).join(" "),this._autocompleterOptions.renderItem?.layout?(this._autocompleterOptions.className+=` autocomplete-custom-${Mt(this._autocompleterOptions.renderItem.layout)}`,this._autocompleterOptions.render=this.renderCustomItem.bind(this)):Array.isArray(e)?this._autocompleterOptions.render=this._autocompleterOptions.render?.bind(this)??this.renderCollectionItem.bind(this):this._autocompleterOptions.render||(this._autocompleterOptions.render=this.renderRegularItem.bind(this)),this._autocompleterOptions?.fetch?(Fs(this._inputElm,this._autocompleterOptions),this._instance=Ui(this._autocompleterOptions)):this._instance=Ui({...this._autocompleterOptions,fetch:(a,l)=>{n&&l(n.filter(d=>((typeof d=="string"?d:d?.label)||"").toLowerCase().includes(a.toLowerCase())))}}),this.args.container.appendChild(this._editorInputGroupElm),this.columnEditor.onInstantiated?.(this._instance),this.args.compositeEditorOptions||setTimeout(()=>this.focus(),50)}};var sn=class{constructor(e){this.args=e,this._isValueTouched=!1,this.disabled=!1,this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new oe,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){let e=this.columnDef?.id??"",t=this.args.compositeEditorOptions;this._checkboxContainerElm=p("div",{className:`checkbox-editor-container editor-${e}`}),this._input=p("input",{type:"checkbox",value:"true",ariaLabel:this.columnEditor?.ariaLabel??`${Xe(e+"")} Checkbox Editor`,className:`editor-checkbox editor-${e}`,title:this.columnEditor?.title??""});let i=this.args?.container;i&&typeof i.appendChild=="function"&&(t?(this._checkboxContainerElm.appendChild(this._input),i.appendChild(this._checkboxContainerElm)):i.appendChild(this._input)),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,"click",()=>{this._isValueTouched=!0,this.save()}),t?this._bindEventService.bind(this._input,"change",o=>{this._isValueTouched=!0,this.handleChangeOnCompositeEditor(o,t)}):this.focus()}destroy(){this._bindEventService.unbindAll(),this._input?.remove?.()}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled"),this._checkboxContainerElm.classList.add("disabled");let i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&i!==!1&&this.reset(!1,!0,!0)}else this._input.removeAttribute("disabled"),this._checkboxContainerElm.classList.remove("disabled")}focus(){this.grid.focus(),this._input?.focus()}preClick(){this._input&&(this._input.checked=!this._input.checked)}show(){!!this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._input?.checked??!1}setValue(e,t=!1,i=!0){let o=!!e;if(this._input&&(this._input.checked=o),t){this.applyValue(this.args.item,this.serializeValue());let r=this.args.compositeEditorOptions;r&&i&&this.handleChangeOnCompositeEditor(null,r,"system")}}applyValue(e,t){let i=this.columnDef?.field;if(i!==void 0){let o=i?.indexOf(".")>0,r=this.validate(null,t),n=r&&r.valid?t:"";if(o){let a=this.columnEditor?.complexObjectPath??i??"";Ae(e,a,n)}else e[i]=n}}isValueChanged(){return this.serializeValue()!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){let t=this.columnDef?.field;if(e&&t!==void 0&&this._input){let o=t?.indexOf(".")>0?ge(e,t):e[t];this._originalValue=o,this._input.checked=!!this._originalValue}}reset(e,t=!0,i=!1){let o=e??this._originalValue??!1;this._input&&(this._originalValue=o,this._input.checked=!!o),this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(null,r,"user",n)}}save(){let e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._input?.checked??!1}validate(e,t){let i=this.args?.compositeEditorOptions?!1:this.columnEditor.required,o=t!==void 0?t:this._input?.checked,r=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(o,this.args):i&&!o?{valid:!1,msg:r||x.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,i="user",o=!1){let r=this.grid.getActiveCell(),n=this.args.column,a=this.columnDef?.id??"",l=this.dataContext,d=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);let h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(o||this.disabled&&h&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],d.onCompositeEditorChange.notify({...r,item:l,grid:d,column:n,formValues:t.formValues,editors:t.editors,triggeredBy:i},new U(e))}};var rn=class{constructor(e){this.args=e,this._isValueTouched=!1,this._lastClickIsDate=!1,this._lastTriggeredByClearDate=!1,this.hasTimePicker=!1,this.disabled=!1,this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this.gridOptions?.translater&&(this._translaterService=this.gridOptions.translater),this._bindEventService=new oe,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._inputElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.date,...this.columnEditor?.editorOptions,...this.columnEditor?.options}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get pickerOptions(){return this._pickerMergedOptions}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}async init(){if(this.args&&this.columnDef){let e=this.args.compositeEditorOptions,t=this.columnDef?.id??"",i=this.args.grid.getOptions()||{};this.defaultDate=this.args.item?.[this.columnDef.field];let o=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||_.dateUtc,r=Le(o),n=this._translaterService?.getCurrentLanguage?.()||i.locale||"en";r&&(r==="ISO8601"||r.toLowerCase().includes("h"))&&(this.hasTimePicker=!0);let a=Le(this.hasTimePicker?_.dateTimeIsoAM_PM:_.dateIso),l={inputMode:!0,enableJumpToSelectedDate:!0,firstWeekday:0,enableDateToggle:!1,locale:n,selectedTheme:this.gridOptions?.darkMode?"dark":"light",positionToInput:"auto",sanitizerHTML:h=>this.grid.sanitizeHtmlString(h),selectedWeekends:[],onClickDate:()=>{this._lastClickIsDate=!0},onChangeToInput:h=>{if(h.context.inputElement){let u="";if(h.context.selectedDates[0]?(u=h.context.selectedDates[0],h.context.inputElement.value=gt(h.context.selectedDates[0],void 0,o)):h.context.inputElement.value="",u&&this.hasTimePicker){let m=ni(u,a);m.setHours(+(h.context.selectedHours||0)),m.setMinutes(+(h.context.selectedMinutes||0)),h.context.inputElement.value=gt(m,void 0,o)}this._lastClickIsDate&&(this.handleOnDateChange(),h.hide())}}};this.hasTimePicker&&(l.selectionTimeMode=24),this._pickerMergedOptions=fe(!0,{},l,this.editorOptions,{type:"default"});let d=`.editor-text.date-picker.editor-${t}.form-control.input-group-editor`;this._editorInputGroupElm=p("div",{className:"vanilla-picker input-group"});let c=p("span",{className:"input-group-btn input-group-append",dataset:{clear:""}});this._clearButtonElm=p("button",{type:"button",className:"btn btn-default btn-clear"}),this._clearButtonElm.appendChild(p("i",{className:"icon-clear"})),this._inputElm=p("input",{placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor&&this.columnEditor.title||"",className:d.replace(/\./g," "),dataset:{input:"",defaultdate:this.defaultDate},readOnly:this.editorOptions?.allowInput!==!0},this._editorInputGroupElm),this.args.container.appendChild(this._editorInputGroupElm),this.editorOptions?.hideClearButton||(c.appendChild(this._clearButtonElm),this._editorInputGroupElm.appendChild(c),this._bindEventService.bind(this._clearButtonElm,"click",()=>{this.clear(),this.handleOnDateChange()})),this._bindEventService.bind(this._inputElm,"keydown",h=>{this.editorOptions?.allowInput===!0&&(this._isValueTouched=!0,this._lastInputKeyEvent=h,(h.key==="ArrowLeft"||h.key==="ArrowRight"||h.key==="Home"||h.key==="End")&&h.stopImmediatePropagation())}),oi(()=>{this.calendarInstance=new Ki(this._inputElm,this._pickerMergedOptions),this.calendarInstance.init(),e||(this.show(),this.focus()),this.calendarInstance&&Ri(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:this.defaultDate,updatePickerUI:!0}),this.columnEditor.onInstantiated?.(this.calendarInstance)})}}destroy(){oi(()=>{this.hide(),this.calendarInstance?.destroy(),j(this._editorInputGroupElm),j(this._inputElm),this._editorInputGroupElm?.remove(),this._inputElm?.remove()}),this._bindEventService.unbindAll()}clear(){this._lastTriggeredByClearDate=!0,this.calendarInstance&&Fo(this.calendarInstance)}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.setAttribute("disabled","disabled"),this._clearButtonElm.disabled=!0;let i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&i!==""&&this.reset("",!0,!0)}else this._inputElm.removeAttribute("disabled"),this._clearButtonElm.disabled=!1}changeEditorOption(e,t){this.columnEditor.options??={},this.columnEditor.editorOptions??={},this.columnEditor.options[e]=this.columnEditor.editorOptions[e]=t,this._pickerMergedOptions=fe(!0,{},this._pickerMergedOptions,{[e]:t}),this.calendarInstance?.set(this._pickerMergedOptions,{dates:!0,locale:!0,month:!0,time:!0,year:!0})}focus(){this.grid.focus(),this.show(),this._inputElm?.focus()}hide(){this.calendarInstance?.hide()}show(){let e=!!this.args?.compositeEditorOptions;!e&&this.calendarInstance?this.calendarInstance.show():e&&this.applyInputUsabilityState()}getValue(){return this._inputElm.value}setValue(e,t=!1,i=!0){if(this.calendarInstance&&Ri(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:e}),t){this.applyValue(this.args.item,this.serializeValue());let o=this.args.compositeEditorOptions;o&&i&&this.handleChangeOnCompositeEditor(o,"system")}}applyValue(e,t){let i=this.columnDef?.field;if(this.columnDef&&i!==void 0){let o=this.columnDef.saveOutputType||this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||_.dateUtc,r=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||_.dateUtc,n=i.indexOf(".")>0,a=this.validate(null,t),l=t&&a?.valid?gt(t,r,o):"";if(n){let d=this.columnEditor?.complexObjectPath??i;Ae(e,d,l)}else e[i]=l}}isValueChanged(){let e=!1,t=this.getValue(),i=this._lastInputKeyEvent?.key;return this.editorOptions?.allowInput===!0&&this.columnEditor?.alwaysSaveOnEnterKey&&i==="Enter"?!0:(this.columnDef&&(e=this._lastTriggeredByClearDate||!(t===""&&this._originalDate==="")&&t!==this._originalDate),e)}isValueTouched(){return this._isValueTouched}loadValue(e){let t=this.columnDef?.field;if(e&&this.columnDef&&t!==void 0){let o=t?.indexOf(".")>0?ge(e,t):e[t],r=this.columnEditor.type||this.columnDef?.type||_.dateIso,n=this.columnDef.outputType||this.columnEditor.type||this.columnDef.type||_.dateIso,a=gt(o,r,n);this._originalDate=a!==""?o:"",this._inputElm.value=a}}reset(e,t=!0,i=!1){let o=e??this._originalDate??"";this.calendarInstance&&(this._originalDate=o,this.calendarInstance.selectedDates=[o],o?Ri(this.columnEditor,this._inputElm,this.calendarInstance,{columnDef:this.columnDef,newVal:o}):Fo(this.calendarInstance)),this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(r,"user",n)}}save(){let t=this.validate()?.valid??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){let e=this.getValue();return e||""}validate(e,t){let i=this.args?.compositeEditorOptions?!1:this.columnEditor.required,o=t??this._inputElm?.value,r=this.columnEditor.errorMessage;return this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled?{valid:!0,msg:""}:this.validator?this.validator(o,this.args):i&&o===""?{valid:!1,msg:r||x.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleOnDateChange(){if(this._isValueTouched=!0,this.args){let e=this.args.compositeEditorOptions;e?this.handleChangeOnCompositeEditor(e):this.save()}setTimeout(()=>this._lastTriggeredByClearDate=!1)}handleChangeOnCompositeEditor(e,t="user",i=!1){let o=this.grid.getActiveCell(),r=this.args.column,n=this.columnDef?.id??"",a=this.dataContext,l=this.grid,d=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,d),this.applyValue(e.formValues,d);let c=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(i||this.disabled&&c&&e.formValues.hasOwnProperty(n))&&delete e.formValues[n],l.onCompositeEditorChange.notify({...o,item:a,grid:l,column:r,formValues:e.formValues,editors:e.editors,triggeredBy:t},new U)}};function nn(s,e){let t=isNaN(s)?null:parseFloat(s),i=e.decimal||0,o=e.required,r=e.minValue,n=e.maxValue,a=e.operatorConditionalType||"inclusive",l=e.errorMessage,d={"{{minValue}}":r,"{{maxValue}}":n,"{{minDecimal}}":0,"{{maxDecimal}}":i},c=!0,h="";if(typeof e.validator=="function")return e.validator(s,e.editorArgs);if(o&&s==="")c=!1,h=l||x.VALIDATION_REQUIRED_FIELD;else if(s!==""&&(isNaN(s)||i===0&&!/^[-+]?(\d*(\.)?(\d)*)$/.test(s)))c=!1,h=l||x.VALIDATION_EDITOR_VALID_NUMBER;else if(r!==void 0&&n!==void 0&&t!==null&&(a==="exclusive"&&(t<=+r||t>=+n)||a==="inclusive"&&(t<+r||t>+n)))c=!1,h=l||x.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,u=>d[u]);else if(r!==void 0&&t!==null&&(a==="exclusive"&&t<=+r||a==="inclusive"&&t<+r)){c=!1;let u=a==="inclusive"?x.VALIDATION_EDITOR_NUMBER_MIN_INCLUSIVE:x.VALIDATION_EDITOR_NUMBER_MIN;h=l||u.replace(/{{minValue}}/gi,m=>d[m])}else if(n!==void 0&&t!==null&&(a==="exclusive"&&t>=+n||a==="inclusive"&&t>+n)){c=!1;let u=a==="inclusive"?x.VALIDATION_EDITOR_NUMBER_MAX_INCLUSIVE:x.VALIDATION_EDITOR_NUMBER_MAX;h=l||u.replace(/{{maxValue}}/gi,m=>d[m])}else i>0&&!new RegExp(`^[-+]?(\\d*(\\.)?(\\d){0,${i}})$`).test(s)&&(c=!1,h=l||x.VALIDATION_EDITOR_DECIMAL_BETWEEN.replace(/{{minDecimal}}|{{maxDecimal}}/gi,u=>d[u]));return{valid:c,msg:h}}function an(s,e){let t=isNaN(s)?null:parseInt(s,10);t!==null&&isNaN(t)&&(t=null);let i=e.errorMessage,o=e.required,r=e.minValue,n=e.maxValue,a=e.operatorConditionalType||"inclusive",l={"{{minValue}}":r,"{{maxValue}}":n},d=!0,c="";if(e.validator)return e.validator(s,e.editorArgs);if(o&&s==="")d=!1,c=i||x.VALIDATION_REQUIRED_FIELD;else if(s!==""&&(isNaN(s)||!/^[+-]?\d+$/.test(s)))d=!1,c=i||x.VALIDATION_EDITOR_VALID_INTEGER;else if(r!==void 0&&n!==void 0&&t!==null&&(a==="exclusive"&&(t<=+r||t>=+n)||a==="inclusive"&&(t<+r||t>+n)))d=!1,c=i||x.VALIDATION_EDITOR_INTEGER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,h=>l[h]);else if(r!==void 0&&t!==null&&(a==="exclusive"&&t<=+r||a==="inclusive"&&t!==null&&t<+r)){d=!1;let h=a==="inclusive"?x.VALIDATION_EDITOR_INTEGER_MIN_INCLUSIVE:x.VALIDATION_EDITOR_INTEGER_MIN;c=i||h.replace(/{{minValue}}/gi,u=>l[u])}else if(n!==void 0&&t!==null&&(a==="exclusive"&&t>=+n||a==="inclusive"&&t!==null&&t>+n)){d=!1;let h=a==="inclusive"?x.VALIDATION_EDITOR_INTEGER_MAX_INCLUSIVE:x.VALIDATION_EDITOR_INTEGER_MAX;c=i||h.replace(/{{maxValue}}/gi,u=>l[u])}return{valid:d,msg:c}}function Nc(s,e){let t=e.required,i=e.minValue,o=e.maxValue,r=e.errorMessage,n={"{{minValue}}":i,"{{maxValue}}":o};return e.validator?e.validator(s,e.editorArgs):t&&s===""?{valid:!1,msg:r||x.VALIDATION_REQUIRED_FIELD}:i!==void 0&&o!==void 0&&s!==null&&(s<i||s>o)?{valid:!1,msg:r||x.VALIDATION_EDITOR_NUMBER_BETWEEN.replace(/{{minValue}}|{{maxValue}}/gi,a=>n[a])}:{valid:!0,msg:null}}var ln=class{constructor(e){this.args=e,this._isValueSaveCalled=!1,this._isLeftValueTouched=!1,this._isRightValueTouched=!1,this.disabled=!1,this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._eventHandler=new G,this._bindEventService=new oe,this.init(),this._eventHandler.subscribe(this.grid.onValidationError,()=>this._isValueSaveCalled=!0)}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return{leftInput:this._leftInput,rightInput:this._rightInput}}get editorParams(){return this.columnEditor.params||{}}get eventHandler(){return this._eventHandler}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get isValueSaveCalled(){return this._isValueSaveCalled}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){if(!this.editorParams||!this.editorParams.leftInput||!this.editorParams.leftInput.field||!this.editorParams.rightInput||!this.editorParams.rightInput.field)throw new Error(`[Slickgrid-Universal] Please make sure that your Combo Input Editor has params defined with "leftInput" and "rightInput" (example: { editor: { model: Editors.comboInput, params: { leftInput: { field: 'firstName' }, { rightSide: { field: 'lastName' } }}}`);this._leftFieldName=this.editorParams.leftInput?.field,this._rightFieldName=this.editorParams.rightInput?.field,this._leftInput=this.createInput("leftInput"),this._rightInput=this.createInput("rightInput");let e=this.args?.container;e&&typeof e.appendChild=="function"&&(e.appendChild(this._leftInput),e.appendChild(this._rightInput)),this._bindEventService.bind(this._leftInput,"keydown",i=>this.handleKeyDown(i,"leftInput")),this._bindEventService.bind(this._rightInput,"keydown",i=>this.handleKeyDown(i,"rightInput")),this.hasAutoCommitEdit&&(this._bindEventService.bind(this._leftInput,"focusout",i=>this.handleFocusOut(i,"leftInput")),this._bindEventService.bind(this._rightInput,"focusout",i=>this.handleFocusOut(i,"rightInput"))),this.args?.compositeEditorOptions?(this._bindEventService.bind(this._leftInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this)),this._bindEventService.bind(this._rightInput,"input",this.handleChangeOnCompositeEditorDebounce.bind(this))):setTimeout(()=>this._leftInput.select(),50)}handleFocusOut(e,t){let i=e.relatedTarget?.className||"";!this.args.compositeEditorOptions&&i.indexOf("dual-editor")===-1&&this._lastEventType!=="focusout-right"&&(t==="rightInput"||t==="leftInput"&&this._lastEventType!=="focusout-left")&&(t==="leftInput"?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this.save());let r=t==="leftInput"?"left":"right";this._lastEventType=`${e?.type}-${r}`}handleKeyDown(e,t){t==="leftInput"?this._isLeftValueTouched=!0:this._isRightValueTouched=!0,this._lastInputKeyEvent=e,(e.key==="ArrowLeft"||e.key==="ArrowRight"||e.key==="Home"||e.key==="End"||e.key==="Tab")&&e.stopImmediatePropagation()}destroy(){this._eventHandler.unsubscribeAll(),this._bindEventService.unbindAll(),this._leftInput?.remove?.(),this._rightInput?.remove?.()}createInput(e){let t=this.editorParams[e],i=this.columnDef?.id??"",o=this.gridOptions.datasetIdPropertyName||"id",r=this.args?.item?.[o]??"",n=t.type||"text";(n==="float"||n==="integer")&&(n="number");let a=p("input",{type:n||"text",id:`item-${r}-${e}`,ariaLabel:this.columnEditor?.ariaLabel??`${Xe(i+"")} Input Editor`,className:`dual-editor-text editor-${i} ${e.replace(/input/gi,"")}`,autocomplete:"off",ariaAutoComplete:"none",placeholder:t.placeholder||"",title:t.title||""});return n==="readonly"&&(a.readOnly=!0,n="text"),n==="number"&&(a.step=this.getInputDecimalSteps(e)),a}disable(e=!0){let t=this.disabled;this.disabled=e,this._leftInput&&this._rightInput&&(e?(this._leftInput.setAttribute("disabled","disabled"),this._rightInput.setAttribute("disabled","disabled"),t!==e&&this.args?.compositeEditorOptions&&this.reset("",!0,!0)):(this._leftInput.removeAttribute("disabled"),this._rightInput.removeAttribute("disabled")))}focus(){this.grid.focus()}show(){!!this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValues(){let e={},t=this._leftInput.value,i=this._rightInput.value,o=this.editorParams.leftInput&&(this.editorParams.leftInput.type==="float"||this.editorParams.leftInput.type==="integer"),r=this.editorParams.rightInput&&(this.editorParams.rightInput.type==="float"||this.editorParams.rightInput.type==="integer"),n=t!==""&&o?+this._leftInput.value:t||"",a=i!==""&&r?+this._rightInput.value:i||"";return Ae(e,this._leftFieldName,n),Ae(e,this._rightFieldName,a),e}setValues(e){Array.isArray(e)&&e.length===2&&(this._leftInput.value=`${e[0]}`,this._rightInput.value=`${e[1]}`)}applyValue(e,t){this.applyValueByPosition(e,t,"leftInput"),this.applyValueByPosition(e,t,"rightInput")}applyValueByPosition(e,t,i){let o=i==="leftInput"?this._leftFieldName:this._rightFieldName;if(o!==void 0){let r=o?.indexOf(".")>0,n=o;if(r){let d=o.split(/\.(.*)/);n=d.length>1?d[1]:d}let a=r?ge(t,n):t[o],l=this.validate(null,{position:i,inputValue:a});if(r){let d=ge(t,n),c=l&&l.valid?d:"",h=this.columnEditor?.complexObjectPath??o??"";Ae(e,h,c)}else o&&(e[o]=l&&l.valid?t[o]:"")}}isValueChanged(){let e=this._leftInput.value,t=this._rightInput.value,i=this.editorParams?.leftInput,o=this.editorParams?.rightInput,r=this._lastInputKeyEvent?.key;if((i&&i.alwaysSaveOnEnterKey||o&&o.alwaysSaveOnEnterKey)&&r==="Enter")return!0;let n=!(e===""&&(this._originalLeftValue===null||this._originalLeftValue===void 0))&&e!==this._originalLeftValue,a=!(t===""&&(this._originalRightValue===null||this._originalRightValue===void 0))&&t!==this._originalRightValue;return n||a}isValueTouched(){return this._isLeftValueTouched||this._isRightValueTouched}loadValue(e){this.loadValueByPosition(e,"leftInput"),this.loadValueByPosition(e,"rightInput"),this._leftInput.select()}loadValueByPosition(e,t){let i=t==="leftInput"?this._leftFieldName:this._rightFieldName,o=t==="leftInput"?"_originalLeftValue":"_originalRightValue",r=t==="leftInput"?"_leftInput":"_rightInput";if(e&&i!==void 0){let a=i?.indexOf(".")>0?ge(e,i):e.hasOwnProperty(i)?e[i]:"";if(this[o]=a,this.editorParams[t].type==="float"){let l=this.getDecimalPlaces(t);l!==null&&(this[o]||this[o]===0)&&this[o]!==void 0&&(this[o]=(+this[o]).toFixed(l))}this[r]&&(this[r].value=`${this[o]}`)}}reset(e,t=!0,i=!1){let o=e??this._originalLeftValue??"",r=e??this._originalRightValue??"";this._leftInput&&this._rightInput&&(this._originalLeftValue=o,this._originalRightValue=r,this._leftInput.value=`${o}`,this._rightInput.value=`${r}`),this._isLeftValueTouched=!1,this._isRightValueTouched=!1;let n=this.args.compositeEditorOptions;if(n&&t){let a=!i;this.handleChangeOnCompositeEditor(null,n,"user",a)}}save(){let e=this.validate(),t=e&&e.valid||!1;this._isValueSaveCalled||(this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges(),this._isValueSaveCalled=!0)}serializeValue(){let e={},t=this.serializeValueByPosition("leftInput"),i=this.serializeValueByPosition("rightInput");return Ae(e,this._leftFieldName,t),Ae(e,this._rightFieldName,i),e}serializeValueByPosition(e){let t=e==="leftInput"?this._leftInput.value:this._rightInput.value;if(t===""||isNaN(+t))return t;let i=parseFloat(t),o=this.getDecimalPlaces(e);return o!==null&&(i||i===0)&&i.toFixed&&(i=parseFloat(i.toFixed(o))),i}getDecimalPlaces(e){let i=e==="leftInput"?"leftInput":"rightInput",r=this.editorParams[i]?.decimal;return r===void 0?0:r}getInputDecimalSteps(e){let t=this.getDecimalPlaces(e),i="";for(let o=1;o<t;o++)i+="0";return t>0?`0.${i}1`:"1"}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(t){let i=this.validateByPosition(t.position,t.inputValue);if(!i.valid)return t.position==="leftInput"?this._leftInput.select():this._rightInput.select(),i}else{let i=this.validateByPosition("leftInput"),o=this.validateByPosition("rightInput");if(!i.valid)return this._leftInput.select(),i;if(!o.valid)return this._rightInput.select(),o}return{valid:!0,msg:""}}validateByPosition(e,t){let i=this.editorParams[e],o="";if(t)o=t;else{let a=e==="leftInput"?this._leftInput:this._rightInput;o=a&&a.value}let r=this.validator;o=typeof r=="function"?this.getValues():o;let n={editorArgs:this.args,errorMessage:i.errorMessage,required:this.args?.compositeEditorOptions?!1:i.required,validator:typeof r=="function"?r:i.validator};switch(i.type){case"float":return nn(o,{...n,decimal:this.getDecimalPlaces(e),minValue:i.minValue,maxValue:i.maxValue,operatorConditionalType:i.operatorConditionalType});case"integer":return an(o,{...n,minValue:i.minValue,maxValue:i.maxValue,operatorConditionalType:i.operatorConditionalType});case"text":case"password":default:return vi(o,n)}}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,i="user",o=!1){let r=this.grid.getActiveCell(),n=this.args.column,a=this.columnEditor.params?.leftInput?.field??"",l=this.columnEditor.params?.rightInput?.field??"",d=this.dataContext,c=this.grid,h=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,h),this.applyValue(t.formValues,h);let u=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(o||this.disabled&&u&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],(o||this.disabled&&u&&t.formValues.hasOwnProperty(l))&&delete t.formValues[l],c.onCompositeEditorChange.notify({...r,item:d,grid:c,column:n,formValues:t.formValues,editors:t.editors,triggeredBy:i},new U(e))}handleChangeOnCompositeEditorDebounce(e){let t=this.args?.compositeEditorOptions;if(t){let i=this.gridOptions?.editorTypingDebounce??500;clearTimeout(this._timer),this._timer=setTimeout(()=>this.handleChangeOnCompositeEditor(e,t),i)}}};var Tp=0,Nt=class{constructor(e,t="text"){this.args=e,this._inputType="text",this._isValueTouched=!1,this.disabled=!1,this.grid=e.grid,this.gridOptions=e.grid?.getOptions(),this._bindEventService=new oe,this.inputType=t,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor||{}}get dataContext(){return this.args.item}get editorDomElement(){return this._input}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get inputType(){return this._inputType}set inputType(e){this._inputType=e}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){let e=this.columnDef?.id??"",t=this.args.compositeEditorOptions;this._input=p("input",{type:this._inputType||"text",autocomplete:"off",ariaAutoComplete:"none",ariaLabel:this.columnEditor?.ariaLabel??`${Xe(e+"")} Input Editor`,className:`editor-text editor-${e}`,placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor?.title??""}),this.inputType==="number"&&(this._input.step=`${this.columnEditor.valueStep!==void 0?this.columnEditor.valueStep:this.getInputDecimalSteps()}`);let i=this.args.container;i&&typeof i.appendChild=="function"&&i.appendChild(this._input),this._bindEventService.bind(this._input,"focus",()=>this._input?.select()),this._bindEventService.bind(this._input,"keydown",o=>{this._isValueTouched=!0,this._lastInputKeyEvent=o,(o.key==="ArrowLeft"||o.key==="ArrowRight"||o.key==="Home"||o.key==="End")&&o.stopImmediatePropagation()}),this.hasAutoCommitEdit&&!t&&this._bindEventService.bind(this._input,["focusout","blur"],()=>{this._isValueTouched=!0,this.save()}),t&&(this._bindEventService.bind(this._input,["input","paste"],this.handleOnInputChange.bind(this)),this.inputType==="number"&&this._bindEventService.bind(this._input,"wheel",this.handleOnMouseWheel.bind(this),{passive:!0}))}destroy(){this._bindEventService.unbindAll(),this._input?.remove?.()}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._input)if(e){this._input.setAttribute("disabled","disabled");let i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&i!==""&&this.reset("",!0,!0)}else this._input.removeAttribute("disabled")}focus(){this.grid.focus(),this._input?.focus()}getDecimalPlaces(){let e=this.columnEditor?.decimal??this.columnEditor?.params?.decimalPlaces??void 0;return e===void 0&&(e=Tp),!e&&e!==0?0:e}getInputDecimalSteps(){let e=this.getDecimalPlaces(),t="";for(let i=1;i<e;i++)t+="0";return e>0?`0.${t}1`:"1"}show(){!!this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._input?.value||""}setValue(e,t=!1,i=!0){if(this._input&&(this._input.value=`${e}`,t)){this.applyValue(this.args.item,this.serializeValue());let o=this.args.compositeEditorOptions;o&&i&&this.handleChangeOnCompositeEditor(null,o,"system")}}applyValue(e,t){let i=this.columnDef?.field;if(i!==void 0){let o=i?.indexOf(".")>0,n=this.validate(null,t)?.valid?t:"";if(o){let a=this.columnEditor?.complexObjectPath??i??"";Ae(e,a,n)}else i&&(e[i]=n)}}isValueChanged(){let e=this._input?.value,t=this._lastInputKeyEvent?.key;return this.columnEditor?.alwaysSaveOnEnterKey&&t==="Enter"?!0:!(e===""&&(this._originalValue===null||this._originalValue===void 0))&&e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){let t=this.columnDef?.field;if(e&&t!==void 0&&this._input){let o=t?.indexOf(".")>0?ge(e,t):e.hasOwnProperty(t)&&e[t]||"";this._originalValue=o,this._input.value=this._originalValue,this._input.select()}}reset(e,t=!0,i=!1){let o=e??this._originalValue??"";this._input&&(this._originalValue=o,this._input.value=`${o}`),this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(null,r,"user",n)}}save(){let e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._input?.value??""}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};let i=t!==void 0?t:this._input&&this._input.value;return vi(i,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:this.args?.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeOnCompositeEditor(e,t,i="user",o=!1){let r=this.grid.getActiveCell(),n=this.args.column,a=this.columnDef?.id??"",l=this.dataContext,d=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);let h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(o||this.disabled&&h&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],d.onCompositeEditorChange.notify({...r,item:l,grid:d,column:n,formValues:t.formValues,editors:t.editors,triggeredBy:i},new U(e))}handleOnInputChange(e){this._isValueTouched=!0;let t=this.args.compositeEditorOptions;if(t){let i=this.gridOptions?.editorTypingDebounce??500;clearTimeout(this._timer),this._timer=setTimeout(()=>this.handleChangeOnCompositeEditor(e,t),i)}}handleOnMouseWheel(e){this._isValueTouched=!0;let t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}};var dn=class extends Nt{constructor(e){super(e,"number"),this.args=e}loadValue(e){let t=this.columnDef?.field;if(t!==void 0&&e&&t!==void 0&&this._input){let o=t?.indexOf(".")>0?ge(e,t):e[t];this._originalValue=o;let r=this.getDecimalPlaces();r!==null&&(this._originalValue||this._originalValue===0)&&this._originalValue!==void 0&&(this._originalValue=(+this._originalValue).toFixed(r)),this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){let e=this._input?.value;if(e===void 0||e===""||isNaN(+e))return e;let t=parseFloat(e),i=this.getDecimalPlaces();return i!==null&&(t||t===0)&&t.toFixed&&(t=parseFloat(t.toFixed(i))),t}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};let i=t!==void 0?t:this._input?.value;return nn(i,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,decimal:this.getDecimalPlaces(),minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:this.args?.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}};var cn=class extends Nt{constructor(e){super(e,"password"),this.args=e}};var hn=class extends Nt{constructor(e){super(e,"number"),this.args=e}loadValue(e){let t=this.columnDef?.field;if(e&&t!==void 0&&this._input){let o=t?.indexOf(".")>0?ge(e,t):e[t];this._originalValue=isNaN(o)||o===null||o===void 0?o:`${o}`,this._input.value=`${this._originalValue}`,this._input.select()}}serializeValue(){let e=this._input?.value;if(e===void 0||e===""||isNaN(+e))return e;let t=isNaN(+e)?e:parseInt(e,10);return isNaN(+t)?e:t}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};let i=t!==void 0?t:this.getValue();return an(i,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,operatorConditionalType:this.columnEditor.operatorConditionalType,required:this.args?.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}handleOnMouseWheel(e){this._isValueTouched=!0;let t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(e,t)}};var un=class{constructor(e){this.args=e,this._isValueTouched=!1,this.disabled=!1,this.grid=e.grid,this.gridOptions=e.grid?.getOptions();let t=this.gridOptions||this.args.column.params||{};t?.translater&&(this._translater=t.translater),this._locales=this.gridOptions?.locales||x.locales,this._bindEventService=new oe,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._textareaElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.longText,...this.columnEditor?.editorOptions,...this.columnEditor?.options}}get hasAutoCommitEdit(){return this.gridOptions?.autoCommitEdit??!1}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){let e="",t="";if(this._translater&&this._translater.translate&&this.gridOptions.enableTranslate){let c=$e(this.gridOptions),h=this.editorOptions.buttonTexts?.cancelKey??`${c}CANCEL`,u=this.editorOptions.buttonTexts?.saveKey??`${c}SAVE`;e=this._translater.translate(`${c}${h}`),t=this._translater.translate(`${c}${u}`)}else e=this.editorOptions.buttonTexts?.cancel??this._locales?.TEXT_CANCEL??"Cancel",t=this.editorOptions.buttonTexts?.save??this._locales?.TEXT_SAVE??"Save";let i=this.args.compositeEditorOptions,o=this.columnDef?.id??"",r=this.columnEditor?.maxLength,n=this.editorOptions?.rows??4,a=i?this.args.container:document.body;this._wrapperElm=p("div",{className:`slick-large-editor-text editor-${o}`,style:{position:i?"relative":"absolute"}}),this.gridOptions?.darkMode&&this._wrapperElm.classList.add("slick-dark-mode"),a.appendChild(this._wrapperElm),this._textareaElm=p("textarea",{ariaLabel:this.columnEditor?.ariaLabel??`${Xe(o+"")} Text Editor`,cols:this.editorOptions?.cols??40,rows:i&&n>3?3:n,placeholder:this.columnEditor?.placeholder??"",title:this.columnEditor?.title??""},this._wrapperElm);let l=p("div",{className:"editor-footer"}),d=p("span",{className:"counter"});if(this._currentLengthElm=p("span",{className:"text-length",textContent:"0"}),d.appendChild(this._currentLengthElm),r!==void 0&&(d.appendChild(p("span",{className:"separator",textContent:"/"})),d.appendChild(p("span",{className:"max-length",textContent:`${r}`}))),l.appendChild(d),!i){let c=p("button",{className:"btn btn-cancel btn-default btn-xs",textContent:e}),h=p("button",{className:"btn btn-save btn-primary btn-xs",textContent:t});this.editorOptions.saveButtonPosition==="left"?(l.appendChild(h),l.appendChild(c)):(l.appendChild(c),l.appendChild(h)),this._bindEventService.bind(c,"click",this.cancel.bind(this)),this._bindEventService.bind(h,"click",this.save.bind(this)),this.position(this.args?.position),this._textareaElm.focus(),this._textareaElm.select()}this._wrapperElm.appendChild(l),this._bindEventService.bind(this._textareaElm,"keydown",this.handleKeyDown.bind(this)),this._bindEventService.bind(this._textareaElm,"input",this.handleOnInputChange.bind(this)),this._bindEventService.bind(this._textareaElm,"paste",this.handleOnInputChange.bind(this))}cancel(){let e=this._defaultTextValue||"";this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,this.args?.cancelChanges&&this.args.cancelChanges()}hide(){this._wrapperElm.style.display="none"}show(){!!this.args?.compositeEditorOptions?this.applyInputUsabilityState():this._wrapperElm.style.display="block"}destroy(){this._bindEventService.unbindAll(),this._wrapperElm?.remove?.()}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._textareaElm&&this._wrapperElm)if(e){this._textareaElm.disabled=!0,this._wrapperElm.classList.add("disabled");let i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&i!==""&&this.reset("",!0,!0)}else this._textareaElm.disabled=!1,this._wrapperElm.classList.remove("disabled")}focus(){this.grid.focus(),this._textareaElm&&(this._textareaElm.focus(),this._textareaElm.select())}getValue(){return this._textareaElm.value}setValue(e,t=!1,i=!0){if(this._textareaElm.value=e,this._currentLengthElm.textContent=`${e.length}`,t){this.applyValue(this.args.item,this.serializeValue());let o=this.args.compositeEditorOptions;o&&i&&this.handleChangeOnCompositeEditor(null,o,"system")}}applyValue(e,t){let i=this.columnDef?.field;if(i!==void 0){let o=i?.indexOf(".")>0,n=this.validate(void 0,t)?.valid?t:"";if(o){let a=this.columnEditor?.complexObjectPath??i??"";Ae(e,a,n)}else e[i]=n}}isValueChanged(){let e=this._textareaElm.value;return!(e===""&&(this._defaultTextValue===null||this._defaultTextValue===void 0))&&e!==this._defaultTextValue}isValueTouched(){return this._isValueTouched}loadValue(e){let t=this.columnDef?.field;if(e&&t!==void 0){let o=t?.indexOf(".")>0?ge(e,t):e[t];this._defaultTextValue=o||"",this._textareaElm.value=this._defaultTextValue,this._currentLengthElm.textContent=this._defaultTextValue.length,this._textareaElm.defaultValue=this._defaultTextValue,this._textareaElm.select()}}position(e){let t=_e(this.args.container),i=this.args.container.offsetHeight,o=this.args.container.offsetWidth,r=this._wrapperElm.getBoundingClientRect().height||this.args.position.height,n=this._wrapperElm.getBoundingClientRect().width||this.args.position.width,a=document.body.offsetHeight||window.innerHeight,l=document.body.offsetWidth||window.innerWidth,d=this.args.container?t.top:e.top??0,c=this.args.container?t.left:e.left??0,h=this.editorOptions?.position??"auto";if(h==="left"||h==="auto"&&c+n>l){let u=this.editorOptions?.marginRight??0;c-=n-o+u}(h==="top"||h==="auto"&&d+r>a)&&(d-=r-i),this._wrapperElm.style.top=`${d}px`,this._wrapperElm.style.left=`${c}px`}reset(e,t=!0,i=!1){let o=e??this._defaultTextValue??"";this._textareaElm&&(this._defaultTextValue=o,this._textareaElm.value=o,this._currentLengthElm.textContent=o.length),this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(null,r,"user",n)}}save(){let t=this.validate()?.valid??!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){return this._textareaElm.value}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};let i=t!==void 0?t:this._textareaElm?.value;return vi(i,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minLength:this.columnEditor.minLength,maxLength:this.columnEditor.maxLength,operatorConditionalType:this.columnEditor.operatorConditionalType,required:this.args?.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleKeyDown(e){let t=e.key;this._isValueTouched=!0,this.args.compositeEditorOptions||(t==="Enter"&&e.ctrlKey||e.ctrlKey&&e.key.toUpperCase()==="S"?(e.preventDefault(),this.save()):t==="Escape"?(e.preventDefault(),this.cancel()):t==="Tab"&&(e.preventDefault(),e.shiftKey?this.grid.navigatePrev():this.grid.navigateNext()))}handleOnInputChange(e){let t=this.args.compositeEditorOptions,i=this.columnEditor?.maxLength,o=!1;if(i&&(o=this.truncateText(this._textareaElm,i)),o)this._currentLengthElm.textContent=`${i}`;else{let r=e.type==="paste"?e.clipboardData.getData("text"):e.target.value;this._currentLengthElm.textContent=`${r.length}`}if(t){let r=this.gridOptions?.editorTypingDebounce??500;clearTimeout(this._timer),this._timer=setTimeout(()=>this.handleChangeOnCompositeEditor(e,t),r)}}handleChangeOnCompositeEditor(e,t,i="user",o=!1){let r=this.grid.getActiveCell(),n=this.args.column,a=this.columnDef?.id??"",l=this.dataContext,d=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);let h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(o||this.disabled&&h&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],d.onCompositeEditorChange.notify({...r,item:l,grid:d,column:n,formValues:t.formValues,editors:t.editors,triggeredBy:i},new U(e))}truncateText(e,t){let i=e.value+"";return i.length>t?(e.value=i.substring(0,t),!0):!1}};var bo=class{constructor(e,t){this.args=e,this.isMultipleSelect=t,this._isValueTouched=!1,this._isDisposingOrCallingSave=!1,this.disabled=!1,this.enableTranslateLabel=!1,this.finalCollection=[],this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this.gridOptions?.translater&&(this._translaterService=this.gridOptions.translater),this._locales=this.gridOptions.locales||x.locales,this.elementName=`editor-${this.columnId}`;let i=this.args.compositeEditorOptions,o={autoAdjustDropHeight:!0,autoAdjustDropPosition:!0,autoAdjustDropWidthByTextSize:!0,container:"body",darkMode:!!this.gridOptions.darkMode,filter:!1,isOpen:!this.isCompositeEditor,maxHeight:275,minHeight:25,name:this.elementName,single:!0,singleRadio:!0,renderOptionLabelAsHtml:this.columnEditor?.enableRenderHtml??!1,sanitizer:r=>this.grid.sanitizeHtmlString(r),onClick:()=>this._isValueTouched=!0,onCheckAll:()=>this._isValueTouched=!0,onUncheckAll:()=>this._isValueTouched=!0,onBlur:r=>{let n=r;n?.key==="Tab"&&this._msInstance?.getOptions().isOpen&&(n.preventDefault(),this._msInstance.close("blur"),this.isCompositeEditor||(n.shiftKey?this.grid.navigatePrev():this.grid.navigateNext()))},onClose:r=>{if(r==="key.escape"||r==="body.click"||!this.hasAutoCommitEdit&&!this.isValueChanged()){r==="key.escape"&&this.cancel();return}i?this.handleChangeOnCompositeEditor(i):(this._isDisposingOrCallingSave=!0,this.save(this.hasAutoCommitEdit))}};if(t){o.single=!1,o.singleRadio=!1,o.displayTitle=!0,o.showOkButton=!0;let r=$e(this.gridOptions);o.countSelectedText=this.translateOrDefault(`${r}X_OF_Y_SELECTED`,this._locales?.TEXT_X_OF_Y_SELECTED),o.allSelectedText=this.translateOrDefault(`${r}ALL_SELECTED`,this._locales?.TEXT_ALL_SELECTED),o.selectAllText=this.translateOrDefault(`${r}SELECT_ALL`,this._locales?.TEXT_SELECT_ALL),o.okButtonText=this.translateOrDefault(`${r}OK`,this._locales?.TEXT_OK),o.noMatchesFoundText=this.translateOrDefault(`${r}NO_MATCHES_FOUND`,this._locales?.TEXT_NO_MATCHES_FOUND)}this.defaultOptions=o,this.init()}get collection(){return this.columnEditor?.collection??[]}get collectionOptions(){return this.columnEditor?.collectionOptions}get columnDef(){return this.args.column}get columnId(){return this.columnDef?.id??""}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.select,...this.columnEditor?.editorOptions,...this.columnEditor?.options}}get isCompositeEditor(){return!!this.args?.compositeEditorOptions}get customStructure(){return this.columnDef?.editor?.customStructure}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get msInstance(){return this._msInstance}get selectOptions(){return this.defaultOptions}get currentValues(){let e=new Set;if((this._msInstance?.getSelects("value")??[]).forEach(o=>e.add(o.toString())),this.collection.every(o=>typeof o=="number"||typeof o=="string"))return this.collection.filter(o=>e.has(o?.toString()));let t=this.collectionOptions?.separatorBetweenTextLabels??"",i=this.collectionOptions?.includePrefixSuffixToSelectedValues??!1;return this.collection.filter(o=>e.has(o?.[this.valueName]?.toString())).map(o=>{let r=o[this.valueName],n=o[this.labelPrefixName]||"",a=o[this.labelSuffixName]||"",d=(this.columnDef?.field??"")?.indexOf(".")>0,c=this.columnEditor?.serializeComplexValueFormat??"object";return d&&typeof o=="object"&&c==="object"?o:(n=this.translatePrefixSuffix(n),a=this.translatePrefixSuffix(a),i?[n,r,a].filter(u=>u).join(t):r)})}get currentValue(){let e=this._msInstance?.getSelects()??[],t=e.length?e[0]:"",i=this.columnDef?.field;if(i!==void 0){if(this.collection.every(d=>typeof d=="number"||typeof d=="string"))return mt(this.collection,d=>d?.toString?.()===`${t}`);let o=this.collectionOptions?.separatorBetweenTextLabels??"",r=this.collectionOptions?.includePrefixSuffixToSelectedValues??!1,n=mt(this.collection,d=>d.hasOwnProperty(this.valueName)&&d[this.valueName]?.toString()===`${t}`),a=i?.indexOf(".")>0,l=this.columnEditor?.serializeComplexValueFormat??"object";if(a&&typeof n=="object"&&l==="object")return n;if(n&&n.hasOwnProperty(this.valueName)){let d=n[this.valueName];if(r){let c=n[this.labelPrefixName]||"",h=n[this.labelSuffixName]||"";return c=this.translatePrefixSuffix(c),h=this.translatePrefixSuffix(h),[c,d,h].filter(m=>m).join(o)}return d}}return""}get validator(){return this.columnEditor?.validator??this.columnDef?.validator}init(){if(!this.columnDef||!this.columnDef.editor||!this.columnDef.editor.collection&&!this.columnDef.editor.collectionAsync)throw new Error(`[Slickgrid-Universal] You need to pass a "collection" (or "collectionAsync") inside Column Definition Editor for the MultipleSelect/SingleSelect Editor to work correctly.
      Also each option should include a value/label pair (or value/labelKey when using Locale).
      For example: { editor: { collection: [{ value: true, label: 'True' },{ value: false, label: 'False'}] } }`);if(this._collectionService=new ho(this._translaterService),this.enableTranslateLabel=this.columnEditor?.enableTranslateLabel??!1,this.labelName=this.customStructure?.label??"label",this.labelPrefixName=this.customStructure?.labelPrefix??"labelPrefix",this.labelSuffixName=this.customStructure?.labelSuffix??"labelSuffix",this.optionLabel=this.customStructure?.optionLabel??"value",this.valueName=this.customStructure?.value??"value",this.enableTranslateLabel&&(!this._translaterService||typeof this._translaterService.translate!="function"))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');this.renderDomElement(this.collection),(this.disabled||this.columnEditor?.collectionAsync&&Array.isArray(this.collection)&&this.collection.length===0)&&this.disable(!0)}getValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}setValue(e,t=!1,i=!0){if(this.isMultipleSelect&&Array.isArray(e)?this.loadMultipleValues(e):this.loadSingleValue(e),t){this.applyValue(this.args.item,this.serializeValue());let o=this.args.compositeEditorOptions;o&&i&&this.handleChangeOnCompositeEditor(o,"system")}}cancel(){this.args?.cancelChanges&&this.args.cancelChanges()}hide(){this._msInstance&&this._msInstance.close()}show(e){!this.isCompositeEditor&&this._msInstance?this._msInstance.open(e):this.isCompositeEditor&&this.applyInputUsabilityState()}applyValue(e,t){let i=this.columnDef?.field,o=this.columnDef?.type,r=t;if(i!==void 0){(o===_.number||o===_.integer||o===_.boolean)&&!isNaN(parseFloat(t))&&(r=parseFloat(t)),this.isMultipleSelect&&typeof t=="string"&&t.indexOf(",")>=0&&(r=t.split(","));let n=i?.indexOf(".")>0;if(r=this.validate(null,r)?.valid?r:"",n){let l=this.columnEditor?.complexObjectPath??i??"";Ae(e,l,r)}else e[i]=r}}destroy(){this._msInstance&&this.hasAutoCommitEdit&&this.isValueChanged()&&!this._isDisposingOrCallingSave&&!this.isCompositeEditor&&(this._isDisposingOrCallingSave=!0,this.save(!0)),this._isDisposingOrCallingSave=!0,typeof this._msInstance?.destroy=="function"&&this._msInstance.destroy(),this.editorElm?.remove(),this._msInstance=void 0}loadValue(e){let t=this.columnDef?.field,i=t!==void 0&&t?.indexOf(".")>0;if(e&&t!==void 0){let o=this.columnEditor?.complexObjectPath??t,r=i?ge(e,o):e.hasOwnProperty(t)&&e[t],n=i&&r?.hasOwnProperty(this.valueName)?r[this.valueName]:r;this.isMultipleSelect&&Array.isArray(n)?this.loadMultipleValues(n):this.loadSingleValue(n)}}loadMultipleValues(e){if(Array.isArray(e)){this.originalValue=e.map(i=>typeof i=="number"||typeof i=="boolean"?`${i}`:i),this._msInstance?.setSelects(this.originalValue);let t=this.args.compositeEditorOptions;t&&this.handleChangeOnCompositeEditor(t)}}loadSingleValue(e){this.originalValue=typeof e=="number"||typeof e=="boolean"?`${e}`:e,this._msInstance?.setSelects([this.originalValue])}serializeValue(){return this.isMultipleSelect?this.currentValues:this.currentValue}changeEditorOption(e,t){this.columnEditor&&(this.columnEditor.options??={},this.columnEditor.editorOptions??={},this.columnEditor.options[e]=this.columnEditor.editorOptions[e]=t,this.editorElmOptions={...this.editorElmOptions,[e]:t},this._msInstance?.refreshOptions(this.editorElmOptions))}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._msInstance)if(e){this._msInstance.disable();let i=this.getValue(),o=Array.isArray(i)&&this.isMultipleSelect?i?.[0]==="":i==="";t!==e&&this.isCompositeEditor&&!o&&this.reset("",!0,!0)}else this._msInstance.enable()}focus(){this.grid.focus(),this._msInstance?.focus()}isValueChanged(){let e=this._msInstance?.getSelects();if(this.isMultipleSelect)return!lt(e,this.originalValue);let t=Array.isArray(e)&&e.length>0?e[0]:void 0;return t!==void 0&&t!==this.originalValue}isValueTouched(){return this._isValueTouched}reset(e,t=!0,i=!1){let o=e??this.originalValue;if(this._msInstance){this.originalValue=this.isMultipleSelect?o!==void 0?[o]:[]:o;let n=this.originalValue===void 0?[]:[this.originalValue];this._msInstance.setSelects(n)}this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(r,"user",n)}}save(e=!1){let i=this.validate()?.valid??!1;(!this._isDisposingOrCallingSave||e)&&this.hasAutoCommitEdit&&i?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}validate(e,t){let i=this.isCompositeEditor?!1:this.columnEditor?.required,o=t!==void 0?t:this._msInstance?.getSelects(),r=this.columnEditor?.errorMessage;if(this.isCompositeEditor&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};if(this.validator){let n=t!==void 0?t:this.isMultipleSelect?this.currentValues:this.currentValue;return this.validator(n,this.args)}return i&&(o===""||Array.isArray(o)&&o.length===0)?{valid:!1,msg:r||x.VALIDATION_REQUIRED_FIELD}:{valid:!0,msg:null}}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}translatePrefixSuffix(e){return this.enableTranslateLabel&&this._translaterService&&e&&typeof e=="string"?this._translaterService.translate(e||" "):e}translateOrDefault(e,t=""){return(this.gridOptions?.enableTranslate??!1)&&this._translaterService?.translate?this._translaterService.translate(e):t}renderDomElement(e){if(e=Ht(e,this.columnEditor),!Array.isArray(e))throw new Error('The "collection" passed to the Select Editor is not a valid array.');let t=[];if(e.length>0&&(t=[...e]),this.collectionOptions?.addBlankEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==""&&(t.unshift(No(this.labelName,this.valueName,this.labelPrefixName,this.labelSuffixName)),this.collection.unshift(No(this.labelName,this.valueName,this.labelPrefixName,this.labelSuffixName))),this.collectionOptions?.addCustomFirstEntry&&Array.isArray(t)&&t.length>0&&t[0][this.valueName]!==this.collectionOptions.addCustomFirstEntry[this.valueName]&&(t.unshift(this.collectionOptions.addCustomFirstEntry),this.collection.unshift(this.collectionOptions.addCustomFirstEntry)),this.collectionOptions?.addCustomLastEntry&&Array.isArray(t)&&t.length>0){let r=t.length-1;t[r][this.valueName]!==this.collectionOptions.addCustomLastEntry[this.valueName]&&t.push(this.collectionOptions.addCustomLastEntry)}let i=t;if(i=Xi(i,this._collectionService,this.columnEditor?.collectionFilterBy,this.collectionOptions),i=Zi(i,this.columnDef,this._collectionService,this.columnEditor?.collectionSortBy,this.enableTranslateLabel),this.columnEditor?.collectionOverride){let r={column:this.columnDef,dataContext:this.dataContext,grid:this.grid,originalCollections:this.collection};if(this.args.compositeEditorOptions){let{formValues:n,modalType:a}=this.args.compositeEditorOptions;r.compositeEditorOptions={formValues:n,modalType:a}}i=this.columnEditor.collectionOverride(i,r)}this.finalCollection=i;let o=hr("editor",i,this.columnDef,this.grid,this.isMultipleSelect,this._translaterService);this.createDomElement(o.selectElement,o.dataCollection)}createDomElement(e,t){let i=this.args.container;e&&i&&typeof i.appendChild=="function"&&(j(i),i.appendChild(e));let o=this.columnEditor?.placeholder??"";this.defaultOptions.placeholder=o||"",this.editorElmOptions={...this.defaultOptions,...this.editorOptions,data:t},this._msInstance=fi(e,this.editorElmOptions),this.editorElm=this._msInstance.getParentElement(),this.columnEditor.onInstantiated?.(this._msInstance)}handleChangeOnCompositeEditor(e,t="user",i=!1){let o=this.grid.getActiveCell(),r=this.args.column,n=this.dataContext,a=this.grid,l=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,l),this.applyValue(e.formValues,l);let d=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(i||this.disabled&&d&&e.formValues.hasOwnProperty(this.columnId))&&delete e.formValues[this.columnId],a.onCompositeEditorChange.notify({...o,item:n,grid:a,column:r,formValues:e.formValues,editors:e.editors,triggeredBy:t},new U)}};var mn=class extends bo{constructor(e){super(e,!0),this.args=e}};var pn=class extends bo{constructor(e){super(e,!1),this.args=e}};var gn=class{constructor(e){this.args=e,this._defaultValue=0,this._isValueTouched=!1,this._sliderNumberElm=null,this.disabled=!1,this.grid=e.grid,this.gridOptions=this.grid.getOptions()||{},this._bindEventService=new oe,this.init()}get columnDef(){return this.args.column}get columnEditor(){return this.columnDef?.editor??{}}get dataContext(){return this.args.item}get editorDomElement(){return this._editorElm}get editorInputDomElement(){return this._inputElm}get editorOptions(){return{...this.gridOptions.defaultEditorOptions?.slider,...this.columnEditor?.editorOptions,...this.columnEditor?.options}}get hasAutoCommitEdit(){return this.gridOptions.autoCommitEdit??!1}get sliderOptions(){return this._sliderOptions}get validator(){return this.columnEditor.validator??this.columnDef?.validator}init(){if(this._cellContainerElm=this.args?.container,this._cellContainerElm&&this.columnDef){let e=this.args.compositeEditorOptions;this._editorElm=this.buildDomElement(),e||this.focus(),this._cellContainerElm.appendChild(this._editorElm),this._bindEventService.bind(this._sliderTrackElm,["click","mouseup"],this.sliderTrackClicked.bind(this)),this._bindEventService.bind(this._inputElm,["change","mouseup","touchend"],this.handleChangeEvent.bind(this)),this._bindEventService.bind(this._inputElm,["input","change"],this.handleChangeSliderNumber.bind(this))}}cancel(){this._inputElm&&(this._inputElm.value=`${this._originalValue}`),this.args.cancelChanges()}destroy(){this._bindEventService.unbindAll(),this._inputElm?.remove(),this._editorElm?.remove(),this._sliderTrackElm?.remove()}disable(e=!0){let t=this.disabled;if(this.disabled=e,this._inputElm)if(e){this._inputElm.disabled=!0;let i=this.getValue();t!==e&&this.args?.compositeEditorOptions&&i!==""&&this.reset(0,!0,!0)}else this._inputElm.disabled=!1}focus(){this.grid.focus(),this._inputElm?.focus()}show(){!!this.args?.compositeEditorOptions&&this.applyInputUsabilityState()}getValue(){return this._inputElm?.value??""}setValue(e,t=!1,i=!0){if(this._inputElm&&(this._inputElm.value=`${e}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${e}`),t){this.applyValue(this.args.item,this.serializeValue());let o=this.args.compositeEditorOptions;o&&i&&this.handleChangeOnCompositeEditor(null,o,"system")}}applyValue(e,t){let i=this.columnDef?.field??"";if(i!==void 0){let o=i?.indexOf(".")>0,r=this.validate(void 0,t),n=r&&r.valid?t:"";if(o){let a=this.columnEditor.complexObjectPath??i??"";Ae(e,a,n)}else e&&(e[i]=n)}}changeEditorOption(e,t){if(this.columnEditor)switch(this.columnEditor.options??={},this.columnEditor.editorOptions??={},this.columnEditor.options[e]=this.columnEditor.editorOptions[e]=t,this._sliderOptions[e]=t,e){case"hideSliderNumber":this.renderSliderNumber(this._editorElm,0);break;case"sliderStartValue":this._inputElm.value=`${t}`,this._inputElm.defaultValue=`${t}`;break;case"maxValue":case"minValue":case"step":this._inputElm[e.replace("Value","")]=`${t}`;break}}isValueChanged(){let e=this._inputElm?.value??"";return!(e===""&&this._originalValue===void 0)&&+e!==this._originalValue}isValueTouched(){return this._isValueTouched}loadValue(e){let t=this.columnDef?.field??"";if(e&&t!==void 0){let o=t?.indexOf(".")>0?ge(e,t):e.hasOwnProperty(t)?e[t]:this._defaultValue;(o===""||o===null||o===void 0)&&(o=this._defaultValue),this._originalValue=+o,this._inputElm&&(this._inputElm.value=`${o}`,this._inputElm.title=`${o}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${o}`)}this.updateTrackFilledColorWhenEnabled()}reset(e,t=!0,i=!1){let o=e??this._originalValue??0;this._inputElm&&(this._inputElm.value=`${o}`),this._sliderNumberElm&&(this._sliderNumberElm.textContent=`${o}`),this._isValueTouched=!1;let r=this.args.compositeEditorOptions;if(r&&t){let n=!i;this.handleChangeOnCompositeEditor(null,r,"user",n)}}save(){let e=this.validate(),t=e&&e.valid||!1;this.hasAutoCommitEdit&&t?this.grid.getEditorLock().commitCurrentEdit():this.args.commitChanges()}serializeValue(){let e=this._inputElm?.value??"";return e!==""?parseInt(e,10):this._originalValue}validate(e,t){if(this.args.compositeEditorOptions&&this.applyInputUsabilityState(),this.disabled)return{valid:!0,msg:""};let i=t!==void 0?t:this._inputElm?.value;return Nc(i,{editorArgs:this.args,errorMessage:this.columnEditor.errorMessage,minValue:this.columnEditor.minValue,maxValue:this.columnEditor.maxValue,required:this.args?.compositeEditorOptions?!1:this.columnEditor.required,validator:this.validator})}buildDomElement(){let e=this.columnDef?.id??"",t=this.columnEditor.title??"",i=+(this.columnEditor.minValue??x.SLIDER_DEFAULT_MIN_VALUE),o=+(this.columnEditor.maxValue??x.SLIDER_DEFAULT_MAX_VALUE),r=+(this.columnEditor.valueStep??x.SLIDER_DEFAULT_STEP),n=this.editorOptions.sliderStartValue??i;this._defaultValue=+n,this._sliderTrackElm=p("div",{className:"slider-track"}),this._inputElm=p("input",{type:"range",title:t,defaultValue:`${n}`,value:`${n}`,min:`${i}`,max:`${o}`,step:`${this.columnEditor.valueStep??x.SLIDER_DEFAULT_STEP}`,ariaLabel:this.columnEditor.ariaLabel??`${Xe(e+"")} Slider Editor`,className:`slider-editor-input editor-${e}`});let a=p("div",{className:"slider-container slider-editor"}),l=p("div",{className:"slider-input-container slider-editor"});return l.appendChild(this._sliderTrackElm),l.appendChild(this._inputElm),a.appendChild(l),this.renderSliderNumber(a,n),this._sliderOptions={minValue:i,maxValue:o,step:r},a}renderSliderNumber(e,t){if(this.editorOptions.hideSliderNumber)e.querySelector(".slider-value")?.remove();else{e.classList.add("input-group");let i=p("div",{className:"input-group-addon input-group-append slider-value"});this._sliderNumberElm=p("span",{className:"input-group-text",textContent:`${t}`}),i.appendChild(this._sliderNumberElm),e.appendChild(i)}}applyInputUsabilityState(){let e=this.grid.getActiveCell(),t=this.grid.onBeforeEditCell.notify({...e,item:this.dataContext,column:this.args.column,grid:this.grid,target:"composite",compositeEditorOptions:this.args.compositeEditorOptions}).getReturnValue();this.disable(t===!1)}handleChangeEvent(e){this._isValueTouched=!0;let t=this.args.compositeEditorOptions;t?this.handleChangeOnCompositeEditor(e,t):this.save()}handleChangeSliderNumber(e){let t=e.target?.value??"";t!==""&&(!this.editorOptions.hideSliderNumber&&this._sliderNumberElm&&(this._sliderNumberElm.textContent=t),this._inputElm.title=t,this.args?.compositeEditorOptions||this.grid.onMouseEnter.notify({column:this.columnDef,grid:this.grid},new U(e))),this.updateTrackFilledColorWhenEnabled()}handleChangeOnCompositeEditor(e,t,i="user",o=!1){let r=this.grid.getActiveCell(),n=this.args.column,a=this.columnDef?.id??"",l=this.dataContext,d=this.grid,c=this.serializeValue();this.validate().valid&&this.applyValue(this.dataContext,c),this.applyValue(t.formValues,c);let h=this.gridOptions?.compositeEditorOptions?.excludeDisabledFieldFormValues??!1;(o||this.disabled&&h&&t.formValues.hasOwnProperty(a))&&delete t.formValues[a],d.onCompositeEditorChange.notify({...r,item:l,grid:d,column:n,formValues:t.formValues,editors:t.editors,triggeredBy:i},new U(e))}sliderTrackClicked(e){e.preventDefault();let t=e.offsetX,i=this._sliderTrackElm.offsetWidth,o=(t+0)*100/i;this._inputElm&&(this._inputElm.value=`${o}`,this._inputElm.dispatchEvent(new Event("change")))}updateTrackFilledColorWhenEnabled(){if(this.editorOptions.enableSliderTrackColoring&&this._inputElm){let t=(+this.getValue()-+this._inputElm.min)/(this.sliderOptions?.maxValue??0-+this._inputElm.min)*100,i="linear-gradient(to right, %b %p1, %c %p1, %c %p2, %b %p2)".replace(/%b/g,"#eee").replace(/%c/g,this.editorOptions?.sliderTrackFilledColor??"var(--slick-slider-filter-thumb-color, #86bff8)").replace(/%p1/g,"0%").replace(/%p2/g,`${t}%`);this._sliderTrackElm.style.background=i,this._sliderOptions.sliderTrackBackground=i}}};var zc={autocompleter:on,checkbox:sn,date:rn,dualInput:ln,float:dn,integer:hn,longText:un,multipleSelect:mn,password:cn,singleSelect:pn,slider:gn,text:Nt};var Bc=(s,e,t,i,o)=>{let r=i?.params??{},n=r.propertyNames,a=r.includeTitle??!0,l=r.dataContextProperty;if(l||(l=i?.field?.split(".")[0]||""),!n||!Array.isArray(n)||!l)throw new Error(`Formatters.arrayObjectToCsv requires you to pass an array of "propertyNames" (declared in "params") that you want to pull the data from.
      For example, if we have an array of user objects that have the property of firstName & lastName then we need to pass in your column definition:: { params: { propertyNames: ['firtName'] }}.
      Optionally, you can also pass the "dataContextProperty" if you wish to run this on another completely different field of the dataContext object.`);if(Array.isArray(o[l])&&o[l].length>0){let d=[];o[l].forEach(u=>{let m=[];n.forEach(g=>{m.push(u[g])}),d.push(m.join(" "))});let c=d.join(", "),h=p("span",{textContent:c});return a&&(h.title=c),h}return t};var Fi=(s,e,t)=>{if(Array.isArray(t)&&t.length>0){let i=t.join(", ");return p("span",{title:i,textContent:i})}return t};var $c=(s,e,t)=>{let i=!1,o=Z(t);return o&&(t=+t),(t===!0||o&&+t>0||typeof t=="string"&&t.length>0&&t.toLowerCase()!=="false"&&t!=="0")&&(i=!0),i?p("i",{className:"mdi font-18px mdi-check checkmark-icon",ariaHidden:"true"}):""};var Wc=(s,e,t,i,o,r)=>{if(!t||!i?.editor?.collection?.length)return t;let{editor:n,editor:{collection:a}}=i,l=n.customStructure?.label??"label",d=n.customStructure?.value??"value";return Array.isArray(t)?a.every(c=>typeof c=="string")?Fi(s,e,t.map(c=>mt(a,h=>h===c)),i,o,r):Fi(s,e,t.map(c=>mt(a,h=>h[d]===c)[l]),i,o,r):mt(a,c=>c[d]===t)[l]||""};var Gc=(s,e,t,i,o,r)=>{if(!t||!i?.params?.collection?.length)return t;let{params:n,params:{collection:a}}=i,l=n.customStructure?.label??"label",d=n.customStructure?.value??"value";return Array.isArray(t)?Fi(s,e,t.map(c=>mt(a,h=>h[d]===c)[l]),i,o,r):mt(a,c=>c[d]===t)[l]||""};var il=(s,e,t,i,o)=>{let r=i.params||{},n=r.complexField??r.complexFieldLabel??i.field;if(!n)throw new Error(`For the Formatters.complexObject to work properly, you need to tell it which property of the complex object to use.
      There are 3 ways to provide it:
      1- via the generic "params" with a "complexField" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', params: { complexField: 'user.firstName' } }]
      2- via the generic "params" with a "complexField" and a "labelKey" property on your Column Definition, example: this.columnDefs = [{ id: 'user', field: 'user', labelKey: 'firstName', params: { complexField: 'user' } }]
      3- via the field name that includes a dot notation, example: this.columnDefs = [{ id: 'user', field: 'user.firstName'}] `);if(i.labelKey&&o.hasOwnProperty(n))return o[n]?.[i.labelKey];if(typeof n=="string"&&n.indexOf(".")>0){let a=n.split(".").reduce((l,d)=>l?.hasOwnProperty(d)?l[d]:"",o);return(a==null||typeof a=="object"&&Object.entries(a).length===0&&!(a instanceof Date))&&(a=""),a}return t};var Uc=(s,e,t,i,o,r)=>{let{minDecimal:n,maxDecimal:a,numberPrefix:l,numberSuffix:d,decimalSeparator:c,thousandSeparator:h,wrapNegativeNumber:u}=Pe(i,r,"decimal","cell");return Z(t)?Ve(t,n,a,u,l,d,c,h):t};var fn=(s,e,t,i,o,r)=>{if(Z(t)){let{minDecimal:n,maxDecimal:a,decimalSeparator:l,thousandSeparator:d,wrapNegativeNumber:c}=Pe(i,r,"currency","cell");return Ve(t,n,a,c,"$","",l,d)}return t};var vn=(s,e,t,i,o,r)=>{if(Z(t)){let n=fn(s,e,t,i,o,r);return p("span",{ariaHidden:"true",style:{color:t>=0?"green":"red"},textContent:n})}return t};var jc=(s,e,t,i,o,r)=>{let n=vn(s,e,t,i,o,r);return n instanceof HTMLElement&&(n.style.fontWeight="bold"),n};var Yc=(s,e,t,i,o,r)=>{let{currencyPrefix:n,currencySuffix:a,minDecimal:l,maxDecimal:d,numberPrefix:c,numberSuffix:h,decimalSeparator:u,thousandSeparator:m,wrapNegativeNumber:g}=Pe(i,r,"decimal","cell");if(Z(t)){let f=Ve(t,l,d,g,n,a,u,m);return`${c}${f}${h}`}return t};var qc=(s,e,t,i,o,r)=>{let n=r.getOptions()??{},a=i?.params??{},l=Ai(a.hyperlinkText||t,n.sanitizer),c=Ai(a.hyperlinkUrl||t,n.sanitizer).match(/^(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-.,@?^=%&amp;:/~+#]*[\w\-@?^=%&amp;/~+#])?/i);return Array.isArray(c)&&c.length>0?p("a",{href:c[0],textContent:l}):t};var Kc=(s,e,t,i)=>{let r=(i?.params||{}).cssClass;if(!r)throw new Error('[Slickgrid-Universal] When using `Formatters.iconBoolean`, you must provide You must provide the "cssClass", e.g.: { formatter: Formatters.iconBoolean, params: { cssClass: "mdi mdi-check" }}');let n=!1,a=!isNaN(t);return(t===!0||a&&parseFloat(t)>0||!a&&typeof t=="string"&&t.toLowerCase()!=="false"&&t!=="0")&&(n=!0),n?p("i",{className:r,ariaHidden:"true"}):""};var Xc=(s,e,t,i)=>{let o=i?.params??{},r=o.iconCssClass||o.icon||o.formatterIcon;if(!r)throw new Error('[Slickgrid-Universal] When using `Formatters.icon`, you must provide the "iconCssClass" via the generic "params". (e.g.: `{ formatter: Formatters.icon, params: { iconCssClass: "mdi mdi-magnify" }}`');let n=o.title||null;return p("i",{className:r,ariaHidden:"true",title:n})};var Zc=(s,e,t,i,o,r)=>{let n=Nn(t);if(n){let a=St(r.getOptions());return a.textContent=n,{html:a}}return n};var Qc=(s,e,t,i,o,r)=>{let a=(i.params||{}).mask;if(!a)throw new Error(`You must provide a "mask" via the generic "params" options (e.g.: { formatter: Formatters.mask, params: { mask: '000-000' }}`);if(t){let l=0,d=t.toString(),c=St(r.getOptions());return c.textContent=a.replace(/[09A]/gi,()=>d[l++]||""),c}return t};var Jc=(s,e,t,i,o,r)=>{let{minDecimal:n,maxDecimal:a,decimalSeparator:l,thousandSeparator:d,wrapNegativeNumber:c}=Pe(i,r,"percent","cell");if(Z(t)){let h=t*100;return Ve(h,n,a,c,"","%",l,d)}return t};var eh=(s,e,t)=>{if(!Z(t))return"";let i="",o=parseFloat(t);return o>100&&(o=100),i=o<30?"red":o<70?"silver":"green",p("span",{className:"percent-complete-bar",title:`${o}%`,style:{background:i,width:`${o}%`}})};var th=(s,e,t)=>{if(!Z(t))return"";let i="",o=parseFloat(t);return o>100&&(o=100),i=o<30?"red":o<70?"silver":"green",p("div",{className:"percent-complete-bar-with-text",title:`${o}%`,textContent:`${o}%`,style:{background:i,width:`${o}%`}})};var ih=(s,e,t,i,o,r)=>{let{minDecimal:n,maxDecimal:a,decimalSeparator:l,thousandSeparator:d,wrapNegativeNumber:c}=Pe(i,r,"percent","cell");if(Z(t)){let h=t<50?"red":"green";return p("span",{style:{color:h},textContent:t>100?"100%":Ve(t,n,a,c,"","%",l,d)})}return t};var oh=(s,e,t,i,o,r)=>{let{minDecimal:n,maxDecimal:a,decimalSeparator:l,thousandSeparator:d,wrapNegativeNumber:c}=Pe(i,r,"percent","cell");return Z(t)?Ve(t,n,a,c,"","%",l,d):t};var sh=(s,e,t)=>{if(!Z(t))return"";let i=parseFloat(t);i>100&&(i=100);let o=i<30?"danger":i<70?"warning":"success",r=p("div",{className:"progress"});return r.appendChild(p("div",{className:`progress-bar progress-bar-${o} bg-${o}`,role:"progressbar",ariaValueNow:String(i),ariaValueMin:"0",ariaValueMax:"100",textContent:`${i}%`,style:{minWidth:"2em",width:`${i}%`}})),r};var rh=(s,e,t,i,o,r)=>{let a=(r?.getOptions()??{}).translater||i?.params?.translater;if(!a||typeof a.translate!="function")throw new Error(`"Formatters.translate" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).
    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }`);return t!=null&&typeof t!="string"&&(t=t+""),t?a.translate(t):""};var nh=(s,e,t,i,o,r)=>{let n=r.getOptions(),a=n?.treeDataOptions,l=a?.collapsedPropName??x.treeDataProperties.COLLAPSED_PROP,d=a?.hasChildrenPropName??x.treeDataProperties.HAS_CHILDREN_PROP,c=a?.levelPropName??x.treeDataProperties.TREE_LEVEL_PROP,h=a?.exportIndentMarginLeft??5,u=a?.exportIndentationLeadingChar??".",m=a?.exportIndentationLeadingSpaceCount??3,g=n?.excelExportOptions?.groupCollapsedSymbol??"\u2B9E",f=n?.excelExportOptions?.groupExpandedSymbol??"\u2B9F",b=t;if(b=$t(i,o,t),b==null||o===void 0)return"";if(!o.hasOwnProperty(c))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');let v=o[c]??0,k="",C=0;o[d]?(k=o[l]?g:f,C=v===0?0:h*v):C=h*(v===0?0:v+1);let E=cs(C);return a?.titleFormatter&&(b=Pi(a.titleFormatter,s,e,i,o,r)),b=`${v===0&&k?"":v===0?`${u}${cs(m)}`:u}${E}${k} ${b}`,Ze(b)};var ah=(s,e,t,i,o,r)=>{let n=r.getOptions(),a=n.treeDataOptions??{},l=a.indentMarginLeft??15,d=a.collapsedPropName??x.treeDataProperties.COLLAPSED_PROP,c=a.hasChildrenPropName??x.treeDataProperties.HAS_CHILDREN_PROP,h=a.levelPropName??x.treeDataProperties.TREE_LEVEL_PROP,u=a.lazyLoadingPropName??x.treeDataProperties.LAZY_LOADING_PROP,m=$t(i,o,t);if(m==null||o===void 0)return"";if(!o.hasOwnProperty(h))throw new Error('[Slickgrid-Universal] You must provide valid "treeDataOptions" in your Grid Options, however it seems that we could not find any tree level info on the current item datacontext row.');let g=o[u],f=o[h]??0,b=`slick-tree-level-${f}`,v="";o[c]&&(v=g&&g!=="done"?g:o[d]?"collapsed":"expanded");let k=p("span",{style:{display:"inline-block",width:`${l*f}px`}}),C=`slick-group-toggle ${v}`.trim(),E=p("div",{className:C,ariaExpanded:String(v==="expanded")}),y=St(n);y.appendChild(k),y.appendChild(E),g==="load-fail"&&y.appendChild(p("span",{className:"slick-tree-load-fail"})),a.titleFormatter&&(m=Pi(a.titleFormatter,s,e,i,o,r));let S=p("span",{className:"slick-tree-title"});return Se(S,m,n),S.setAttribute("level",f),y.appendChild(S),{addClasses:b,html:y}};var lh=(s,e,t,i,o,r)=>{let a=r.getOptions().treeDataOptions?.hasChildrenPropName??x.treeDataProperties.HAS_CHILDREN_PROP,{groupTotalsFormatter:l,treeTotalsFormatter:d,params:c}=i;if(!l&&!d)throw new Error('[Slickgrid-Universal] When using Formatters.treeParseTotals, you must provide a total formatter via "groupTotalsFormatter" or "treeTotalsFormatter".');if(o[a]&&o?.__treeTotals&&(l||d))return(d??l)(o?.__treeTotals,i,r);if(c.formatters){let h=t;for(let u of c.formatters)!o[a]&&!o?.__treeTotals&&typeof u=="function"&&(h=u(s,e,h,i,o,r)||t);return h}return t};var dh=(s,e,t,i,o,r)=>{let a=(r?.getOptions()??{}).translater||i?.params?.translater;if(!a||typeof a.translate!="function")throw new Error(`"Formatters.translateBoolean" requires the Translate Service to be provided as a Grid Options "translater" (or "i18n" depending on which framework you use).
    For example: this.gridOptions = { enableTranslate: true, translater: this.translateService }`);return t!=null&&typeof t!="string"&&(t=t+""),t?a.translate(t.toUpperCase()):""};var Op={arrayObjectToCsv:Bc,arrayToCsv:Fi,checkmarkMaterial:$c,complex:il,complexObject:il,collection:Gc,collectionEditor:Wc,currency:Yc,date:mc(),decimal:Uc,dollar:fn,dollarColored:vn,dollarColoredBold:jc,hyperlink:qc,icon:Xc,htmlDecode:Zc,iconBoolean:Kc,mask:Qc,multiple:lo,percent:Jc,percentComplete:ih,percentCompleteBar:eh,percentCompleteBarWithText:th,percentSymbol:oh,progressBar:sh,translate:rh,translateBoolean:dh,tree:ah,treeParseTotals:lh,treeExport:nh};$i().forEach(s=>{let e=_[s];e&&e!==_.date&&(Op[s]=uc(e,s))});var es=class{constructor(){this.options=Fc}};var JA={...An,...Ln,...Mn,...Zn,...$n,deepAssign:Gt};var wo=ye(ht(),1);var bn=class{get eventHandler(){return this._eventHandler}get gridUid(){return this.grid?.getUID()??""}get gridUidSelector(){return this.gridUid?`.${this.gridUid}`:""}get gridOptions(){return this.grid?.getOptions()??{}}get locales(){return this.gridOptions?.locales??x.locales}set metrics(e){this.renderMetrics(e)}get leftFooterText(){return document.querySelector(`.slick-custom-footer${this.gridUidSelector} .left-footer`)?.textContent??""}set leftFooterText(e){this.renderLeftFooterText(e)}get rightFooterText(){return document.querySelector(`.slick-custom-footer${this.gridUidSelector} .right-footer`)?.textContent??""}set rightFooterText(e){this.renderRightFooterText(e)}constructor(e,t,i,o){if(this.grid=e,this.customFooterOptions=t,this.pubSubService=i,this.translaterService=o,this._enableTranslate=!1,this._isLeftFooterOriginallyEmpty=!0,this._isLeftFooterDisplayingSelectionRowCount=!1,this._isRightFooterOriginallyEmpty=!0,this._selectedRowCount=0,this._subscriptions=[],this._bindingHelper=new ji,this._bindingHelper.querySelectorPrefix=`.${this.gridUid} `,this._eventHandler=new G,this._enableTranslate=this.gridOptions?.enableTranslate??!1,this._isLeftFooterOriginallyEmpty=!this.gridOptions.customFooterOptions?.leftFooterText,this._isRightFooterOriginallyEmpty=!this.gridOptions.customFooterOptions?.rightFooterText,this.registerOnSelectedRowsChangedWhenEnabled(t),this._enableTranslate&&(!this.translaterService||!this.translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translateCustomFooterTexts(),this._enableTranslate&&this.pubSubService?.subscribe){let r=this.translaterService?.eventName??"onLanguageChange";this._subscriptions.push(this.pubSubService.subscribe(r,()=>this.translateCustomFooterTexts()))}}dispose(){this._eventHandler.unsubscribeAll(),this.pubSubService.unsubscribeAll(this._subscriptions),this._bindingHelper.dispose(),this._footerElement?.remove()}renderFooter(e){this.translateCustomFooterTexts(),this.createFooterContainer(e)}renderMetrics(e){let t=e?.endTime?Fe(e.endTime,this.customFooterOptions.dateFormat,"en-US"):"";this._bindingHelper.setElementAttributeValue("span.last-update-timestamp","textContent",t),this._bindingHelper.setElementAttributeValue("span.item-count","textContent",e.itemCount),this._bindingHelper.setElementAttributeValue("span.total-count","textContent",e.totalItemCount),this.customFooterOptions.metricTexts?.lastUpdate&&this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"lastUpdate","span.text-last-update","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"items","span.text-items","textContent"),this._bindingHelper.addElementBinding(this.customFooterOptions.metricTexts,"of","span.text-of","textContent")}renderLeftFooterText(e){this._bindingHelper.setElementAttributeValue("div.left-footer","textContent",e)}renderRightFooterText(e){this._bindingHelper.setElementAttributeValue("div.right-footer","textContent",e)}translateCustomFooterTexts(){if(this.gridOptions.enableTranslate&&this.translaterService?.translate){this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{};for(let e of Object.keys(this.customFooterOptions.metricTexts))if(e.lastIndexOf("Key")>0){let t=e.substring(0,e.lastIndexOf("Key"));this.customFooterOptions.metricTexts[t]=this.translaterService.translate(this.customFooterOptions.metricTexts[e]||" ")}this._isLeftFooterDisplayingSelectionRowCount&&(this.leftFooterText=`${this._selectedRowCount} ${this.customFooterOptions.metricTexts.itemsSelected}`)}else this.locales&&(this.customFooterOptions.metricTexts=this.customFooterOptions.metricTexts||{},this.customFooterOptions.metricTexts.lastUpdate||=this.localeOrDefault("TEXT_LAST_UPDATE"),this.customFooterOptions.metricTexts.items||=this.localeOrDefault("TEXT_ITEMS"),this.customFooterOptions.metricTexts.itemsSelected||=this.localeOrDefault("TEXT_ITEMS_SELECTED"),this.customFooterOptions.metricTexts.of||=this.localeOrDefault("TEXT_OF"))}localeOrDefault(e){return this.locales[e]||e}createFooterContainer(e){let t=p("div",{className:`slick-custom-footer ${this.gridUid}`,style:{width:"100%",height:`${this.customFooterOptions.footerHeight||20}px`}}),i=p("div",{className:`left-footer ${this.customFooterOptions.leftContainerClass}`});Se(i,this.customFooterOptions.leftFooterText,this.gridOptions),t.appendChild(i),t.appendChild(this.createFooterRightContainer()),this._footerElement=t,e?.appendChild&&this._footerElement&&e.appendChild(this._footerElement)}createFooterRightContainer(){let e=p("div",{className:`right-footer ${this.customFooterOptions.rightContainerClass||""}`});if(!this._isRightFooterOriginallyEmpty)Se(e,this.customFooterOptions.rightFooterText,this.gridOptions);else if(!this.customFooterOptions.hideMetrics){e.classList.add("metrics");let t=p("span",{className:"timestamp"},e);if(!this.customFooterOptions.hideLastUpdateTimestamp){let i=this.createFooterLastUpdate();i&&t.appendChild(i)}e.appendChild(p("span",{className:"item-count",textContent:`${this.metrics?.itemCount??"0"}`})),this.customFooterOptions.hideTotalItemCount||(e.appendChild(document.createTextNode(`\r
`)),e.appendChild(p("span",{className:"text-of",textContent:` ${this.customFooterOptions.metricTexts?.of??"of"} `})),e.appendChild(document.createTextNode(`\r
`)),e.appendChild(p("span",{className:"total-count",textContent:`${this.metrics?.totalItemCount??"0"}`}))),e.appendChild(document.createTextNode(`\r
`)),e.appendChild(p("span",{className:"text-items",textContent:` ${this.customFooterOptions.metricTexts?.items??"items"} `}))}return e}createFooterLastUpdate(){let e=this.customFooterOptions?.metricTexts?.lastUpdate??"Last Update",t=this.metrics?.endTime?Fe(this.metrics?.endTime,this.customFooterOptions.dateFormat,"en-US"):"",i=p("span");return i.appendChild(p("span",{className:"text-last-update",textContent:e})),i.appendChild(document.createTextNode(`\r
`)),i.appendChild(p("span",{className:"last-update-timestamp",textContent:t})),i.appendChild(p("span",{className:"separator",textContent:` ${this.customFooterOptions.metricSeparator||""} `})),i}registerOnSelectedRowsChangedWhenEnabled(e){if((this.gridOptions.enableCheckboxSelector||this.gridOptions.enableRowSelection)&&e&&!e.hideRowSelectionCount&&this._isLeftFooterOriginallyEmpty){this._isLeftFooterDisplayingSelectionRowCount=!0;let i=e.metricTexts?.itemsSelected??this.localeOrDefault("TEXT_ITEMS_SELECTED");e.leftFooterText=`0 ${i}`,this._eventHandler.subscribe(this.grid.onSelectedRowsChanged,(o,r)=>{this._selectedRowCount=r.rows.length;let n=e.metricTexts?.itemsSelected??this.localeOrDefault("TEXT_ITEMS_SELECTED");this.leftFooterText=`${this._selectedRowCount} ${n}`})}}};var wn=class{constructor(){this._isPreviouslyShown=!1,this._warningLeftElement=null,this._warningRightElement=null}get gridOptions(){return this._grid?.getOptions()??{}}init(e,t){this._grid=e,this._translaterService=t.get("TranslaterService")}dispose(){this._warningLeftElement?.remove(),this._warningRightElement?.remove(),this._warningLeftElement=null,this._warningRightElement=null}showEmptyDataMessage(e=!0,t){if(!this._grid||!this.gridOptions||this._isPreviouslyShown===e)return!1;this._isPreviouslyShown=e;let i=this._grid.getUID(),r={message:"No data to display.",...this.gridOptions.emptyDataWarning,...t},n=r?.className??"slick-empty-data-warning";this._warningLeftElement=document.querySelector(`.${i} .${n}`);let a=document.querySelector(`.${i} .grid-canvas.grid-canvas-left`),l=document.querySelector(`.${i} .grid-canvas.grid-canvas-right`),d=r.leftViewportMarginLeft??0,c=r.rightViewportMarginLeft??0,h=r.frozenLeftViewportMarginLeft??0,u=r.frozenRightViewportMarginLeft??0,m=this.gridOptions?.frozenColumn!==void 0&&this.gridOptions.frozenColumn>=0,g=typeof d=="string"?d:`${d}px`,f=typeof c=="string"?c:`${c}px`;if(this.gridOptions.autoHeight){let v=document.querySelector(`.${i} .slick-pane.slick-pane-top.slick-pane-left`);if(v&&v.style&&a&&a.style){let k=parseInt(v.style.height,10)||0,C=this.gridOptions?.rowHeight??0,E=this.gridOptions.enableFiltering?this.gridOptions?.headerRowHeight??0:0,y=this.gridOptions.createPreHeaderPanel?this.gridOptions?.preHeaderPanelHeight??0:0;if(e){let S=k!==null&&k<100?k:100;S+=E+y,v.style.minHeight=`${S}px`,a.style.minHeight=`${C}px`}}}let b=r.message;if(this.gridOptions.enableTranslate&&this._translaterService&&r?.messageKey&&(b=this._translaterService.translate(r.messageKey)),!this._warningLeftElement&&a&&l&&(this._warningLeftElement=document.createElement("div"),this._warningLeftElement.classList.add(...ae(n),"left"),Se(this._warningLeftElement,b,this.gridOptions),this._warningRightElement=this._warningLeftElement.cloneNode(!0),this._warningRightElement.classList.add("right"),l.appendChild(this._warningRightElement),a.appendChild(this._warningLeftElement)),this._warningLeftElement){let v=e?"flex":"none";m&&e&&(v=r.hideFrozenLeftWarning?"none":"flex"),this._warningLeftElement.style.display=v;let k=typeof h=="string"?h:`${h}px`;this._warningLeftElement.style.marginLeft=m?k:g}if(this._warningRightElement){let v=e?"flex":"none";m&&e&&(v=r.hideFrozenRightWarning?"none":"flex"),this._warningRightElement.style.display=v;let k=typeof u=="string"?u:`${u}px`;this._warningRightElement.style.marginLeft=m?k:f}return e}};var kn=class{constructor(){this._enableTranslate=!1,this._subscriptions=[],this.currentPagination={},this.firstButtonClasses="",this.lastButtonClasses="",this.prevButtonClasses="",this.nextButtonClasses="",this.textItemsPerPage="items per page",this.textItems="items",this.textOf="of",this.textPage="Page",this._bindingHelper=new ji,this._bindingEventService=new oe}get availablePageSizes(){return this._paginationService.availablePageSizes||[]}get dataFrom(){return this._paginationService.dataFrom}get dataTo(){return this._paginationService.dataTo}get itemsPerPage(){return this._paginationService.itemsPerPage}set itemsPerPage(e){this._paginationService.changeItemPerPage(e)}get pageCount(){return this._paginationService.pageCount}get pageNumber(){return this._paginationService.pageNumber}get gridOptions(){return this._grid?.getOptions()??{}}get gridUid(){return this._grid?.getUID()||""}get locales(){return this.gridOptions?.locales??x.locales}get totalItems(){return this._paginationService.totalItems}get isLeftPaginationDisabled(){return this.pageNumber===1||this.totalItems===0}get isRightPaginationDisabled(){return this.pageNumber===this.pageCount||this.totalItems===0}init(e,t,i,o){if(this._grid=e,this._pubSubService=i,this._translaterService=o,this._paginationService=t,this.currentPagination=t.getFullPagination(),this._bindingHelper.querySelectorPrefix=this.gridUid?`.${this.gridUid} `:"",this._enableTranslate=this.gridOptions?.enableTranslate??!1,this._enableTranslate&&(!this._translaterService||!this._translaterService.translate))throw new Error('[Slickgrid-Universal] requires a Translate Service to be installed and configured when the grid option "enableTranslate" is enabled.');if(this.translatePaginationTexts(),this._enableTranslate&&this._pubSubService?.subscribe){let r=this._translaterService?.eventName??"onLanguageChange";this._subscriptions.push(this._pubSubService.subscribe(r,()=>this.translatePaginationTexts()))}this._subscriptions.push(this._pubSubService.subscribe("onPaginationRefreshed",r=>{Object.keys(r).forEach(n=>this.currentPagination[n]=r[n]),this.updatePageButtonsUsability(),this._spanInfoFromToElm?.style&&(this._spanInfoFromToElm.style.display=this.currentPagination.totalItems===0?"none":"")}),this._pubSubService.subscribe("onPaginationSetCursorBased",()=>{this.disposeDom(),this.renderPagination(this._gridContainerElm)}))}dispose(){this._pubSubService.unsubscribeAll(this._subscriptions),this.disposeDom()}disposeDom(){this._bindingEventService.unbindAll(),this._bindingHelper.dispose(),this._paginationElement.remove()}renderPagination(e){this._gridContainerElm=e;let t=this.createPaginationContainer(),i=p("div",{className:"slick-pagination-nav"}),o=p("nav",{ariaLabel:"Page navigation"}),r=p("ul",{className:"pagination"},o);this._seekFirstElm=p("li",{className:"page-item seek-first"},r),this._seekFirstElm.appendChild(p("a",{className:"page-link icon-seek-first",ariaLabel:"First Page",role:"button"})),this._seekPrevElm=p("li",{className:"page-item seek-prev"},r),this._seekPrevElm.appendChild(p("a",{className:"page-link icon-seek-prev",ariaLabel:"Previous Page",role:"button"}));let n=this.createPageNumberSection(),a=p("nav",{ariaLabel:"Page navigation"}),l=p("ul",{className:"pagination"},a);this._seekNextElm=p("li",{className:"page-item seek-next"},l),this._seekNextElm.appendChild(p("a",{className:"page-link icon-seek-next",ariaLabel:"Next Page",role:"button"})),this._seekEndElm=p("li",{className:"page-item seek-end"},l),this._seekEndElm.appendChild(p("a",{className:"page-link icon-seek-end",ariaLabel:"Last Page",role:"button"})),t.appendChild(i),i.appendChild(o),i.appendChild(n),i.appendChild(a);let d=this.createPaginationSettingsSection();t.appendChild(i),t.appendChild(d),this._paginationElement.appendChild(t),e?.appendChild&&this._paginationElement&&e.appendChild(this._paginationElement),this.renderPageSizes(),this.addBindings(),this.addEventListeners(),this.updatePageButtonsUsability()}renderPageSizes(){if(this._itemPerPageElm&&Array.isArray(this.availablePageSizes))for(let e of this.availablePageSizes)p("option",{value:`${e}`,text:`${e}`},this._itemPerPageElm)}addBindings(){this._bindingHelper.addElementBinding(this,"firstButtonClasses","li.page-item.seek-first","className"),this._bindingHelper.addElementBinding(this,"prevButtonClasses","li.page-item.seek-prev","className"),this._bindingHelper.addElementBinding(this,"lastButtonClasses","li.page-item.seek-end","className"),this._bindingHelper.addElementBinding(this,"nextButtonClasses","li.page-item.seek-next","className"),this._bindingHelper.addElementBinding(this.currentPagination,"dataFrom","span.item-from","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"dataTo","span.item-to","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"totalItems","span.total-items","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageCount","span.page-count","textContent"),this._bindingHelper.addElementBinding(this.currentPagination,"pageSize","select.items-per-page","value"),this._paginationService.isCursorBased?this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","span.page-number","textContent"):this._bindingHelper.addElementBinding(this.currentPagination,"pageNumber","input.page-number","value","change",this.changeToCurrentPage.bind(this)),this._bindingHelper.addElementBinding(this,"textItems","span.text-items","textContent"),this._bindingHelper.addElementBinding(this,"textItemsPerPage","span.text-item-per-page","textContent"),this._bindingHelper.addElementBinding(this,"textOf","span.text-of","textContent"),this._bindingHelper.addElementBinding(this,"textPage","span.text-page","textContent")}addEventListeners(){this._bindingEventService.bind(this._seekFirstElm,"click",this.changeToFirstPage.bind(this)),this._bindingEventService.bind(this._seekEndElm,"click",this.changeToLastPage.bind(this)),this._bindingEventService.bind(this._seekNextElm,"click",this.changeToNextPage.bind(this)),this._bindingEventService.bind(this._seekPrevElm,"click",this.changeToPreviousPage.bind(this)),this._bindingEventService.bind(this._itemPerPageElm,"change",this.updateItemsPerPage.bind(this))}changeToFirstPage(e){this.isLeftPaginationDisabled||this._paginationService.goToFirstPage(e)}changeToLastPage(e){this.isRightPaginationDisabled||this._paginationService.goToLastPage(e)}changeToNextPage(e){this.isRightPaginationDisabled||this._paginationService.goToNextPage(e)}changeToPreviousPage(e){this.isLeftPaginationDisabled||this._paginationService.goToPreviousPage(e)}changeToCurrentPage(e){this._paginationService.goToPageNumber(+e)}updateItemsPerPage(e){this.itemsPerPage=+(e?.target?.value??0)}translatePaginationTexts(){let e=t=>this.locales[t]||t;if(this._enableTranslate&&this._translaterService?.translate){let t=$e(this.gridOptions);this.textItemsPerPage=this._translaterService.translate(`${t}ITEMS_PER_PAGE`),this.textItems=this._translaterService.translate(`${t}ITEMS`),this.textOf=this._translaterService.translate(`${t}OF`),this.textPage=this._translaterService.translate(`${t}PAGE`)}else this.locales&&(this.textItemsPerPage=e("TEXT_ITEMS_PER_PAGE"),this.textItems=e("TEXT_ITEMS"),this.textOf=e("TEXT_OF"),this.textPage=e("TEXT_PAGE"))}createPaginationContainer(){let e=p("div",{id:"pager",className:`slick-pagination-container ${this.gridUid} pager`,style:{width:"100%"}}),t=p("div",{className:"slick-pagination"},e);return this._paginationElement=e,t}createPageNumberSection(){let e=p("div",{className:"slick-page-number"});return p("span",{className:"text-page",textContent:"Page"},e),e.appendChild(document.createTextNode(" ")),this._paginationService.isCursorBased?p("span",{className:"page-number",ariaLabel:"Page Number",dataset:{test:"page-number-label"},textContent:"1"},e):p("input",{type:"text",className:"form-control page-number",ariaLabel:"Page Number",value:"1",size:1,dataset:{test:"page-number-input"}},e),e.appendChild(document.createTextNode(" ")),p("span",{className:"text-of",textContent:"of"},e),e.appendChild(document.createTextNode(" ")),p("span",{className:"page-count",dataset:{test:"page-count"}},e),e}createPaginationSettingsSection(){let e=p("span",{className:"slick-pagination-settings"});this._itemPerPageElm=p("select",{id:"items-per-page-label",ariaLabel:"Items per Page",className:"items-per-page"},e),e.appendChild(document.createTextNode(" ")),p("span",{className:"text-item-per-page",textContent:"items per page"},e),e.appendChild(document.createTextNode(", "));let t=p("span",{className:"slick-pagination-count"},e);this._spanInfoFromToElm=p("span",{className:"page-info-from-to"},t),p("span",{className:"item-from",ariaLabel:"Page Item From",dataset:{test:"item-from"}},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode("-")),p("span",{className:"item-to",ariaLabel:"Page Item To",dataset:{test:"item-to"}},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode(" ")),p("span",{className:"text-of",textContent:"of"},this._spanInfoFromToElm),this._spanInfoFromToElm.appendChild(document.createTextNode(" "));let i=p("span",{className:"page-info-total-items"},t);return p("span",{className:"total-items",ariaLabel:"Total Items",dataset:{test:"total-items"}},i),i.appendChild(document.createTextNode(" ")),p("span",{className:"text-items",textContent:"items"},i),i.appendChild(document.createTextNode(" ")),e}updatePageButtonsUsability(){this.firstButtonClasses=`page-item seek-first${this.isLeftPaginationDisabled?" disabled":""}`,this.prevButtonClasses=`page-item seek-prev${this.isLeftPaginationDisabled?" disabled":""}`,this.lastButtonClasses=`page-item seek-end${this.isRightPaginationDisabled?" disabled":""}`,this.nextButtonClasses=`page-item seek-next${this.isRightPaginationDisabled?" disabled":""}`}};var fh=ye(Jt(),1);var hh=ye(Jt(),1),Cn=hh.default.createContext(null),Ap=Cn.Provider;var sl={alwaysShowVerticalScroll:!0,autoEdit:!1,asyncEditorLoading:!1,autoFitColumnsOnFirstLoad:!0,autoResize:{applyResizeToContainer:!0,autoHeight:!0,autoHeightRecalcRow:100,calculateAvailableSizeBy:"window",bottomPadding:20,minHeight:250,minWidth:300,rightPadding:0},cellHighlightCssClass:"slick-cell-modified",checkboxSelector:{cssClass:"slick-cell-checkboxsel",width:40},cellMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideCommandSection:!1,hideOptionSection:!1},columnGroupSeparator:" - ",columnPicker:{hideForceFitButton:!1,hideSyncResizeButton:!0,headerColumnValueExtractor:uh},compositeEditorOptions:{labels:{cancelButtonKey:"CANCEL",cloneButtonKey:"CLONE",resetEditorButtonTooltipKey:"RESET_INPUT_VALUE",resetFormButtonKey:"RESET_FORM",massSelectionButtonKey:"APPLY_TO_SELECTION",massSelectionStatusKey:"X_OF_Y_MASS_SELECTED",massUpdateButtonKey:"APPLY_MASS_UPDATE",massUpdateStatusKey:"ALL_X_RECORDS_SELECTED",saveButtonKey:"SAVE"},resetEditorButtonCssClass:"mdi mdi-refresh font-15px",resetFormButtonIconCssClass:"mdi mdi-refresh font-16px mdi-flip-h"},contextMenu:{autoAdjustDrop:!0,autoAlignSide:!0,hideCloseButton:!0,hideClearAllGrouping:!1,hideCollapseAllGroups:!1,hideCommandSection:!1,hideCopyCellValueCommand:!1,hideExpandAllGroups:!1,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideMenuOnScroll:!0,hideOptionSection:!1,iconCollapseAllGroupsCommand:"mdi mdi-arrow-collapse",iconExpandAllGroupsCommand:"mdi mdi-arrow-expand",iconClearGroupingCommand:"mdi mdi-close",iconCopyCellValueCommand:"mdi mdi-content-copy",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline text-success",iconExportTextDelimitedCommand:"mdi mdi-download"},customFooterOptions:{dateFormat:"YYYY-MM-DD, hh:mm a",hideRowSelectionCount:!1,hideTotalItemCount:!1,hideLastUpdateTimestamp:!0,footerHeight:25,leftContainerClass:"col-xs-12 col-sm-5",rightContainerClass:"col-xs-6 col-sm-7",metricSeparator:"|",metricTexts:{items:"items",itemsKey:"ITEMS",of:"of",ofKey:"OF",itemsSelected:"items selected",itemsSelectedKey:"ITEMS_SELECTED"}},dataView:{syncGridSelection:{preserveHidden:!1,preserveHiddenOnSelectionChange:!0},syncGridSelectionWithBackendService:!1},datasetIdPropertyName:"id",defaultFilter:tn.input,defaultBackendServiceFilterTypingDebounce:500,defaultColumnSortFieldId:"id",defaultFilterPlaceholder:"\u{1F50E}\uFE0E",defaultFilterRangeOperator:"RangeInclusive",editable:!1,editorTypingDebounce:450,filterTypingDebounce:0,enableEmptyDataWarningMessage:!0,enableFilterTrimWhiteSpace:!1,emptyDataWarning:{className:"slick-empty-data-warning",message:"No data to display.",messageKey:"EMPTY_DATA_WARNING_MESSAGE",hideFrozenLeftWarning:!1,hideFrozenRightWarning:!1,leftViewportMarginLeft:"40%",rightViewportMarginLeft:"40%",frozenLeftViewportMarginLeft:"0px",frozenRightViewportMarginLeft:"40%"},enableAutoResize:!0,enableAutoSizeColumns:!0,enableCellNavigation:!1,enableColumnPicker:!0,enableColumnReorder:!0,enableColumnResizeOnDoubleClick:!0,enableContextMenu:!0,enableExcelExport:!1,enableTextExport:!1,enableGridMenu:!0,enableHeaderMenu:!0,enableMouseHoverHighlightRow:!0,enableSorting:!0,enableTextSelectionOnCells:!0,eventNamingStyle:We.camelCase,explicitInitialization:!0,excelExportOptions:{addGroupIndentation:!0,exportWithFormatter:!1,filename:"export",format:"xlsx",groupingColumnHeaderTitle:"Group By",groupCollapsedSymbol:"\u2B9E",groupExpandedSymbol:"\u2B9F",groupingAggregatorRowText:"",sanitizeDataExport:!1},textExportOptions:{delimiter:bt.comma,exportWithFormatter:!1,filename:"export",format:"csv",groupingColumnHeaderTitle:"Group By",groupingAggregatorRowText:"",sanitizeDataExport:!1,useUtf8WithBom:!0},forceFitColumns:!1,frozenHeaderWidthCalcDifferential:1,gridMenu:{commandLabels:{clearAllFiltersCommandKey:"CLEAR_ALL_FILTERS",clearAllSortingCommandKey:"CLEAR_ALL_SORTING",clearFrozenColumnsCommandKey:"CLEAR_PINNING",exportCsvCommandKey:"EXPORT_TO_CSV",exportExcelCommandKey:"EXPORT_TO_EXCEL",exportTextDelimitedCommandKey:"EXPORT_TO_TAB_DELIMITED",refreshDatasetCommandKey:"REFRESH_DATASET",toggleDarkModeCommandKey:"TOGGLE_DARK_MODE",toggleFilterCommandKey:"TOGGLE_FILTER_ROW",togglePreHeaderCommandKey:"TOGGLE_PRE_HEADER_ROW"},hideClearAllFiltersCommand:!1,hideClearAllSortingCommand:!1,hideClearFrozenColumnsCommand:!0,hideExportCsvCommand:!1,hideExportExcelCommand:!1,hideExportTextDelimitedCommand:!0,hideForceFitButton:!1,hideRefreshDatasetCommand:!1,hideSyncResizeButton:!0,hideToggleDarkModeCommand:!0,hideToggleFilterCommand:!1,hideTogglePreHeaderCommand:!1,iconCssClass:"mdi mdi-menu",iconClearAllFiltersCommand:"mdi mdi-filter-remove-outline",iconClearAllSortingCommand:"mdi mdi-sort-variant-off",iconClearFrozenColumnsCommand:"mdi mdi-close",iconExportCsvCommand:"mdi mdi-download",iconExportExcelCommand:"mdi mdi-file-excel-outline",iconExportTextDelimitedCommand:"mdi mdi-download",iconRefreshDatasetCommand:"mdi mdi-sync",iconToggleDarkModeCommand:"mdi mdi-brightness-4 mdi mdi-brightness-4",iconToggleFilterCommand:"mdi mdi-flip-vertical",iconTogglePreHeaderCommand:"mdi mdi-flip-vertical",menuWidth:16,resizeOnShowHeaderRow:!0,headerColumnValueExtractor:uh},headerMenu:{autoAlign:!0,autoAlignOffset:12,minWidth:140,iconClearFilterCommand:"mdi mdi-filter-remove-outline",iconClearSortCommand:"mdi mdi-sort-variant-off",iconFreezeColumns:"mdi mdi-pin-outline",iconUnfreezeColumns:"mdi mdi-pin-off-outline",iconSortAscCommand:"mdi mdi-sort-ascending",iconSortDescCommand:"mdi mdi-sort-descending",iconColumnHideCommand:"mdi mdi-close",iconColumnResizeByContentCommand:"mdi mdi-arrow-expand-horizontal",hideColumnResizeByContentCommand:!1,hideColumnHideCommand:!1,hideClearFilterCommand:!1,hideClearSortCommand:!1,hideFreezeColumnsCommand:!0,hideSortCommands:!1},multiColumnSort:!0,numberedMultiColumnSort:!0,tristateMultiColumnSort:!1,sortColNumberInSeparateSpan:!0,suppressActiveCellChangeOnEdit:!1,pagination:{pageSizes:[10,15,20,25,30,40,50,75,100],pageSize:25,totalItems:0},rowDetailView:{collapseAllOnSort:!0,cssClass:"detail-view-toggle",panelRows:1,keyPrefix:"__",useRowClick:!1,saveDetailViewOnScroll:!1},headerRowHeight:35,rowHeight:35,topPanelHeight:30,preHeaderPanelWidth:"100%",translationNamespaceSeparator:":",resetFilterSearchValueAfterOnBeforeCancellation:!0,resizeByContentOnlyOnFirstLoad:!0,resizeByContentOptions:{alwaysRecalculateColumnWidth:!1,cellPaddingWidthInPx:14,defaultRatioForStringType:.88,formatterPaddingWidthInPx:0,maxItemToInspectCellContentWidth:1e3,maxItemToInspectSingleColumnWidthByContent:5e3,widthToRemoveFromExceededWidthReadjustment:50},rowTopOffsetRenderType:"transform",treeDataOptions:{exportIndentMarginLeft:5,exportIndentationLeadingChar:"\u034F\u034F\u034F\u034F\u034F\u034F\u034F\u034F\u034F\xB7"}};function uh(s,e){let t=s?.columnPickerLabel??s?.name??"";(t instanceof HTMLElement||t instanceof DocumentFragment)&&(t=t.textContent||"");let i=s?.columnGroup||"",o=e?.columnGroupSeparator??" - ";return i?i+o+t:t}function rl(s){if(Array.isArray(s))for(;s.length>0;){let e=s.pop();e?.unsubscribe&&e.unsubscribe()}return s}var _n=class{container={};get(e){return this.container[e]}registerInstance(e,t){this.container[e]=t}};var ZL=new Ei,QL=new go,mh=new _n;var xn=ye(Jt(),1),ph=ye(al(),1);function gh(s,e,t,i){return new Promise(o=>{let r=(0,xn.createRef)();i??=(0,ph.createRoot)(e),i.render(xn.default.createElement(s,{...t,ref:r})),queueMicrotask(()=>o({component:r.current,root:i}))})}var ts=class{i18n;set i18nInstance(e){this.i18n=e}getCurrentLanguage(){return this.i18n?.language||""}async use(e){return this.i18n?.changeLanguage(e)}translate(e){return this.i18n?.t(e)||""}};var Lp=1e4,is=class extends fh.default.Component{props;static contextType=Cn;_mounted=!1;setStateValue(e,t,i){if(this.state?.[e]!==t){if(!this._mounted){this.state=this.state||{},this.state[e]=t;return}this.setState(()=>{let o={};return o[e]=t,o},i)}}_columns=[];_currentDatasetLength=0;_dataset=null;_options={};_elm;_collectionObservers=[];_eventHandler;_eventPubSubService;_hideHeaderRowAfterPageLoad=!1;_i18next;_isAutosizeColsCalled=!1;_isGridInitialized=!1;_isDatasetInitialized=!1;_isDatasetHierarchicalInitialized=!1;_isPaginationInitialized=!1;_isLocalGrid=!0;_paginationOptions;_registeredResources=[];_scrollEndCalled=!1;get options(){return this._options||{}}set options(e){let t;this.grid?.getOptions?t=fe(!0,{},this.grid.getOptions(),e):t=this.mergeGridOptions(e),this.sharedService?.gridOptions&&this.grid?.setOptions&&(this.sharedService.gridOptions=t,this.grid.setOptions(t,!1,!0),this.grid.reRenderColumns(!0)),this._options=t}groupItemMetadataProvider;backendServiceApi;metrics;showPagination=!1;serviceList=[];subscriptions=[];slickEmptyWarning;slickFooter;slickPagination;backendUtilityService;collectionService;extensionService;extensionUtility;filterFactory;filterService;gridEventService;gridService;gridStateService;groupingService;headerGroupingService;resizerService;rxjs;sharedService;sortService;treeDataService;dataView;grid;totalItems=0;extensions;instances=null;static defaultProps={containerService:mh,translaterService:new ts,gridId:"",dataset:[],columns:[],options:{}};get dataset(){return this.dataView?.getItems()||[]}set dataset(e){let t=this._currentDatasetLength,i=lt(e,this.dataset||[]),o=this._options?.enableDeepCopyDatasetOnPageLoad?ei(e):e;this.grid&&this.options?.enableTreeData&&Array.isArray(e)&&(e.length>0||e.length!==t||!i)&&(this._isDatasetHierarchicalInitialized=!1,o=this.sortTreeDataset(e,!i)),this.refreshGridData(o||[]),this._currentDatasetLength=(e||[]).length,this.grid&&this.options.autoFitColumnsOnFirstLoad&&t===0&&!this._isAutosizeColsCalled&&(this.grid.autosizeColumns(),this._isAutosizeColsCalled=!0)}get datasetHierarchical(){return this.sharedService.hierarchicalDataset}set datasetHierarchical(e){let t=lt(e,this.sharedService?.hierarchicalDataset??[]),i=this._currentDatasetLength;this.sharedService&&(this.sharedService.hierarchicalDataset=e),e&&this.props.columns&&this.filterService?.clearFilters&&this.filterService.clearFilters(),this.dataView&&e&&this.grid&&this.sortService?.processTreeDataInitialSort&&(this.dataView.setItems([],this._options?.datasetIdPropertyName??"id"),this.sortService.processTreeDataInitialSort(),this.treeDataService.initHierarchicalTree(),queueMicrotask(()=>{let o=this.dataView?.getItemCount()??0;o>0&&(o!==i||!t)&&this.filterService.refreshTreeDataFilters()})),this._isDatasetHierarchicalInitialized=!0}get paginationService(){return this.state?.paginationService}set paginationService(e){this.setStateValue("paginationService",e)}constructor(e){super(e),this.props=e;let t=new es;this._eventHandler=new G,this.showPagination=!1,this._hideHeaderRowAfterPageLoad=e.options?.showHeaderRow===!1,this._options=this.mergeGridOptions(e.options||{}),this._eventPubSubService=new Ei,this._eventPubSubService.eventNamingStyle=We.camelCase,this.backendUtilityService=new _o,this.gridEventService=new Mr,this.sharedService=new go,this.collectionService=new ho(this.props.translaterService),this.extensionUtility=new ur(this.sharedService,this.backendUtilityService,this.props.translaterService),this.filterFactory=new Ar(t,this.props.translaterService,this.collectionService),this.filterService=new Lr(this.filterFactory,this._eventPubSubService,this.sharedService,this.backendUtilityService),this.resizerService=new Fr(this._eventPubSubService),this.sortService=new Nr(this.collectionService,this.sharedService,this._eventPubSubService,this.backendUtilityService),this.treeDataService=new zr(this._eventPubSubService,this.filterService,this.sharedService,this.sortService),this.paginationService=new Vr(this._eventPubSubService,this.sharedService,this.backendUtilityService),this.extensionService=new Rr(this.extensionUtility,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService,this.props.translaterService,()=>this.gridService),this.gridStateService=new Pr(this.extensionService,this.filterService,this._eventPubSubService,this.sharedService,this.sortService,this.treeDataService),this.gridService=new Dr(this.gridStateService,this.filterService,this._eventPubSubService,this.paginationService,this.sharedService,this.sortService,this.treeDataService),this.headerGroupingService=new Hr(this.extensionUtility),this.serviceList=[this.extensionService,this.filterService,this.gridEventService,this.gridService,this.gridStateService,this.headerGroupingService,this.paginationService,this.resizerService,this.sortService,this.treeDataService],this.props.datasetHierarchical&&(this.sharedService.hierarchicalDataset=this.props.datasetHierarchical||[]),this.props.containerService.registerInstance("PubSubService",this._eventPubSubService),this.props.containerService.registerInstance("EventPubSubService",this._eventPubSubService),this.props.containerService.registerInstance("ExtensionUtility",this.extensionUtility),this.props.containerService.registerInstance("FilterService",this.filterService),this.props.containerService.registerInstance("CollectionService",this.collectionService),this.props.containerService.registerInstance("ExtensionService",this.extensionService),this.props.containerService.registerInstance("GridEventService",this.gridEventService),this.props.containerService.registerInstance("GridService",this.gridService),this.props.containerService.registerInstance("GridStateService",this.gridStateService),this.props.containerService.registerInstance("HeaderGroupingService",this.headerGroupingService),this.props.containerService.registerInstance("PaginationService",this.paginationService),this.props.containerService.registerInstance("ResizerService",this.resizerService),this.props.containerService.registerInstance("SharedService",this.sharedService),this.props.containerService.registerInstance("SortService",this.sortService),this.props.containerService.registerInstance("TranslaterService",this.props.translaterService),this.props.containerService.registerInstance("TreeDataService",this.treeDataService)}get backendService(){return this.options.backendServiceApi?.service}get eventHandler(){return this._eventHandler}get isDatasetInitialized(){return this._isDatasetInitialized}set isDatasetInitialized(e){this._isDatasetInitialized=e}set isDatasetHierarchicalInitialized(e){this._isDatasetHierarchicalInitialized=e}get registeredResources(){return this._registeredResources}componentDidMount(){if(this._mounted=!0,this._elm&&this._eventPubSubService instanceof Ei){this._eventPubSubService.elementSource=this._elm;for(let e in this.props)if(e.startsWith("on")){let t=this.props[e];typeof t=="function"&&this.subscriptions.push(this._eventPubSubService.subscribe(e,i=>{let o=this._eventPubSubService.getEventNameByNamingConvention(e,"");t.call(null,new CustomEvent(o,{detail:i}))}))}}if(this._registeredResources=this.options?.externalResources||[],this.initialization(this._eventHandler),this._isGridInitialized=!0,this.hasBackendInfiniteScroll()||(this.options.enablePagination=!!(this.options.backendServiceApi&&this.options.enablePagination===void 0||this.options.enablePagination)),!this._isPaginationInitialized&&!this.props.datasetHierarchical&&this._options?.enablePagination&&this._isLocalGrid&&(this.showPagination=!0,this.loadLocalGridPagination(this.dataset)),this._options?.enableEmptyDataWarningMessage){let e=this.props.dataset||[];if(Array.isArray(e)){let t=e.length;this.displayEmptyDataWarning(t<1)}}this.options.darkMode&&this.setDarkMode(!0),this.suggestDateParsingWhenHelpful()}initialization(e){if(!this._columns)throw new Error("Using `<SlickgridReact>` requires `columns` and it seems that you might have forgot to provide this missing bindable model.");if(this._options.translater=this.props.translaterService,this._eventHandler=e,this._isAutosizeColsCalled=!1,this._options&&(this._options.frozenRow!==void 0&&this._options.frozenRow>=0||this._options.frozenColumn!==void 0&&this._options.frozenColumn>=0)&&this._options.enableMouseWheelScrollHandler===void 0&&(this._options.enableMouseWheelScrollHandler=!0),this._eventPubSubService.eventNamingStyle=this._options?.eventNamingStyle??We.camelCase,this._eventPubSubService.publish("onBeforeGridCreate",!0),this._dataset||=this.props.dataset||[],this._currentDatasetLength=this._dataset.length,this._options=this.mergeGridOptions(this._options),this._paginationOptions=this._options?.pagination,this.backendServiceApi=this._options?.backendServiceApi,this._isLocalGrid=!this.backendServiceApi,this._options?.enableTranslate||this._options?.i18n){let r='[Slickgrid-React] Enabling translation requires you to install I18Next in your App and use `I18nextProvider` to provide it. Please make sure to first install it via "npm install i18next react-i18next" and then use `<I18nextProvider value={i18n}><App/></I18nextProvider>` in your main index.tsx file. Visit https://ghiscoding.gitbook.io/slickgrid-react/localization/localization for more info.';if(this._i18next=this.context,this.props.translaterService&&this._i18next)this.props.translaterService.i18nInstance=this._i18next;else throw new Error(r)}if(this.options.backendServiceApi&&!this.options.backendServiceApi?.disableInternalPostProcess&&this.createBackendApiInternalPostProcessCallback(this._options),!this.props.customDataView){let r=this._options.dataView&&this._options.dataView.inlineFilters||!1,n={...this._options.dataView,inlineFilters:r};(this._options.draggableGrouping||this._options.enableGrouping)&&(this.groupItemMetadataProvider=new to,this.sharedService.groupItemMetadataProvider=this.groupItemMetadataProvider,n={...n,groupItemMetadataProvider:this.groupItemMetadataProvider}),this.dataView=new $s(n,this._eventPubSubService),this._eventPubSubService.publish("onDataviewCreated",this.dataView)}this.preRegisterResources(),this._columns=this.loadSlickGridEditors(this.props.columns),this._options.autoAddCustomEditorFormatter&&La(this._columns,this._options.autoAddCustomEditorFormatter),this.sharedService.allColumns=this._columns,this.sharedService.visibleColumns=this._columns,this.extensionService.createExtensionsBeforeGridCreation(this._columns,this._options),this.options.presets?.pinning&&(this.options={...this.options,...this.options.presets.pinning}),this.grid=new ar(`#${this.props.gridId}`,this.props.customDataView||this.dataView,this._columns,this._options,this._eventPubSubService),this.sharedService.dataView=this.dataView,this.sharedService.slickGrid=this.grid,this.sharedService.gridContainerElement=this._elm,this.groupItemMetadataProvider&&this.grid.registerPlugin(this.groupItemMetadataProvider),this.extensionService.bindDifferentExtensions(),this.bindDifferentHooks(this.grid,this._options,this.dataView);let t=this._options?.frozenColumn??-1;t>=0&&t<=this.sharedService.visibleColumns.length&&this.sharedService.visibleColumns.length>0&&(this.sharedService.frozenVisibleColumnId=this.sharedService.visibleColumns[t]?.id??""),this.registerResources(),this.grid.init();let i=this._elm;if(i&&this.resizerService.init(this.grid,i),!this._options.enablePagination&&this._options.showCustomFooter&&this._options.customFooterOptions&&i&&(this.slickFooter=new bn(this.grid,this._options.customFooterOptions,this._eventPubSubService,this.props.translaterService),this.slickFooter.renderFooter(i)),!this.props.customDataView&&this.dataView){let r=this._options?.enableTreeData?this.sortTreeDataset(this.props.dataset):this.props.dataset;if(Array.isArray(r)&&this.dataView.setItems(r,this._options.datasetIdPropertyName??"id"),this.grid?.getSelectionModel()&&this._options?.dataView&&this._options.dataView.hasOwnProperty("syncGridSelection")){let n=!1;this._options.backendServiceApi&&this._options.dataView.hasOwnProperty("syncGridSelectionWithBackendService")&&(n=this._options.dataView.syncGridSelectionWithBackendService);let a=this._options.dataView.syncGridSelection;if(typeof a=="boolean"){let l=a;this._isLocalGrid||(l=a&&n),this.dataView.syncGridSelection(this.grid,l)}else typeof a=="object"&&this.dataView.syncGridSelection(this.grid,a.preserveHidden,a.preserveHiddenOnSelectionChange)}this._dataset.length>0&&(!this._isDatasetInitialized&&(this._options.enableCheckboxSelector||this._options.enableRowSelection)&&this.loadRowSelectionPresetWhenExists(),this.loadFilterPresetsWhenDatasetInitialized(),this._isDatasetInitialized=!0)}this._hideHeaderRowAfterPageLoad&&(this.showHeaderRow(!1),this.sharedService.hideHeaderRowAfterPageLoad=this._hideHeaderRowAfterPageLoad),this._eventPubSubService.publish("onGridCreated",this.grid),this.props.customDataView||this.executeAfterDataviewCreated(this.grid,this._options),this.bindResizeHook(this.grid,this._options),this._options?.backendServiceApi&&this.bindBackendCallbackFunctions(this._options);let o={element:this._elm,dataView:this.dataView,slickGrid:this.grid,dispose:this.dispose.bind(this),backendService:this.backendService,eventPubSubService:this._eventPubSubService,extensionService:this.extensionService,filterService:this.filterService,gridEventService:this.gridEventService,gridStateService:this.gridStateService,gridService:this.gridService,headerGroupingService:this.headerGroupingService,paginationService:this.paginationService,resizerService:this.resizerService,sortService:this.sortService,treeDataService:this.treeDataService};this.extensions=this.extensionService?.extensionList,this.instances=o,this.setStateValue("instances",o),this._eventPubSubService.publish("onReactGridCreated",o),this.observeColumns()}componentWillUnmount(e=!1){if(this._eventPubSubService.publish("onBeforeGridDestroy",this.grid),this._eventHandler?.unsubscribeAll(),typeof this._i18next?.off=="function"&&this._i18next.off("languageChanged"),e&&this.emptyGridContainerElm(),this._collectionObservers.forEach(t=>t?.disconnect()),this._eventPubSubService.publish("onAfterGridDestroyed",!0),this.serviceList.forEach(t=>{t?.dispose&&t.dispose()}),this.serviceList=[],this.backendService?.dispose?.(),this.disposeExternalResources(),this.slickEmptyWarning?.dispose(),this.slickFooter?.dispose(),this.slickPagination?.dispose(),this.dataView&&(this.dataView.setItems&&this.dataView.setItems([]),this.dataView.destroy&&this.dataView.destroy()),this.grid?.destroy&&this.grid.destroy(e),this.subscriptions=rl(this.subscriptions),this.backendServiceApi){for(let t of Object.keys(this.backendServiceApi))this.backendServiceApi[t]=null;this.backendServiceApi=void 0}for(let t of Object.keys(this.props.columns))this.props.columns[t]=null;for(let t of Object.keys(this.sharedService))this.sharedService[t]=null;this._dataset=null,this._columns=[]}emptyGridContainerElm(){let e=this._options?.gridContainerId||"grid1",t=document.querySelector(`#${e}`);j(t)}dispose(e=!1){this.componentWillUnmount(e)}disposeExternalResources(){if(Array.isArray(this._registeredResources))for(;this._registeredResources.length>0;){let e=this._registeredResources.pop();e?.dispose&&e.dispose()}this._registeredResources=[]}componentDidUpdate(e){this.props.options!==e.options&&(this._options={...sl,...this._options}),this.props.columns!==e.columns&&(this._columns=this.props.columns,this.columnsChanged(this.props.columns)),this.props.dataset!==e.dataset&&(this.dataset=this.props.dataset||e.dataset),this.props.datasetHierarchical&&this.props.datasetHierarchical!==e.datasetHierarchical&&(this.datasetHierarchical=this.props.datasetHierarchical),this.suggestDateParsingWhenHelpful()}columnsChanged(e){e&&(this._columns=e),this._isGridInitialized&&this.updateColumnsList(this._columns),this._columns.length>0&&this.copyColumnWidthsReference(this._columns)}createBackendApiInternalPostProcessCallback(e){let t=e?.backendServiceApi;if(t?.service){let i=t.service;typeof i.getDatasetName=="function"&&(t.internalPostProcess=o=>{let r=t&&i&&typeof i.getDatasetName=="function"?i.getDatasetName():"";if(o?.data[r]){let n=o.data[r].hasOwnProperty("nodes")?o.data[r].nodes:o.data[r],a=o.data[r].hasOwnProperty("totalCount")?o.data[r].totalCount:o.data[r].length;this.refreshGridData(n,a||0)}})}}bindDifferentHooks(e,t,i){if(t.enableTranslate&&this.extensionService.translateAllExtensions(),typeof this._i18next?.on=="function"&&this._i18next.on("languageChanged",o=>{this._eventPubSubService.publish("onLanguageChange"),t.enableTranslate&&(this.extensionService.translateAllExtensions(o),(t.createPreHeaderPanel&&t.createTopHeaderPanel||t.createPreHeaderPanel&&!t.enableDraggableGrouping)&&this.headerGroupingService.translateHeaderGrouping())}),t.backendServiceApi){let o=t.backendServiceApi;o?.service?.init&&o.service.init(o.options,t.pagination,this.grid,this.sharedService)}i&&e&&(this.gridEventService.bindOnBeforeEditCell(e),this.gridEventService.bindOnCellChange(e),this.gridEventService.bindOnClick(e),i&&e&&(t.enableSorting&&(t.backendServiceApi&&!t.backendServiceApi.useLocalSorting?this.sortService.bindBackendOnSort(e):this.sortService.bindLocalOnSort(e)),t.enableFiltering&&(this.filterService.init(e),t.backendServiceApi&&!t.backendServiceApi.useLocalFiltering?this.filterService.bindBackendOnFilter(e):this.filterService.bindLocalOnFilter(e)),this._eventHandler.subscribe(e.onColumnsReordered,(o,r)=>{this.sharedService.hasColumnsReordered=!0,this.sharedService.visibleColumns=r.impactedColumns}),this._eventHandler.subscribe(e.onSetOptions,(o,r)=>{r.optionsBefore.darkMode!==r.optionsAfter.darkMode&&this.sharedService.gridContainerElement&&this.setDarkMode(r.optionsAfter.darkMode)}),this.loadColumnPresetsWhenDatasetInitialized(),this.loadFilterPresetsWhenDatasetInitialized(),this._eventHandler.subscribe(i.onRowCountChanged,(o,r)=>{!t.enableRowDetailView||!Array.isArray(r.changedRows)||r.changedRows.length===r.itemCount?e.invalidate():(e.invalidateRows(r.changedRows),e.render()),this.handleOnItemCountChanged(i.getFilteredItemCount()||0,i.getItemCount()||0)}),this._eventHandler.subscribe(i.onSetItemsCalled,(o,r)=>{this.sharedService.isItemsDateParsed=!1,this.handleOnItemCountChanged(i.getFilteredItemCount()||0,r.itemCount),r.itemCount>0&&(this.options.autosizeColumnsByCellContentOnFirstLoad||this.options.enableAutoResizeColumnsByCellContent)&&this.resizerService.resizeColumnsByCellContent(!this._options?.resizeByContentOnlyOnFirstLoad)}),t?.enableFiltering&&!t.enableRowDetailView&&this._eventHandler.subscribe(i.onRowsChanged,(o,{calledOnRowCountChanged:r,rows:n})=>{if(!r&&Array.isArray(n)){let a=e.getRenderedRange();n.filter(l=>l>=a.top&&l<=a.bottom).forEach(l=>e.updateRow(l)),e.render()}})))}bindBackendCallbackFunctions(e){let t=e.backendServiceApi,i=t?.service,o=i?.options||{},r=o?o&&o.hasOwnProperty("executeProcessCommandOnInit")?o.executeProcessCommandOnInit:!0:!1;if(i){if(e?.presets){if(i.updateFilters&&Array.isArray(e.presets.filters)&&e.presets.filters.length>0&&i.updateFilters(e.presets.filters,!0),i.updateSorters&&Array.isArray(e.presets.sorters)&&e.presets.sorters.length>0){let n=this._options?.multiColumnSort?e.presets.sorters:e.presets.sorters.slice(0,1);i.updateSorters(void 0,n)}if(i.updatePagination&&e.presets.pagination&&!this.hasBackendInfiniteScroll()){let{pageNumber:n,pageSize:a}=e.presets.pagination;i.updatePagination(n,a)}}else{let n=this.filterService.getColumnFilters();n&&i.updateFilters&&i.updateFilters(n,!1)}if(t&&i&&(t.onInit||r)){let n=typeof i.buildQuery=="function"?i.buildQuery():"",a=r?t.process?.(n)??null:t.onInit?.(n)??null;queueMicrotask(()=>{let l=this.backendUtilityService,d=new Date;t.preProcess&&t.preProcess();let c=this._options?.pagination?.totalItems??0;a instanceof Promise?a.then(h=>l.executeBackendProcessesCallback(d,h,t,c)).catch(h=>l.onBackendError(h,t)):a&&this.rxjs?.isObservable(a)&&this.subscriptions.push(a.subscribe(h=>l.executeBackendProcessesCallback(d,h,t,c),h=>l.onBackendError(h,t)))})}t.service.options?.infiniteScroll&&this.addBackendInfiniteScrollCallback()}}addBackendInfiniteScrollCallback(){if(this.grid&&this.options.backendServiceApi&&this.hasBackendInfiniteScroll()&&!this.options.backendServiceApi?.onScrollEnd){let e=()=>{this.backendUtilityService.setInfiniteScrollBottomHit(!0),this.paginationService.goToNextPage().then(i=>{i||this.backendUtilityService.setInfiniteScrollBottomHit(!1)})};this.options.backendServiceApi.onScrollEnd=e,this._eventHandler.subscribe(this.grid.onScroll,(i,o)=>{let r=o.grid.getViewportNode();["mousewheel","scroll"].includes(o.triggeredBy||"")&&this.paginationService?.totalItems&&o.scrollTop>0&&Math.ceil(r.offsetHeight+o.scrollTop)>=o.scrollHeight&&(this._scrollEndCalled||(e(),this._scrollEndCalled=!0))});let t=this.options.backendServiceApi.postProcess;this.options.backendServiceApi.postProcess=i=>{this._scrollEndCalled=!1,t&&t(i)}}}bindResizeHook(e,t){if(t.autoFitColumnsOnFirstLoad&&t.autosizeColumnsByCellContentOnFirstLoad||t.enableAutoSizeColumns&&t.enableAutoResizeColumnsByCellContent)throw new Error('[Slickgrid-React] You cannot enable both autosize/fit viewport & resize by content, you must choose which resize technique to use. You can enable these 2 options ("autoFitColumnsOnFirstLoad" and "enableAutoSizeColumns") OR these other 2 options ("autosizeColumnsByCellContentOnFirstLoad" and "enableAutoResizeColumnsByCellContent").');t.gridHeight||t.gridWidth?this.resizerService.resizeGrid(0,{height:t.gridHeight,width:t.gridWidth}):this.resizerService.resizeGrid(),e&&t?.enableAutoResize&&t.autoFitColumnsOnFirstLoad&&t.enableAutoSizeColumns&&!this._isAutosizeColsCalled&&(e.autosizeColumns(),this._isAutosizeColsCalled=!0)}executeAfterDataviewCreated(e,t){if(t.enableSorting&&t.presets&&Array.isArray(t.presets.sorters)){let i=this._options?.multiColumnSort?t.presets.sorters:t.presets.sorters.slice(0,1);this.sortService.loadGridSorters(i)}}paginationChanged(e){let t=this.gridStateService?.needToPreserveRowSelection()??!1;this.grid&&!t&&this.options?.backendServiceApi&&(this.options.enableRowSelection||this.options.enableCheckboxSelector)&&this.grid.setSelectedRows([]);let{pageNumber:i,pageSize:o}=e;this.sharedService&&o!==void 0&&i!==void 0&&(this.sharedService.currentPagination={pageNumber:i,pageSize:o}),this._eventPubSubService.publish("onGridStateChanged",{change:{newValues:{pageNumber:i,pageSize:o},type:"pagination"},gridState:this.gridStateService.getCurrentGridState()})}paginationOptionsChanged(e){e&&this._paginationOptions?this._paginationOptions={...this._paginationOptions,...e}:this._paginationOptions=e,this._options&&(this._options.pagination=this._paginationOptions,this.paginationService.updateTotalItems(e?.totalItems??0,!0))}refreshGridData(e,t){if(this.grid&&this._options){if(this._options?.enablePagination&&this._isLocalGrid&&(this.showPagination=!0,this.loadLocalGridPagination(e)),this._options?.enableEmptyDataWarningMessage&&Array.isArray(e)){let i=t||e.length;this.displayEmptyDataWarning(i<1)}if(Array.isArray(e)&&this.grid&&this.dataView?.setItems){if(this.dataView.setItems(e,this._options.datasetIdPropertyName??"id"),!this._options.backendServiceApi&&!this._options.enableTreeData&&this.dataView.reSort(),e.length>0&&(this._isDatasetInitialized||(this.loadFilterPresetsWhenDatasetInitialized(),this._options.enableCheckboxSelector&&this.loadRowSelectionPresetWhenExists()),this._isDatasetInitialized=!0),this.showPagination=!!(this._options&&(this._options.enablePagination||this._options.backendServiceApi&&this._options.enablePagination===void 0)),this._paginationOptions&&this._options?.pagination&&this._options?.backendServiceApi){let i=this.setPaginationOptionsWhenPresetDefined(this._options,this._paginationOptions),o=t!==void 0?t:this._options?.pagination?.totalItems;o!==void 0&&o!==this.totalItems&&(this.totalItems=+o),this._isPaginationInitialized?this.paginationService.updateTotalItems(this.totalItems):this.initializePaginationService(i)}if(this.grid&&this._options.enableAutoResize){let i=this._options.autoResize&&this._options.autoResize.delay;this.resizerService.resizeGrid(i||10)}}}}showHeaderRow(e=!0){return this.grid.setHeaderRowVisibility(e),e===!0&&this._isGridInitialized&&this.grid.setColumns(this.props.columns),e}setPaginationOptionsWhenPresetDefined(e,t){return e.presets?.pagination&&e.pagination&&(this.hasBackendInfiniteScroll()?console.warn("[Slickgrid-React] `presets.pagination` is not supported with Infinite Scroll, reverting to first page."):(t.pageSize=e.presets.pagination.pageSize,t.pageNumber=e.presets.pagination.pageNumber)),t}setDarkMode(e=!1){this.sharedService.gridContainerElement?.classList.toggle("slick-dark-mode",e)}updateColumnsList(e){this.grid&&this._options&&Array.isArray(e)&&(e=this.loadSlickGridEditors(e),this._options.autoAddCustomEditorFormatter&&La(e,this._options.autoAddCustomEditorFormatter),this._options.enableTranslate?this.extensionService.translateColumnHeaders(void 0,e):this.extensionService.renderColumnHeaders(e,!0),this._options?.enableAutoSizeColumns?this.grid.autosizeColumns():this._options?.enableAutoResizeColumnsByCellContent&&this.resizerService?.resizeColumnsByCellContent&&this.resizerService.resizeColumnsByCellContent())}observeColumns(){this._collectionObservers.push(Bt(this._columns,this.columnsChanged.bind(this)))}copyColumnWidthsReference(e){e.forEach(t=>t.originalWidth=t.width)}displayEmptyDataWarning(e=!0){this.slickEmptyWarning?.showEmptyDataMessage(e)}handleOnItemCountChanged(e,t){this._currentDatasetLength=t,this.metrics={startTime:new Date,endTime:new Date,itemCount:e,totalItemCount:t},this.slickFooter&&(this.slickFooter.metrics=this.metrics),this._isLocalGrid&&this._options?.enableEmptyDataWarningMessage&&this.displayEmptyDataWarning(e===0),this._options.enableAutoResize&&this.resizerService.isAutoHeightEnabled&&e>0&&this.resizerService.resizeGrid()}initializePaginationService(e){this.grid&&this.options&&(this.paginationService.totalItems=this.totalItems,this.paginationService.init(this.grid,e,this.backendServiceApi),this.subscriptions.push(this._eventPubSubService.subscribe("onPaginationChanged",t=>this.paginationChanged(t)),this._eventPubSubService.subscribe("onPaginationOptionsChanged",t=>this.paginationOptionsChanged(t)),this._eventPubSubService.subscribe("onPaginationVisibilityChanged",t=>{this.showPagination=t?.visible??!1,this.options?.backendServiceApi&&this.backendUtilityService?.refreshBackendDataset(this.options),this.renderPagination(this.showPagination)})),this.renderPagination(),this._isPaginationInitialized=!0)}async renderPagination(e=!0){if(this.grid&&this._options?.enablePagination&&!this._isPaginationInitialized&&e){if(this.options.customPaginationComponent){let t=document.createElement("section");this._elm.appendChild(t);let{component:i}=await gh(this.options.customPaginationComponent,t);this.slickPagination=i}else this.slickPagination=new kn;this.slickPagination&&(this.slickPagination.init(this.grid,this.paginationService,this._eventPubSubService,this.props.translaterService),this.slickPagination.renderPagination(this._elm),this._isPaginationInitialized=!0)}else e||(this.slickPagination?.dispose(),this._isPaginationInitialized=!1)}loadEditorCollectionAsync(e){if(e?.editor){let t=e.editor.collectionAsync;e.editor.disabled=!0,t instanceof Promise?t.then(i=>{Array.isArray(i)?this.updateEditorCollection(e,i):i instanceof Response&&typeof i.json=="function"?i.bodyUsed?console.warn("[SlickGrid-React] The response body passed to collectionAsync was already read.Either pass the dataset from the Response or clone the response first using response.clone()"):i.json().then(o=>this.updateEditorCollection(e,o)):i?.content&&this.updateEditorCollection(e,i.content)}):this.rxjs?.isObservable(t)&&queueMicrotask(()=>{this.subscriptions.push(t.subscribe(i=>this.updateEditorCollection(e,i)))})}}insertDynamicPresetColumns(e,t){if(this._columns){let i=this._columns.findIndex(o=>o.id===e);if(i>=0){let o=this._columns[i];o?.id===e&&!t.some(r=>r.id===e)&&(i>0?t.splice(i,0,o):t.unshift(o))}}}loadColumnPresetsWhenDatasetInitialized(){if(this.grid&&this.options.presets&&Array.isArray(this.options.presets.columns)&&this.options.presets.columns.length>0){let e=this.gridStateService.getAssociatedGridColumns(this.grid,this.options.presets.columns);if(e&&Array.isArray(e)&&e.length>0&&Array.isArray(this._columns)){if(this.options.enableRowMoveManager){let t=this.options?.rowMoveManager?.columnId??"_move";this.insertDynamicPresetColumns(t,e)}if(this.options.enableCheckboxSelector){let t=this.options?.checkboxSelector?.columnId??"_checkbox_selector";this.insertDynamicPresetColumns(t,e)}if(this.options.enableRowDetailView){let t=this.options?.rowDetailView?.columnId??"_detail_selector";this.insertDynamicPresetColumns(t,e)}e.forEach(t=>t.originalWidth=t.width),this.grid.setColumns(e),this.sharedService.visibleColumns=e}}}loadFilterPresetsWhenDatasetInitialized(){this._options&&!this.props.customDataView&&this._options.presets&&(Array.isArray(this._options.presets.filters)||Array.isArray(this._options.presets?.treeData?.toggledItems))&&this.filterService.populateColumnFilterSearchTermPresets(this._options.presets?.filters||[])}loadLocalGridPagination(e){if(this._options&&this._paginationOptions){if(this.totalItems=Array.isArray(e)?e.length:0,this._paginationOptions&&this.dataView?.getPagingInfo){let i=this.dataView.getPagingInfo();i?.hasOwnProperty("totalRows")&&this._paginationOptions.totalItems!==i.totalRows&&(this.totalItems=i.totalRows||0)}this._paginationOptions.totalItems=this.totalItems;let t=this.setPaginationOptionsWhenPresetDefined(this._options,this._paginationOptions);this.initializePaginationService(t)}}loadRowSelectionPresetWhenExists(){let e=this._options?.presets;if(this._options&&(this._options.enableCheckboxSelector||this._options.enableRowSelection)&&this.grid?.getSelectionModel()&&e?.rowSelection&&(Array.isArray(e.rowSelection.gridRowIndexes)||Array.isArray(e.rowSelection.dataContextIds))){let i=e.rowSelection.dataContextIds,o=e.rowSelection.gridRowIndexes;Array.isArray(i)&&i.length>0?o=this.dataView.mapIdsToRows(i)||[]:Array.isArray(o)&&o.length>0&&(i=this.dataView.mapRowsToIds(o)||[]),this.grid&&Array.isArray(o)&&(this.grid.setSelectedRows(o),this.dataView.setSelectedIds(i||[],{isRowBeingAdded:!0,shouldTriggerEvent:!1,applyRowSelectionToGrid:!0}))}}hasBackendInfiniteScroll(e){return!!(e||this.options).backendServiceApi?.service.options?.infiniteScroll}mergeGridOptions(e){let t=fe(!0,{},sl,e);return t.gridId=this.props.gridId,t.gridContainerId=`slickGridContainer-${this.props.gridId}`,t.enableFiltering&&!t.showHeaderRow&&(t.showHeaderRow=t.enableFiltering),t?.pagination&&(e.enablePagination||e.backendServiceApi)&&e.pagination&&Array.isArray(e.pagination.pageSizes)&&(t.pagination.pageSizes=e.pagination.pageSizes),this.sharedService&&!t.enableFiltering&&t.enablePagination&&this._isLocalGrid&&(t.enableFiltering=!0,t.showHeaderRow=!1,this._hideHeaderRowAfterPageLoad=!0,this.sharedService.hideHeaderRowAfterPageLoad=!0),t}registerExternalResources(e,t=!1){t&&this.disposeExternalResources(),e.forEach(i=>this._registeredResources.push(i)),this.initializeExternalResources(e)}resetExternalResources(){this._registeredResources=[]}preRegisterResources(){if(this._registeredResources=this.options.externalResources||[],Array.isArray(this._registeredResources))for(let e of this._registeredResources)e?.className==="RxJsResource"&&this.registerRxJsResource(e)}initializeExternalResources(e){if(Array.isArray(e))for(let t of e)this.grid&&typeof t.init=="function"&&t.init(this.grid,this.props.containerService)}registerResources(){Array.isArray(this._registeredResources)&&(this.sharedService.externalRegisteredResources=this._registeredResources),this._registeredResources.push(this.gridService,this.gridStateService),(this.options.createPreHeaderPanel&&this.options.createTopHeaderPanel||this.options.createPreHeaderPanel&&!this.options.enableDraggableGrouping)&&this._registeredResources.push(this.headerGroupingService),this.options.enableTreeData&&this._registeredResources.push(this.treeDataService),this.options.enableTranslate&&this.extensionService.translateColumnHeaders(),this.slickEmptyWarning=new wn,this._registeredResources.push(this.slickEmptyWarning),this.initializeExternalResources(this._registeredResources)}registerRxJsResource(e){this.rxjs=e,this.backendUtilityService.addRxJsResource(this.rxjs),this.filterFactory.addRxJsResource(this.rxjs),this.filterService.addRxJsResource(this.rxjs),this.sortService.addRxJsResource(this.rxjs),this.paginationService.addRxJsResource(this.rxjs),this.props.containerService.registerInstance("RxJsResource",this.rxjs)}sortTreeDataset(e,t=!1){let i=this._currentDatasetLength,o,r=[];return this._isDatasetHierarchicalInitialized&&this.datasetHierarchical?(o=this.treeDataService.sortHierarchicalDataset(this.datasetHierarchical),r=o.flat):this._options&&Array.isArray(e)&&e.length>0&&(o=this.treeDataService.convertFlatParentChildToTreeDatasetAndSort(e,this._columns,this._options),this.sharedService.hierarchicalDataset=o.hierarchical,r=o.flat),e.length>0&&(t||e.length!==i)&&this.filterService.refreshTreeDataFilters(r),r}loadSlickGridEditors(e){return e.some(t=>`${t?.id}`.includes("."))&&console.warn('[Slickgrid-React] Make sure that none of your Column Definition "id" property includes a dot in its name because that will cause some problems with the Editors. For example if your column definition "field" property is "user.firstName" then use "firstName" as the column "id".'),e.map(t=>{if(t)return t.editor?.collectionAsync&&this.loadEditorCollectionAsync(t),{...t,editorClass:t.editor?.model}})}suggestDateParsingWhenHelpful(){this.dataView?.getItemCount()>Lp&&!this.options.silenceWarnings&&!this.options.preParseDateColumns&&this.grid.getColumns().some(e=>ut(e.type))&&console.warn("[Slickgrid-React] For getting better perf, we suggest you enable the `preParseDateColumns` grid option, for more info visit => https://ghiscoding.gitbook.io/slickgrid-react/column-functionalities/sorting#pre-parse-date-columns-for-better-perf")}updateEditorCollection(e,t){if(this.grid&&e.editor){e.editor.collection=t,e.editor.disabled=!1;let i=this.grid.getCellEditor();i?.disable&&i?.renderDomElement&&(i.destroy(),i.disable(!1),i.renderDomElement(t))}}render(){return(0,wo.jsxs)("div",{id:`slickGridContainer-${this.props.gridId}`,className:"grid-pane",ref:e=>{this._elm=e},children:[this.props.header&&(0,wo.jsx)("div",{className:"header",children:this.props.header}),(0,wo.jsx)("div",{id:`${this.props.gridId}`,className:"slickgrid-container"}),this.props.footer&&(0,wo.jsx)("div",{className:"footer",children:this.props.footer})]})}};var it=ye(Jt());var Ce=ye(ht()),yn=100,Ip=1,Dp=1,Mp=10,Pp=it.default.forwardRef((s,e)=>{let[t,i]=(0,it.useState)({}),[o,r]=(0,it.useState)(!1),[n,a]=(0,it.useState)(!1),[l,d]=(0,it.useState)(String(yn)),c=(0,it.useRef)(null),h=(0,it.useRef)(null),u=(0,it.useRef)(null),m=(0,it.useRef)(null),g=(0,it.useRef)([]),f=M=>M.pageNumber===Dp||M.totalItems===0,b=M=>M.pageNumber===M.pageCount||M.totalItems===0,v=(M,Y,me)=>{h.current=M,u.current=Y,m.current=me;let re=Y.getFullPagination();i(re),r(f(re)),a(b(re)),d(String(re.pageSize||yn));let pe=me.subscribe("onPaginationRefreshed",xe=>{i(xe),r(f(xe)),a(b(xe)),d(String(xe.pageSize||yn))});g.current.push(pe)},k=()=>{m.current?.unsubscribeAll(g.current),c.current?.remove()},C=()=>{if(u.current){let M=u.current.getFullPagination();i(M),r(f(M)),a(b(M)),d(String(M.pageSize||yn))}},E=M=>{f(t)||u.current?.goToFirstPage(M)},y=M=>{b(t)||u.current?.goToLastPage(M)},S=M=>{b(t)||u.current?.goToNextPage(M)},F=M=>{f(t)||u.current?.goToPreviousPage(M)},V=(M,Y)=>{let me=Y.optionValue||Y.value;d(me);let re=parseInt(me,Mp);!isNaN(re)&&re>=Ip&&u.current?.changeItemPerPage(re)};return(0,it.useEffect)(()=>()=>{k()},[]),(0,it.useImperativeHandle)(e,()=>({init:v,dispose:k,renderPagination:C})),(0,Ce.jsxs)("div",{className:"table-explorer-custom-pagination",ref:c,children:[(0,Ce.jsxs)("div",{className:"page-size-selector",children:[(0,Ce.jsx)("span",{className:"page-size-label",children:le.tableExplorer.rowsPerPage}),(0,Ce.jsxs)(wl,{value:l,selectedOptions:[l],onOptionSelect:V,size:"small",children:[(0,Ce.jsx)(yt,{value:"10",children:"10"}),(0,Ce.jsx)(yt,{value:"50",children:"50"}),(0,Ce.jsx)(yt,{value:"100",children:"100"}),(0,Ce.jsx)(yt,{value:"1000",children:"1000"})]})]}),(0,Ce.jsxs)("div",{className:"pagination-controls",children:[(0,Ce.jsxs)("div",{className:"pagination-nav",children:[(0,Ce.jsx)("button",{className:`pagination-button first ${o?"disabled":""}`,"aria-label":le.tableExplorer.firstPage,title:le.tableExplorer.firstPage,disabled:o,onClick:E,children:(0,Ce.jsx)(hl,{})}),(0,Ce.jsx)("button",{className:`pagination-button previous ${o?"disabled":""}`,"aria-label":le.tableExplorer.previousPage,title:le.tableExplorer.previousPage,disabled:o,onClick:F,children:(0,Ce.jsx)(ml,{})})]}),(0,Ce.jsxs)("div",{className:"page-info",children:[(0,Ce.jsx)("span",{className:"item-from","data-test":"item-from",children:t.dataFrom||0}),(0,Ce.jsx)("span",{className:"separator",children:"-"}),(0,Ce.jsx)("span",{className:"item-to","data-test":"item-to",children:t.dataTo||0}),(0,Ce.jsx)("span",{className:"separator",children:" of "}),(0,Ce.jsx)("span",{className:"total-items","data-test":"total-items",children:t.totalItems||0})]}),(0,Ce.jsxs)("div",{className:"pagination-nav",children:[(0,Ce.jsx)("button",{className:`pagination-button next ${n?"disabled":""}`,"aria-label":le.tableExplorer.nextPage,title:le.tableExplorer.nextPage,disabled:n,onClick:S,children:(0,Ce.jsx)(pl,{})}),(0,Ce.jsx)("button",{className:`pagination-button last ${n?"disabled":""}`,"aria-label":le.tableExplorer.lastPage,title:le.tableExplorer.lastPage,disabled:n,onClick:y,children:(0,Ce.jsx)(ul,{})})]})]})]})}),vh=Pp;var En=ye(ht()),bh=(0,ke.forwardRef)(({resultSet:s,themeKind:e,pageSize:t=100,failedCells:i,onDeleteRow:o,onUpdateCell:r,onRevertCell:n,onRevertRow:a,onCellChangeCountChanged:l,onDeletionCountChanged:d},c)=>{let[h,u]=(0,ke.useState)([]),[m,g]=(0,ke.useState)(void 0),[f,b]=(0,ke.useState)([]),[v,k]=(0,ke.useState)(e),C=(0,ke.useRef)(null),E=(0,ke.useRef)(new Map),y=(0,ke.useRef)(new Set),S=(0,ke.useRef)(new Set),F=(0,ke.useRef)(1),V=(0,ke.useRef)(t),M=(0,ke.useRef)(void 0),Y=(0,ke.useRef)(!1),me=(0,ke.useMemo)(()=>ke.default.forwardRef((P,L)=>(0,En.jsx)(vh,{ref:L,...P})),[]);function re(P){if(C.current=P,Y.current=!0,P.slickGrid){let L=P.slickGrid.getContainerNode();L&&L.addEventListener("focusout",W=>{let ne=W.relatedTarget;(!ne||!L.contains(ne))&&P.slickGrid?.getEditorLock().isActive()&&P.slickGrid.getEditorLock().commitCurrentEdit()})}}function pe(){E.current.clear(),y.current.clear(),S.current.clear(),C.current?.slickGrid&&C.current.slickGrid.invalidate(),l&&l(0),d&&d(0)}(0,ke.useImperativeHandle)(c,()=>({clearAllChangeTracking:pe,getCellChangeCount:()=>E.current.size,goToLastPage:()=>{if(C.current?.paginationService&&C.current?.dataView){let P=C.current.dataView.getLength(),L=C.current.paginationService.itemsPerPage,W=Math.ceil(P/L);C.current.paginationService.goToPageNumber(W)}},goToFirstPage:()=>{C.current?.paginationService&&C.current.paginationService.goToPageNumber(1)}}));function xe(P){let L={id:P.id};return P.cells.forEach((W,ne)=>{let X=W.isNull||!W.displayValue?"NULL":W.displayValue;L[`col${ne}`]=X}),L}function Qe(P){return P.map((W,ne)=>{let X={id:`col${ne}`,name:W.name,field:`col${ne}`,sortable:!1,minWidth:98,formatter:(de,we,Me,be,He)=>{let z=`${He.id}-${we}`,se=E.current.has(z),Be=S.current.has(z),Ye=Me??"",st=Ye==="NULL",qe=Ye&&typeof Ye=="string"?Ye.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):String(Ye||""),Lt=qe,rt=[];Be?rt.push("table-cell-error"):se&&rt.push("table-cell-modified"),st&&rt.push("table-cell-null");let Ke=rt.length>0?` class="${rt.join(" ")}"`:"";return Be?`<div title="${Lt}"${Ke}>${qe}</div>`:se?`<div title="${Lt}"${Ke}>${qe}</div>`:`<span title="${Lt}"${Ke}>${qe}</span>`}};return W.isEditable&&(X.editor={model:zc.text}),X})}(0,ke.useEffect)(()=>{C.current?.paginationService&&t&&C.current.paginationService.changeItemPerPage(t)},[t]),(0,ke.useEffect)(()=>{i&&(S.current=new Set(i),C.current?.slickGrid&&C.current.slickGrid.invalidate())},[i]),(0,ke.useEffect)(()=>{e!==v&&(console.log("Theme changed - triggering re-render"),k(e))},[e,v]),(0,ke.useEffect)(()=>{if(!s?.columnInfo||!s?.subset)return;let P=M.current,L=!Y.current||!P,W=P?.columnInfo?.length!==s.columnInfo.length,ne=P?.subset?.length!==s.subset.length;if(console.log(`ResultSet update - Initial: ${L}, Columns changed: ${W}, Rows changed: ${ne}`),L||W){console.log("Full grid initialization");let X=Qe(s.columnInfo);u(X);let de=s.subset.map(xe);b(de),m||g({enableColumnPicker:!1,enableGridMenu:!1,autoEdit:!1,autoCommitEdit:!1,editable:!0,enableAutoResize:!0,autoResize:{container:"#grid-container",bottomPadding:50},forceFitColumns:!1,enableColumnReorder:!1,enableHeaderMenu:!1,enableCellNavigation:!0,enableSorting:!1,enableContextMenu:!0,contextMenu:T(),customPaginationComponent:me,enablePagination:!0,pagination:{pageSize:t,pageSizes:[10,50,100,1e3]},editCommandHandler:(Me,be,He)=>{He.execute()},rowHeight:26,darkMode:e===2||e===3})}else if(ne&&C.current?.dataView&&C.current?.gridService){console.log("Row count changed - applying incremental updates");let X=new Set(P?.subset?.map(be=>be.id)||[]),de=new Set(s.subset.map(be=>be.id)),we=s.subset.filter(be=>!X.has(be.id));console.log(`Adding ${we.length} new row(s) by ID`);for(let be of we){let He=xe(be);C.current.gridService.addItem(He,{position:"bottom",highlightRow:!0,scrollRowIntoView:!0,triggerEvent:!0}),console.log(`Added row ${He.id} at bottom using gridService`)}let Me=(P?.subset||[]).filter(be=>!de.has(be.id));console.log(`Removing ${Me.length} deleted row(s) by ID`);for(let be of Me)C.current.gridService.deleteItemById(be.id)}else if(C.current?.dataView){console.log("Incremental update - checking for changed rows");let X=!1;for(let de=0;de<s.subset.length;de++){let we=s.subset[de],Me=P?.subset[de];if(!Me||JSON.stringify(we)!==JSON.stringify(Me)){let be=xe(we);C.current.dataView.getItemById(be.id)&&(console.log(`Updating row ${be.id} incrementally`),C.current.dataView.updateItem(be.id,be),X=!0)}}X&&C.current?.slickGrid&&C.current.slickGrid.invalidate()}M.current=s},[s,m,e,t]),(0,ke.useEffect)(()=>{if(!C.current?.paginationService||!C.current?.dataView||f.length===0)return;let P=F.current,L=V.current,W=C.current.paginationService.pageNumber;C.current.paginationService.itemsPerPage!==L&&(console.log(`Restoring items per page to: ${L}`),C.current.paginationService.changeItemPerPage(L)),P>1&&W!==P&&(console.log(`Restoring page to: ${P}`),C.current.paginationService.goToPageNumber(P))},[f]);function De(P,L){C.current?.paginationService&&(F.current=C.current.paginationService.pageNumber,V.current=C.current.paginationService.itemsPerPage);let W=L.cell,ne=W,X=h[W],de=L.item.id;console.log(`Cell Changed - Row ID: ${de}, Column Index: ${ne}`);let we=`${de}-${ne}`;if(E.current.set(we,{rowId:de,columnIndex:ne,columnId:X?.id,field:X?.field,newValue:L.item[X?.field]}),console.log(`Total changes tracked: ${E.current.size}`),l&&l(E.current.size),r){let Me=L.item[X?.field];r(de,ne,Me)}C.current?.slickGrid&&C.current.slickGrid.invalidate()}function O(P,L){C.current?.paginationService&&(F.current=C.current.paginationService.pageNumber,V.current=C.current.paginationService.itemsPerPage);let W=L.command,X=L.dataContext.id;switch(W){case"delete-row":o&&o(X),y.current.add(X);let de=[];E.current.forEach((At,z)=>{z.startsWith(`${X}-`)&&de.push(z)}),de.forEach(At=>{E.current.delete(At),S.current.delete(At)}),l&&l(E.current.size),d&&d(y.current.size);break;case"revert-cell":let Me=L.cell,be=`${X}-${Me}`;n&&n(X,Me),E.current.delete(be),S.current.delete(be),console.log(`Reverted cell for row ID ${X}, column ${Me}`),l&&l(E.current.size);break;case"revert-row":a&&a(X);let He=[];E.current.forEach((At,z)=>{z.startsWith(`${X}-`)&&He.push(z)}),He.forEach(At=>{E.current.delete(At),S.current.delete(At)}),console.log(`Reverted row with ID ${X}`),l&&l(E.current.size);break}}function T(){return{hideCopyCellValueCommand:!0,hideCloseButton:!0,commandItems:[{command:"delete-row",title:le.tableExplorer.deleteRow,iconCssClass:"mdi mdi-close",cssClass:"red",textCssClass:"bold",positionOrder:1},{command:"revert-cell",title:le.tableExplorer.revertCell,iconCssClass:"mdi mdi-undo",positionOrder:2},{command:"revert-row",title:le.tableExplorer.revertRow,iconCssClass:"mdi mdi-undo",positionOrder:3}],onCommand:(P,L)=>O(P,L)}}if(!s||h.length===0||!m)return null;let D=v===2||v===3;return(0,En.jsx)("div",{id:"grid-container",className:`table-explorer-grid-container ${D?"dark-mode":""}`,children:(0,En.jsx)(is,{gridId:"tableExplorerGrid",columns:h,options:m,dataset:f,onReactGridCreated:P=>re(P.detail),onCellChange:P=>De(P,P.detail.args)})})});var nl=ye(Jt());function zt(s,e=Object.is){return xl(s,e)}var Ue=ye(ht()),wh=({onSaveComplete:s,cellChangeCount:e,deletionCount:t,currentRowCount:i,onLoadSubset:o})=>{let r=ns(),n=100,a=1,l=10,d=zt(y=>y.showScriptPane),h=zt(y=>y.loadStatus)==="loading",[u,m]=nl.default.useState(String(n)),g=()=>{r.commitChanges(),s&&s()},f=()=>{r.createRow()},b=y=>{let S=y.target.value;m(S)},v=(y,S)=>{S.optionValue&&m(S.optionValue)},k=()=>{let y=parseInt(u||String(n),l);!isNaN(y)&&y>=a&&o&&o(y)};nl.default.useEffect(()=>{i!==void 0&&m(String(i))},[i]);let C=e+t,E=C>0?`${le.tableExplorer.saveChanges} (${C})`:le.tableExplorer.saveChanges;return(0,Ue.jsxs)(kl,{children:[(0,Ue.jsx)(ss,{"aria-label":E,title:E,icon:(0,Ue.jsx)(fl,{}),onClick:g,disabled:C===0||h,children:E}),(0,Ue.jsx)(ss,{"aria-label":le.tableExplorer.addRow,title:le.tableExplorer.addRow,icon:(0,Ue.jsx)(dl,{}),onClick:f,disabled:h,children:le.tableExplorer.addRow}),(0,Ue.jsx)(ss,{"aria-label":d?le.tableExplorer.hideScript:le.tableExplorer.showScript,title:d?le.tableExplorer.hideScript:le.tableExplorer.showScript,icon:(0,Ue.jsx)(gl,{}),onClick:()=>{d?r.toggleScriptPane():r.generateScript()},disabled:h,children:d?le.tableExplorer.hideScript:le.tableExplorer.showScript}),(0,Ue.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginLeft:"auto"},children:[(0,Ue.jsx)("span",{style:{fontSize:"12px"},children:le.tableExplorer.totalRowsToFetch}),(0,Ue.jsxs)(bl,{value:u,onChange:b,onOptionSelect:v,size:"small",freeform:!0,disabled:h,children:[(0,Ue.jsx)(yt,{value:"10",children:"10"}),(0,Ue.jsx)(yt,{value:"50",children:"50"}),(0,Ue.jsx)(yt,{value:"100",children:"100"}),(0,Ue.jsx)(yt,{value:"500",children:"500"}),(0,Ue.jsx)(yt,{value:"1000",children:"1000"})]}),(0,Ue.jsx)(vl,{appearance:"primary",size:"small",icon:(0,Ue.jsx)(cl,{}),onClick:k,title:le.tableExplorer.fetchRows,"aria-label":le.tableExplorer.fetchRows,disabled:h})]})]})};var je=ye(ht()),Vp=ll({root:{display:"flex",flexDirection:"column",height:"100vh",width:"100%",...bi.overflow("hidden")},panelGroup:{...bi.flex(1),width:"100%",height:"100%"},contentArea:{...bi.flex(1),display:"flex",flexDirection:"column",...bi.overflow("hidden"),height:"100%"},dataGridContainer:{...bi.flex(1),...bi.overflow("auto"),minHeight:0,position:"relative"},resizeHandle:{height:"2px",backgroundColor:"var(--vscode-editorWidget-border)"},loadingContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",flexDirection:"column"},loadingOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"var(--vscode-editor-background)",opacity:.9,zIndex:1e3,flexDirection:"column"}}),kh=()=>{let s=Vp(),e=ns(),{themeKind:t}=rs(),i=zt(k=>k.resultSet),o=zt(k=>k.loadStatus),r=zt(k=>k.currentRowCount),n=zt(k=>k.failedCells),a=zt(k=>k.showScriptPane),l=zt(k=>k.updateScript),d=o==="loading",c=(0,os.useRef)(null),[h,u]=os.default.useState(0),[m,g]=os.default.useState(0),f=()=>{c.current?.clearAllChangeTracking()},b=k=>{u(k)},v=k=>{g(k)};return(0,je.jsx)("div",{className:s.root,children:d&&!i?(0,je.jsx)("div",{className:s.loadingContainer,children:(0,je.jsx)(Tn,{label:le.tableExplorer.loadingTableData,labelPosition:"below"})}):(0,je.jsxs)(El,{direction:"vertical",className:s.panelGroup,children:[(0,je.jsx)(yl,{defaultSize:75,children:(0,je.jsxs)("div",{className:s.contentArea,children:[(0,je.jsx)(wh,{onSaveComplete:f,cellChangeCount:h,deletionCount:m,currentRowCount:r,onLoadSubset:e?.loadSubset}),i?(0,je.jsx)("div",{className:s.dataGridContainer,children:d?(0,je.jsx)("div",{className:s.loadingContainer,children:(0,je.jsx)(Tn,{label:le.tableExplorer.loadingTableData,labelPosition:"below"})}):(0,je.jsx)(bh,{ref:c,resultSet:i,themeKind:t,pageSize:10,currentRowCount:r,failedCells:n,onDeleteRow:e?.deleteRow,onUpdateCell:e?.updateCell,onRevertCell:e?.revertCell,onRevertRow:e?.revertRow,onLoadSubset:e?.loadSubset,onCellChangeCountChanged:b,onDeletionCountChanged:v})}):(0,je.jsx)("p",{children:le.tableExplorer.noDataAvailable})]})}),a&&(0,je.jsxs)(je.Fragment,{children:[(0,je.jsx)(Sl,{className:s.resizeHandle}),(0,je.jsx)(Tl,{script:l||`-- ${le.tableExplorer.noPendingChanges}`,themeKind:t,openInEditor:()=>e.openScriptInEditor(),copyToClipboard:()=>e.copyScriptToClipboard(),activeTab:"script",onClose:()=>e.toggleScriptPane()})]})]})})};var Sn=ye(ht());Ch.default.createRoot(document.getElementById("root")).render((0,Sn.jsx)(_l,{children:(0,Sn.jsx)(Rl,{children:(0,Sn.jsx)(kh,{})})}));
/*! Bundled license information:

vanilla-calendar-pro/index.mjs:
  (*! name: vanilla-calendar-pro v3.0.5 | url: https://github.com/uvarov-frontend/vanilla-calendar-pro *)

sortablejs/modular/sortable.core.esm.js:
  (**!
   * Sortable 1.15.6
   * @author	RubaXa   <trash@rubaxa.org>
   * @author	owenm    <owen23355@gmail.com>
   * @license MIT
   *)
*/
