"use strict";(self.webpackChunkechoapi_for_vscode=self.webpackChunkechoapi_for_vscode||[]).push([[7399],{777399:(e,n,t)=>{t.r(n),t.d(n,{default:()=>U});var r=t(364467),i=t(3453),l=t(296540),o=t(778291),s=t(971524),a=t(811721),u=(t(852741),t(892911)),c=t(614869),d=t(123328),v=t(302543),m=t(445448),f=t(600594),p=t(110563),g=t(833581),h=t(273904),b=t(166166),y=t(164394),j=t(960864),O=t(476701),w=t(456734),A=t(987959),x=t(790070),P=t(236492),S=t(768645),_=t(716535),k=t(430269),M=t(38344),E=t(461627),C=t(936006),T=t(474848);function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?D(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const z=(0,l.forwardRef)((function(e,n){var t,s,a,c,d=e.onChange,m=e.rawHtml,f=e.data,p=e.mode,g=(0,O.mL)(m||"").value,b=(0,o.Bd)().t,y=(0,l.useState)(!1),j=(0,i.A)(y,2),w=j[0],D=j[1],z=(0,l.useState)(""),L=(0,i.A)(z,2),F=L[0],N=L[1],I=(0,l.useState)(!1),H=(0,i.A)(I,2),R=H[0],B=H[1],V=(0,l.useState)("response"),X=(0,i.A)(V,2),J=X[0],W=X[1],Y=(0,l.useState)(q({},E.oY)),K=(0,i.A)(Y,2),U=K[0],G=K[1];(0,l.useImperativeHandle)(n,(function(){return{show:function(e){var n=e.key;if(W("response"),"add"===n)B(!0),G(q(q({},E.oY),{},{response:q(q({},E.oY.response),{},{raw:g,mode:p})}));else{B(!1);var t=(0,v.find)(null==f?void 0:f.message,(function(e){return e.param_id===n}));t&&G(q(q({},t),{},{response:q(q({},t.response),{},{raw:g,mode:p})}))}D(!0)}}}));var $=(0,l.useMemo)((function(){return(0,v.map)(["request","response"],(function(e){return{label:(0,T.jsx)(T.Fragment,{children:e}),key:e}}))}),[]),Q=(0,l.useMemo)((function(){var e,n,t;return{raw:(null==U||null===(e=U[J])||void 0===e?void 0:e.raw)||"",raw_schema:null==U||null===(n=U[J])||void 0===n?void 0:n.raw_schema,raw_parameter:(null==U||null===(t=U[J])||void 0===t?void 0:t.raw_parameter)||[]}}),[J,U]),Z=(0,S.A)((function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"response",i=(0,v.cloneDeep)(U);(0,v.isEqual)(e,"name")?i=q(q({},i),{},(0,r.A)({},e,n)):(0,v.isEqual)(e,"raw-edit")||(0,v.isEqual)(e,"schema")?i=q(q({},i),{},(0,r.A)({},t,q(q({},i[t]),n))):(0,v.isEqual)(e,"mode")&&(i=q(q({},i),{},(0,r.A)({},t,q(q({},i[t]),{},(0,r.A)({},e,n))))),G(i)}));return(0,T.jsx)(h.aF,{onOk:function(){if(null!=U&&U.name){if(R){var e=(0,_.Ay)(f,(function(e){e.message.push(U)}));d&&d(e)}else{var n=(0,_.Ay)(f,(function(e){var n=(0,v.findIndex)(null==e?void 0:e.message,(function(e){return(0,v.isEqual)(e.param_id,null==U?void 0:U.param_id)}));e.message[n]=U}));d&&d(n)}D(!1)}else A.Ay.info(b("api.design.new_modal.name_error_tip"))},destroyOnClose:!0,width:"60vw",closeIcon:null,onCancel:function(){return D(!1)},open:w,children:(0,T.jsxs)(C.JO,{children:[(0,T.jsx)(h.pd,{width:110,value:null==U?void 0:U.name,onBlur:function(e){var n;return Z("name",(null===(n=e.target.value)||void 0===n?void 0:n.trim())||b("supplement.msg"))},onChange:function(e){return Z("name",e.target.value)}}),(0,T.jsx)(k.A,{items:$,activeKey:J,onChange:function(e){return W(e)}}),(0,T.jsx)(u.A,{align:"center",justify:"space-between",children:(0,T.jsxs)(x.A,{align:"center",className:"info-wrap",children:[(0,v.isEqual)(J,"request")?b("supplement.req"):b("supplement.res"),(0,T.jsxs)(P.A,{value:F||(null==U||null===(t=U[J])||void 0===t?void 0:t.mode),onChange:function(e){if("binary"===e)return N(e),void Z("mode",(0,v.isEqual)(J,"request")?"base64":"binary",J);N(""),Z("mode",e,J)},size:"small",style:{width:80},children:[(0,T.jsx)(P.A.Option,{value:"text",children:"Text"}),(0,T.jsx)(P.A.Option,{value:"json",children:"JSON"}),(0,T.jsx)(P.A.Option,{value:"xml",children:"XML"}),(0,T.jsx)(P.A.Option,{value:"html",children:"HTML"}),(0,T.jsx)(P.A.Option,{value:"binary",children:"Binary"})]}),"binary"===F&&(0,v.isEqual)(J,"request")&&(0,T.jsxs)(P.A,{size:"small",value:null==U||null===(s=U[J])||void 0===s?void 0:s.mode,onChange:function(e){return Z("mode",e,J)},style:{width:115},children:[(0,T.jsx)(P.A.Option,{value:"base64",children:"Base64"}),(0,T.jsx)(P.A.Option,{value:"hexadecimal",children:"Hexadecimal"})]})]})}),(0,T.jsx)("div",{className:"raw-editor-example",children:(0,T.jsx)(M.A,{responseParameterTitle:b("common.raw_input.body_value"),mode:null==U||null===(a=U[J])||void 0===a?void 0:a.mode,isParameter:!["json","xml"].includes(null==U||null===(c=U[J])||void 0===c?void 0:c.mode),value:Q,onChange:function(e){return Z(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"schema",e,J)}})})]})})}));var L=t(779888),F=t(362611),N=t(827659);function I(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function H(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?I(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):I(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const R=function(e){var n=(0,o.Bd)().t,t=e||{},i=t.filterValue,l=t.setFilterValue,s=t.filterType,a=t.setFilterType,c=t.target_id,d=(0,j.A)((function(e){return e.websocket2ConnectionPool})),v=(0,j.A)((function(e){return e.updateWebsocket2ConnectionPool}));return(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(u.A,{justify:"space-between",className:"ws-header",children:(0,T.jsxs)(u.A,{align:"center",gap:8,style:{wordBreak:"keep-all"},children:[(0,T.jsx)(L.A,{prefix:(0,T.jsx)(N.A,{type:"icon-search-line",className:"icon-color"}),placeholder:n("ws.response.search_tip"),value:i,onChange:function(e){var n;return l((null==e||null===(n=e.target)||void 0===n?void 0:n.value)||"")},size:"small"}),(0,T.jsxs)(P.A,{getPopupContainer:function(e){return e.parentNode},value:s,onChange:a,size:"small",children:[(0,T.jsx)(P.A.Option,{value:"all",children:n("ws.response.all_message")}),(0,T.jsx)(P.A.Option,{value:"send",children:n("ws.response.sent")}),(0,T.jsx)(P.A.Option,{value:"message",children:n("ws.response.received")})]}),(0,T.jsx)(F.A,{style:{height:32,borderColor:"var(--color-table-border)"},size:"small",icon:(0,T.jsx)(N.A,{type:"icon-delete"}),onClick:function(){return v(H(H({},d),{},(0,r.A)({},c,H(H({},d[c]),{},{socketRes:[]}))))},children:n("ws.response.clear")})]})})})};function B(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function V(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?B(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):B(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function X(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var J=function(e){for(var n=0,t=0;t<e.length;t++)n=e.charCodeAt(t)+((n<<5)-n);for(var r=0,i=0,l=0,o=0;o<3;o++){var s=n>>8*o&255;0===o&&(r=s),1===o&&(i=s),2===o&&(l=s)}var a=[r,i,l],u=a.filter((function(e){return e<100})).length;u>1&&(a.sort((function(e,n){return e-n})),a[0]=Math.max(100,a[0]),a[1]=Math.max(100,a[1]),r=a[0],i=a[1],l=a[2]);var c=(.299*r+.587*i+.114*l)/255;if(c<50/255){var d=50/(255*c);r=Math.min(255,Math.round(r*d)),i=Math.min(255,Math.round(i*d)),l=Math.min(255,Math.round(l*d))}else if(c>100/255){var v=100/(255*c);r=Math.max(0,Math.round(r*v)),i=Math.max(0,Math.round(i*v)),l=Math.max(0,Math.round(l*v))}return r=Math.max(50,Math.min(225,r)),i=Math.max(50,Math.min(225,i)),l=Math.max(50,Math.min(225,l)),"#".concat(("00"+r.toString(16)).substr(-2)).concat(("00"+i.toString(16)).substr(-2)).concat(("00"+l.toString(16)).substr(-2))},W=function(e){return(0,v.isString)(e)?e:(0,v.isPlainObject)(e)?JSON.stringify(e):(0,v.toString)(e)};function Y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Y(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Y(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const U=function(e){var n,t,u,A,x=e.target_id,P=e.onChange,S=e.apiScreenDirection,_=(0,o.Bd)().t,k=(0,j.A)((function(e){return e.websocket2ConnectionPool})),M=((0,j.A)((function(e){return e.updateWebsocket2aborts})),(0,j.A)((function(e){return e.aborts})),(0,w.A)().updatePool),E=(0,y.XX)((function(e){return e.apisActiveKey})),D=(0,y.XX)((function(e){return e.opensApiDetailsData}))[x],q=(0,c.A)("text"),L=(0,i.A)(q,2),F=L[0],N=L[1],I=(0,c.A)({}),H=(0,i.A)(I,2),B=H[0],Y=H[1],U=(0,c.A)(""),G=(0,i.A)(U,2),$=G[0],Q=G[1],Z=(0,c.A)("all"),ee=(0,i.A)(Z,2),ne=ee[0],te=ee[1],re=(0,c.A)(!0),ie=(0,i.A)(re,2),le=ie[0],oe=ie[1],se=(0,l.useRef)(),ae=(0,l.useRef)(null),ue=(0,l.useRef)(null),ce=(0,l.useRef)(null),de={defaultSize:50,minSize:5,collapsible:!0,collapsedSize:5},ve={connect:"",disconnect:"".concat(_("ws.response.disconnect")),error:"",send:"",message:"",listen:"".concat(_("supplement.listening")),"listen-end":"".concat(_("supplement.listen_end"))},me=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var t=e||{},r=t.action,i=t.message.message;if("message"===r){var l,o;if(!(0,v.isString)(i)&&null!=i&&null!==(l=i.data)&&void 0!==l&&l.type&&null!=i&&null!==(o=i.data)&&void 0!==o&&o.data){var s,a=d.Ay.bufferToRaw(null==i||null===(s=i.data)||void 0===s?void 0:s.data,{}).raw;return function(e){try{var n=JSON.parse(e);return(0,v.isObject)(n)&&!(0,v.isArray)(n)}catch(e){return!1}}(a)?a:n?JSON.stringify(a):a}return n?JSON.stringify(i):String(i)}return function(e){var n,t,r,i,l="";switch(null==e?void 0:e.action){case"connect":l=null==e||null===(n=e.message)||void 0===n?void 0:n.message;break;case"send":l=W(null==e||null===(t=e.message)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.data);break;case"listen":case"listen-end":l=null==e?void 0:e.message;break;case"send_ack":l=W(null==e||null===(r=e.message)||void 0===r||null===(r=r.message)||void 0===r?void 0:r.data);break;default:l=null==e||null===(i=e.message)||void 0===i?void 0:i.message}return l||""}(e)}catch(e){return""}},fe=(0,l.useMemo)((function(){return me(B)||""}),[B]),pe=(0,l.useMemo)((function(){var e;return function(e,n,t){var r,i,l,o,s,a=[],u=function(e){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,n){if(e){if("string"==typeof e)return X(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?X(e,n):void 0}}(e))){n&&(e=n);var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){o=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw i}}}}(e||[]);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(!(0,v.isString)(t)||"all"===t||(null==c?void 0:c.action)===t)switch(null==c?void 0:c.action){case"connect":var m;if((0,v.isString)(n)&&(0,v.trim)(n).length>0&&!(0,v.includes)(null==c||null===(m=c.message)||void 0===m?void 0:m.message,(0,v.trim)(n)))continue;a.push(V(V({},c),{},{id:(null==c?void 0:c.id)||(0,d.aL)()}));break;case"disconnect":case"listen":case"listen-end":if((0,v.isString)(n)&&(0,v.trim)(n).length>0&&!(0,v.includes)(null==c?void 0:c.message,(0,v.trim)(n)))continue;a.push(V(V({},c),{},{id:(null==c?void 0:c.id)||(0,d.aL)()}));break;case"error":if((0,v.isString)(n)&&(0,v.trim)(n).length>0&&!(0,v.includes)(null==c||null===(r=c.message)||void 0===r?void 0:r.message,(0,v.trim)(n)))continue;a.push(V(V({},c),{},{id:(null==c?void 0:c.id)||(0,d.aL)()}));break;case"message":if((0,v.isString)(n)&&(0,v.trim)(n).length>0&&!(0,v.includes)(null==c||null===(i=c.message)||void 0===i?void 0:i.data,(0,v.trim)(n)))continue;a.push(V(V({},c),{},{id:(null==c?void 0:c.id)||(0,d.aL)()}));break;case"send":if((0,v.isString)(n)&&(0,v.trim)(n).length>0&&!(0,v.includes)(W(null==c||null===(l=c.message)||void 0===l||null===(l=l.message)||void 0===l?void 0:l.data),(0,v.trim)(n)))continue;a.push(V(V({},c),{},{id:(null==c?void 0:c.id)||(0,d.aL)()}));break;case"send_ack":if((0,v.isString)(n)&&(0,v.trim)(n).length>0&&!(0,v.includes)(W(null==c||null===(o=c.message)||void 0===o||null===(o=o.message)||void 0===o?void 0:o.data),(0,v.trim)(n)))continue;a.push(V(V({},c),{},{id:(null==c?void 0:c.id)||(0,d.aL)()}))}}}catch(e){u.e(e)}finally{u.f()}return a}(null===(e=k[E])||void 0===e?void 0:e.socketRes,$,ne)}),[k,E,$,ne]);return(0,l.useMemo)((function(){return(0,v.map)(null==D?void 0:D.message,(function(e){return{label:(0,T.jsx)(C.Wo,{children:(0,T.jsx)("span",{className:"name",children:(0,T.jsx)(h.m_,{title:e.name,children:e.name})})}),key:e.param_id}}))}),[D]),a.A,h.m_,_("api.design.save_response"),h.rP,(0,l.useEffect)((function(){var e,n,t;!(0,v.isEqual)(null==B||null===(e=B.message)||void 0===e?void 0:e.fitForShow,"Monaco")&&(0,v.isEqual)(null==B?void 0:B.action,"message")?null==ae||null===(n=ae.current)||void 0===n||n.setTabsValue("preview"):null==ae||null===(t=ae.current)||void 0===t||t.setTabsValue("beautify")}),[B]),(0,l.useEffect)((function(){var e;(null==ue?void 0:ue.current)&&le&&(ue.current.scrollTop=(null==ue||null===(e=ue.current)||void 0===e?void 0:e.scrollHeight)||0)}),[E,le,pe]),(0,l.useEffect)((function(){var e;null===(e=ue.current)||void 0===e||e.addEventListener("scroll",(function(){se.current||(se.current=(0,r.A)({},E,0));var e=ue.current.scrollTop;e<se.current[E]&&oe(!1),se.current[E]=e}));var n=ue.current;return function(){null==n||n.removeEventListener("scroll",(function(){}))}}),[E]),(0,l.useEffect)((function(){var e;"send"===(null===(e=pe[(0,v.size)(pe)-1])||void 0===e?void 0:e.action)&&oe(!0)}),[pe]),(0,T.jsxs)(T.Fragment,{children:["connecting"===(null===(n=k[E])||void 0===n?void 0:n.status)&&(0,T.jsx)(m.fr,{onCancel:function(){var e;null===(e=window)||void 0===e||e.vscode.postMessage({action:"socketio_disconnect",data:x}),M(x,"disconnect",{})}}),(0,T.jsx)("div",{style:{height:"100%"},children:(0,v.size)(pe)>-1?(0,T.jsx)(p.A,{panelGroupProps:{autoSaveId:"ws_realtime_container_resize_save_id",direction:"horizontal"===S?"vertical":"horizontal"},leftPanelProps:K(K({},de),{},{collapseTitle:_("supplement.socket_realtime_msg")}),rightPanelProps:K(K({},de),{},{collapseTitle:_("supplement.socket_realtime_content")}),leftPanel:(0,T.jsxs)(C.iU,{children:[(0,T.jsx)(R,{target_id:E,filterValue:$,filterType:ne,setFilterType:te,setFilterValue:Q}),(0,T.jsx)("div",{ref:ue,style:{overflow:"auto",maxHeight:"calc(100% - 50px)",border:"1px solid var(--color-border)",borderRadius:"var(--border-radius)"},children:(0,T.jsx)(f.A,{renderTitle:function(e){var n,t,r,i,l,o=(e||{}).action;return(0,T.jsxs)("div",{className:"title",style:{whiteSpace:"nowrap",maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden"},children:[ve[o],(0,v.includes)(["message","send","send_ack"],o)&&(null==e||null===(n=e.message)||void 0===n||null===(n=n.message)||void 0===n?void 0:n.event)&&(0,T.jsx)(s.A,{bordered:!1,style:{marginLeft:8,color:J(null==e||null===(t=e.message)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.event),background:(0,O.zX)(J(null==e||null===(r=e.message)||void 0===r||null===(r=r.message)||void 0===r?void 0:r.event),.05)},children:null==e||null===(i=e.message)||void 0===i||null===(i=i.message)||void 0===i?void 0:i.event}),(0,v.includes)(["listen","listen-end"],o)?(0,T.jsx)(s.A,{bordered:!1,style:{marginLeft:8,color:J(me(e)),background:(0,O.zX)(J(me(e)),.05)},children:me(e)}):(0,T.jsx)(T.Fragment,{children:!(0,v.isEqual)(null==e||null===(l=e.message)||void 0===l?void 0:l.fitForShow,"Monaco")&&(0,v.isEqual)(null==e?void 0:e.action,"message")?"<Binary>":me(e)})]})},customTipsContent:function(e){var n,t,r;return(0,v.isString)(null==e?void 0:e.message)?{}:{size:null==e||null===(n=e.message)||void 0===n?void 0:n.size,time:null==e||null===(t=e.message)||void 0===t?void 0:t.time,mode:null==e||null===(r=e.message)||void 0===r?void 0:r.dataType}},onItemClick:function(e){Y(e)},data:pe})})]}),rightPanel:(0,T.jsxs)("div",{style:{height:"100%",padding:8},children:[(0,v.isEqual)(null==B?void 0:B.action,"message")&&(0,T.jsx)(g.A,{ref:ae,data:K(K({},B),{},{fit_for_show:null==B||null===(t=B.message)||void 0===t?void 0:t.fitForShow,stream:null==B||null===(u=B.message)||void 0===u||null===(u=u.message)||void 0===u?void 0:u.data,mime_type:{ext:null==B||null===(A=B.message)||void 0===A?void 0:A.dataType,mime:""}}),setMode:N,resultIncludesTabs:["beautify","native","preview"],warpVisible:!1,rawHtml:fe}),!(0,v.isEqual)(null==B?void 0:B.action,"message")&&(0,T.jsx)(g.A,{ref:ae,setMode:N,resultIncludesTabs:["beautify","native"],warpVisible:!1,rawHtml:fe})]})}):(0,T.jsx)(b.A,{})}),(0,T.jsx)(z,{data:D,mode:F,rawHtml:fe,onChange:P,ref:ce})]})}}}]);