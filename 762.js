"use strict";exports.id=762,exports.ids=[762],exports.modules={1762:(e,n,t)=>{t.r(n),t.d(n,{BE_PROFILE:()=>y,NRT_PROFILE:()=>p,PostChannel:()=>ve,RT_PROFILE:()=>h});var r=t(4661),i=t(3919),a=t(5778),o=t(6611),u=t(8106),s=t(5881),c=t(7895),l=t(7494),f=t(1628),d=t(3377),v=t(4111),h="REAL_TIME",p="NEAR_REAL_TIME",y="BEST_EFFORT",g="POST",m="drop",b="requeue",S="application/x-json-stream",T="cache-control",E="content-type",x="kill-duration",_="time-delta-millis",w="client-version",R="client-id",P="time-delta-to-apply-millis",k="upload-time",C="apikey",B="AuthMsaDeviceTicket",H="AuthXToken",K="msfpc",M="trace",O="user";function I(e){var n=(e.ext||{}).intweb;return n&&(0,s.yD)(n[K])?n[K]:null}function A(e){for(var n=null,t=0;null===n&&t<e.length;t++)n=I(e[t]);return n}var z=function(){function e(n,t){var r=t?[].concat(t):[],i=this,a=A(r);i.iKey=function(){return n},i.Msfpc=function(){return a||""},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),a||(a=I(e)),!0)},i.split=function(t,i){var o;if(t<r.length){var u=r.length-t;(0,c.hX)(i)||(u=i<u?i:u),o=r.splice(t,u),a=A(r)}return new e(n,o)}}return e.create=function(n,t){return new e(n,t)},e}();const D=function(){function e(){var n=!0,t=!0,r=!0,a="use-collector-delta",o=!1;(0,i.A)(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return a},e.setClockSkew=function(e){o||(e?(a=e,t=!0,o=!0):t=!1,n=!0)}}))}return e.__ieDyn=1,e}(),L=function(){function e(){var n={};(0,i.A)(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=(o=e.split(","),u=[],o&&(0,c.Iu)(o,(function(e){u.push((0,c.EH)(e))})),u);if("this-request-only"===t)return r;for(var i=1e3*parseInt(t,10),a=0;a<r.length;++a)n[r[a]]=(0,c.x3)()+i}catch(e){return[]}var o,u;return[]},e.isTenantKilled=function(e){var t=n,r=(0,c.EH)(e);return void 0!==t[r]&&t[r]>(0,c.x3)()||(delete t[r],!1)}}))}return e.__ieDyn=1,e}();var q=t(9166);function U(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)}var F,W=2e6,N=Math.min(W,65e3),X="metadata",Q="f",G=/\./,Z=function(){function e(n,t,r,o){var u="data",l="baseData",f=!!o,d=!0,v=t,h={};(0,i.A)(e,this,(function(e){function t(e,n,i,a,o,u,l){(0,c.z)(e,(function(e,d){var p=null;if(d||(0,s.yD)(d)){var y=i,g=e,m=o,b=n;if(f&&!a&&G.test(e)){var S=e.split("."),T=S.length;if(T>1){m&&(m=m.slice());for(var E=0;E<T-1;E++){var x=S[E];b=b[x]=b[x]||{},y+="."+x,m&&m.push(x)}g=S[T-1]}}var _=a&&function(e){var n=h[e];return void 0===n&&(e.length>=7&&(n=(0,c.tG)(e,"ext.metadata")||(0,c.tG)(e,"ext.web")),h[e]=n),n}(y);if(p=!_&&v&&v.handleField(y,g)?v.value(y,g,d,r):(0,s.TC)(g,d,r)){var w=p.value;if(b[g]=w,u&&u(m,g,p),l&&"object"==typeof w&&!(0,c.cy)(w)){var R=m;R&&(R=R.slice()).push(g),t(d,w,y+"."+g,a,R,u,l)}}}}))}e.createPayload=function(e,n,t,r,i,a){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r,sendType:a,sendReason:i}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&(0,a.r2)(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=r.events(),a=t.payloadBlob,o=t.numEvents,u=!1,s=[],l=[],f=t.isBeacon,d=f?65e3:3984588,v=f?N:W,h=0,p=0;h<n.length;){var y=n[h];if(y){if(o>=i){t.overflow=r.split(h);break}var g=e.getEventBlob(y);if(g&&g.length<=v){var m=g.length;if(a.length+m>d){t.overflow=r.split(h);break}a&&(a+="\n"),a+=g,++p>20&&(a.substr(0,1),p=0),u=!0,o++}else g?s.push(y):l.push(y),n.splice(h,1),h--}h++}if(s&&s.length>0&&t.sizeExceed.push(z.create(r.iKey(),s)),l&&l.length>0&&t.failedEvts.push(z.create(r.iKey(),l)),u){t.batches.push(r),t.payloadBlob=a,t.numEvents=o;var b=r.iKey();-1===(0,c.rD)(t.apiKeys,b)&&t.apiKeys.push(b)}}),(function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return(0,a.r2)(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+(0,s.EO)(e.iKey);var r={},i=e.ext;i&&(n.ext=r,(0,c.z)(i,(function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)})));var a=n[u]={};a.baseType=e.baseType;var o=a[l]={};return t(e.baseData,o,l,!1,[l],(function(e,n,t){j(r,e,n,t)}),d),t(e.data,a,u,!1,[],(function(e,n,t){j(r,e,n,t)}),d),JSON.stringify(n)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function j(e,n,t,r){if(r&&e){var i=(0,s.Go)(r.value,r.kind,r.propertyType);if(i>-1){var a=e[X];a||(a=e[X]={f:{}});var o=a[Q];if(o||(o=a[Q]={}),n)for(var u=0;u<n.length;u++){var l=n[u];o[l]||(o[l]={f:{}});var f=o[l][Q];f||(f=o[l][Q]={}),o=f}o=o[t]={},(0,c.cy)(r.value)?o.a={t:i}:o.t=i}}}var V="sendAttempt",$="&NoResponseBody=true",J=((F={})[1]=b,F[100]=b,F[200]="sent",F[8004]=m,F[8003]=m,F),Y={},ee={};function ne(e,n,t){Y[e]=n,!1!==t&&(ee[n]=e)}function te(e){try{return e.responseText}catch(e){}return""}function re(e,n){var t=!1;if(e&&n){var r=(0,c.cG)(e);if(r&&r.length>0)for(var i=n.toLowerCase(),a=0;a<r.length;a++){var o=r[a];if(o&&(0,c.mQ)(n,o)&&o.toLowerCase()===i){t=!0;break}}}return t}function ie(e,n,t,r){n&&t&&t.length>0&&(r&&Y[n]?(e.hdrs[Y[n]]=t,e.useHdrs=!0):e.url+="&"+n+"="+t)}ne(B,B,!1),ne(w,w),ne(R,"Client-Id"),ne(C,C),ne(P,P),ne(k,k),ne(H,H);var ae=function(){function e(n,t,r,o,u){this._responseHandlers=[];var f,v,h,p,y,b,B,H="?cors=true&"+E.toLowerCase()+"="+S,M=new L,O=!1,I=new D,A=!1,z=0,F=!0,W=[],N={},X=[],Q=null,G=!1,j=!1,Y=!1;(0,i.A)(e,this,(function(e){var i=!0;function D(e,n){for(var t=0,r=null,i=0;null==r&&i<e.length;)1===(t=e[i])?(0,l.PV)()?r=L:(0,l.xk)()&&(r=ae):2===t&&(0,l.R7)(n)?r=ne:A&&3===t&&(0,l.Uf)()&&(r=ue),i++;return r?{_transport:t,_isSync:n,sendPOST:r}:null}function L(e,n,t){var r=new XDomainRequest;r.open(g,e.urlString),e.timeout&&(r.timeout=e.timeout),r.onload=function(){var e=te(r);oe(n,200,{},e),me(e)},r.onerror=function(){oe(n,400,{})},r.ontimeout=function(){oe(n,500,{})},r.onprogress=function(){},t?r.send(e.data):u.set((function(){r.send(e.data)}),0)}function ne(e,n,t){var r,a=e.urlString,o=!1,s=!1,l=((r={body:e.data,method:g}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);t&&(l.keepalive=!0,2===e._sendReason&&(o=!0,a+=$)),i&&(l.credentials="include"),e.headers&&(0,c.cG)(e.headers).length>0&&(l.headers=e.headers),fetch(a,l).then((function(e){var t={},r="",i=e.headers;i&&i.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){r=e})),s||(s=!0,oe(n,e.status,t,r),me(r))})).catch((function(e){s||(s=!0,oe(n,0,{}))})),o&&!s&&(s=!0,oe(n,200,{})),!s&&e.timeout>0&&u.set((function(){s||(s=!0,oe(n,500,{}))}),e.timeout)}function ae(e,n,t){var r=e.urlString;function a(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=(0,c.EH)(r))}return e}function o(e,t){oe(n,e.status,function(e){var n={};return e.getAllResponseHeaders?n=function(e){var n={};if((0,c.Kg)(e)){var t=(0,c.EH)(e).split(/[\r\n]+/);(0,c.Iu)(t,(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var r=(0,c.EH)(e.substring(0,t)).toLowerCase(),i=(0,c.EH)(e.substring(t+1));n[r]=i}else n[(0,c.EH)(e)]=1}}))}return n}(e.getAllResponseHeaders()):(n=a(n,e,_),n=a(n,e,x),n=a(n,e,"kill-duration-seconds")),n}(e),t)}t&&e.disableXhrSync&&(t=!1);var u=(0,s.H$)(g,r,i,!0,t,e.timeout);(0,c.z)(e.headers,(function(e,n){u.setRequestHeader(e,n)})),u.onload=function(){var e=te(u);o(u,e),me(e)},u.onerror=function(){o(u)},u.ontimeout=function(){o(u)},u.send(e.data)}function oe(e,n,t,r){try{e(n,t,r)}catch(e){(0,d.ZP)(v,2,518,(0,l.mm)(e))}}function ue(e,n,t){var r=200,i=e._thePayload,a=e.urlString+$;try{var o=(0,l.w3)();if(!o.sendBeacon(a,e.data))if(i){var u=[];(0,c.Iu)(i.batches,(function(e){if(u&&e&&e.count()>0){for(var n=e.events(),t=0;t<n.length;t++)if(!o.sendBeacon(a,Q.getEventBlob(n[t]))){u.push(e.split(t));break}}else u.push(e.split(0))})),be(u,8003,i.sendType,!0)}else r=0}catch(e){(0,d.OG)(v,"Failed to send telemetry using sendBeacon API. Ex:"+(0,l.mm)(e)),r=0}finally{oe(n,r,{},"")}}function se(e){return 2===e||3===e}function ce(e){return j&&se(e)&&(e=2),e}function le(){return!O&&z<t}function fe(){var e=X;return X=[],e}function de(e,n,t){var r=!1;return e&&e.length>0&&!O&&h[n]&&Q&&(r=0!==n||le()&&(t>0||I.allowRequestSending())),r}function ve(e){var n={};return e&&(0,c.Iu)(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function he(e,t,r,i,o){if(e&&0!==e.length)if(O)be(e,1,i);else{i=ce(i);try{var u=e,c=0!==i;(0,a.r2)(p,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var u=[],f=null,d=(0,s.WB)(),v=h[i]||(c?h[1]:h[0]),p=(j||se(i)||v&&3===v._transport)&&!F&&A&&(0,l.Uf)();de(e,i,t);){var y=e.shift();y&&y.count()>0&&(M.isTenantKilled(y.iKey())?u.push(y):(f=f||Q.createPayload(t,r,c,p,o,i),Q.appendPayload(f,y,n)?null!==f.overflow&&(e=[f.overflow].concat(e),f.overflow=null,ye(f,d,(0,s.WB)(),o),d=(0,s.WB)(),f=null):(ye(f,d,(0,s.WB)(),o),d=(0,s.WB)(),e=[y].concat(e),f=null)))}f&&ye(f,d,(0,s.WB)(),o),e.length>0&&(X=e.concat(X)),be(u,8004,i)}),(function(){return{batches:ve(u),retryCount:t,isTeardown:r,isSynchronous:c,sendReason:o,useSendBeacon:se(i),sendType:i}}),!c)}catch(e){(0,d.ZP)(v,2,48,"Unexpected Exception sending batch: "+(0,l.mm)(e))}}}function pe(e,n,t){e[n]=e[n]||{},e[n][f.identifier]=t}function ye(n,t,i,o){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var u=!!e.sendHook,y=h[n.sendType];!se(n.sendType)&&n.isBeacon&&2===n.sendReason&&(y=h[2]||h[3]||y);var g=Y;(n.isBeacon||3===y._transport)&&(g=!1);var m=function(e,n){var t={url:H,hdrs:{},useHdrs:!1};n?(t.hdrs=(0,s.X$)(t.hdrs,N),t.useHdrs=(0,c.cG)(t.hdrs).length>0):(0,c.z)(N,(function(e,n){ee[e]?ie(t,ee[e],n,!1):(t.hdrs[e]=n,t.useHdrs=!0)})),ie(t,R,"NO_AUTH",n),ie(t,w,s.xE,n);var r="";(0,c.Iu)(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),ie(t,C,r,n),ie(t,k,(0,c.x3)().toString(),n);var i=function(e){for(var n=0;n<e.batches.length;n++){var t=e.batches[n].Msfpc();if(t)return encodeURIComponent(t)}return""}(e);if((0,s.yD)(i)&&(t.url+="&ext.intweb.msfpc="+i),I.shouldAddClockSkewHeaders()&&ie(t,P,I.getClockSkewHeaderValue(),n),p.getWParam){var a=p.getWParam();a>=0&&(t.url+="&w="+a)}for(var o=0;o<W.length;o++)t.url+="&"+W[o].name+"="+W[o].value;return t}(n,g);g=g||m.useHdrs;var K=(0,s.WB)();(0,a.r2)(p,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var h=0;h<n.batches.length;h++)for(var w=n.batches[h].events(),R=0;R<w.length;R++){var P=w[R];if(G){var k=P.timings=P.timings||{};pe(k,"sendEventStart",K),pe(k,"serializationStart",t),pe(k,"serializationCompleted",i)}P[V]>0?P[V]++:P[V]=1}be(n.batches,1e3+(o||0),n.sendType,!0);var C={data:n.payloadBlob,urlString:m.url,headers:m.hdrs,_thePayload:n,_sendReason:o,timeout:b};(0,c.b0)(B)||(C.disableXhrSync=!!B),g&&(re(C.headers,T)||(C.headers[T]="no-cache, no-store"),re(C.headers,E)||(C.headers[E]=S));var H=null;y&&(H=function(t){I.firstRequestSent();var i=function(t,i){!function(n,t,i,a){var o,u=9e3,l=null,d=!1,v=!1;try{var h=!0;if(typeof n!==q.bA){if(t){I.setClockSkew(t[_]);var p=t[x]||t["kill-duration-seconds"];(0,c.Iu)(M.setKillSwitchTenants(t["kill-tokens"],p),(function(e){(0,c.Iu)(i.batches,(function(n){if(n.iKey()===e){l=l||[];var t=n.split(0);i.numEvents-=t.count(),l.push(t)}}))}))}if(200==n||204==n)return void(u=200);((o=n)>=300&&o<500&&408!=o&&429!=o||501==o||505==o||i.numEvents<=0)&&(h=!1),u=9e3+n%1e3}if(h){u=100;var y=i.retryCnt;0===i.sendType&&(y<r?(d=!0,ge((function(){0===i.sendType&&z--,he(i.batches,y+1,i.isTeardown,j?2:i.sendType,5)}),j,U(y))):(v=!0,j&&(u=8001)))}}finally{d||(I.setClockSkew(),function(n,t,r,i){try{i&&f._backOffTransmission(),200===t&&(i||n.isSync||f._clearBackOff(),function(e){if(G){var n=(0,s.WB)();(0,c.Iu)(e,(function(e){e&&e.count()>0&&function(e,n){G&&(0,c.Iu)(e,(function(e){pe(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(n.batches)),be(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(z--,5!==r&&e.sendQueuedRequests(n.sendType,r))}}(i,u,a,v)),be(l,8004,i.sendType)}}(t,i,n,o)},a=n.isTeardown||n.isSync;try{y.sendPOST(t,i,a),e.sendListener&&e.sendListener(C,t,a,n.isBeacon)}catch(e){(0,d.OG)(v,"Unexpected exception sending payload. Ex:"+(0,l.mm)(e)),oe(i,0,{})}}),(0,a.r2)(p,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(H)if(0===n.sendType&&z++,u&&!n.isBeacon&&3!==y._transport){var t={data:C.data,urlString:C.urlString,headers:(0,s.X$)({},C.headers),timeout:C.timeout,disableXhrSync:C.disableXhrSync},r=!1;(0,a.r2)(p,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){r=!0,F||e._thePayload||(e._thePayload=e._thePayload||C._thePayload,e._sendReason=e._sendReason||C._sendReason),H(e)}),n.isSync||n.isTeardown)}catch(e){r||H(C)}}))}else H(C)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:i,sendReason:o}}),n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&be(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&be(n.failedEvts,8002,n.sendType)}function ge(e,n,t){n?e():u.set(e,t)}function me(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){(0,d.ZP)(v,1,519,"Response handler failed: "+e)}if(n){var i=JSON.parse(n);(0,s.yD)(i.webResult)&&(0,s.yD)(i.webResult[K])&&y.set("MSFPC",i.webResult[K],31536e3)}}catch(e){}}function be(e,n,t,r){if(e&&e.length>0&&o){var i=o[(c=n,l=J[c],(0,s.yD)(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l=m:c>=1e3&&c<=1999&&(l="send")),l)];if(i){var u=0!==t;(0,a.r2)(p,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){ge((function(){try{i.call(o,e,n,u,t)}catch(e){(0,d.ZP)(v,1,74,"send request notification failed: "+e)}}),r||u,0)}),(function(){return{batches:ve(e),reason:n,isSync:u,sendSync:r,sendType:t}}),!u)}}var c,l}e.initialize=function(e,n,t,r,a){var o;a||(a={}),H=e+H,Y=!!(0,c.b0)(a.avoidOptions)||!a.avoidOptions,p=n,y=n.getCookieMgr(),G=!p.config.disableEventTimings;var u=!!p.config.enableCompoundKey;v=(f=t).diagLog();var s=a.valueSanitizer,g=a.stringifyObjects;(0,c.b0)(a.enableCompoundKey)||(u=!!a.enableCompoundKey),b=a.xhrTimeout,B=a.disableXhrSync,A=!(0,l.lV)(),Q=new Z(p,s,g,u);var m=r,S=a.alwaysUseXhrOverride?r:null,T=a.alwaysUseXhrOverride?r:null;if(!r){F=!1;var E=(0,l.g$)();E&&E.protocol&&"file:"===E.protocol.toLowerCase()&&(i=!1);var x=[];x=(0,l.lV)()?[2,1]:[1,2,3];var _=a.transports;_&&((0,c.Et)(_)?x=[_].concat(x):(0,c.cy)(_)&&(x=_.concat(x))),r=D(x,!1),m=D(x,!0),r||(0,d.OG)(v,"No available transport to send events")}(o={})[0]=r,o[1]=m||D([1,2,3],!0),o[2]=S||D([3,2],!0)||m||D([1],!0),o[3]=T||D([2,3],!0)||m||D([1],!0),h=o},e._getDbgPlgTargets=function(){return[h[0],M,Q,h]},e.addQueryStringParameter=function(e,n){for(var t=0;t<W.length;t++)if(W[t].name===e)return void(W[t].value=n);W.push({name:e,value:n})},e.addHeader=function(e,n){N[e]=n},e.canSendRequest=function(){return le()&&I.allowRequestSending()},e.sendQueuedRequests=function(e,n){(0,c.b0)(e)&&(e=0),j&&(e=ce(e),n=2),de(X,e,0)&&he(fe(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!O&&0===z&&0===X.length},e.setUnloading=function(e){j=e},e.addBatch=function(e){if(e&&e.count()>0){if(M.isTenantKilled(e.iKey()))return!1;X.push(e)}return!0},e.teardown=function(){X.length>0&&he(fe(),0,!0,2,2)},e.pause=function(){O=!0},e.resume=function(){O=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&((0,c.hX)(n)&&(n=1),j&&(n=ce(n),t=2),he([e],0,!1,n,t||0))}}))}return e.__ieDyn=1,e}();function oe(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return setTimeout(e,n,t)}function ue(e){clearTimeout(e)}function se(e,n){return{set:e||oe,clear:n||ue}}var ce="eventsDiscarded",le="overrideInstrumentationKey",fe="maxEventRetryAttempts",de="maxUnloadEventRetryAttempts";const ve=function(e){function n(){var t,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.2.4";var v,g,m,b,S,T,E,x=!1,_=[],w=null,R=!1,P=0,k=500,C=0,H=1e4,K={},I=h,A=null,D=null,L=0,q=0,F={},W=-1,N=!0,X=!1,Q=6,G=2;return(0,i.A)(n,r,(function(e,n){function r(e){"beforeunload"!==(e||(0,l.zk)().event).type&&(X=!0,g.setUnloading(X)),ne(2,2)}function i(e){X=!1,g.setUnloading(X)}function Z(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext[M]&&delete e.ext[M],e.ext&&e.ext[O]&&e.ext[O].id&&delete e.ext[O].id,N&&(s.u9,e.ext=(0,c.hW)(e.ext),e.baseData&&(e.baseData=(0,c.hW)(e.baseData)),e.data&&(e.data=(0,c.hW)(e.data))),e.sync)if(L||R)e.latency=3,e.sync=!1;else if(g)return N&&(e=(0,c.hW)(e)),void g.sendSynchronousBatch(z.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,r=C,i=H;4===t&&(r=P,i=k);var a=!1;if(r<i)a=!ie(e,n);else{var o=1,u=20;4===t&&(o=4,u=1),a=!0,function(e,n,t,r){for(;t<=n;){var i=te(e,n,!0);if(i&&i.count()>0){var a=i.split(0,r),o=a.count();if(o>0)return 4===t?P-=o:C-=o,be(ce,[a],f.x.QueueFull),!0}t++}return oe(),!1}(e.iKey,e.latency,o,u)&&(a=!ie(e,n))}a&&me(ce,[e],f.x.QueueFull)}function j(e,n,t){var r=ue(e,n,t);return g.sendQueuedRequests(n,t),r}function V(){return C>0}function $(){if(W>=0&&ue(W,0,S)&&g.sendQueuedRequests(0,S),P>0&&!D&&!R){var e=K[I][2];e>=0&&(D=Y((function(){D=null,j(4,0,1),$()}),e))}var n=K[I][1];!A&&!w&&n>=0&&!R&&(V()?A=Y((function(){A=null,j(0===q?3:1,0,1),q++,q%=2,$()}),n):q=0)}function J(){t=null,x=!1,_=[],w=null,R=!1,P=0,k=500,C=0,H=1e4,K={},I=h,A=null,D=null,L=0,q=0,v=null,F={},m=void 0,b=0,W=-1,S=null,N=!0,X=!1,Q=6,G=2,T=null,E=se(),g=new ae(500,2,1,{requeue:ye,send:Se,sent:Te,drop:Ee,rspFail:xe,oth:_e},E),pe(),F[4]={batches:[],iKeyMap:{}},F[3]={batches:[],iKeyMap:{}},F[2]={batches:[],iKeyMap:{}},F[1]={batches:[],iKeyMap:{}},we()}function Y(e,n){0===n&&L&&(n=1);var t=1e3;return L&&(t=U(L-1)),E.set(e,n*t)}function ee(){return null!==A&&(E.clear(A),A=null,q=0,!0)}function ne(e,n){ee(),w&&(E.clear(w),w=null),R||j(1,e,n)}function te(e,n,t){var r=F[n];r||(r=F[n=1]);var i=r.iKeyMap[e];return!i&&t&&(i=z.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function re(n,t){g.canSendRequest()&&!L&&(m>0&&C>m&&(t=!0),t&&null==w&&e.flush(n,null,20))}function ie(e,n){N&&(e=(0,c.hW)(e));var t=e.latency,r=te(e.iKey,t,!0);return!!r.addEvent(e)&&(4!==t?(C++,n&&0===e.sendAttempt&&re(!e.sync,b>0&&r.count()>=b)):P++,!0)}function oe(){for(var e=0,n=0,t=function(t){var r=F[t];r&&r.batches&&(0,c.Iu)(r.batches,(function(r){4===t?e+=r.count():n+=r.count()}))},r=1;r<=4;r++)t(r);C=n,P=e}function ue(n,t,r){var i=!1,o=0===t;return!o||g.canSendRequest()?(0,a.r2)(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=4;t>=n;){var r=F[t];r&&r.batches&&r.batches.length>0&&((0,c.Iu)(r.batches,(function(n){g.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),4===t?P-=n.count():C-=n.count()})),r.batches=[],r.iKeyMap={}),t--}e.length>0&&me(ce,e,f.x.KillSwitch),i&&W>=n&&(W=-1,S=0)}),(function(){return{latency:n,sendType:t,sendReason:r}}),!o):(W=W>=0?Math.min(W,n):n,S=Math.max(S,r)),i}function ve(e,n){j(1,0,n),oe(),he((function(){e&&e(),_.length>0?w=Y((function(){w=null,ve(_.shift(),n)}),0):(w=null,$())}))}function he(e){g.isCompletelyIdle()?e():w=Y((function(){w=null,he(e)}),.25)}function pe(){(K={})[h]=[2,1,0],K[p]=[6,3,0],K[y]=[18,9,0]}function ye(n,t){var r=[],i=Q;X&&(i=G),(0,c.Iu)(n,(function(n){n&&n.count()>0&&(0,c.Iu)(n.events(),(function(n){n&&(n.sync&&(n.latency=4,n.sync=!1),n.sendAttempt<i?((0,s.u9)(n,e.identifier),Z(n,!1)):r.push(n))}))})),r.length>0&&me(ce,r,f.x.NonRetryableStatus),X&&ne(2,2)}function ge(n,t){var r=e._notificationManager||{},i=r[n];if(i)try{i.apply(r,t)}catch(t){(0,d.ZP)(e.diagLog(),1,74,n+" notification failed: "+t)}}function me(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&ge(e,[n].concat(t))}function be(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&(0,c.Iu)(n,(function(n){n&&n.count()>0&&ge(e,[n.events()].concat(t))}))}function Se(e,n,t){e&&e.length>0&&ge("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])}function Te(e,n){be("eventsSent",e,n),$()}function Ee(e,n){be(ce,e,n>=8e3&&n<=8999?n-8e3:f.x.Unknown)}function xe(e){be(ce,e,f.x.NonRetryableStatus),$()}function _e(e,n){be(ce,e,f.x.Unknown),$()}function we(){b=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,H/6)}J(),e._getDbgPlgTargets=function(){return[g]},e.initialize=function(l,f,d){(0,a.r2)(f,(function(){return"PostChannel:initialize"}),(function(){var a=f;n.initialize(l,f,d);try{f.addUnloadCb,T=(0,o.Hm)((0,u.Z)(e.identifier),f.evtNamespace&&f.evtNamespace());var h=e._getTelCtx();l.extensionConfig[e.identifier]=l.extensionConfig[e.identifier]||{},t=h.getExtCfg(e.identifier),E=se(t.setTimeoutOverride,t.clearTimeoutOverride),N=!t.disableOptimizeObj&&(0,s.F2)(),function(e){var n=e.getWParam;e.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|n()}}(a),t.eventsLimitInMem>0&&(H=t.eventsLimitInMem),t.immediateEventLimit>0&&(k=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(m=t.autoFlushEventsLimit),(0,c.Et)(t[fe])&&(Q=t[fe]),(0,c.Et)(t[de])&&(G=t[de]),we(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(v=t.httpXHROverride),(0,s.yD)(l.anonCookieName)&&g.addQueryStringParameter("anoncknm",l.anonCookieName),g.sendHook=t.payloadPreprocessor,g.sendListener=t.payloadListener;var p=t.overrideEndpointUrl?t.overrideEndpointUrl:l.endpointUrl;e._notificationManager=l.extensionConfig.NotificationManager,g.initialize(p,e.core,e,v,t);var y=l.disablePageUnloadEvents||[];(0,o.ee)(r,y,T),(0,o.Fc)(r,y,T),(0,o.oS)(i,l.disablePageShowEvents,T)}catch(n){throw e.setInitialized(!1),n}}),(function(){return{coreConfig:l,core:f,extensions:d}}))},e.processTelemetry=function(n,r){(0,s.u9)(n,e.identifier);var i=(r=e._getTelCtx(r)).getExtCfg(e.identifier),a=!!t.disableTelemetry;i&&(a=a||!!i.disableTelemetry);var o=n;a||x||(t[le]&&(o.iKey=t[le]),i&&i[le]&&(o.iKey=i[le]),Z(o,!0),X?ne(2,2):$()),e.processNext(o,r)},e._doTeardown=function(e,n){ne(2,2),x=!0,g.teardown(),(0,o.Ds)(null,T),(0,o.sq)(null,T),(0,o.vF)(null,T),J()},e.setEventQueueLimits=function(e,n){H=e>0?e:1e4,m=n>0?n:0,we();var t=C>e;if(!t&&b>0)for(var r=1;!t&&r<=3;r++){var i=F[r];i&&i.batches&&(0,c.Iu)(i.batches,(function(e){e&&e.count()>=b&&(t=!0)}))}re(!0,t)},e.pause=function(){ee(),R=!0,g.pause()},e.resume=function(){R=!1,g.resume(),$()},e.addResponseHandler=function(e){g._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){ee(),pe(),I=h,$(),(0,c.z)(e,(function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),K[e]=n}}))},e.flush=function(e,n,t){if(void 0===e&&(e=!0),!R)if(t=t||1,e)null==w?(ee(),ue(1,0,t),w=Y((function(){w=null,ve(n,t)}),0)):_.push(n);else{var r=ee();j(1,1,t),null!=n&&n(),r&&$()}},e.setMsaAuthTicket=function(e){g.addHeader(B,e)},e.hasEvents=V,e._setTransmitProfile=function(e){I!==e&&void 0!==K[e]&&(ee(),I=e,$())},e._backOffTransmission=function(){L<4&&(L++,ee(),$())},e._clearBackOff=function(){L&&(L=0,ee(),$())},(0,c.r)(e,"_setTimeoutOverride",(function(){return E.set}),(function(e){E=se(e,E.clear)})),(0,c.r)(e,"_clearTimeoutOverride",(function(){return E.clear}),(function(e){E=se(E.set,e)}))})),r}return(0,r.qU)(n,e),n.__ieDyn=1,n}(v.s)}};