"use strict";(self.webpackChunkcollection_runner=self.webpackChunkcollection_runner||[]).push([[1994],{98283:(e,a,t)=>{function r(e,a){if(null==e)return{};var t,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],a.indexOf(t)>=0||(n[t]=e[t]);return n}t.d(a,{Z:()=>r})},11994:(e,a,t)=>{function r(){return"package-service"}t.r(a),t.d(a,{ALLOWED_PROPS_FOR_TEXT:()=>te,PackageRegistry:()=>n,PackageSelectDropdown:()=>Ne,PackageService:()=>r,SearchExternalPackageRegistryFilter:()=>i,getScriptQuery:()=>R,isValidConfig:()=>re,searchExternalPackagesQuery:()=>j,useCreatePackage:()=>P,useDeletePackage:()=>E,useIsExternalPackageEnabled:()=>N,useIsPackageEnabled:()=>le,usePackage:()=>g,usePackages:()=>y,usePackagesWithGlobalName:()=>w,usePlanFeatures:()=>W,usePlanUsageData:()=>se,useResourceUsage:()=>B,useScript:()=>U,useSearchExternalPackages:()=>C,useTemplateMessages:()=>ie,useUpdatePackage:()=>T,useUpdateScript:()=>q});let n=function(e){return e.NPM="npm",e.JSR="jsr",e.POSTMAN="postman",e}({}),i=function(e){return e.NPM="npm",e.JSR="jsr",e.ALL="npm,jsr",e}({});var s=t(97201),o=t(45860),l=t(26663),c=t.n(l);const u="package-library-service",d="packages",p="package",g=({packageId:e})=>(0,s.useDataFetch)((e=>({queryKey:[p,e],queryFn:({signal:a})=>(async({packageId:e,signal:a})=>(await o.postmanGateway.get({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:`/packages/${e}`,signal:a})).data)({packageId:e,signal:a}),enabled:!!e,useErrorBoundary:!1}))(e));var m=t(7560);const h=({cursor:e,isDeleted:a})=>({queryKey:[d],queryFn:({signal:t})=>(async({cursor:e,isDeleted:a=!1,signal:t})=>(await o.postmanGateway.get({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:"/packages",query:(0,m.Z)({},e&&{cursor:e},{isDeleted:a.toString()}),signal:t})).data)({signal:t,cursor:e,isDeleted:a}),useErrorBoundary:!1}),y=({cursor:e,isDeleted:a})=>(0,s.useDataFetch)(h({cursor:e,isDeleted:a}));var v=t(98283),f=t(40540),k=t(16669);const b=["data"],w=()=>{const{data:e,isLoading:a}=(0,k.useTeamsByUserId)(),t=y({isDeleted:!1}),{data:r}=t,n=(0,v.Z)(t,b),i=a=>{var t;const r=null==e||null==(t=e.organizations[0])?void 0:t.domain;return r?["@"+r,a].join("/"):a},s=(0,f.useMemo)((()=>(null==r?void 0:r.map((e=>(0,m.Z)({},e,{globalName:i(e.name)}))))||[]),[a,n.isLoading]),o=(0,f.useMemo)((()=>{const e=new Map;if(null!=s&&s.length)for(const a of s)e.set(a.globalName,a.id);return e}),[s]);return(0,m.Z)({data:s,globalNameToIdMap:o},n)};var I=t(88749);const _="reusable_packages",L="/messages/packages/defaults/limits.json",x={thresholds:{notifyLimit:null,hardLimit:null,softLimit:null},templatePath:L},P=()=>(0,s.useMutation)({mutationFn:({workspaceId:e,requestBody:a,signal:t})=>(async({workspaceId:e,requestBody:a,signal:t})=>await o.postmanGateway.post({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:"/packages",query:{workspace:e},data:{body:a},signal:t}))({workspaceId:e,requestBody:a,signal:t}),onSettled:(e,a)=>{const t=h({isDeleted:!1}).queryKey;(0,s.updateCache)({key:t,updater:a=>a&&null!=e&&e.data?[e.data,...a]:a}),(0,s.invalidateCache)(t),(0,s.invalidateCache)((0,I.getUsageForOperation)({operation:_}).queryKey)}}),T=()=>(0,s.useMutation)({mutationFn:({packageId:e,patches:a,signal:t})=>(async({packageId:e,patches:a,signal:t})=>await o.postmanGateway.patch({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:`/packages/${e}`,data:{body:a},signal:t}))({packageId:e,patches:a,signal:t}),onSettled:(e,a,t)=>{(0,s.invalidateCache)([d]),(0,s.invalidateCache)([p,t.packageId])}}),E=()=>{const e=(0,s.useCacheClient)();return(0,s.useMutation)({mutationFn:({packageId:e,signal:a})=>(async({packageId:e,signal:a})=>await o.postmanGateway.delete({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:`/packages/${e}`,signal:a}))({packageId:e,signal:a}),onSuccess:(e,a)=>{(0,s.updateCache)({key:h({isDeleted:!1}).queryKey,updater:e=>e?e.filter((e=>e.id!==a.packageId)):e})},onSettled:(a,t,r)=>{(0,s.invalidateCache)([d]),(0,s.invalidateCache)((0,I.getUsageForOperation)({operation:_}).queryKey),e.removeQueries([p,r.packageId])}})},S=5,j=({query:e="",registry:a=i.ALL,limit:t=5,authToken:r})=>({queryKey:["external-packages",e,a,t],queryFn:()=>async function(e,a){const{query:t="",registry:r=i.ALL,limit:n=S}=e;try{const e=new URLSearchParams({query:t,registry:r,limit:n.toString()}),i=`${c().PACKMAN_SERVICE_URL}/v1/search?${e.toString()}`,s=await fetch(i,{headers:{Authorization:`Bearer ${a}`}});if(!s.ok)throw new Error(`Failed to fetch package details, status: ${s.status}`);return(await s.json()).data}catch(e){if(e instanceof Error&&"AbortError"===e.name)return[];throw e}}({query:e,registry:a,limit:t},r),staleTime:6e4,useErrorBoundary:!1,enabled:!!r}),C=({query:e="",registry:a=i.ALL,limit:t=5,authToken:r})=>(0,s.useDataFetch)(j({query:e,registry:a,limit:t,authToken:r}));var A=t(24568);const N=()=>{const{value:e}=(0,A.useFeatureFlag)({flagName:"enable-npm-scripts"});return{isEnabled:e}},R=(e,a)=>({queryKey:[p,e,"script",a],queryFn:({signal:t})=>(async({packageId:e,scriptId:a,signal:t})=>(await o.postmanGateway.get({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:`/packages/${e}/scripts/${a}?include=contents`,signal:t})).data)({packageId:e,scriptId:a,signal:t}),enabled:!!e&&!!a,useErrorBoundary:!1}),U=({packageId:e,scriptId:a})=>(0,s.useDataFetch)(R(e,a)),q=()=>(0,s.useMutation)({mutationFn:({packageId:e,scriptId:a,patches:t,signal:r})=>(async({packageId:e,scriptId:a,patches:t,signal:r})=>await o.postmanGateway.patch({service:u,url:`${c().HTTPS_GATEWAY_PRIVATE_URL}/ws/proxy`,path:`/packages/${e}/scripts/${a}`,data:{body:t},signal:r}))({packageId:e,scriptId:a,patches:t,signal:r}),onSuccess:(e,a)=>{const t=R(a.packageId,a.scriptId).queryKey;(0,s.updateCache)({key:t,updater:a=>a&&null!=e&&e.data?(0,m.Z)({},a,{contents:e.data.contents}):a}),(0,s.invalidateCache)(t)}});var D=t(13101);function M(e){const a={};for(const t in e)e.hasOwnProperty(t)&&(a[e[t]]=t);return a}const F=e=>{var a;return null!==(null==e||null==(a=e.thresholds)?void 0:a.softLimit)},Z=(e,a)=>{var t,r;if(F(e))return null===(null==e||null==(t=e.thresholds)?void 0:t.hardLimit)?null==a?void 0:a.limit:null==e||null==(r=e.thresholds)?void 0:r.hardLimit},O=(e,a)=>{var t,r;return void 0!==(null==e||null==(t=e.thresholds)?void 0:t.softLimit)?null==e||null==(r=e.thresholds)?void 0:r.softLimit:null==a?void 0:a.limit},$=(e,a)=>(0,m.Z)({},"object"==typeof(null==e?void 0:e.thresholds)?e.thresholds:{},{softLimit:O(e,a)}),G=(e,a)=>{if(!F(e)||void 0===V(a))return;const t=M($(e,a)),r=Object.keys(t).map(Number).sort();return Math.max(...r.filter((e=>e<=V(a))))},V=e=>{if(e)return e.usage+e.spillage},W=()=>{var e;const a=(0,D.getUserId)(),{data:t,isLoading:r,isError:n}=(0,I.useGetPlanFeatures)(a),i=(e=>{let a=null==e?void 0:e.packages_usage_limit.value;if("string"==typeof a)try{a=JSON.parse(a)}catch(e){console.error("Error parsing plan features",e)}return a})(null==t||null==(e=t.data)?void 0:e.features);return{planFeatures:n?x:i,isLoading:r,isError:n}},B=()=>{const{data:e,isLoading:a,isError:t}=(0,I.useGetOperationUsage)(_);return{resourceUsage:null==e?void 0:e.operation,isLoading:a,isError:t}},Y={library:{indicator:{notifyLimit:{type:"banner",title:"{{currentUsage}}/{{softLimit}} packages created",value:[{type:"text",value:" To increase the number of packages you can create, "},{type:"link",variation:"link-default",to:"{{artemisUrl}}/purchase",value:"upgrade plan",analytics:{action:"upgrade",label:"manual_run_soft_limit",value:"{{planName}}"},target:"_blank"},{type:"text",value:". Learn more about "},{type:"link",variation:"link-default",to:"https://go.pstmn.io/package-library-limits",value:"package limits",analytics:{action:"learn_more",label:"packages_soft_limit"},target:"_blank",isExternal:!0}]},softLimit:{type:"banner",status:"warning",title:"{{currentUsage}}/{{softLimit}} packages created",value:[{type:"text",value:" To increase the number of packages you can create, "},{type:"link",variation:"link-default",to:"{{artemisUrl}}/purchase",value:"upgrade plan",analytics:{action:"upgrade",label:"manual_run_soft_limit",value:"{{planName}}"},target:"_blank"},{type:"text",value:". Learn more about "},{type:"link",variation:"link-default",to:"https://go.pstmn.io/package-library-limits",value:"package limits",analytics:{action:"learn_more",label:"packages_soft_limit"},target:"_blank",isExternal:!0}]},hardLimit:{type:"banner",status:"error",title:"{{currentUsage}}/{{softLimit}} packages created",value:[{type:"text",value:" To continue creating packages, "},{type:"link",variation:"link-default",to:"{{artemisUrl}}/purchase",value:"upgrade plan",analytics:{action:"upgrade",label:"manual_run_soft_limit",value:"{{planName}}"},target:"_blank"},{type:"text",value:". Learn more about "},{type:"link",variation:"link-default",to:"https://go.pstmn.io/package-library-limits",value:"package limits",analytics:{action:"learn_more",label:"packages_soft_limit"},target:"_blank",isExternal:!0}]}}},buttons:{createPackage:{tooltip:{hardLimit:"You have reached the limit of {{softLimit}} packages. To continue creating packages, upgrade your plan."}}}},K=/^[\w !$%&'()*,./:=?{|}~-]+$/,H=new Set(["content-color-primary","content-color-secondary","content-color-tertiary","content-color-brand","content-color-info","content-color-error","content-color-warning","content-color-success","content-color-constant","content-color-link"]),z=new Set(["para","lead","small","strong","code","kbd","link-default","link-primary","link-button","link-button-primary","link-button-outline","link-subtle","body-small","body-medium","body-large"]),J=new Set(["primary","secondary","tertiary","plain","monochrome-plain","muted-plain"]),Q=new Set(["h1","h2","h3","h4","h5","h6"]),X=new Set(["text","heading"]),ee=new Set(["button","link"]),ae=new Set(["blue","purple","yellow","green","pink","teal","orange"]),te=["color","isExternal"];function re(e){var a,t;if(!e||"object"!=typeof e)return!1;const r=e.hideIcon&&"boolean"!=typeof e.hideIcon,n=e.status&&!["success","info","warning","error"].includes(e.status),i=e.title&&"string"!=typeof e.title&&!K.test(e.title),s=e.value&&"string"==typeof e.value&&!K.test(e.value),o=e.color&&!H.has(e.color),l=e.variation&&!z.has(e.variation),c=e.isExternal&&"boolean"!=typeof e.isExternal,u=!(null!=e&&null!=(a=e.value)&&a.every((e=>X.has(e.type)))),d=!(null!=e&&null!=(t=e.actions)&&t.every((e=>ee.has(e.type)))),p=(null==e?void 0:e.trigger)&&!re(e.trigger),g=(null==e?void 0:e.actions)&&!ne(null==e?void 0:e.actions),m=e.color&&!ae.has(e.color),h=e.value&&"string"==typeof e.value&&!K.test(e.value);switch(null==e?void 0:e.type){case"banner":return!(r||n||i||s)&&ne(null==e?void 0:e.value);case"text":return!(o||l||c)&&ne(null==e?void 0:e.value);case"popover":return!(d||u||p||g)&&ne(null==e?void 0:e.value);case"tag":return!m&&!h&&K.test(e.value);default:return!1}}function ne(e){if(!e||"object"!=typeof e)return!1;if(Array.isArray(e))return e.every((e=>ne(e)));const a=e.color&&!H.has(e.color),t=e.variation&&!z.has(e.variation),r=e.variation&&!z.has(e.variation),n=e.target&&"_blank"!==e.target,i=e.action&&!K.test(e.action),s=e.label&&!K.test(e.label),o=e.to&&"string"!=typeof e.to,l=e.variation&&!z.has(e.variation),c=!e.action||"string"!=typeof e.action,u=e.variation&&!J.has(e.variation),d=e.variation&&!Q.has(e.variation),p="string"!=typeof e.value;switch(null==e?void 0:e.type){case"text":return!(a||t||r)&&(Array.isArray(e.value)?e.value.every((e=>ne(e))):K.test(e.value));case"link":return!(n||i||s||o||l)&&K.test(e.value);case"button":return!c&&!u&&K.test(e.value)&&K.test(e.action);case"heading":return!d&&!p&&K.test(e.value);default:return!1}}const ie=e=>{var a,t,r;const{data:n,isLoading:i,isError:s,isRefetching:o,refetch:l}=(0,I.useGetTemplateMessages)(e);if(null!=n&&null!=(a=n.library)&&a.indicator&&"object"==typeof n.library.indicator){const e=n.library.indicator;for(const a of Object.values(e))if(!re(a))return{messageTemplates:Y,isLoading:i,isError:s,isRefetching:o,refetch:l}}if(null!=n&&null!=(t=n.buttons)&&t.createPackage&&"object"==typeof(null==n||null==(r=n.buttons)?void 0:r.createPackage)){const e=n.buttons.createPackage;for(const a of Object.values(e))if(!re(a))return{messageTemplates:Y,isLoading:i,isError:s,isRefetching:o,refetch:l}}return{messageTemplates:s?Y:n,isLoading:i,isError:s,isRefetching:o,refetch:l}},se=()=>{var e;const{planFeatures:a}=W(),{resourceUsage:t}=B(),{messageTemplates:r}=ie((null==a?void 0:a.templatePath)||L),n=(0,f.useMemo)((()=>((e,a)=>{const t=G(e,a);if(!t)return;const r=M($(e,a));return null==r?void 0:r[t]})(a,t)),[a,t]),i=null==r?void 0:r.library.indicator,s=null==i?void 0:i[n],o=(0,f.useMemo)((()=>((e,a)=>{const t=$(e,a),r=Z(e,a),n=V(a),i=O(e,a),s=G(e,a),o=(0,m.Z)({currentUsage:n,usageLimit:r,softLimit:i,applicableMessageThreshold:G(e,a)},"object"==typeof t?t:{},{artemisUrl:c().ARTEMIS_URL,planName:"planname"});Number.isInteger(r)&&Number.isInteger(n)&&0!==r&&Object.assign(o,{remainingLimit:r-n,remainingLimitPercentage:Math.ceil(100-n/r*100),hardLimitPercentUsed:Math.ceil(n/r*100)});const l=r-i;return Number.isInteger(r)&&Number.isInteger(i)&&Object.assign(o,{additionalLimit:l}),Number.isInteger(n)&&Number.isInteger(i)&&0!==i&&Object.assign(o,{additionalLimitUsed:n-i,remainingSoftLimit:i-n,remainingSoftLimitPercentage:Math.ceil(100-n/i*100),softLimitPercentUsed:Math.ceil(n/i*100)}),Number.isInteger(n)&&Number.isInteger(i)&&0!==l&&Number.isInteger(l)&&Object.assign(o,{additionalLimitRemaining:r-n,additionalLimitPercentageUsed:Math.ceil(100*(n-i)/l)}),Number.isInteger(s)&&Number.isInteger(n)&&Object.assign(o,{notificationThresholdPercentReached:Math.ceil(n/s*100)}),o})(a,t)),[a,t]),l=((e,a)=>{var t;const r=Z(e,a),n=V(a);return!(!F(e)||!r||void 0===n)&&null!==(null==e||null==(t=e.thresholds)?void 0:t.hardLimit)&&n>=r})(a,t);return{planLimitMessageConfig:s,configTemplateVariables:o,isHardLimitReached:l,createNewPackageButtonTooltip:l?null==r||null==(e=r.buttons)||null==(e=e.createPackage)||null==(e=e.tooltip)?void 0:e.hardLimit:""}};var oe=t(10099);const le=()=>{const{planFeatures:e,isLoading:a,isError:t}=W(),{data:r}=(0,oe.useActiveWorkspaceInfo)(),n=null==r?void 0:r.visibilityStatus;return{isEnabled:(0,f.useMemo)((()=>!(!n||a||t)&&!![oe.VISIBILITY_STATUS.personal,oe.VISIBILITY_STATUS.team,oe.VISIBILITY_STATUS.private,""].includes(n)&&(null==e?void 0:e.isEnabled)),[n,a,t,null==e?void 0:e.isEnabled])}};var ce=t(59530),ue=t.n(ce),de=t(56415),pe=t(20856),ge=t(58560),me=t(38053),he=t(56880),ye=t(52385),ve=t(35736),fe=t(63622),ke=t(80429),be=t(52322);const we=ue()(ge.Z).withConfig({displayName:"package-list__DropDownList",componentId:"sc-4d38fe-0"})(["max-height:200px;overflow-y:auto;scrollbar-width:none;-ms-overflow-style:none;&::-webkit-scrollbar{display:none;}"]),Ie=ue().div.withConfig({displayName:"package-list__DropDownListItem",componentId:"sc-4d38fe-1"})(["display:flex;align-items:center;padding-right:var(--spacing-xs);border-radius:var(--border-radius-default);&:hover{background:var(--highlight-background-color-primary);cursor:pointer;}",""],(({disabled:e})=>e&&"\n    &:hover {\n      background: var(--background-color-primary);\n      cursor: not-allowed;\n    }\n  ")),_e=ue().div.withConfig({displayName:"package-list__DropDownEmptyState",componentId:"sc-4d38fe-2"})(["padding:var(--spacing-xs) var(--spacing-m);"]),Le=ue()(ge.Z).withConfig({displayName:"package-list__IconContainer",componentId:"sc-4d38fe-3"})(["height:28px;width:28px;"]),xe=ue().div.withConfig({displayName:"package-list__CustomMenuError",componentId:"sc-4d38fe-4"})(["display:flex;padding:var(--spacing-xs) var(--spacing-s);"]),Pe=ue()(ge.Z).withConfig({displayName:"package-list__CustomMenuLoader",componentId:"sc-4d38fe-5"})(["height:120px;"]),Te=({packages:e,parsedPackagesId:a,searchTerm:t,isLoadingPackages:r,isError:n,refetch:i,handleAddPackages:s})=>{if(r)return(0,be.jsx)(Pe,{justifyContent:"center",alignItems:"center",children:(0,be.jsx)(ve.Z,{description:"Loading packages"})});if(n)return(0,be.jsx)(xe,{children:(0,be.jsxs)(fe.ZP,{children:["Error loading packages",(0,be.jsx)("span",{style:{marginLeft:"var(--spacing-xs)"},children:(0,be.jsx)(ke.Z,{type:"monochrome-plain",text:"retry.",onClick:i})})]})});if(!e||0===e.length)return(0,be.jsx)(_e,{children:(0,be.jsx)(fe.ZP,{color:"content-color-tertiary",children:"No packages found."})});const o=(null==e?void 0:e.filter((e=>{var a;return!t||(null==(a=e.name)?void 0:a.toLowerCase().includes(t.toLowerCase()))})))||[],l=[],c=[];for(const e of o)a.includes(e.id)?l.push(e):c.push(e);return 0===l.length&&0===c.length?(0,be.jsx)(_e,{children:(0,be.jsx)(fe.ZP,{color:"content-color-tertiary",children:"No packages found."})}):(0,be.jsxs)(we,{direction:"column",children:[l.map((({id:e,name:a})=>(0,be.jsxs)(Ie,{disabled:!0,"data-testid":"package-select-dropdown-item",children:[(0,be.jsx)(Le,{alignItems:"center",justifyContent:"center",children:(0,be.jsx)(ye.Z,{color:"content-color-tertiary"})}),(0,be.jsx)(fe.ZP,{color:"content-color-tertiary",isTruncated:!0,tooltip:a,children:a})]},e))),c.map((({id:e,name:a,globalName:t})=>(0,be.jsxs)(Ie,{"data-testid":"package-select-dropdown-item",onClick:()=>{he.AnalyticsService.addEventV2({category:"package_library",action:"use_existing_package",entityType:"package",variantId:"ide"}),s(a,t)},children:[(0,be.jsx)(Le,{alignItems:"center",justifyContent:"center"}),(0,be.jsx)(fe.ZP,{isTruncated:!0,tooltip:a,children:a})]},e)))]})},Ee=ue()(pe.ZP).withConfig({displayName:"package-select-dropdown__CustomDropDownWrapper",componentId:"sc-1sqoarw-0"})(["width:",";transform:translate(var(--border-width-default));background:var(--background-color-primary);border-radius:var(--border-radius-default);border:solid var(--border-width-default) var(--border-color-strong);.tippy-content{background:var(--background-color-primary);border-radius:var(--border-radius-s);}"],(e=>e.popoverWidth||"120px")),Se=ue()(ge.Z).withConfig({displayName:"package-select-dropdown__CustomDropDownTrigger",componentId:"sc-1sqoarw-1"})(["background:var(--background-color-primary);border:solid var(--border-width-default) var(--content-color-tertiary);border-radius:var(--border-radius-default);padding:var(--spacing-xs) var(--spacing-s);padding-right:0;height:32px;margin-right:1px;margin-left:1px;width:248px;&:focus-within{box-shadow:0 0 0 1px var(--input-border-color-focus);}"]),je=ue().input.withConfig({displayName:"package-select-dropdown__CustomDropDownInput",componentId:"sc-1sqoarw-2"})(["width:100%;background:var(--background-color-primary);border:none;color:var(--content-color-primary);&::placeholder{color:var(--content-color-tertiary);}"]),Ce=ue().div.withConfig({displayName:"package-select-dropdown__StyledInputContainer",componentId:"sc-1sqoarw-3"})(["display:flex;flex-grow:1;"]),Ae=ue().div.withConfig({displayName:"package-select-dropdown__StyledIconContainer",componentId:"sc-1sqoarw-4"})(["width:var(--size-m);height:var(--size-m);display:flex;align-items:center;justify-content:center;cursor:pointer;"]),Ne=({parsedPackagesId:e,handleAddPackages:a})=>{const[t,r]=(0,f.useState)(!1),[n,i]=(0,f.useState)(""),{data:s,isLoading:o,isError:l,refetch:c}=(0,me.usePackagesWithGlobalName)(),u=(0,f.useRef)(null),d=(0,f.useRef)(null),p=(0,f.useRef)(null);return(0,f.useLayoutEffect)((()=>{let e;const a=()=>{if(u.current){const e=u.current.getBoundingClientRect();p.current&&(e.top!==p.current.top||e.left!==p.current.left)&&r(!1),p.current=e}e=requestAnimationFrame(a)};return a(),()=>{cancelAnimationFrame(e)}}),[]),(0,be.jsx)(Ee,{isOpen:t,onClickOutside:()=>r(!1),popoverWidth:null!=u&&u.current?`${u.current.offsetWidth}px`:null,trigger:(0,be.jsxs)(Se,{justifyContent:"space-between",alignItems:"center",ref:u,"data-testid":"package-select-dropdown-trigger",children:[(0,be.jsx)(Ce,{onClick:()=>{he.AnalyticsService.addEventV2({category:"package_library",action:"find_and_use_pkgs",variantId:"ide"}),r(!0)},children:(0,be.jsx)(je,{value:n,onChange:e=>(e=>{i(e)})(e.target.value),placeholder:"Find & use packages",ref:d})}),(0,be.jsx)(Ae,{onClick:()=>{var e;r(!t),null==(e=d.current)||e.focus()},children:(0,be.jsx)(de.Z,{})})]}),children:(0,be.jsx)(Te,{packages:s||[],parsedPackagesId:e,searchTerm:n,isLoadingPackages:o,isError:l,refetch:c,handleAddPackages:a})})}}}]);
//# sourceMappingURL=1994.fee090332a8e8846.js.map