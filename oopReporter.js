"use strict";var se=Object.create;var m=Object.defineProperty;var ne=Object.getOwnPropertyDescriptor;var ie=Object.getOwnPropertyNames;var oe=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var g=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),pe=(r,e)=>{for(var t in e)m(r,t,{get:e[t],enumerable:!0})},C=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of ie(e))!ae.call(r,n)&&n!==t&&m(r,n,{get:()=>e[n],enumerable:!(s=ne(e,n))||s.enumerable});return r};var y=(r,e,t)=>(t=r!=null?se(oe(r)):{},C(e||!r||!r.__esModule?m(t,"default",{value:r,enumerable:!0}):t,r)),ue=r=>C(m({},"__esModule",{value:!0}),r);var j=g(c=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});c.sync=c.isexe=void 0;var le=require("fs"),ce=require("fs/promises"),de=async(r,e={})=>{let{ignoreErrors:t=!1}=e;try{return O(await(0,ce.stat)(r),e)}catch(s){let n=s;if(t||n.code==="EACCES")return!1;throw n}};c.isexe=de;var he=(r,e={})=>{let{ignoreErrors:t=!1}=e;try{return O((0,le.statSync)(r),e)}catch(s){let n=s;if(t||n.code==="EACCES")return!1;throw n}};c.sync=he;var O=(r,e)=>r.isFile()&&ge(r,e),ge=(r,e)=>{var x,E,b,w,P,R,I,J;let t=(E=e.uid)!=null?E:(x=process.getuid)==null?void 0:x.call(process),s=(P=(w=e.groups)!=null?w:(b=process.getgroups)==null?void 0:b.call(process))!=null?P:[],n=(J=(I=e.gid)!=null?I:(R=process.getgid)==null?void 0:R.call(process))!=null?J:s[0];if(t===void 0||n===void 0)throw new Error("cannot get uid or gid");let i=new Set([n,...s]),a=r.mode,l=r.uid,h=r.gid,p=parseInt("100",8),T=parseInt("010",8),te=parseInt("001",8),re=p|T;return!!(a&te||a&T&&i.has(h)||a&p&&l===t||a&re&&t===0)}});var L=g(d=>{"use strict";Object.defineProperty(d,"__esModule",{value:!0});d.sync=d.isexe=void 0;var fe=require("fs"),Te=require("fs/promises"),me=async(r,e={})=>{let{ignoreErrors:t=!1}=e;try{return M(await(0,Te.stat)(r),r,e)}catch(s){let n=s;if(t||n.code==="EACCES")return!1;throw n}};d.isexe=me;var _e=(r,e={})=>{let{ignoreErrors:t=!1}=e;try{return M((0,fe.statSync)(r),r,e)}catch(s){let n=s;if(t||n.code==="EACCES")return!1;throw n}};d.sync=_e;var ye=(r,e)=>{let{pathExt:t=process.env.PATHEXT||""}=e,s=t.split(";");if(s.indexOf("")!==-1)return!0;for(let n=0;n<s.length;n++){let i=s[n].toLowerCase(),a=r.substring(r.length-i.length).toLowerCase();if(i&&a===i)return!0}return!1},M=(r,e,t)=>r.isFile()&&ye(e,t)});var B=g(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0})});var q=g(o=>{"use strict";var D=o&&o.__createBinding||(Object.create?function(r,e,t,s){s===void 0&&(s=t);var n=Object.getOwnPropertyDescriptor(e,t);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,s,n)}:function(r,e,t,s){s===void 0&&(s=t),r[s]=e[t]}),ve=o&&o.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),k=o&&o.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&D(e,r,t);return ve(e,r),e},Se=o&&o.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&D(e,r,t)};Object.defineProperty(o,"__esModule",{value:!0});o.sync=o.isexe=o.posix=o.win32=void 0;var A=k(j());o.posix=A;var z=k(L());o.win32=z;Se(B(),o);var xe=process.env._ISEXE_TEST_PLATFORM_||process.platform,N=xe==="win32"?z:A;o.isexe=N.isexe;o.sync=N.sync});var Q=g((De,K)=>{var{isexe:Ee,sync:be}=q(),{join:we,delimiter:Pe,sep:$,posix:V}=require("path"),H=process.platform==="win32",U=new RegExp(`[${V.sep}${$===V.sep?"":$}]`.replace(/(\\)/g,"\\$1")),Re=new RegExp(`^\\.${U.source}`),W=r=>Object.assign(new Error(`not found: ${r}`),{code:"ENOENT"}),G=(r,{path:e=process.env.PATH,pathExt:t=process.env.PATHEXT,delimiter:s=Pe})=>{let n=r.match(U)?[""]:[...H?[process.cwd()]:[],...(e||"").split(s)];if(H){let i=t||[".EXE",".CMD",".BAT",".COM"].join(s),a=i.split(s).flatMap(l=>[l,l.toLowerCase()]);return r.includes(".")&&a[0]!==""&&a.unshift(""),{pathEnv:n,pathExt:a,pathExtExe:i}}return{pathEnv:n,pathExt:[""]}},X=(r,e)=>{let t=/^".*"$/.test(r)?r.slice(1,-1):r;return(!t&&Re.test(e)?e.slice(0,2):"")+we(t,e)},Z=async(r,e={})=>{let{pathEnv:t,pathExt:s,pathExtExe:n}=G(r,e),i=[];for(let a of t){let l=X(a,r);for(let h of s){let p=l+h;if(await Ee(p,{pathExt:n,ignoreErrors:!0})){if(!e.all)return p;i.push(p)}}}if(e.all&&i.length)return i;if(e.nothrow)return null;throw W(r)},Ie=(r,e={})=>{let{pathEnv:t,pathExt:s,pathExtExe:n}=G(r,e),i=[];for(let a of t){let l=X(a,r);for(let h of s){let p=l+h;if(be(p,{pathExt:n,ignoreErrors:!0})){if(!e.all)return p;i.push(p)}}}if(e.all&&i.length)return i;if(e.nothrow)return null;throw W(r)};K.exports=Z;Z.sync=Ie});var Oe={};pe(Oe,{default:()=>Ce});module.exports=ue(Oe);var ee=y(require("path"));var Y=y(require("crypto"));var Je=y(Q());function v(){return Y.default.randomBytes(16).toString("hex")}var ke=new RegExp("([\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:[a-zA-Z\\d]*(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)|(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~])))","g");var Ae=process.platform==="win32"?";":":";var Ne={forbidOnly:!1,fullyParallel:!1,globalSetup:null,globalTeardown:null,globalTimeout:0,grep:/.*/,grepInvert:null,maxFailures:0,metadata:{},preserveOutput:"always",projects:[],reporter:[[process.env.CI?"dot":"list"]],reportSlowTests:{max:5,threshold:15e3},configFile:"",rootDir:"",quiet:!1,shard:null,updateSnapshots:"missing",version:"",workers:0,webServer:null};function f(r){return Array.isArray(r)||(r=[r]),r.map(e=>typeof e=="string"?{s:e}:{r:{source:e.source,flags:e.flags}})}var _=class{constructor(e,t={}){this._messageSink=e,this._emitterOptions=t}version(){return"v2"}onConfigure(e){this._rootDir=e.rootDir,this._messageSink({method:"onConfigure",params:{config:this._serializeConfig(e)}})}onBegin(e){let t=e.suites.map(s=>this._serializeProject(s));for(let s of t)this._messageSink({method:"onProject",params:{project:s}});this._messageSink({method:"onBegin",params:void 0})}onTestBegin(e,t){t[u]=v(),this._messageSink({method:"onTestBegin",params:{testId:e.id,result:this._serializeResultStart(t)}})}onTestEnd(e,t){let s={testId:e.id,expectedStatus:e.expectedStatus,annotations:e.annotations,timeout:e.timeout};this._messageSink({method:"onTestEnd",params:{test:s,result:this._serializeResultEnd(t)}})}onStepBegin(e,t,s){s[u]=v(),this._messageSink({method:"onStepBegin",params:{testId:e.id,resultId:t[u],step:this._serializeStepStart(s)}})}onStepEnd(e,t,s){this._messageSink({method:"onStepEnd",params:{testId:e.id,resultId:t[u],step:this._serializeStepEnd(s)}})}onError(e){this._messageSink({method:"onError",params:{error:e}})}onStdOut(e,t,s){this._onStdIO("stdout",e,t,s)}onStdErr(e,t,s){this._onStdIO("stderr",e,t,s)}_onStdIO(e,t,s,n){if(this._emitterOptions.omitOutput)return;let i=typeof t!="string",a=i?t.toString("base64"):t;this._messageSink({method:"onStdIO",params:{testId:s==null?void 0:s.id,resultId:n?n[u]:void 0,type:e,data:a,isBase64:i}})}async onEnd(e){let t={status:e.status,startTime:e.startTime.getTime(),duration:e.duration};this._messageSink({method:"onEnd",params:{result:t}})}async onExit(){}printsToStdio(){return!1}_serializeConfig(e){return{configFile:this._relativePath(e.configFile),globalTimeout:e.globalTimeout,maxFailures:e.maxFailures,metadata:e.metadata,rootDir:e.rootDir,version:e.version,workers:e.workers,globalSetup:e.globalSetup,globalTeardown:e.globalTeardown,webServer:e.webServer}}_serializeProject(e){let t=e.project();return{metadata:t.metadata,name:t.name,outputDir:this._relativePath(t.outputDir),repeatEach:t.repeatEach,retries:t.retries,testDir:this._relativePath(t.testDir),testIgnore:f(t.testIgnore),testMatch:f(t.testMatch),timeout:t.timeout,suites:e.suites.map(n=>this._serializeSuite(n)),grep:f(t.grep),grepInvert:f(t.grepInvert||[]),dependencies:t.dependencies,snapshotDir:this._relativePath(t.snapshotDir),teardown:t.teardown,use:this._serializeProjectUseOptions(t.use)}}_serializeProjectUseOptions(e){return{testIdAttribute:e.testIdAttribute}}_serializeSuite(e){return{title:e.title,location:this._relativeLocation(e.location),suites:e.suites.map(s=>this._serializeSuite(s)),tests:e.tests.map(s=>this._serializeTest(s))}}_serializeTest(e){return{testId:e.id,title:e.title,location:this._relativeLocation(e.location),retries:e.retries,tags:e.tags,repeatEachIndex:e.repeatEachIndex}}_serializeResultStart(e){return{id:e[u],retry:e.retry,workerIndex:e.workerIndex,parallelIndex:e.parallelIndex,startTime:+e.startTime}}_serializeResultEnd(e){return{id:e[u],duration:e.duration,status:e.status,errors:e.errors,attachments:this._serializeAttachments(e.attachments)}}_serializeAttachments(e){return e.map(t=>{let{body:s,...n}=t;return{...n,base64:s&&!this._emitterOptions.omitBuffers?s.toString("base64"):void 0}})}_serializeStepStart(e){var t;return{id:e[u],parentStepId:(t=e.parent)==null?void 0:t[u],title:e.title,category:e.category,startTime:+e.startTime,location:this._relativeLocation(e.location)}}_serializeStepEnd(e){return{id:e[u],duration:e.duration,error:e.error}}_relativeLocation(e){return e&&{...e,file:this._relativePath(e.file)}}_relativePath(e){return e&&ee.default.relative(this._rootDir,e)}},u=Symbol("id");var S=class extends _{constructor(e){let t;e!=null&&e._send?t=e._send:t=s=>{console.log(s)},super(t,{omitBuffers:!1,omitOutput:!0}),this._hasSender=!!(e!=null&&e._send)}async onEnd(e){await super.onEnd(e),this._hasSender||await new Promise(()=>{})}},Ce=S;
