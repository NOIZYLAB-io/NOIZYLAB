import{a as ut}from"./chunk-KH7BRNI5.js";import{a as Za}from"./chunk-5FDIEALQ.js";import{a as ja,b as Qa,c as Ja,d as el}from"./chunk-EKO4BB2A.js";import"./chunk-2F3NDXUU.js";import{b as Xa}from"./chunk-FOF4SQ2Y.js";import{a as Ht}from"./chunk-FFE62TXH.js";import{a as Ya,b as Ga}from"./chunk-W5RJDKNB.js";import{$ as la,$a as Sa,$b as mn,Ab as mi,Bb as Ta,Cb as Bt,D as ea,Dc as Oa,E as ta,Ec as Pa,Fb as an,Fc as Aa,Gb as $t,Gc as La,Hc as Fa,Ib as Po,Ic as za,J as na,Jb as ln,Jc as Ba,Kb as cn,Lc as yn,M as oa,Ma as ya,Nb as Ao,Ob as ka,Pb as Da,Pc as Wo,Q as zt,Qa as ba,Qb as Ia,Qc as $a,R as ra,Rb as _e,Sa as xa,Sc as Ha,Tc as Va,Ub as Ma,Uc as Wa,V as ia,Va as wa,Vb as dn,Wb as dt,Wc as Ko,X as sa,Xa as va,Xb as un,Xc as Ka,Y as aa,Yb as fn,Yc as qa,Zb as hn,_b as pn,a as J,ab as Ea,ac as Ra,bd as D,c as K,ca,cc as gi,cd as _g,d as he,da,dc as Lo,e as Eg,ec as Fo,f as Cg,fc as rt,gb as Ca,gc as zo,h as ci,hc as gn,ic as Bo,jc as $o,k as Oe,kc as Ho,lc as Vo,n as Js,oa as ua,ob as di,p as ee,pb as ui,q as Oo,qb as fi,ra as fa,rb as hi,sb as _a,sd as Ua,ta as ha,tb as te,ub as Na,vb as Tt,wa as pa,wb as Ge,x as sn,xb as Hn,ya as ma,yb as pi,za as ga}from"./chunk-M3U674VW.js";var Td=J(Nd=>{"use strict";var In=he();function m0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var g0=typeof Object.is=="function"?Object.is:m0,y0=In.useState,b0=In.useEffect,x0=In.useLayoutEffect,w0=In.useDebugValue;function v0(e,t){var n=t(),o=y0({inst:{value:n,getSnapshot:t}}),r=o[0].inst,i=o[1];return x0(function(){r.value=n,r.getSnapshot=t,is(r)&&i({inst:r})},[e,n,t]),b0(function(){return is(r)&&i({inst:r}),e(function(){is(r)&&i({inst:r})})},[e]),w0(n),n}function is(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!g0(e,n)}catch{return!0}}function S0(e,t){return t()}var E0=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?S0:v0;Nd.useSyncExternalStore=In.useSyncExternalStore!==void 0?In.useSyncExternalStore:E0});var Dd=J((CD,kd)=>{"use strict";kd.exports=Td()});var Md=J(Id=>{"use strict";var Fr=he(),C0=Dd();function _0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var N0=typeof Object.is=="function"?Object.is:_0,T0=C0.useSyncExternalStore,k0=Fr.useRef,D0=Fr.useEffect,I0=Fr.useMemo,M0=Fr.useDebugValue;Id.useSyncExternalStoreWithSelector=function(e,t,n,o,r){var i=k0(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=I0(function(){function l(h){if(!c){if(c=!0,d=h,h=o(h),r!==void 0&&s.hasValue){var p=s.value;if(r(p,h))return u=p}return u=h}if(p=u,N0(d,h))return p;var g=o(h);return r!==void 0&&r(p,g)?(d=h,p):(d=h,u=g)}var c=!1,d,u,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,o,r]);var a=T0(e,i[0],i[1]);return D0(function(){s.hasValue=!0,s.value=a},[a]),M0(a),a}});var Od=J((ND,Rd)=>{"use strict";Rd.exports=Md()});var qr=J((GD,Qu)=>{"use strict";var Hw="\0",nn="\0",Xu="",hs=class{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(t){t&&(this._isDirected=Object.hasOwn(t,"directed")?t.directed:!0,this._isMultigraph=Object.hasOwn(t,"multigraph")?t.multigraph:!1,this._isCompound=Object.hasOwn(t,"compound")?t.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[nn]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return this._defaultNodeLabelFn=t,typeof t!="function"&&(this._defaultNodeLabelFn=()=>t),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var t=this;return this.nodes().filter(n=>Object.keys(t._in[n]).length===0)}sinks(){var t=this;return this.nodes().filter(n=>Object.keys(t._out[n]).length===0)}setNodes(t,n){var o=arguments,r=this;return t.forEach(function(i){o.length>1?r.setNode(i,n):r.setNode(i)}),this}setNode(t,n){return Object.hasOwn(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=nn,this._children[t]={},this._children[nn][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return Object.hasOwn(this._nodes,t)}removeNode(t){var n=this;if(Object.hasOwn(this._nodes,t)){var o=r=>n.removeEdge(n._edgeObjs[r]);delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],this.children(t).forEach(function(r){n.setParent(r)}),delete this._children[t]),Object.keys(this._in[t]).forEach(o),delete this._in[t],delete this._preds[t],Object.keys(this._out[t]).forEach(o),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=nn;else{n+="";for(var o=n;o!==void 0;o=this.parent(o))if(o===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var n=this._parent[t];if(n!==nn)return n}}children(t=nn){if(this._isCompound){var n=this._children[t];if(n)return Object.keys(n)}else{if(t===nn)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var n=this._preds[t];if(n)return Object.keys(n)}successors(t){var n=this._sucs[t];if(n)return Object.keys(n)}neighbors(t){var n=this.predecessors(t);if(n){let r=new Set(n);for(var o of this.successors(t))r.add(o);return Array.from(r.values())}}isLeaf(t){var n;return this.isDirected()?n=this.successors(t):n=this.neighbors(t),n.length===0}filterNodes(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var o=this;Object.entries(this._nodes).forEach(function([s,a]){t(s)&&n.setNode(s,a)}),Object.values(this._edgeObjs).forEach(function(s){n.hasNode(s.v)&&n.hasNode(s.w)&&n.setEdge(s,o.edge(s))});var r={};function i(s){var a=o.parent(s);return a===void 0||n.hasNode(a)?(r[s]=a,a):a in r?r[a]:i(a)}return this._isCompound&&n.nodes().forEach(s=>n.setParent(s,i(s))),n}setDefaultEdgeLabel(t){return this._defaultEdgeLabelFn=t,typeof t!="function"&&(this._defaultEdgeLabelFn=()=>t),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(t,n){var o=this,r=arguments;return t.reduce(function(i,s){return r.length>1?o.setEdge(i,s,n):o.setEdge(i,s),s}),this}setEdge(){var t,n,o,r,i=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,n=s.w,o=s.name,arguments.length===2&&(r=arguments[1],i=!0)):(t=s,n=arguments[1],o=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),t=""+t,n=""+n,o!==void 0&&(o=""+o);var a=xo(this._isDirected,t,n,o);if(Object.hasOwn(this._edgeLabels,a))return i&&(this._edgeLabels[a]=r),this;if(o!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?r:this._defaultEdgeLabelFn(t,n,o);var l=Vw(this._isDirected,t,n,o);return t=l.v,n=l.w,Object.freeze(l),this._edgeObjs[a]=l,Zu(this._preds[n],t),Zu(this._sucs[t],n),this._in[n][a]=l,this._out[t][a]=l,this._edgeCount++,this}edge(t,n,o){var r=arguments.length===1?fs(this._isDirected,arguments[0]):xo(this._isDirected,t,n,o);return this._edgeLabels[r]}edgeAsObj(){let t=this.edge(...arguments);return typeof t!="object"?{label:t}:t}hasEdge(t,n,o){var r=arguments.length===1?fs(this._isDirected,arguments[0]):xo(this._isDirected,t,n,o);return Object.hasOwn(this._edgeLabels,r)}removeEdge(t,n,o){var r=arguments.length===1?fs(this._isDirected,arguments[0]):xo(this._isDirected,t,n,o),i=this._edgeObjs[r];return i&&(t=i.v,n=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],ju(this._preds[n],t),ju(this._sucs[t],n),delete this._in[n][r],delete this._out[t][r],this._edgeCount--),this}inEdges(t,n){var o=this._in[t];if(o){var r=Object.values(o);return n?r.filter(i=>i.v===n):r}}outEdges(t,n){var o=this._out[t];if(o){var r=Object.values(o);return n?r.filter(i=>i.w===n):r}}nodeEdges(t,n){var o=this.inEdges(t,n);if(o)return o.concat(this.outEdges(t,n))}};function Zu(e,t){e[t]?e[t]++:e[t]=1}function ju(e,t){--e[t]||delete e[t]}function xo(e,t,n,o){var r=""+t,i=""+n;if(!e&&r>i){var s=r;r=i,i=s}return r+Xu+i+Xu+(o===void 0?Hw:o)}function Vw(e,t,n,o){var r=""+t,i=""+n;if(!e&&r>i){var s=r;r=i,i=s}var a={v:r,w:i};return o&&(a.name=o),a}function fs(e,t){return xo(e,t.v,t.w,t.name)}Qu.exports=hs});var ef=J((XD,Ju)=>{"use strict";Ju.exports="2.2.4"});var nf=J((ZD,tf)=>{"use strict";tf.exports={Graph:qr(),version:ef()}});var rf=J((jD,of)=>{"use strict";var Ww=qr();of.exports={write:Kw,read:Yw};function Kw(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:qw(e),edges:Uw(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function qw(e){return e.nodes().map(function(t){var n=e.node(t),o=e.parent(t),r={v:t};return n!==void 0&&(r.value=n),o!==void 0&&(r.parent=o),r})}function Uw(e){return e.edges().map(function(t){var n=e.edge(t),o={v:t.v,w:t.w};return t.name!==void 0&&(o.name=t.name),n!==void 0&&(o.value=n),o})}function Yw(e){var t=new Ww(e.options).setGraph(e.value);return e.nodes.forEach(function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),e.edges.forEach(function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}});var af=J((QD,sf)=>{"use strict";sf.exports=Gw;function Gw(e){var t={},n=[],o;function r(i){Object.hasOwn(t,i)||(t[i]=!0,o.push(i),e.successors(i).forEach(r),e.predecessors(i).forEach(r))}return e.nodes().forEach(function(i){o=[],r(i),o.length&&n.push(o)}),n}});var ms=J((JD,lf)=>{"use strict";var ps=class{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(t){return t.key})}has(t){return Object.hasOwn(this._keyIndices,t)}priority(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(t,n){var o=this._keyIndices;if(t=String(t),!Object.hasOwn(o,t)){var r=this._arr,i=r.length;return o[t]=i,r.push({key:t,priority:n}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key}decrease(t,n){var o=this._keyIndices[t];if(n>this._arr[o].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[o].priority+" New: "+n);this._arr[o].priority=n,this._decrease(o)}_heapify(t){var n=this._arr,o=2*t,r=o+1,i=t;o<n.length&&(i=n[o].priority<n[i].priority?o:i,r<n.length&&(i=n[r].priority<n[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))}_decrease(t){for(var n=this._arr,o=n[t].priority,r;t!==0&&(r=t>>1,!(n[r].priority<o));)this._swap(t,r),t=r}_swap(t,n){var o=this._arr,r=this._keyIndices,i=o[t],s=o[n];o[t]=s,o[n]=i,r[s.key]=t,r[i.key]=n}};lf.exports=ps});var gs=J((eI,cf)=>{"use strict";var Xw=ms();cf.exports=jw;var Zw=()=>1;function jw(e,t,n,o){return Qw(e,String(t),n||Zw,o||function(r){return e.outEdges(r)})}function Qw(e,t,n,o){var r={},i=new Xw,s,a,l=function(c){var d=c.v!==s?c.v:c.w,u=r[d],f=n(c),h=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+c+" Weight: "+f);h<u.distance&&(u.distance=h,u.predecessor=s,i.decrease(d,h))};for(e.nodes().forEach(function(c){var d=c===t?0:Number.POSITIVE_INFINITY;r[c]={distance:d},i.add(c,d)});i.size()>0&&(s=i.removeMin(),a=r[s],a.distance!==Number.POSITIVE_INFINITY);)o(s).forEach(l);return r}});var uf=J((tI,df)=>{"use strict";var Jw=gs();df.exports=ev;function ev(e,t,n){return e.nodes().reduce(function(o,r){return o[r]=Jw(e,r,t,n),o},{})}});var ys=J((nI,ff)=>{"use strict";ff.exports=tv;function tv(e){var t=0,n=[],o={},r=[];function i(s){var a=o[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(d){Object.hasOwn(o,d)?o[d].onStack&&(a.lowlink=Math.min(a.lowlink,o[d].index)):(i(d),a.lowlink=Math.min(a.lowlink,o[d].lowlink))}),a.lowlink===a.index){var l=[],c;do c=n.pop(),o[c].onStack=!1,l.push(c);while(s!==c);r.push(l)}}return e.nodes().forEach(function(s){Object.hasOwn(o,s)||i(s)}),r}});var pf=J((oI,hf)=>{"use strict";var nv=ys();hf.exports=ov;function ov(e){return nv(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}});var gf=J((rI,mf)=>{"use strict";mf.exports=iv;var rv=()=>1;function iv(e,t,n){return sv(e,t||rv,n||function(o){return e.outEdges(o)})}function sv(e,t,n){var o={},r=e.nodes();return r.forEach(function(i){o[i]={},o[i][i]={distance:0},r.forEach(function(s){i!==s&&(o[i][s]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var a=s.v===i?s.w:s.v,l=t(s);o[i][a]={distance:l,predecessor:i}})}),r.forEach(function(i){var s=o[i];r.forEach(function(a){var l=o[a];r.forEach(function(c){var d=l[i],u=s[c],f=l[c],h=d.distance+u.distance;h<f.distance&&(f.distance=h,f.predecessor=u.predecessor)})})}),o}});var bs=J((iI,bf)=>{"use strict";function yf(e){var t={},n={},o=[];function r(i){if(Object.hasOwn(n,i))throw new wo;Object.hasOwn(t,i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(r),delete n[i],o.push(i))}if(e.sinks().forEach(r),Object.keys(t).length!==e.nodeCount())throw new wo;return o}var wo=class extends Error{constructor(){super(...arguments)}};bf.exports=yf;yf.CycleException=wo});var vf=J((sI,wf)=>{"use strict";var xf=bs();wf.exports=av;function av(e){try{xf(e)}catch(t){if(t instanceof xf.CycleException)return!1;throw t}return!0}});var xs=J((aI,Ef)=>{"use strict";Ef.exports=lv;function lv(e,t,n){Array.isArray(t)||(t=[t]);var o=e.isDirected()?a=>e.successors(a):a=>e.neighbors(a),r=n==="post"?cv:dv,i=[],s={};return t.forEach(a=>{if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);r(a,o,s,i)}),i}function cv(e,t,n,o){for(var r=[[e,!1]];r.length>0;){var i=r.pop();i[1]?o.push(i[0]):Object.hasOwn(n,i[0])||(n[i[0]]=!0,r.push([i[0],!0]),Sf(t(i[0]),s=>r.push([s,!1])))}}function dv(e,t,n,o){for(var r=[e];r.length>0;){var i=r.pop();Object.hasOwn(n,i)||(n[i]=!0,o.push(i),Sf(t(i),s=>r.push(s)))}}function Sf(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}});var _f=J((lI,Cf)=>{"use strict";var uv=xs();Cf.exports=fv;function fv(e,t){return uv(e,t,"post")}});var Tf=J((cI,Nf)=>{"use strict";var hv=xs();Nf.exports=pv;function pv(e,t){return hv(e,t,"pre")}});var Df=J((dI,kf)=>{"use strict";var mv=qr(),gv=ms();kf.exports=yv;function yv(e,t){var n=new mv,o={},r=new gv,i;function s(l){var c=l.v===i?l.w:l.v,d=r.priority(c);if(d!==void 0){var u=t(l);u<d&&(o[c]=i,r.decrease(c,u))}}if(e.nodeCount()===0)return n;e.nodes().forEach(function(l){r.add(l,Number.POSITIVE_INFINITY),n.setNode(l)}),r.decrease(e.nodes()[0],0);for(var a=!1;r.size()>0;){if(i=r.removeMin(),Object.hasOwn(o,i))n.setEdge(i,o[i]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(i).forEach(s)}return n}});var Mf=J((uI,If)=>{"use strict";If.exports={components:af(),dijkstra:gs(),dijkstraAll:uf(),findCycles:pf(),floydWarshall:gf(),isAcyclic:vf(),postorder:_f(),preorder:Tf(),prim:Df(),tarjan:ys(),topsort:bs()}});var Qe=J((fI,Of)=>{"use strict";var Rf=nf();Of.exports={Graph:Rf.Graph,json:rf(),alg:Mf(),version:Rf.version}});var Lf=J((hI,Af)=>{"use strict";var ws=class{constructor(){let t={};t._next=t._prev=t,this._sentinel=t}dequeue(){let t=this._sentinel,n=t._prev;if(n!==t)return Pf(n),n}enqueue(t){let n=this._sentinel;t._prev&&t._next&&Pf(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n}toString(){let t=[],n=this._sentinel,o=n._prev;for(;o!==n;)t.push(JSON.stringify(o,bv)),o=o._prev;return"["+t.join(", ")+"]"}};function Pf(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function bv(e,t){if(e!=="_next"&&e!=="_prev")return t}Af.exports=ws});var zf=J((pI,Ff)=>{"use strict";var xv=Qe().Graph,wv=Lf();Ff.exports=Sv;var vv=()=>1;function Sv(e,t){if(e.nodeCount()<=1)return[];let n=Cv(e,t||vv);return Ev(n.graph,n.buckets,n.zeroIdx).flatMap(r=>e.outEdges(r.v,r.w))}function Ev(e,t,n){let o=[],r=t[t.length-1],i=t[0],s;for(;e.nodeCount();){for(;s=i.dequeue();)vs(e,t,n,s);for(;s=r.dequeue();)vs(e,t,n,s);if(e.nodeCount()){for(let a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){o=o.concat(vs(e,t,n,s,!0));break}}}return o}function vs(e,t,n,o,r){let i=r?[]:void 0;return e.inEdges(o.v).forEach(s=>{let a=e.edge(s),l=e.node(s.v);r&&i.push({v:s.v,w:s.w}),l.out-=a,Ss(t,n,l)}),e.outEdges(o.v).forEach(s=>{let a=e.edge(s),l=s.w,c=e.node(l);c.in-=a,Ss(t,n,c)}),e.removeNode(o.v),i}function Cv(e,t){let n=new xv,o=0,r=0;e.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),e.edges().forEach(a=>{let l=n.edge(a.v,a.w)||0,c=t(a),d=l+c;n.setEdge(a.v,a.w,d),r=Math.max(r,n.node(a.v).out+=c),o=Math.max(o,n.node(a.w).in+=c)});let i=_v(r+o+3).map(()=>new wv),s=o+1;return n.nodes().forEach(a=>{Ss(i,s,n.node(a))}),{graph:n,buckets:i,zeroIdx:s}}function Ss(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function _v(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}});var ve=J((mI,qf)=>{"use strict";var Bf=Qe().Graph;qf.exports={addBorderNode:Pv,addDummyNode:$f,applyWithChunking:Ur,asNonCompoundGraph:Tv,buildLayerMatrix:Mv,intersectRect:Iv,mapValues:Hv,maxRank:Vf,normalizeRanks:Rv,notime:zv,partition:Lv,pick:$v,predecessorWeights:Dv,range:Kf,removeEmptyRanks:Ov,simplify:Nv,successorWeights:kv,time:Fv,uniqueId:Wf,zipObject:Es};function $f(e,t,n,o){let r;do r=Wf(o);while(e.hasNode(r));return n.dummy=t,e.setNode(r,n),r}function Nv(e){let t=new Bf().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let o=t.edge(n.v,n.w)||{weight:0,minlen:1},r=e.edge(n);t.setEdge(n.v,n.w,{weight:o.weight+r.weight,minlen:Math.max(o.minlen,r.minlen)})}),t}function Tv(e){let t=new Bf({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function kv(e){let t=e.nodes().map(n=>{let o={};return e.outEdges(n).forEach(r=>{o[r.w]=(o[r.w]||0)+e.edge(r).weight}),o});return Es(e.nodes(),t)}function Dv(e){let t=e.nodes().map(n=>{let o={};return e.inEdges(n).forEach(r=>{o[r.v]=(o[r.v]||0)+e.edge(r).weight}),o});return Es(e.nodes(),t)}function Iv(e,t){let n=e.x,o=e.y,r=t.x-n,i=t.y-o,s=e.width/2,a=e.height/2;if(!r&&!i)throw new Error("Not possible to find intersection inside of the rectangle");let l,c;return Math.abs(i)*s>Math.abs(r)*a?(i<0&&(a=-a),l=a*r/i,c=a):(r<0&&(s=-s),l=s,c=s*i/r),{x:n+l,y:o+c}}function Mv(e){let t=Kf(Vf(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let o=e.node(n),r=o.rank;r!==void 0&&(t[r][o.order]=n)}),t}function Rv(e){let t=e.nodes().map(o=>{let r=e.node(o).rank;return r===void 0?Number.MAX_VALUE:r}),n=Ur(Math.min,t);e.nodes().forEach(o=>{let r=e.node(o);Object.hasOwn(r,"rank")&&(r.rank-=n)})}function Ov(e){let t=e.nodes().map(s=>e.node(s).rank),n=Ur(Math.min,t),o=[];e.nodes().forEach(s=>{let a=e.node(s).rank-n;o[a]||(o[a]=[]),o[a].push(s)});let r=0,i=e.graph().nodeRankFactor;Array.from(o).forEach((s,a)=>{s===void 0&&a%i!==0?--r:s!==void 0&&r&&s.forEach(l=>e.node(l).rank+=r)})}function Pv(e,t,n,o){let r={width:0,height:0};return arguments.length>=4&&(r.rank=n,r.order=o),$f(e,"border",r,t)}function Av(e,t=Hf){let n=[];for(let o=0;o<e.length;o+=t){let r=e.slice(o,o+t);n.push(r)}return n}var Hf=65535;function Ur(e,t){if(t.length>Hf){let n=Av(t);return e.apply(null,n.map(o=>e.apply(null,o)))}else return e.apply(null,t)}function Vf(e){let n=e.nodes().map(o=>{let r=e.node(o).rank;return r===void 0?Number.MIN_VALUE:r});return Ur(Math.max,n)}function Lv(e,t){let n={lhs:[],rhs:[]};return e.forEach(o=>{t(o)?n.lhs.push(o):n.rhs.push(o)}),n}function Fv(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function zv(e,t){return t()}var Bv=0;function Wf(e){var t=++Bv;return toString(e)+t}function Kf(e,t,n=1){t==null&&(t=e,e=0);let o=i=>i<t;n<0&&(o=i=>t<i);let r=[];for(let i=e;o(i);i+=n)r.push(i);return r}function $v(e,t){let n={};for(let o of t)e[o]!==void 0&&(n[o]=e[o]);return n}function Hv(e,t){let n=t;return typeof t=="string"&&(n=o=>o[t]),Object.entries(e).reduce((o,[r,i])=>(o[r]=n(i,r),o),{})}function Es(e,t){return e.reduce((n,o,r)=>(n[o]=t[r],n),{})}});var Yf=J((gI,Uf)=>{"use strict";var Vv=zf(),Wv=ve().uniqueId;Uf.exports={run:Kv,undo:Uv};function Kv(e){(e.graph().acyclicer==="greedy"?Vv(e,n(e)):qv(e)).forEach(o=>{let r=e.edge(o);e.removeEdge(o),r.forwardName=o.name,r.reversed=!0,e.setEdge(o.w,o.v,r,Wv("rev"))});function n(o){return r=>o.edge(r).weight}}function qv(e){let t=[],n={},o={};function r(i){Object.hasOwn(o,i)||(o[i]=!0,n[i]=!0,e.outEdges(i).forEach(s=>{Object.hasOwn(n,s.w)?t.push(s):r(s.w)}),delete n[i])}return e.nodes().forEach(r),t}function Uv(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let o=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,o)}})}});var Xf=J((yI,Gf)=>{"use strict";var Yv=ve();Gf.exports={run:Gv,undo:Zv};function Gv(e){e.graph().dummyChains=[],e.edges().forEach(t=>Xv(e,t))}function Xv(e,t){let n=t.v,o=e.node(n).rank,r=t.w,i=e.node(r).rank,s=t.name,a=e.edge(t),l=a.labelRank;if(i===o+1)return;e.removeEdge(t);let c,d,u;for(u=0,++o;o<i;++u,++o)a.points=[],d={width:0,height:0,edgeLabel:a,edgeObj:t,rank:o},c=Yv.addDummyNode(e,"edge",d,"_d"),o===l&&(d.width=a.width,d.height=a.height,d.dummy="edge-label",d.labelpos=a.labelpos),e.setEdge(n,c,{weight:a.weight},s),u===0&&e.graph().dummyChains.push(c),n=c;e.setEdge(n,r,{weight:a.weight},s)}function Zv(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),o=n.edgeLabel,r;for(e.setEdge(n.edgeObj,o);n.dummy;)r=e.successors(t)[0],e.removeNode(t),o.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(o.x=n.x,o.y=n.y,o.width=n.width,o.height=n.height),t=r,n=e.node(t)})}});var vo=J((bI,Zf)=>{"use strict";var{applyWithChunking:jv}=ve();Zf.exports={longestPath:Qv,slack:Jv};function Qv(e){var t={};function n(o){var r=e.node(o);if(Object.hasOwn(t,o))return r.rank;t[o]=!0;let i=e.outEdges(o).map(a=>a==null?Number.POSITIVE_INFINITY:n(a.w)-e.edge(a).minlen);var s=jv(Math.min,i);return s===Number.POSITIVE_INFINITY&&(s=0),r.rank=s}e.sources().forEach(n)}function Jv(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}});var Cs=J((xI,jf)=>{"use strict";var eS=Qe().Graph,Yr=vo().slack;jf.exports=tS;function tS(e){var t=new eS({directed:!1}),n=e.nodes()[0],o=e.nodeCount();t.setNode(n,{});for(var r,i;nS(t,e)<o;)r=oS(t,e),i=t.hasNode(r.v)?Yr(e,r):-Yr(e,r),rS(t,e,i);return t}function nS(e,t){function n(o){t.nodeEdges(o).forEach(r=>{var i=r.v,s=o===i?r.w:i;!e.hasNode(s)&&!Yr(t,r)&&(e.setNode(s,{}),e.setEdge(o,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function oS(e,t){return t.edges().reduce((o,r)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(r.v)!==e.hasNode(r.w)&&(i=Yr(t,r)),i<o[0]?[i,r]:o},[Number.POSITIVE_INFINITY,null])[1]}function rS(e,t,n){e.nodes().forEach(o=>t.node(o).rank+=n)}});var sh=J((wI,ih)=>{"use strict";var iS=Cs(),Qf=vo().slack,sS=vo().longestPath,aS=Qe().alg.preorder,lS=Qe().alg.postorder,cS=ve().simplify;ih.exports=on;on.initLowLimValues=Ns;on.initCutValues=_s;on.calcCutValue=eh;on.leaveEdge=nh;on.enterEdge=oh;on.exchangeEdges=rh;function on(e){e=cS(e),sS(e);var t=iS(e);Ns(t),_s(t,e);for(var n,o;n=nh(t);)o=oh(t,e,n),rh(t,e,n,o)}function _s(e,t){var n=lS(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(o=>dS(e,t,o))}function dS(e,t,n){var o=e.node(n),r=o.parent;e.edge(n,r).cutvalue=eh(e,t,n)}function eh(e,t,n){var o=e.node(n),r=o.parent,i=!0,s=t.edge(n,r),a=0;return s||(i=!1,s=t.edge(r,n)),a=s.weight,t.nodeEdges(n).forEach(l=>{var c=l.v===n,d=c?l.w:l.v;if(d!==r){var u=c===i,f=t.edge(l).weight;if(a+=u?f:-f,fS(e,n,d)){var h=e.edge(n,d).cutvalue;a+=u?-h:h}}}),a}function Ns(e,t){arguments.length<2&&(t=e.nodes()[0]),th(e,{},1,t)}function th(e,t,n,o,r){var i=n,s=e.node(o);return t[o]=!0,e.neighbors(o).forEach(a=>{Object.hasOwn(t,a)||(n=th(e,t,n,a,o))}),s.low=i,s.lim=n++,r?s.parent=r:delete s.parent,n}function nh(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function oh(e,t,n){var o=n.v,r=n.w;t.hasEdge(o,r)||(o=n.w,r=n.v);var i=e.node(o),s=e.node(r),a=i,l=!1;i.lim>s.lim&&(a=s,l=!0);var c=t.edges().filter(d=>l===Jf(e,e.node(d.v),a)&&l!==Jf(e,e.node(d.w),a));return c.reduce((d,u)=>Qf(t,u)<Qf(t,d)?u:d)}function rh(e,t,n,o){var r=n.v,i=n.w;e.removeEdge(r,i),e.setEdge(o.v,o.w,{}),Ns(e),_s(e,t),uS(e,t)}function uS(e,t){var n=e.nodes().find(r=>!t.node(r).parent),o=aS(e,n);o=o.slice(1),o.forEach(r=>{var i=e.node(r).parent,s=t.edge(r,i),a=!1;s||(s=t.edge(i,r),a=!0),t.node(r).rank=t.node(i).rank+(a?s.minlen:-s.minlen)})}function fS(e,t,n){return e.hasEdge(t,n)}function Jf(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}});var dh=J((vI,ch)=>{"use strict";var hS=vo(),lh=hS.longestPath,pS=Cs(),mS=sh();ch.exports=gS;function gS(e){switch(e.graph().ranker){case"network-simplex":ah(e);break;case"tight-tree":bS(e);break;case"longest-path":yS(e);break;default:ah(e)}}var yS=lh;function bS(e){lh(e),pS(e)}function ah(e){mS(e)}});var fh=J((SI,uh)=>{"use strict";uh.exports=xS;function xS(e){let t=vS(e);e.graph().dummyChains.forEach(n=>{let o=e.node(n),r=o.edgeObj,i=wS(e,t,r.v,r.w),s=i.path,a=i.lca,l=0,c=s[l],d=!0;for(;n!==r.w;){if(o=e.node(n),d){for(;(c=s[l])!==a&&e.node(c).maxRank<o.rank;)l++;c===a&&(d=!1)}if(!d){for(;l<s.length-1&&e.node(c=s[l+1]).minRank<=o.rank;)l++;c=s[l]}e.setParent(n,c),n=e.successors(n)[0]}})}function wS(e,t,n,o){let r=[],i=[],s=Math.min(t[n].low,t[o].low),a=Math.max(t[n].lim,t[o].lim),l,c;l=n;do l=e.parent(l),r.push(l);while(l&&(t[l].low>s||a>t[l].lim));for(c=l,l=o;(l=e.parent(l))!==c;)i.push(l);return{path:r.concat(i.reverse()),lca:c}}function vS(e){let t={},n=0;function o(r){let i=n;e.children(r).forEach(o),t[r]={low:i,lim:n++}}return e.children().forEach(o),t}});var mh=J((EI,ph)=>{"use strict";var Gr=ve();ph.exports={run:SS,cleanup:_S};function SS(e){let t=Gr.addDummyNode(e,"root",{},"_root"),n=ES(e),o=Object.values(n),r=Gr.applyWithChunking(Math.max,o)-1,i=2*r+1;e.graph().nestingRoot=t,e.edges().forEach(a=>e.edge(a).minlen*=i);let s=CS(e)+1;e.children().forEach(a=>hh(e,t,i,s,r,n,a)),e.graph().nodeRankFactor=i}function hh(e,t,n,o,r,i,s){let a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}let l=Gr.addBorderNode(e,"_bt"),c=Gr.addBorderNode(e,"_bb"),d=e.node(s);e.setParent(l,s),d.borderTop=l,e.setParent(c,s),d.borderBottom=c,a.forEach(u=>{hh(e,t,n,o,r,i,u);let f=e.node(u),h=f.borderTop?f.borderTop:u,p=f.borderBottom?f.borderBottom:u,g=f.borderTop?o:2*o,v=h!==p?1:r-i[s]+1;e.setEdge(l,h,{weight:g,minlen:v,nestingEdge:!0}),e.setEdge(p,c,{weight:g,minlen:v,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,l,{weight:0,minlen:r+i[s]})}function ES(e){var t={};function n(o,r){var i=e.children(o);i&&i.length&&i.forEach(s=>n(s,r+1)),t[o]=r}return e.children().forEach(o=>n(o,1)),t}function CS(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function _S(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{var o=e.edge(n);o.nestingEdge&&e.removeEdge(n)})}});var bh=J((CI,yh)=>{"use strict";var NS=ve();yh.exports=TS;function TS(e){function t(n){let o=e.children(n),r=e.node(n);if(o.length&&o.forEach(t),Object.hasOwn(r,"minRank")){r.borderLeft=[],r.borderRight=[];for(let i=r.minRank,s=r.maxRank+1;i<s;++i)gh(e,"borderLeft","_bl",n,r,i),gh(e,"borderRight","_br",n,r,i)}}e.children().forEach(t)}function gh(e,t,n,o,r,i){let s={width:0,height:0,rank:i,borderType:t},a=r[t][i-1],l=NS.addDummyNode(e,"border",s,n);r[t][i]=l,e.setParent(l,o),a&&e.setEdge(a,l,{weight:1})}});var Sh=J((_I,vh)=>{"use strict";vh.exports={adjust:kS,undo:DS};function kS(e){let t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&wh(e)}function DS(e){let t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&IS(e),(t==="lr"||t==="rl")&&(MS(e),wh(e))}function wh(e){e.nodes().forEach(t=>xh(e.node(t))),e.edges().forEach(t=>xh(e.edge(t)))}function xh(e){let t=e.width;e.width=e.height,e.height=t}function IS(e){e.nodes().forEach(t=>Ts(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(Ts),Object.hasOwn(n,"y")&&Ts(n)})}function Ts(e){e.y=-e.y}function MS(e){e.nodes().forEach(t=>ks(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(ks),Object.hasOwn(n,"x")&&ks(n)})}function ks(e){let t=e.x;e.x=e.y,e.y=t}});var _h=J((NI,Ch)=>{"use strict";var Eh=ve();Ch.exports=RS;function RS(e){let t={},n=e.nodes().filter(l=>!e.children(l).length),o=n.map(l=>e.node(l).rank),r=Eh.applyWithChunking(Math.max,o),i=Eh.range(r+1).map(()=>[]);function s(l){if(t[l])return;t[l]=!0;let c=e.node(l);i[c.rank].push(l),e.successors(l).forEach(s)}return n.sort((l,c)=>e.node(l).rank-e.node(c).rank).forEach(s),i}});var Th=J((TI,Nh)=>{"use strict";var OS=ve().zipObject;Nh.exports=PS;function PS(e,t){let n=0;for(let o=1;o<t.length;++o)n+=AS(e,t[o-1],t[o]);return n}function AS(e,t,n){let o=OS(n,n.map((c,d)=>d)),r=t.flatMap(c=>e.outEdges(c).map(d=>({pos:o[d.w],weight:e.edge(d).weight})).sort((d,u)=>d.pos-u.pos)),i=1;for(;i<n.length;)i<<=1;let s=2*i-1;i-=1;let a=new Array(s).fill(0),l=0;return r.forEach(c=>{let d=c.pos+i;a[d]+=c.weight;let u=0;for(;d>0;)d%2&&(u+=a[d+1]),d=d-1>>1,a[d]+=c.weight;l+=c.weight*u}),l}});var Dh=J((kI,kh)=>{"use strict";kh.exports=LS;function LS(e,t=[]){return t.map(n=>{let o=e.inEdges(n);if(o.length){let r=o.reduce((i,s)=>{let a=e.edge(s),l=e.node(s.v);return{sum:i.sum+a.weight*l.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:n}})}});var Mh=J((DI,Ih)=>{"use strict";var FS=ve();Ih.exports=zS;function zS(e,t){let n={};e.forEach((r,i)=>{let s=n[r.v]={indegree:0,in:[],out:[],vs:[r.v],i};r.barycenter!==void 0&&(s.barycenter=r.barycenter,s.weight=r.weight)}),t.edges().forEach(r=>{let i=n[r.v],s=n[r.w];i!==void 0&&s!==void 0&&(s.indegree++,i.out.push(n[r.w]))});let o=Object.values(n).filter(r=>!r.indegree);return BS(o)}function BS(e){let t=[];function n(r){return i=>{i.merged||(i.barycenter===void 0||r.barycenter===void 0||i.barycenter>=r.barycenter)&&$S(r,i)}}function o(r){return i=>{i.in.push(r),--i.indegree===0&&e.push(i)}}for(;e.length;){let r=e.pop();t.push(r),r.in.reverse().forEach(n(r)),r.out.forEach(o(r))}return t.filter(r=>!r.merged).map(r=>FS.pick(r,["vs","i","barycenter","weight"]))}function $S(e,t){let n=0,o=0;e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/o,e.weight=o,e.i=Math.min(t.i,e.i),t.merged=!0}});var Ph=J((II,Oh)=>{"use strict";var HS=ve();Oh.exports=VS;function VS(e,t){let n=HS.partition(e,d=>Object.hasOwn(d,"barycenter")),o=n.lhs,r=n.rhs.sort((d,u)=>u.i-d.i),i=[],s=0,a=0,l=0;o.sort(WS(!!t)),l=Rh(i,r,l),o.forEach(d=>{l+=d.vs.length,i.push(d.vs),s+=d.barycenter*d.weight,a+=d.weight,l=Rh(i,r,l)});let c={vs:i.flat(!0)};return a&&(c.barycenter=s/a,c.weight=a),c}function Rh(e,t,n){let o;for(;t.length&&(o=t[t.length-1]).i<=n;)t.pop(),e.push(o.vs),n++;return n}function WS(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}});var Fh=J((MI,Lh)=>{"use strict";var KS=Dh(),qS=Mh(),US=Ph();Lh.exports=Ah;function Ah(e,t,n,o){let r=e.children(t),i=e.node(t),s=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,l={};s&&(r=r.filter(f=>f!==s&&f!==a));let c=KS(e,r);c.forEach(f=>{if(e.children(f.v).length){let h=Ah(e,f.v,n,o);l[f.v]=h,Object.hasOwn(h,"barycenter")&&GS(f,h)}});let d=qS(c,n);YS(d,l);let u=US(d,o);if(s&&(u.vs=[s,u.vs,a].flat(!0),e.predecessors(s).length)){let f=e.node(e.predecessors(s)[0]),h=e.node(e.predecessors(a)[0]);Object.hasOwn(u,"barycenter")||(u.barycenter=0,u.weight=0),u.barycenter=(u.barycenter*u.weight+f.order+h.order)/(u.weight+2),u.weight+=2}return u}function YS(e,t){e.forEach(n=>{n.vs=n.vs.flatMap(o=>t[o]?t[o].vs:o)})}function GS(e,t){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}});var Bh=J((RI,zh)=>{"use strict";var XS=Qe().Graph,ZS=ve();zh.exports=jS;function jS(e,t,n){let o=QS(e),r=new XS({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{let s=e.node(i),a=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(r.setNode(i),r.setParent(i,a||o),e[n](i).forEach(l=>{let c=l.v===i?l.w:l.v,d=r.edge(c,i),u=d!==void 0?d.weight:0;r.setEdge(c,i,{weight:e.edge(l).weight+u})}),Object.hasOwn(s,"minRank")&&r.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),r}function QS(e){for(var t;e.hasNode(t=ZS.uniqueId("_root")););return t}});var Hh=J((OI,$h)=>{"use strict";$h.exports=JS;function JS(e,t,n){let o={},r;n.forEach(i=>{let s=e.parent(i),a,l;for(;s;){if(a=e.parent(s),a?(l=o[a],o[a]=s):(l=r,r=s),l&&l!==s){t.setEdge(l,s);return}s=a}})}});var Uh=J((PI,qh)=>{"use strict";var eE=_h(),tE=Th(),nE=Fh(),oE=Bh(),rE=Hh(),iE=Qe().Graph,Xr=ve();qh.exports=Kh;function Kh(e,t){if(t&&typeof t.customOrder=="function"){t.customOrder(e,Kh);return}let n=Xr.maxRank(e),o=Vh(e,Xr.range(1,n+1),"inEdges"),r=Vh(e,Xr.range(n-1,-1,-1),"outEdges"),i=eE(e);if(Wh(e,i),t&&t.disableOptimalOrderHeuristic)return;let s=Number.POSITIVE_INFINITY,a;for(let l=0,c=0;c<4;++l,++c){sE(l%2?o:r,l%4>=2),i=Xr.buildLayerMatrix(e);let d=tE(e,i);d<s&&(c=0,a=Object.assign({},i),s=d)}Wh(e,a)}function Vh(e,t,n){return t.map(function(o){return oE(e,o,n)})}function sE(e,t){let n=new iE;e.forEach(function(o){let r=o.graph().root,i=nE(o,r,n,t);i.vs.forEach((s,a)=>o.node(s).order=a),rE(o,n,i.vs)})}function Wh(e,t){Object.values(t).forEach(n=>n.forEach((o,r)=>e.node(o).order=r))}});var np=J((AI,tp)=>{"use strict";var aE=Qe().Graph,_t=ve();tp.exports={positionX:dE,findType1Conflicts:Yh,findType2Conflicts:Gh,addConflict:Ds,hasConflict:Xh,verticalAlignment:Zh,horizontalCompaction:jh,alignCoordinates:Jh,findSmallestWidthAlignment:Qh,balance:ep};function Yh(e,t){let n={};function o(r,i){let s=0,a=0,l=r.length,c=i[i.length-1];return i.forEach((d,u)=>{let f=lE(e,d),h=f?e.node(f).order:l;(f||d===c)&&(i.slice(a,u+1).forEach(p=>{e.predecessors(p).forEach(g=>{let v=e.node(g),m=v.order;(m<s||h<m)&&!(v.dummy&&e.node(p).dummy)&&Ds(n,g,p)})}),a=u+1,s=h)}),i}return t.length&&t.reduce(o),n}function Gh(e,t){let n={};function o(i,s,a,l,c){let d;_t.range(s,a).forEach(u=>{d=i[u],e.node(d).dummy&&e.predecessors(d).forEach(f=>{let h=e.node(f);h.dummy&&(h.order<l||h.order>c)&&Ds(n,f,d)})})}function r(i,s){let a=-1,l,c=0;return s.forEach((d,u)=>{if(e.node(d).dummy==="border"){let f=e.predecessors(d);f.length&&(l=e.node(f[0]).order,o(s,c,u,a,l),c=u,a=l)}o(s,c,s.length,l,i.length)}),s}return t.length&&t.reduce(r),n}function lE(e,t){if(e.node(t).dummy)return e.predecessors(t).find(n=>e.node(n).dummy)}function Ds(e,t,n){if(t>n){let r=t;t=n,n=r}let o=e[t];o||(e[t]=o={}),o[n]=!0}function Xh(e,t,n){if(t>n){let o=t;t=n,n=o}return!!e[t]&&Object.hasOwn(e[t],n)}function Zh(e,t,n,o){let r={},i={},s={};return t.forEach(a=>{a.forEach((l,c)=>{r[l]=l,i[l]=l,s[l]=c})}),t.forEach(a=>{let l=-1;a.forEach(c=>{let d=o(c);if(d.length){d=d.sort((f,h)=>s[f]-s[h]);let u=(d.length-1)/2;for(let f=Math.floor(u),h=Math.ceil(u);f<=h;++f){let p=d[f];i[c]===c&&l<s[p]&&!Xh(n,c,p)&&(i[p]=c,i[c]=r[c]=r[p],l=s[p])}}})}),{root:r,align:i}}function jh(e,t,n,o,r){let i={},s=cE(e,t,n,r),a=r?"borderLeft":"borderRight";function l(u,f){let h=s.nodes(),p=h.pop(),g={};for(;p;)g[p]?u(p):(g[p]=!0,h.push(p),h=h.concat(f(p))),p=h.pop()}function c(u){i[u]=s.inEdges(u).reduce((f,h)=>Math.max(f,i[h.v]+s.edge(h)),0)}function d(u){let f=s.outEdges(u).reduce((p,g)=>Math.min(p,i[g.w]-s.edge(g)),Number.POSITIVE_INFINITY),h=e.node(u);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[u]=Math.max(i[u],f))}return l(c,s.predecessors.bind(s)),l(d,s.successors.bind(s)),Object.keys(o).forEach(u=>i[u]=i[n[u]]),i}function cE(e,t,n,o){let r=new aE,i=e.graph(),s=uE(i.nodesep,i.edgesep,o);return t.forEach(a=>{let l;a.forEach(c=>{let d=n[c];if(r.setNode(d),l){var u=n[l],f=r.edge(u,d);r.setEdge(u,d,Math.max(s(e,c,l),f||0))}l=c})}),r}function Qh(e,t){return Object.values(t).reduce((n,o)=>{let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;Object.entries(o).forEach(([a,l])=>{let c=fE(e,a)/2;r=Math.max(l+c,r),i=Math.min(l-c,i)});let s=r-i;return s<n[0]&&(n=[s,o]),n},[Number.POSITIVE_INFINITY,null])[1]}function Jh(e,t){let n=Object.values(t),o=_t.applyWithChunking(Math.min,n),r=_t.applyWithChunking(Math.max,n);["u","d"].forEach(i=>{["l","r"].forEach(s=>{let a=i+s,l=e[a];if(l===t)return;let c=Object.values(l),d=o-_t.applyWithChunking(Math.min,c);s!=="l"&&(d=r-_t.applyWithChunking(Math.max,c)),d&&(e[a]=_t.mapValues(l,u=>u+d))})})}function ep(e,t){return _t.mapValues(e.ul,(n,o)=>{if(t)return e[t.toLowerCase()][o];{let r=Object.values(e).map(i=>i[o]).sort((i,s)=>i-s);return(r[1]+r[2])/2}})}function dE(e){let t=_t.buildLayerMatrix(e),n=Object.assign(Yh(e,t),Gh(e,t)),o={},r;["u","d"].forEach(s=>{r=s==="u"?t:Object.values(t).reverse(),["l","r"].forEach(a=>{a==="r"&&(r=r.map(u=>Object.values(u).reverse()));let l=(s==="u"?e.predecessors:e.successors).bind(e),c=Zh(e,r,n,l),d=jh(e,r,c.root,c.align,a==="r");a==="r"&&(d=_t.mapValues(d,u=>-u)),o[s+a]=d})});let i=Qh(e,o);return Jh(o,i),ep(o,e.graph().align)}function uE(e,t,n){return(o,r,i)=>{let s=o.node(r),a=o.node(i),l=0,c;if(l+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":c=-s.width/2;break;case"r":c=s.width/2;break}if(c&&(l+=n?c:-c),c=0,l+=(s.dummy?t:e)/2,l+=(a.dummy?t:e)/2,l+=a.width/2,Object.hasOwn(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":c=a.width/2;break;case"r":c=-a.width/2;break}return c&&(l+=n?c:-c),c=0,l}}function fE(e,t){return e.node(t).width}});var ip=J((LI,rp)=>{"use strict";var op=ve(),hE=np().positionX;rp.exports=pE;function pE(e){e=op.asNonCompoundGraph(e),mE(e),Object.entries(hE(e)).forEach(([t,n])=>e.node(t).x=n)}function mE(e){let t=op.buildLayerMatrix(e),n=e.graph().ranksep,o=0;t.forEach(r=>{let i=r.reduce((s,a)=>{let l=e.node(a).height;return s>l?s:l},0);r.forEach(s=>e.node(s).y=o+i/2),o+=i+n})}});var fp=J((FI,up)=>{"use strict";var sp=Yf(),ap=Xf(),gE=dh(),yE=ve().normalizeRanks,bE=fh(),xE=ve().removeEmptyRanks,lp=mh(),wE=bh(),cp=Sh(),vE=Uh(),SE=ip(),Je=ve(),EE=Qe().Graph;up.exports=CE;function CE(e,t){let n=t&&t.debugTiming?Je.time:Je.notime;n("layout",()=>{let o=n("  buildLayoutGraph",()=>PE(e));n("  runLayout",()=>_E(o,n,t)),n("  updateInputGraph",()=>NE(e,o))})}function _E(e,t,n){t("    makeSpaceForEdgeLabels",()=>AE(e)),t("    removeSelfEdges",()=>KE(e)),t("    acyclic",()=>sp.run(e)),t("    nestingGraph.run",()=>lp.run(e)),t("    rank",()=>gE(Je.asNonCompoundGraph(e))),t("    injectEdgeLabelProxies",()=>LE(e)),t("    removeEmptyRanks",()=>xE(e)),t("    nestingGraph.cleanup",()=>lp.cleanup(e)),t("    normalizeRanks",()=>yE(e)),t("    assignRankMinMax",()=>FE(e)),t("    removeEdgeLabelProxies",()=>zE(e)),t("    normalize.run",()=>ap.run(e)),t("    parentDummyChains",()=>bE(e)),t("    addBorderSegments",()=>wE(e)),t("    order",()=>vE(e,n)),t("    insertSelfEdges",()=>qE(e)),t("    adjustCoordinateSystem",()=>cp.adjust(e)),t("    position",()=>SE(e)),t("    positionSelfEdges",()=>UE(e)),t("    removeBorderNodes",()=>WE(e)),t("    normalize.undo",()=>ap.undo(e)),t("    fixupEdgeLabelCoords",()=>HE(e)),t("    undoCoordinateSystem",()=>cp.undo(e)),t("    translateGraph",()=>BE(e)),t("    assignNodeIntersects",()=>$E(e)),t("    reversePoints",()=>VE(e)),t("    acyclic.undo",()=>sp.undo(e))}function NE(e,t){e.nodes().forEach(n=>{let o=e.node(n),r=t.node(n);o&&(o.x=r.x,o.y=r.y,o.rank=r.rank,t.children(n).length&&(o.width=r.width,o.height=r.height))}),e.edges().forEach(n=>{let o=e.edge(n),r=t.edge(n);o.points=r.points,Object.hasOwn(r,"x")&&(o.x=r.x,o.y=r.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var TE=["nodesep","edgesep","ranksep","marginx","marginy"],kE={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},DE=["acyclicer","ranker","rankdir","align"],IE=["width","height"],dp={width:0,height:0},ME=["minlen","weight","width","height","labeloffset"],RE={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},OE=["labelpos"];function PE(e){let t=new EE({multigraph:!0,compound:!0}),n=Ms(e.graph());return t.setGraph(Object.assign({},kE,Is(n,TE),Je.pick(n,DE))),e.nodes().forEach(o=>{let r=Ms(e.node(o)),i=Is(r,IE);Object.keys(dp).forEach(s=>{i[s]===void 0&&(i[s]=dp[s])}),t.setNode(o,i),t.setParent(o,e.parent(o))}),e.edges().forEach(o=>{let r=Ms(e.edge(o));t.setEdge(o,Object.assign({},RE,Is(r,ME),Je.pick(r,OE)))}),t}function AE(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let o=e.edge(n);o.minlen*=2,o.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?o.width+=o.labeloffset:o.height+=o.labeloffset)})}function LE(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let o=e.node(t.v),i={rank:(e.node(t.w).rank-o.rank)/2+o.rank,e:t};Je.addDummyNode(e,"edge-proxy",i,"_ep")}})}function FE(e){let t=0;e.nodes().forEach(n=>{let o=e.node(n);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,t=Math.max(t,o.maxRank))}),e.graph().maxRank=t}function zE(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function BE(e){let t=Number.POSITIVE_INFINITY,n=0,o=Number.POSITIVE_INFINITY,r=0,i=e.graph(),s=i.marginx||0,a=i.marginy||0;function l(c){let d=c.x,u=c.y,f=c.width,h=c.height;t=Math.min(t,d-f/2),n=Math.max(n,d+f/2),o=Math.min(o,u-h/2),r=Math.max(r,u+h/2)}e.nodes().forEach(c=>l(e.node(c))),e.edges().forEach(c=>{let d=e.edge(c);Object.hasOwn(d,"x")&&l(d)}),t-=s,o-=a,e.nodes().forEach(c=>{let d=e.node(c);d.x-=t,d.y-=o}),e.edges().forEach(c=>{let d=e.edge(c);d.points.forEach(u=>{u.x-=t,u.y-=o}),Object.hasOwn(d,"x")&&(d.x-=t),Object.hasOwn(d,"y")&&(d.y-=o)}),i.width=n-t+s,i.height=r-o+a}function $E(e){e.edges().forEach(t=>{let n=e.edge(t),o=e.node(t.v),r=e.node(t.w),i,s;n.points?(i=n.points[0],s=n.points[n.points.length-1]):(n.points=[],i=r,s=o),n.points.unshift(Je.intersectRect(o,i)),n.points.push(Je.intersectRect(r,s))})}function HE(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function VE(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function WE(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),o=e.node(n.borderTop),r=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),s=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(s.x-i.x),n.height=Math.abs(r.y-o.y),n.x=i.x+n.width/2,n.y=o.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy==="border"&&e.removeNode(t)})}function KE(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function qE(e){var t=Je.buildLayerMatrix(e);t.forEach(n=>{var o=0;n.forEach((r,i)=>{var s=e.node(r);s.order=i+o,(s.selfEdges||[]).forEach(a=>{Je.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:i+ ++o,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function UE(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy==="selfedge"){var o=e.node(n.e.v),r=o.x+o.width/2,i=o.y,s=n.x-r,a=o.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:r+2*s/3,y:i-a},{x:r+5*s/6,y:i-a},{x:r+s,y:i},{x:r+5*s/6,y:i+a},{x:r+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function Is(e,t){return Je.mapValues(Je.pick(e,t),Number)}function Ms(e){var t={};return e&&Object.entries(e).forEach(([n,o])=>{typeof n=="string"&&(n=n.toLowerCase()),t[n]=o}),t}});var pp=J((zI,hp)=>{"use strict";var YE=ve(),GE=Qe().Graph;hp.exports={debugOrdering:XE};function XE(e){let t=YE.buildLayerMatrix(e),n=new GE({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(o=>{n.setNode(o,{label:o}),n.setParent(o,"layer"+e.node(o).rank)}),e.edges().forEach(o=>n.setEdge(o.v,o.w,{},o.name)),t.forEach((o,r)=>{let i="layer"+r;n.setNode(i,{rank:"same"}),o.reduce((s,a)=>(n.setEdge(s,a,{style:"invis"}),a))}),n}});var gp=J((BI,mp)=>{"use strict";mp.exports="1.1.4"});var bp=J(($I,yp)=>{"use strict";yp.exports={graphlib:Qe(),layout:fp(),debug:pp(),util:{time:ve().time,notime:ve().notime},version:gp()}});var vm=K(Cg());var lt=K(he());var it=K(_g()),de;(u=>{let e;(v=>(v[v.CASCADE=0]="CASCADE",v[v.NO_ACTION=1]="NO_ACTION",v[v.SET_NULL=2]="SET_NULL",v[v.SET_DEFAULT=3]="SET_DEFAULT"))(e=u.OnAction||={});let t;(g=>(g[g.Created=0]="Created",g[g.Updated=1]="Updated",g[g.Dropped=2]="Dropped"))(t=u.SchemaDesignerReportTableState||={});let n;(h=>h.type=new it.RequestType("publishSession"))(n=u.PublishSessionRequest||={});let o;(h=>h.type=new it.NotificationType("closeDesigner"))(o=u.CloseSchemaDesignerNotification||={});let r;(h=>h.type=new it.NotificationType("openInEditorWithConnection"))(r=u.OpenInEditorWithConnectionNotification||={});let i;(h=>h.type=new it.NotificationType("openInEditor"))(i=u.OpenInEditorNotification||={});let s;(h=>h.type=new it.NotificationType("copyToClipboard"))(s=u.CopyToClipboardNotification||={});let a;(h=>h.type=new it.RequestType("getReport"))(a=u.GetReportWebviewRequest||={});let l;(h=>h.type=new it.NotificationType("exportToFile"))(l=u.ExportToFileNotification||={});let c;(h=>h.type=new it.RequestType("getDefinition"))(c=u.GetDefinitionRequest||={});let d;(h=>h.type=new it.RequestType("initializeSchemaDesigner"))(d=u.InitializeSchemaDesignerRequest||={})})(de||={});var I=K(ee()),O=K(he());function be(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=be(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Ng={value:()=>{}};function nl(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new qo(n)}function qo(e){this._=e}function Tg(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}qo.prototype=nl.prototype={constructor:qo,on:function(e,t){var n=this._,o=Tg(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=kg(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=tl(n[r],e.name,t);else if(t==null)for(r in n)n[r]=tl(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new qo(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function kg(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function tl(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=Ng,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Vt=nl;var Uo="http://www.w3.org/1999/xhtml",yi={svg:"http://www.w3.org/2000/svg",xhtml:Uo,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function wt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),yi.hasOwnProperty(t)?{space:yi[t],local:e}:e}function Dg(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Uo&&t.documentElement.namespaceURI===Uo?t.createElement(e):t.createElementNS(n,e)}}function Ig(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Yo(e){var t=wt(e);return(t.local?Ig:Dg)(t)}function Mg(){}function Wt(e){return e==null?Mg:function(){return this.querySelector(e)}}function ol(e){typeof e!="function"&&(e=Wt(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),l,c,d=0;d<s;++d)(l=i[d])&&(c=e.call(l,l.__data__,d,i))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new xe(o,this._parents)}function bi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Rg(){return[]}function Vn(e){return e==null?Rg:function(){return this.querySelectorAll(e)}}function Og(e){return function(){return bi(e.apply(this,arguments))}}function rl(e){typeof e=="function"?e=Og(e):e=Vn(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(o.push(e.call(l,l.__data__,c,s)),r.push(l));return new xe(o,r)}function Wn(e){return function(){return this.matches(e)}}function Go(e){return function(t){return t.matches(e)}}var Pg=Array.prototype.find;function Ag(e){return function(){return Pg.call(this.children,e)}}function Lg(){return this.firstElementChild}function il(e){return this.select(e==null?Lg:Ag(typeof e=="function"?e:Go(e)))}var Fg=Array.prototype.filter;function zg(){return Array.from(this.children)}function Bg(e){return function(){return Fg.call(this.children,e)}}function sl(e){return this.selectAll(e==null?zg:Bg(typeof e=="function"?e:Go(e)))}function al(e){typeof e!="function"&&(e=Wn(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new xe(o,this._parents)}function Xo(e){return new Array(e.length)}function ll(){return new xe(this._enter||this._groups.map(Xo),this._parents)}function Kn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Kn.prototype={constructor:Kn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function cl(e){return function(){return e}}function $g(e,t,n,o,r,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new Kn(e,i[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function Hg(e,t,n,o,r,i,s){var a,l,c=new Map,d=t.length,u=i.length,f=new Array(d),h;for(a=0;a<d;++a)(l=t[a])&&(f[a]=h=s.call(l,l.__data__,a,t)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<u;++a)h=s.call(e,i[a],a,i)+"",(l=c.get(h))?(o[a]=l,l.__data__=i[a],c.delete(h)):n[a]=new Kn(e,i[a]);for(a=0;a<d;++a)(l=t[a])&&c.get(f[a])===l&&(r[a]=l)}function Vg(e){return e.__data__}function dl(e,t){if(!arguments.length)return Array.from(this,Vg);var n=t?Hg:$g,o=this._parents,r=this._groups;typeof e!="function"&&(e=cl(e));for(var i=r.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var d=o[c],u=r[c],f=u.length,h=Wg(e.call(d,d&&d.__data__,c,o)),p=h.length,g=a[c]=new Array(p),v=s[c]=new Array(p),m=l[c]=new Array(f);n(d,u,g,v,m,h,t);for(var b=0,y=0,x,E;b<p;++b)if(x=g[b]){for(b>=y&&(y=b+1);!(E=v[y])&&++y<p;);x._next=E||null}}return s=new xe(s,o),s._enter=a,s._exit=l,s}function Wg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ul(){return new xe(this._exit||this._groups.map(Xo),this._parents)}function fl(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function hl(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),l=0;l<s;++l)for(var c=n[l],d=o[l],u=c.length,f=a[l]=new Array(u),h,p=0;p<u;++p)(h=c[p]||d[p])&&(f[p]=h);for(;l<r;++l)a[l]=n[l];return new xe(a,this._parents)}function pl(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function ml(e){e||(e=Kg);function t(u,f){return u&&f?e(u.__data__,f.__data__):!u-!f}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,l=r[i]=new Array(a),c,d=0;d<a;++d)(c=s[d])&&(l[d]=c);l.sort(t)}return new xe(r,this._parents).order()}function Kg(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function gl(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function yl(){return Array.from(this)}function bl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function xl(){let e=0;for(let t of this)++e;return e}function wl(){return!this.node()}function vl(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function qg(e){return function(){this.removeAttribute(e)}}function Ug(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Yg(e,t){return function(){this.setAttribute(e,t)}}function Gg(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Xg(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Zg(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Sl(e,t){var n=wt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Ug:qg:typeof t=="function"?n.local?Zg:Xg:n.local?Gg:Yg)(n,t))}function Zo(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function jg(e){return function(){this.style.removeProperty(e)}}function Qg(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Jg(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function El(e,t,n){return arguments.length>1?this.each((t==null?jg:typeof t=="function"?Jg:Qg)(e,t,n??"")):kt(this.node(),e)}function kt(e,t){return e.style.getPropertyValue(t)||Zo(e).getComputedStyle(e,null).getPropertyValue(t)}function ey(e){return function(){delete this[e]}}function ty(e,t){return function(){this[e]=t}}function ny(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Cl(e,t){return arguments.length>1?this.each((t==null?ey:typeof t=="function"?ny:ty)(e,t)):this.node()[e]}function _l(e){return e.trim().split(/^|\s+/)}function xi(e){return e.classList||new Nl(e)}function Nl(e){this._node=e,this._names=_l(e.getAttribute("class")||"")}Nl.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Tl(e,t){for(var n=xi(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function kl(e,t){for(var n=xi(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function oy(e){return function(){Tl(this,e)}}function ry(e){return function(){kl(this,e)}}function iy(e,t){return function(){(t.apply(this,arguments)?Tl:kl)(this,e)}}function Dl(e,t){var n=_l(e+"");if(arguments.length<2){for(var o=xi(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?iy:t?oy:ry)(n,t))}function sy(){this.textContent=""}function ay(e){return function(){this.textContent=e}}function ly(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Il(e){return arguments.length?this.each(e==null?sy:(typeof e=="function"?ly:ay)(e)):this.node().textContent}function cy(){this.innerHTML=""}function dy(e){return function(){this.innerHTML=e}}function uy(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Ml(e){return arguments.length?this.each(e==null?cy:(typeof e=="function"?uy:dy)(e)):this.node().innerHTML}function fy(){this.nextSibling&&this.parentNode.appendChild(this)}function Rl(){return this.each(fy)}function hy(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ol(){return this.each(hy)}function Pl(e){var t=typeof e=="function"?e:Yo(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function py(){return null}function Al(e,t){var n=typeof e=="function"?e:Yo(e),o=t==null?py:typeof t=="function"?t:Wt(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function my(){var e=this.parentNode;e&&e.removeChild(this)}function Ll(){return this.each(my)}function gy(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yy(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fl(e){return this.select(e?yy:gy)}function zl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function by(e){return function(t){e.call(this,t,this.__data__)}}function xy(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function wy(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function vy(e,t,n){return function(){var o=this.__on,r,i=by(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function Bl(e,t,n){var o=xy(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(r=0,d=a[l];r<i;++r)if((s=o[r]).type===d.type&&s.name===d.name)return d.value}return}for(a=t?vy:wy,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function $l(e,t,n){var o=Zo(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Sy(e,t){return function(){return $l(this,e,t)}}function Ey(e,t){return function(){return $l(this,e,t.apply(this,arguments))}}function Hl(e,t){return this.each((typeof t=="function"?Ey:Sy)(e,t))}function*Vl(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var wi=[null];function xe(e,t){this._groups=e,this._parents=t}function Wl(){return new xe([[document.documentElement]],wi)}function Cy(){return this}xe.prototype=Wl.prototype={constructor:xe,select:ol,selectAll:rl,selectChild:il,selectChildren:sl,filter:al,data:dl,enter:ll,exit:ul,join:fl,merge:hl,selection:Cy,order:pl,sort:ml,call:gl,nodes:yl,node:bl,size:xl,empty:wl,each:vl,attr:Sl,style:El,property:Cl,classed:Dl,text:Il,html:Ml,raise:Rl,lower:Ol,append:Pl,insert:Al,remove:Ll,clone:Fl,datum:zl,on:Bl,dispatch:Hl,[Symbol.iterator]:Vl};var vt=Wl;function De(e){return typeof e=="string"?new xe([[document.querySelector(e)]],[document.documentElement]):new xe([[e]],wi)}function Kl(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ae(e,t){if(e=Kl(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}var ql={passive:!1},Kt={capture:!0,passive:!1};function jo(e){e.stopImmediatePropagation()}function Dt(e){e.preventDefault(),e.stopImmediatePropagation()}function qn(e){var t=e.document.documentElement,n=De(e).on("dragstart.drag",Dt,Kt);"onselectstart"in t?n.on("selectstart.drag",Dt,Kt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Un(e,t){var n=e.document.documentElement,o=De(e).on("dragstart.drag",null);t&&(o.on("click.drag",Dt,Kt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Yn=e=>()=>e;function Gn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Gn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function _y(e){return!e.ctrlKey&&!e.button}function Ny(){return this.parentNode}function Ty(e,t){return t??{x:e.x,y:e.y}}function ky(){return navigator.maxTouchPoints||"ontouchstart"in this}function Qo(){var e=_y,t=Ny,n=Ty,o=ky,r={},i=Vt("start","drag","end"),s=0,a,l,c,d,u=0;function f(x){x.on("mousedown.drag",h).filter(o).on("touchstart.drag",v).on("touchmove.drag",m,ql).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(x,E){if(!(d||!e.call(this,x,E))){var C=y(this,t.call(this,x,E),x,E,"mouse");C&&(De(x.view).on("mousemove.drag",p,Kt).on("mouseup.drag",g,Kt),qn(x.view),jo(x),c=!1,a=x.clientX,l=x.clientY,C("start",x))}}function p(x){if(Dt(x),!c){var E=x.clientX-a,C=x.clientY-l;c=E*E+C*C>u}r.mouse("drag",x)}function g(x){De(x.view).on("mousemove.drag mouseup.drag",null),Un(x.view,c),Dt(x),r.mouse("end",x)}function v(x,E){if(e.call(this,x,E)){var C=x.changedTouches,N=t.call(this,x,E),M=C.length,R,L;for(R=0;R<M;++R)(L=y(this,N,x,E,C[R].identifier,C[R]))&&(jo(x),L("start",x,C[R]))}}function m(x){var E=x.changedTouches,C=E.length,N,M;for(N=0;N<C;++N)(M=r[E[N].identifier])&&(Dt(x),M("drag",x,E[N]))}function b(x){var E=x.changedTouches,C=E.length,N,M;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),N=0;N<C;++N)(M=r[E[N].identifier])&&(jo(x),M("end",x,E[N]))}function y(x,E,C,N,M,R){var L=i.copy(),$=Ae(R||C,E),z,B,w;if((w=n.call(x,new Gn("beforestart",{sourceEvent:C,target:f,identifier:M,active:s,x:$[0],y:$[1],dx:0,dy:0,dispatch:L}),N))!=null)return z=w.x-$[0]||0,B=w.y-$[1]||0,function T(S,k,A){var _=$,P;switch(S){case"start":r[M]=T,P=s++;break;case"end":delete r[M],--s;case"drag":$=Ae(A||k,E),P=s;break}L.call(S,x,new Gn(S,{sourceEvent:k,subject:w,target:f,identifier:M,active:P,x:$[0]+z,y:$[1]+B,dx:$[0]-_[0],dy:$[1]-_[1],dispatch:L}),N)}}return f.filter=function(x){return arguments.length?(e=typeof x=="function"?x:Yn(!!x),f):e},f.container=function(x){return arguments.length?(t=typeof x=="function"?x:Yn(x),f):t},f.subject=function(x){return arguments.length?(n=typeof x=="function"?x:Yn(x),f):n},f.touchable=function(x){return arguments.length?(o=typeof x=="function"?x:Yn(!!x),f):o},f.on=function(){var x=i.on.apply(i,arguments);return x===i?f:x},f.clickDistance=function(x){return arguments.length?(u=(x=+x)*x,f):Math.sqrt(u)},f}function Jo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vi(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function jn(){}var Xn=.7,nr=1/Xn,bn="\\s*([+-]?\\d+)\\s*",Zn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ft="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Dy=/^#([0-9a-f]{3,8})$/,Iy=new RegExp(`^rgb\\(${bn},${bn},${bn}\\)$`),My=new RegExp(`^rgb\\(${ft},${ft},${ft}\\)$`),Ry=new RegExp(`^rgba\\(${bn},${bn},${bn},${Zn}\\)$`),Oy=new RegExp(`^rgba\\(${ft},${ft},${ft},${Zn}\\)$`),Py=new RegExp(`^hsl\\(${Zn},${ft},${ft}\\)$`),Ay=new RegExp(`^hsla\\(${Zn},${ft},${ft},${Zn}\\)$`),Ul={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Jo(jn,It,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Yl,formatHex:Yl,formatHex8:Ly,formatHsl:Fy,formatRgb:Gl,toString:Gl});function Yl(){return this.rgb().formatHex()}function Ly(){return this.rgb().formatHex8()}function Fy(){return ec(this).formatHsl()}function Gl(){return this.rgb().formatRgb()}function It(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Dy.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Xl(t):n===3?new $e(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?er(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?er(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Iy.exec(e))?new $e(t[1],t[2],t[3],1):(t=My.exec(e))?new $e(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ry.exec(e))?er(t[1],t[2],t[3],t[4]):(t=Oy.exec(e))?er(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Py.exec(e))?Ql(t[1],t[2]/100,t[3]/100,1):(t=Ay.exec(e))?Ql(t[1],t[2]/100,t[3]/100,t[4]):Ul.hasOwnProperty(e)?Xl(Ul[e]):e==="transparent"?new $e(NaN,NaN,NaN,0):null}function Xl(e){return new $e(e>>16&255,e>>8&255,e&255,1)}function er(e,t,n,o){return o<=0&&(e=t=n=NaN),new $e(e,t,n,o)}function zy(e){return e instanceof jn||(e=It(e)),e?(e=e.rgb(),new $e(e.r,e.g,e.b,e.opacity)):new $e}function xn(e,t,n,o){return arguments.length===1?zy(e):new $e(e,t,n,o??1)}function $e(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}Jo($e,xn,vi(jn,{brighter(e){return e=e==null?nr:Math.pow(nr,e),new $e(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Xn:Math.pow(Xn,e),new $e(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new $e(Ut(this.r),Ut(this.g),Ut(this.b),or(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zl,formatHex:Zl,formatHex8:By,formatRgb:jl,toString:jl}));function Zl(){return`#${qt(this.r)}${qt(this.g)}${qt(this.b)}`}function By(){return`#${qt(this.r)}${qt(this.g)}${qt(this.b)}${qt((isNaN(this.opacity)?1:this.opacity)*255)}`}function jl(){let e=or(this.opacity);return`${e===1?"rgb(":"rgba("}${Ut(this.r)}, ${Ut(this.g)}, ${Ut(this.b)}${e===1?")":`, ${e})`}`}function or(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ut(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qt(e){return e=Ut(e),(e<16?"0":"")+e.toString(16)}function Ql(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new st(e,t,n,o)}function ec(e){if(e instanceof st)return new st(e.h,e.s,e.l,e.opacity);if(e instanceof jn||(e=It(e)),!e)return new st;if(e instanceof st)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,l=(i+r)/2;return a?(t===i?s=(n-o)/a+(n<o)*6:n===i?s=(o-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+r:2-i-r,s*=60):a=l>0&&l<1?0:s,new st(s,a,l,e.opacity)}function tc(e,t,n,o){return arguments.length===1?ec(e):new st(e,t,n,o??1)}function st(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}Jo(st,tc,vi(jn,{brighter(e){return e=e==null?nr:Math.pow(nr,e),new st(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Xn:Math.pow(Xn,e),new st(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new $e(Si(e>=240?e-240:e+120,r,o),Si(e,r,o),Si(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new st(Jl(this.h),tr(this.s),tr(this.l),or(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=or(this.opacity);return`${e===1?"hsl(":"hsla("}${Jl(this.h)}, ${tr(this.s)*100}%, ${tr(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Jl(e){return e=(e||0)%360,e<0?e+360:e}function tr(e){return Math.max(0,Math.min(1,e||0))}function Si(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function Ei(e,t,n,o,r){var i=e*e,s=i*e;return((1-3*e+3*i-s)*t+(4-6*i+3*s)*n+(1+3*e+3*i-3*s)*o+s*r)/6}function nc(e){var t=e.length-1;return function(n){var o=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[o],i=e[o+1],s=o>0?e[o-1]:2*r-i,a=o<t-1?e[o+2]:2*i-r;return Ei((n-o/t)*t,s,r,i,a)}}function oc(e){var t=e.length;return function(n){var o=Math.floor(((n%=1)<0?++n:n)*t),r=e[(o+t-1)%t],i=e[o%t],s=e[(o+1)%t],a=e[(o+2)%t];return Ei((n-o/t)*t,r,i,s,a)}}var Ci=e=>()=>e;function $y(e,t){return function(n){return e+n*t}}function Hy(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function rc(e){return(e=+e)==1?rr:function(t,n){return n-t?Hy(t,n,e):Ci(isNaN(t)?n:t)}}function rr(e,t){var n=t-e;return n?$y(e,n):Ci(isNaN(e)?t:e)}var ir=function e(t){var n=rc(t);function o(r,i){var s=n((r=xn(r)).r,(i=xn(i)).r),a=n(r.g,i.g),l=n(r.b,i.b),c=rr(r.opacity,i.opacity);return function(d){return r.r=s(d),r.g=a(d),r.b=l(d),r.opacity=c(d),r+""}}return o.gamma=e,o}(1);function ic(e){return function(t){var n=t.length,o=new Array(n),r=new Array(n),i=new Array(n),s,a;for(s=0;s<n;++s)a=xn(t[s]),o[s]=a.r||0,r[s]=a.g||0,i[s]=a.b||0;return o=e(o),r=e(r),i=e(i),a.opacity=1,function(l){return a.r=o(l),a.g=r(l),a.b=i(l),a+""}}}var Vy=ic(nc),Wy=ic(oc);function Xe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Ni=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_i=new RegExp(Ni.source,"g");function Ky(e){return function(){return e}}function qy(e){return function(t){return e(t)+""}}function Ti(e,t){var n=Ni.lastIndex=_i.lastIndex=0,o,r,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(o=Ni.exec(e))&&(r=_i.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(o=o[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:Xe(o,r)})),n=_i.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?qy(l[0].x):Ky(t):(t=l.length,function(c){for(var d=0,u;d<t;++d)a[(u=l[d]).i]=u.x(c);return a.join("")})}var sc=180/Math.PI,sr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ki(e,t,n,o,r,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*sc,skewX:Math.atan(l)*sc,scaleX:s,scaleY:a}}var ar;function ac(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?sr:ki(t.a,t.b,t.c,t.d,t.e,t.f)}function lc(e){return e==null?sr:(ar||(ar=document.createElementNS("http://www.w3.org/2000/svg","g")),ar.setAttribute("transform",e),(e=ar.transform.baseVal.consolidate())?(e=e.matrix,ki(e.a,e.b,e.c,e.d,e.e,e.f)):sr)}function cc(e,t,n,o){function r(c){return c.length?c.pop()+" ":""}function i(c,d,u,f,h,p){if(c!==u||d!==f){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:Xe(c,u)},{i:g-2,x:Xe(d,f)})}else(u||f)&&h.push("translate("+u+t+f+n)}function s(c,d,u,f){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),f.push({i:u.push(r(u)+"rotate(",null,o)-2,x:Xe(c,d)})):d&&u.push(r(u)+"rotate("+d+o)}function a(c,d,u,f){c!==d?f.push({i:u.push(r(u)+"skewX(",null,o)-2,x:Xe(c,d)}):d&&u.push(r(u)+"skewX("+d+o)}function l(c,d,u,f,h,p){if(c!==u||d!==f){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:Xe(c,u)},{i:g-2,x:Xe(d,f)})}else(u!==1||f!==1)&&h.push(r(h)+"scale("+u+","+f+")")}return function(c,d){var u=[],f=[];return c=e(c),d=e(d),i(c.translateX,c.translateY,d.translateX,d.translateY,u,f),s(c.rotate,d.rotate,u,f),a(c.skewX,d.skewX,u,f),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,u,f),c=d=null,function(h){for(var p=-1,g=f.length,v;++p<g;)u[(v=f[p]).i]=v.x(h);return u.join("")}}}var Di=cc(ac,"px, ","px)","deg)"),Ii=cc(lc,", ",")",")");var Uy=1e-12;function dc(e){return((e=Math.exp(e))+1/e)/2}function Yy(e){return((e=Math.exp(e))-1/e)/2}function Gy(e){return((e=Math.exp(2*e))-1)/(e+1)}var Mi=function e(t,n,o){function r(i,s){var a=i[0],l=i[1],c=i[2],d=s[0],u=s[1],f=s[2],h=d-a,p=u-l,g=h*h+p*p,v,m;if(g<Uy)m=Math.log(f/c)/t,v=function(N){return[a+N*h,l+N*p,c*Math.exp(t*N*m)]};else{var b=Math.sqrt(g),y=(f*f-c*c+o*g)/(2*c*n*b),x=(f*f-c*c-o*g)/(2*f*n*b),E=Math.log(Math.sqrt(y*y+1)-y),C=Math.log(Math.sqrt(x*x+1)-x);m=(C-E)/t,v=function(N){var M=N*m,R=dc(E),L=c/(n*b)*(R*Gy(t*M+E)-Yy(E));return[a+L*h,l+L*p,c*R/dc(t*M+E)]}}return v.duration=m*1e3*t/Math.SQRT2,v}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},r}(Math.SQRT2,2,4);var wn=0,Jn=0,Qn=0,fc=1e3,lr,eo,cr=0,Yt=0,dr=0,to=typeof performance=="object"&&performance.now?performance:Date,hc=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function oo(){return Yt||(hc(Xy),Yt=to.now()+dr)}function Xy(){Yt=0}function no(){this._call=this._time=this._next=null}no.prototype=ur.prototype={constructor:no,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?oo():+n)+(t==null?0:+t),!this._next&&eo!==this&&(eo?eo._next=this:lr=this,eo=this),this._call=e,this._time=n,Ri()},stop:function(){this._call&&(this._call=null,this._time=1/0,Ri())}};function ur(e,t,n){var o=new no;return o.restart(e,t,n),o}function pc(){oo(),++wn;for(var e=lr,t;e;)(t=Yt-e._time)>=0&&e._call.call(void 0,t),e=e._next;--wn}function uc(){Yt=(cr=to.now())+dr,wn=Jn=0;try{pc()}finally{wn=0,jy(),Yt=0}}function Zy(){var e=to.now(),t=e-cr;t>fc&&(dr-=t,cr=e)}function jy(){for(var e,t=lr,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:lr=n);eo=e,Ri(o)}function Ri(e){if(!wn){Jn&&(Jn=clearTimeout(Jn));var t=e-Yt;t>24?(e<1/0&&(Jn=setTimeout(uc,e-to.now()-dr)),Qn&&(Qn=clearInterval(Qn))):(Qn||(cr=to.now(),Qn=setInterval(Zy,fc)),wn=1,hc(uc))}}function fr(e,t,n){var o=new no;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Qy=Vt("start","end","cancel","interrupt"),Jy=[],yc=0,mc=1,pr=2,hr=3,gc=4,mr=5,ro=6;function Mt(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;eb(e,n,{name:t,index:o,group:r,on:Qy,tween:Jy,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:yc})}function io(e,t){var n=ke(e,t);if(n.state>yc)throw new Error("too late; already scheduled");return n}function Me(e,t){var n=ke(e,t);if(n.state>hr)throw new Error("too late; already running");return n}function ke(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function eb(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=ur(i,0,n.time);function i(c){n.state=mc,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var d,u,f,h;if(n.state!==mc)return l();for(d in o)if(h=o[d],h.name===n.name){if(h.state===hr)return fr(s);h.state===gc?(h.state=ro,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[d]):+d<t&&(h.state=ro,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[d])}if(fr(function(){n.state===hr&&(n.state=gc,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=pr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===pr){for(n.state=hr,r=new Array(f=n.tween.length),d=0,u=-1;d<f;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=h);r.length=u+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=mr,1),u=-1,f=r.length;++u<f;)r[u].call(e,d);n.state===mr&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=ro,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function Gt(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>pr&&o.state<mr,o.state=ro,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function bc(e){return this.each(function(){Gt(this,e)})}function tb(e,t){var n,o;return function(){var r=Me(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function nb(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=Me(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}i.tween=r}}function xc(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=ke(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?tb:nb)(n,e,t))}function vn(e,t,n){var o=e._id;return e.each(function(){var r=Me(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return ke(r,o).value[t]}}function gr(e,t){var n;return(typeof t=="number"?Xe:t instanceof It?ir:(n=It(t))?(t=n,ir):Ti)(e,t)}function ob(e){return function(){this.removeAttribute(e)}}function rb(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ib(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function sb(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function ab(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function lb(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function wc(e,t){var n=wt(e),o=n==="transform"?Ii:gr;return this.attrTween(e,typeof t=="function"?(n.local?lb:ab)(n,o,vn(this,"attr."+e,t)):t==null?(n.local?rb:ob)(n):(n.local?sb:ib)(n,o,t))}function cb(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function db(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function ub(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&db(e,i)),n}return r._value=t,r}function fb(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&cb(e,i)),n}return r._value=t,r}function vc(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=wt(e);return this.tween(n,(o.local?ub:fb)(o,t))}function hb(e,t){return function(){io(this,e).delay=+t.apply(this,arguments)}}function pb(e,t){return t=+t,function(){io(this,e).delay=t}}function Sc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?hb:pb)(t,e)):ke(this.node(),t).delay}function mb(e,t){return function(){Me(this,e).duration=+t.apply(this,arguments)}}function gb(e,t){return t=+t,function(){Me(this,e).duration=t}}function Ec(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?mb:gb)(t,e)):ke(this.node(),t).duration}function yb(e,t){if(typeof t!="function")throw new Error;return function(){Me(this,e).ease=t}}function Cc(e){var t=this._id;return arguments.length?this.each(yb(t,e)):ke(this.node(),t).ease}function bb(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Me(this,e).ease=n}}function _c(e){if(typeof e!="function")throw new Error;return this.each(bb(this._id,e))}function Nc(e){typeof e!="function"&&(e=Wn(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Le(o,this._parents,this._name,this._id)}function Tc(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var l=t[a],c=n[a],d=l.length,u=s[a]=new Array(d),f,h=0;h<d;++h)(f=l[h]||c[h])&&(u[h]=f);for(;a<o;++a)s[a]=t[a];return new Le(s,this._parents,this._name,this._id)}function xb(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function wb(e,t,n){var o,r,i=xb(t)?io:Me;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function kc(e,t){var n=this._id;return arguments.length<2?ke(this.node(),n).on.on(e):this.each(wb(n,e,t))}function vb(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Dc(){return this.on("end.remove",vb(this._id))}function Ic(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Wt(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],l=a.length,c=i[s]=new Array(l),d,u,f=0;f<l;++f)(d=a[f])&&(u=e.call(d,d.__data__,f,a))&&("__data__"in d&&(u.__data__=d.__data__),c[f]=u,Mt(c[f],t,n,f,c,ke(d,n)));return new Le(i,this._parents,t,n)}function Mc(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Vn(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var l=o[a],c=l.length,d,u=0;u<c;++u)if(d=l[u]){for(var f=e.call(d,d.__data__,u,l),h,p=ke(d,n),g=0,v=f.length;g<v;++g)(h=f[g])&&Mt(h,t,n,g,f,p);i.push(f),s.push(d)}return new Le(i,s,t,n)}var Sb=vt.prototype.constructor;function Rc(){return new Sb(this._groups,this._parents)}function Eb(e,t){var n,o,r;return function(){var i=kt(this,e),s=(this.style.removeProperty(e),kt(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function Oc(e){return function(){this.style.removeProperty(e)}}function Cb(e,t,n){var o,r=n+"",i;return function(){var s=kt(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function _b(e,t,n){var o,r,i;return function(){var s=kt(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),kt(this,e))),s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a))}}function Nb(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var l=Me(this,e),c=l.on,d=l.value[i]==null?a||(a=Oc(t)):void 0;(c!==n||r!==d)&&(o=(n=c).copy()).on(s,r=d),l.on=o}}function Pc(e,t,n){var o=(e+="")=="transform"?Di:gr;return t==null?this.styleTween(e,Eb(e,o)).on("end.style."+e,Oc(e)):typeof t=="function"?this.styleTween(e,_b(e,o,vn(this,"style."+e,t))).each(Nb(this._id,e)):this.styleTween(e,Cb(e,o,t),n).on("end.style."+e,null)}function Tb(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function kb(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&Tb(e,s,n)),o}return i._value=t,i}function Ac(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,kb(e,t,n??""))}function Db(e){return function(){this.textContent=e}}function Ib(e){return function(){var t=e(this);this.textContent=t??""}}function Lc(e){return this.tween("text",typeof e=="function"?Ib(vn(this,"text",e)):Db(e==null?"":e+""))}function Mb(e){return function(t){this.textContent=e.call(this,t)}}function Rb(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Mb(r)),t}return o._value=e,o}function Fc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Rb(e))}function zc(){for(var e=this._name,t=this._id,n=yr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var d=ke(l,t);Mt(l,e,n,c,s,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Le(o,this._parents,e,n)}function Bc(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--r===0&&i()}};n.each(function(){var c=Me(this,o),d=c.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),r===0&&i()})}var Ob=0;function Le(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function $c(e){return vt().transition(e)}function yr(){return++Ob}var St=vt.prototype;Le.prototype=$c.prototype={constructor:Le,select:Ic,selectAll:Mc,selectChild:St.selectChild,selectChildren:St.selectChildren,filter:Nc,merge:Tc,selection:Rc,transition:zc,call:St.call,nodes:St.nodes,node:St.node,size:St.size,empty:St.empty,each:St.each,on:kc,attr:wc,attrTween:vc,style:Pc,styleTween:Ac,text:Lc,textTween:Fc,remove:Dc,tween:xc,delay:Sc,duration:Ec,ease:Cc,easeVarying:_c,end:Bc,[Symbol.iterator]:St[Symbol.iterator]};function br(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Pb={time:null,delay:0,duration:250,ease:br};function Ab(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Hc(e){var t,n;e instanceof Le?(t=e._id,e=e._name):(t=yr(),(n=Pb).time=oo(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&Mt(l,e,t,c,s,n||Ab(l,t));return new Le(o,this._parents,e,t)}vt.prototype.interrupt=bc;vt.prototype.transition=Hc;var so=e=>()=>e;function Oi(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function at(e,t,n){this.k=e,this.x=t,this.y=n}at.prototype={constructor:at,scale:function(e){return e===1?this:new at(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new at(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Xt=new at(1,0,0);ao.prototype=at.prototype;function ao(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Xt;return e.__zoom}function xr(e){e.stopImmediatePropagation()}function Sn(e){e.preventDefault(),e.stopImmediatePropagation()}function Lb(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Fb(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Vc(){return this.__zoom||Xt}function zb(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Bb(){return navigator.maxTouchPoints||"ontouchstart"in this}function $b(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function wr(){var e=Lb,t=Fb,n=$b,o=zb,r=Bb,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=Mi,c=Vt("start","zoom","end"),d,u,f,h=500,p=150,g=0,v=10;function m(w){w.property("__zoom",Vc).on("wheel.zoom",M,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",L).filter(r).on("touchstart.zoom",$).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(w,T,S,k){var A=w.selection?w.selection():w;A.property("__zoom",Vc),w!==A?E(w,T,S,k):A.interrupt().each(function(){C(this,arguments).event(k).start().zoom(null,typeof T=="function"?T.apply(this,arguments):T).end()})},m.scaleBy=function(w,T,S,k){m.scaleTo(w,function(){var A=this.__zoom.k,_=typeof T=="function"?T.apply(this,arguments):T;return A*_},S,k)},m.scaleTo=function(w,T,S,k){m.transform(w,function(){var A=t.apply(this,arguments),_=this.__zoom,P=S==null?x(A):typeof S=="function"?S.apply(this,arguments):S,V=_.invert(P),F=typeof T=="function"?T.apply(this,arguments):T;return n(y(b(_,F),P,V),A,s)},S,k)},m.translateBy=function(w,T,S,k){m.transform(w,function(){return n(this.__zoom.translate(typeof T=="function"?T.apply(this,arguments):T,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,k)},m.translateTo=function(w,T,S,k,A){m.transform(w,function(){var _=t.apply(this,arguments),P=this.__zoom,V=k==null?x(_):typeof k=="function"?k.apply(this,arguments):k;return n(Xt.translate(V[0],V[1]).scale(P.k).translate(typeof T=="function"?-T.apply(this,arguments):-T,typeof S=="function"?-S.apply(this,arguments):-S),_,s)},k,A)};function b(w,T){return T=Math.max(i[0],Math.min(i[1],T)),T===w.k?w:new at(T,w.x,w.y)}function y(w,T,S){var k=T[0]-S[0]*w.k,A=T[1]-S[1]*w.k;return k===w.x&&A===w.y?w:new at(w.k,k,A)}function x(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function E(w,T,S,k){w.on("start.zoom",function(){C(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){C(this,arguments).event(k).end()}).tween("zoom",function(){var A=this,_=arguments,P=C(A,_).event(k),V=t.apply(A,_),F=S==null?x(V):typeof S=="function"?S.apply(A,_):S,H=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),W=A.__zoom,U=typeof T=="function"?T.apply(A,_):T,Y=l(W.invert(F).concat(H/W.k),U.invert(F).concat(H/U.k));return function(q){if(q===1)q=U;else{var Z=Y(q),re=H/Z[2];q=new at(re,F[0]-Z[0]*re,F[1]-Z[1]*re)}P.zoom(null,q)}})}function C(w,T,S){return!S&&w.__zooming||new N(w,T)}function N(w,T){this.that=w,this.args=T,this.active=0,this.sourceEvent=null,this.extent=t.apply(w,T),this.taps=0}N.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,T){return this.mouse&&w!=="mouse"&&(this.mouse[1]=T.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=T.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=T.invert(this.touch1[0])),this.that.__zoom=T,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var T=De(this.that).datum();c.call(w,this.that,new Oi(w,{sourceEvent:this.sourceEvent,target:m,type:w,transform:this.that.__zoom,dispatch:c}),T)}};function M(w,...T){if(!e.apply(this,arguments))return;var S=C(this,T).event(w),k=this.__zoom,A=Math.max(i[0],Math.min(i[1],k.k*Math.pow(2,o.apply(this,arguments)))),_=Ae(w);if(S.wheel)(S.mouse[0][0]!==_[0]||S.mouse[0][1]!==_[1])&&(S.mouse[1]=k.invert(S.mouse[0]=_)),clearTimeout(S.wheel);else{if(k.k===A)return;S.mouse=[_,k.invert(_)],Gt(this),S.start()}Sn(w),S.wheel=setTimeout(P,p),S.zoom("mouse",n(y(b(k,A),S.mouse[0],S.mouse[1]),S.extent,s));function P(){S.wheel=null,S.end()}}function R(w,...T){if(f||!e.apply(this,arguments))return;var S=w.currentTarget,k=C(this,T,!0).event(w),A=De(w.view).on("mousemove.zoom",F,!0).on("mouseup.zoom",H,!0),_=Ae(w,S),P=w.clientX,V=w.clientY;qn(w.view),xr(w),k.mouse=[_,this.__zoom.invert(_)],Gt(this),k.start();function F(W){if(Sn(W),!k.moved){var U=W.clientX-P,Y=W.clientY-V;k.moved=U*U+Y*Y>g}k.event(W).zoom("mouse",n(y(k.that.__zoom,k.mouse[0]=Ae(W,S),k.mouse[1]),k.extent,s))}function H(W){A.on("mousemove.zoom mouseup.zoom",null),Un(W.view,k.moved),Sn(W),k.event(W).end()}}function L(w,...T){if(e.apply(this,arguments)){var S=this.__zoom,k=Ae(w.changedTouches?w.changedTouches[0]:w,this),A=S.invert(k),_=S.k*(w.shiftKey?.5:2),P=n(y(b(S,_),k,A),t.apply(this,T),s);Sn(w),a>0?De(this).transition().duration(a).call(E,P,k,w):De(this).call(m.transform,P,k,w)}}function $(w,...T){if(e.apply(this,arguments)){var S=w.touches,k=S.length,A=C(this,T,w.changedTouches.length===k).event(w),_,P,V,F;for(xr(w),P=0;P<k;++P)V=S[P],F=Ae(V,this),F=[F,this.__zoom.invert(F),V.identifier],A.touch0?!A.touch1&&A.touch0[2]!==F[2]&&(A.touch1=F,A.taps=0):(A.touch0=F,_=!0,A.taps=1+!!d);d&&(d=clearTimeout(d)),_&&(A.taps<2&&(u=F[0],d=setTimeout(function(){d=null},h)),Gt(this),A.start())}}function z(w,...T){if(this.__zooming){var S=C(this,T).event(w),k=w.changedTouches,A=k.length,_,P,V,F;for(Sn(w),_=0;_<A;++_)P=k[_],V=Ae(P,this),S.touch0&&S.touch0[2]===P.identifier?S.touch0[0]=V:S.touch1&&S.touch1[2]===P.identifier&&(S.touch1[0]=V);if(P=S.that.__zoom,S.touch1){var H=S.touch0[0],W=S.touch0[1],U=S.touch1[0],Y=S.touch1[1],q=(q=U[0]-H[0])*q+(q=U[1]-H[1])*q,Z=(Z=Y[0]-W[0])*Z+(Z=Y[1]-W[1])*Z;P=b(P,Math.sqrt(q/Z)),V=[(H[0]+U[0])/2,(H[1]+U[1])/2],F=[(W[0]+Y[0])/2,(W[1]+Y[1])/2]}else if(S.touch0)V=S.touch0[0],F=S.touch0[1];else return;S.zoom("touch",n(y(P,V,F),S.extent,s))}}function B(w,...T){if(this.__zooming){var S=C(this,T).event(w),k=w.changedTouches,A=k.length,_,P;for(xr(w),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),_=0;_<A;++_)P=k[_],S.touch0&&S.touch0[2]===P.identifier?delete S.touch0:S.touch1&&S.touch1[2]===P.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(P=Ae(P,this),Math.hypot(u[0]-P[0],u[1]-P[1])<v)){var V=De(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return m.wheelDelta=function(w){return arguments.length?(o=typeof w=="function"?w:so(+w),m):o},m.filter=function(w){return arguments.length?(e=typeof w=="function"?w:so(!!w),m):e},m.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:so(!!w),m):r},m.extent=function(w){return arguments.length?(t=typeof w=="function"?w:so([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),m):t},m.scaleExtent=function(w){return arguments.length?(i[0]=+w[0],i[1]=+w[1],m):[i[0],i[1]]},m.translateExtent=function(w){return arguments.length?(s[0][0]=+w[0][0],s[1][0]=+w[1][0],s[0][1]=+w[0][1],s[1][1]=+w[1][1],m):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},m.constrain=function(w){return arguments.length?(n=w,m):n},m.duration=function(w){return arguments.length?(a=+w,m):a},m.interpolate=function(w){return arguments.length?(l=w,m):l},m.on=function(){var w=c.on.apply(c,arguments);return w===c?m:w},m.clickDistance=function(w){return arguments.length?(g=(w=+w)*w,m):Math.sqrt(g)},m.tapDistance=function(w){return arguments.length?(v=+w,m):v},m}var Ke={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Nn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],zi=["Enter"," ","Escape"],pt;(function(e){e.Strict="strict",e.Loose="loose"})(pt||(pt={}));var Et;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Et||(Et={}));var Zt;(function(e){e.Partial="partial",e.Full="full"})(Zt||(Zt={}));var Bi={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null},He;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(He||(He={}));var je;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(je||(je={}));var X;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(X||(X={}));var Wc={[X.Left]:X.Right,[X.Right]:X.Left,[X.Top]:X.Bottom,[X.Bottom]:X.Top};function $i(e){return e===null?null:e?"valid":"invalid"}var Hi=e=>"id"in e&&"source"in e&&"target"in e,td=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Vi=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e);var uo=(e,t=[0,0])=>{let{width:n,height:o}=mt(e),r=e.origin??t,i=n*r[0],s=o*r[1];return{x:e.position.x-i,y:e.position.y-s}},fo=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};let n=e.reduce((o,r)=>{let i=typeof r=="string",s=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(r):Vi(r)?r:t.nodeLookup.get(r.id));let a=s?Er(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Nr(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Tr(n)},Tn=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){let r=Er(o);n=Nr(n,r)}}),Tr(n)},Wi=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1)=>{let a={...Dn(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(let c of e.values()){let{measured:d,selectable:u=!0,hidden:f=!1}=c;if(s&&!u||f)continue;let h=d.width??c.width??c.initialWidth??null,p=d.height??c.height??c.initialHeight??null,g=kn(a,Jt(c)),v=(h??0)*(p??0),m=i&&g>0;(!c.internals.handleBounds||m||g>=v||c.dragging)&&l.push(c)}return l},nd=(e,t)=>{let n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Cr(e,t){let n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function _r({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(e.size===0)return Promise.resolve(!1);let a=Tn(e),l=en(a,t,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(l,{duration:s?.duration}),Promise.resolve(!0)}function Ki({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){let s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},d=s.origin??o,u=r;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",Ke.error005());else{let h=a.measured.width,p=a.measured.height;h&&p&&(u=[[l,c],[l+h,c+p]])}else a&&_n(s.extent)&&(u=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);let f=_n(u)?jt(t,u,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",Ke.error015()),{position:{x:f.x-l+(s.measured.width??0)*d[0],y:f.y-c+(s.measured.height??0)*d[1]},positionAbsolute:f}}async function od({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){let i=new Set(e.map(f=>f.id)),s=[];for(let f of n){if(f.deletable===!1)continue;let h=i.has(f.id),p=!h&&f.parentId&&s.find(g=>g.id===f.parentId);(h||p)&&s.push(f)}let a=new Set(t.map(f=>f.id)),l=o.filter(f=>f.deletable!==!1),d=nd(s,l);for(let f of l)a.has(f.id)&&!d.find(p=>p.id===f.id)&&d.push(f);if(!r)return{edges:d,nodes:s};let u=await r({nodes:s,edges:d});return typeof u=="boolean"?u?{edges:d,nodes:s}:{edges:[],nodes:[]}:u}var Cn=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),jt=(e={x:0,y:0},t,n)=>({x:Cn(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Cn(e.y,t[0][1],t[1][1]-(n?.height??0))});function rd(e,t,n){let{width:o,height:r}=mt(n),{x:i,y:s}=n.internals.positionAbsolute;return jt(e,[[i,s],[i+o,s+r]],t)}var Kc=(e,t,n)=>e<t?Cn(Math.abs(e-t),1,t)/t:e>n?-Cn(Math.abs(e-n),1,t)/t:0,id=(e,t,n=15,o=40)=>{let r=Kc(e.x,o,t.width-o)*n,i=Kc(e.y,o,t.height-o)*n;return[r,i]},Nr=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Fi=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Tr=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Jt=(e,t=[0,0])=>{let{x:n,y:o}=Vi(e)?e.internals.positionAbsolute:uo(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Er=(e,t=[0,0])=>{let{x:n,y:o}=Vi(e)?e.internals.positionAbsolute:uo(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},qi=(e,t)=>Tr(Nr(Fi(e),Fi(t))),kn=(e,t)=>{let n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Ui=e=>Ze(e.width)&&Ze(e.height)&&Ze(e.x)&&Ze(e.y),Ze=e=>!isNaN(e)&&isFinite(e),Yi=(e,t)=>{},ho=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Dn=({x:e,y:t},[n,o,r],i=!1,s=[1,1])=>{let a={x:(e-n)/r,y:(t-o)/r};return i?ho(a,s):a},Gi=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o}),en=(e,t,n,o,r,i)=>{let s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),c=Cn(l,o,r),d=e.x+e.width/2,u=e.y+e.height/2,f=t/2-d*c,h=n/2-u*c;return{x:f,y:h,zoom:c}},po=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function _n(e){return e!==void 0&&e!=="parent"}function mt(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Xi(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Zi(e,t={width:0,height:0},n,o,r){let i={...e},s=o.get(n);if(s){let a=s.origin||r;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function ji(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function lo(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){let{x:i,y:s}=ht(e),a=Dn({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:l,y:c}=n?ho(a,t):a;return{xSnapped:l,ySnapped:c,...a}}var mo=e=>({width:e.offsetWidth,height:e.offsetHeight}),Qi=e=>e?.getRootNode?.()||window?.document,Hb=["INPUT","SELECT","TEXTAREA"];function kr(e){let t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Hb.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}var Ji=e=>"clientX"in e,ht=(e,t)=>{let n=Ji(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},qc=(e,t,n,o,r)=>{let i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{let a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...mo(s)}})};function Dr({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){let l=e*.125+r*.375+s*.375+n*.125,c=t*.125+i*.375+a*.375+o*.125,d=Math.abs(l-e),u=Math.abs(c-t);return[l,c,d,u]}function vr(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Uc({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case X.Left:return[t-vr(t-o,i),n];case X.Right:return[t+vr(o-t,i),n];case X.Top:return[t,n-vr(n-r,i)];case X.Bottom:return[t,n+vr(r-n,i)]}}function Ir({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:i=X.Top,curvature:s=.25}){let[a,l]=Uc({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[c,d]=Uc({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[u,f,h,p]=Dr({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${e},${t} C${a},${l} ${c},${d} ${o},${r}`,u,f,h,p]}function es({sourceX:e,sourceY:t,targetX:n,targetY:o}){let r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,a=o<t?o+s:o-s;return[i,a,r,s]}function sd({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1}){if(!r)return o;let i=n||t.selected||e.selected,s=Math.max(e.internals.z||0,t.internals.z||0,1e3);return o+(i?s:0)}function ad({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){let i=Nr(Er(e),Er(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);let s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return kn(s,Tr(i))>0}var Vb=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,Wb=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),go=(e,t)=>{if(!e.source||!e.target)return Yi("006",Ke.error006()),t;let n;return Hi(e)?n={...e}:n={...e,id:Vb(e)},Wb(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function Mr({sourceX:e,sourceY:t,targetX:n,targetY:o}){let[r,i,s,a]=es({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,a]}var Yc={[X.Left]:{x:-1,y:0},[X.Right]:{x:1,y:0},[X.Top]:{x:0,y:-1},[X.Bottom]:{x:0,y:1}},Kb=({source:e,sourcePosition:t=X.Bottom,target:n})=>t===X.Left||t===X.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Gc=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function qb({source:e,sourcePosition:t=X.Bottom,target:n,targetPosition:o=X.Top,center:r,offset:i}){let s=Yc[t],a=Yc[o],l={x:e.x+s.x*i,y:e.y+s.y*i},c={x:n.x+a.x*i,y:n.y+a.y*i},d=Kb({source:l,sourcePosition:t,target:c}),u=d.x!==0?"x":"y",f=d[u],h=[],p,g,v={x:0,y:0},m={x:0,y:0},[b,y,x,E]=es({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[u]*a[u]===-1){p=r.x??b,g=r.y??y;let N=[{x:p,y:l.y},{x:p,y:c.y}],M=[{x:l.x,y:g},{x:c.x,y:g}];s[u]===f?h=u==="x"?N:M:h=u==="x"?M:N}else{let N=[{x:l.x,y:c.y}],M=[{x:c.x,y:l.y}];if(u==="x"?h=s.x===f?M:N:h=s.y===f?N:M,t===o){let B=Math.abs(e[u]-n[u]);if(B<=i){let w=Math.min(i-1,i-B);s[u]===f?v[u]=(l[u]>e[u]?-1:1)*w:m[u]=(c[u]>n[u]?-1:1)*w}}if(t!==o){let B=u==="x"?"y":"x",w=s[u]===a[B],T=l[B]>c[B],S=l[B]<c[B];(s[u]===1&&(!w&&T||w&&S)||s[u]!==1&&(!w&&S||w&&T))&&(h=u==="x"?N:M)}let R={x:l.x+v.x,y:l.y+v.y},L={x:c.x+m.x,y:c.y+m.y},$=Math.max(Math.abs(R.x-h[0].x),Math.abs(L.x-h[0].x)),z=Math.max(Math.abs(R.y-h[0].y),Math.abs(L.y-h[0].y));$>=z?(p=(R.x+L.x)/2,g=h[0].y):(p=h[0].x,g=(R.y+L.y)/2)}return[[e,{x:l.x+v.x,y:l.y+v.y},...h,{x:c.x+m.x,y:c.y+m.y},n],p,g,x,E]}function Ub(e,t,n,o){let r=Math.min(Gc(e,t)/2,Gc(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){let c=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${i+r*c},${s}Q ${i},${s} ${i},${s+r*d}`}let a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+r*l}Q ${i},${s} ${i+r*a},${s}`}function yo({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:i=X.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20}){let[d,u,f,h,p]=qb({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:l},offset:c});return[d.reduce((v,m,b)=>{let y="";return b>0&&b<d.length-1?y=Ub(d[b-1],m,d[b+1],s):y=`${b===0?"M":"L"}${m.x} ${m.y}`,v+=y,v},""),u,f,h,p]}function Xc(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function ld(e){let{sourceNode:t,targetNode:n}=e;if(!Xc(t)||!Xc(n))return null;let o=t.internals.handleBounds||Zc(t.handles),r=n.internals.handleBounds||Zc(n.handles),i=jc(o?.source??[],e.sourceHandle),s=jc(e.connectionMode===pt.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",Ke.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let a=i?.position||X.Bottom,l=s?.position||X.Top,c=co(t,i,a),d=co(n,s,l);return{sourceX:c.x,sourceY:c.y,targetX:d.x,targetY:d.y,sourcePosition:a,targetPosition:l}}function Zc(e){if(!e)return null;let t=[],n=[];for(let o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function co(e,t,n=X.Left,o=!1){let r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??mt(e);if(o)return{x:r+s/2,y:i+a/2};switch(t?.position??n){case X.Top:return{x:r+s/2,y:i};case X.Right:return{x:r+s,y:i+a/2};case X.Bottom:return{x:r+s/2,y:i+a};case X.Left:return{x:r,y:i+a/2}}}function jc(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function Rr(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function cd(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){let i=new Set;return e.reduce((s,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){let c=Rr(l,t);i.has(c)||(s.push({id:c,color:l.color||n,...l}),i.add(c))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}var ts={nodeOrigin:[0,0],nodeExtent:Nn,elevateNodesOnSelect:!0,defaults:{}},Yb={...ts,checkEquality:!0};function ns(e,t){let n={...e};for(let o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function dd(e,t,n){let o=ns(ts,n);for(let r of e.values())if(r.parentId)os(r,e,t,o);else{let i=uo(r,o.nodeOrigin),s=_n(r.extent)?r.extent:o.nodeExtent,a=jt(i,s,mt(r));r.internals.positionAbsolute=a}}function Or(e,t,n,o){let r=ns(Yb,o),i=new Map(t),s=r?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(let a of e){let l=i.get(a.id);if(r.checkEquality&&a===l?.internals.userNode)t.set(a.id,l);else{let c=uo(a,r.nodeOrigin),d=_n(a.extent)?a.extent:r.nodeExtent,u=jt(c,d,mt(a));l={...r.defaults,...a,measured:{width:a.measured?.width,height:a.measured?.height},internals:{positionAbsolute:u,handleBounds:a.measured?l?.internals.handleBounds:void 0,z:ud(a,s),userNode:a}},t.set(a.id,l)}a.parentId&&os(l,t,n,o)}}function Gb(e,t){if(!e.parentId)return;let n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function os(e,t,n,o){let{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:s}=ns(ts,o),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}Gb(e,n);let c=r?1e3:0,{x:d,y:u,z:f}=Xb(e,l,i,s,c),{positionAbsolute:h}=e.internals,p=d!==h.x||u!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:d,y:u}:h,z:f}})}function ud(e,t){return(Ze(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function Xb(e,t,n,o,r){let{x:i,y:s}=t.internals.positionAbsolute,a=mt(e),l=uo(e,n),c=_n(e.extent)?jt(l,e.extent,a):l,d=jt({x:i+c.x,y:s+c.y},o,a);e.extent==="parent"&&(d=rd(d,a,t));let u=ud(e,r),f=t.internals.z??0;return{x:d.x,y:d.y,z:f>u?f:u}}function Pr(e,t,n,o=[0,0]){let r=[],i=new Map;for(let s of e){let a=t.get(s.parentId);if(!a)continue;let l=i.get(s.parentId)?.expandedRect??Jt(a),c=qi(l,s.rect);i.set(s.parentId,{expandedRect:c,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},l)=>{let c=a.internals.positionAbsolute,d=mt(a),u=a.origin??o,f=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,h=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,p=Math.max(d.width,Math.round(s.width)),g=Math.max(d.height,Math.round(s.height)),v=(p-d.width)*u[0],m=(g-d.height)*u[1];(f>0||h>0||v||m)&&(r.push({id:l,type:"position",position:{x:a.position.x-f+v,y:a.position.y-h+m}}),n.get(l)?.forEach(b=>{e.some(y=>y.id===b.id)||r.push({id:b.id,type:"position",position:{x:b.position.x+f,y:b.position.y+h}})})),(d.width<s.width||d.height<s.height||f||h)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(f?u[0]*f-v:0),height:g+(h?u[1]*h-m:0)}})}),r}function fd(e,t,n,o,r,i){let s=o?.querySelector(".xyflow__viewport"),a=!1;if(!s)return{changes:[],updatedInternals:a};let l=[],c=window.getComputedStyle(s),{m22:d}=new window.DOMMatrixReadOnly(c.transform),u=[];for(let f of e.values()){let h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}let p=mo(f.nodeElement),g=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(g||!h.internals.handleBounds||f.force))){let m=f.nodeElement.getBoundingClientRect(),b=_n(h.extent)?h.extent:i,{positionAbsolute:y}=h.internals;h.parentId&&h.extent==="parent"?y=rd(y,p,t.get(h.parentId)):b&&(y=jt(y,b,p));let x={...h,measured:p,internals:{...h.internals,positionAbsolute:y,handleBounds:{source:qc("source",f.nodeElement,m,d,h.id),target:qc("target",f.nodeElement,m,d,h.id)}}};t.set(h.id,x),h.parentId&&os(x,t,n,{nodeOrigin:r}),a=!0,g&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&u.push({id:h.id,parentId:h.parentId,rect:Jt(x,r)}))}}if(u.length>0){let f=Pr(u,t,n,r);l.push(...f)}return{changes:l,updatedInternals:a}}async function hd({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);let s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function Qc(e,t,n,o,r,i){let s=r,a=o.get(s)||new Map;o.set(s,a.set(n,t)),s=`${r}-${e}`;let l=o.get(s)||new Map;if(o.set(s,l.set(n,t)),i){s=`${r}-${e}-${i}`;let c=o.get(s)||new Map;o.set(s,c.set(n,t))}}function rs(e,t,n){e.clear(),t.clear();for(let o of n){let{source:r,target:i,sourceHandle:s=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:a},c=`${r}-${s}--${i}-${a}`,d=`${i}-${a}--${r}-${s}`;Qc("source",l,d,e,r,s),Qc("target",l,c,e,i,a),t.set(o.id,o)}}function pd(e,t){if(!e.parentId)return!1;let n=t.get(e.parentId);return n?n.selected?!0:pd(n,t):!1}function Jc(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function Zb(e,t,n,o){let r=new Map;for(let[i,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!pd(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){let a=e.get(i);a&&r.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function Pi({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){let r=[];for(let[s,a]of t){let l=n.get(s)?.internals.userNode;l&&r.push({...l,position:a.position,dragging:o})}if(!e)return[r[0],r];let i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function md({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},d=null,u=!1,f=null,h=!1;function p({noDragClassName:v,handleSelector:m,domNode:b,isSelectable:y,nodeId:x,nodeClickDistance:E=0}){f=De(b);function C({x:L,y:$},z){let{nodeLookup:B,nodeExtent:w,snapGrid:T,snapToGrid:S,nodeOrigin:k,onNodeDrag:A,onSelectionDrag:_,onError:P,updateNodePositions:V}=t();i={x:L,y:$};let F=!1,H={x:0,y:0,x2:0,y2:0};if(a.size>1&&w){let W=Tn(a);H=Fi(W)}for(let[W,U]of a){if(!B.has(W))continue;let Y={x:L-U.distance.x,y:$-U.distance.y};S&&(Y=ho(Y,T));let q=[[w[0][0],w[0][1]],[w[1][0],w[1][1]]];if(a.size>1&&w&&!U.extent){let{positionAbsolute:se}=U.internals,ae=se.x-H.x+w[0][0],Q=se.x+U.measured.width-H.x2+w[1][0],le=se.y-H.y+w[0][1],me=se.y+U.measured.height-H.y2+w[1][1];q=[[ae,le],[Q,me]]}let{position:Z,positionAbsolute:re}=Ki({nodeId:W,nextPosition:Y,nodeLookup:B,nodeExtent:q,nodeOrigin:k,onError:P});F=F||U.position.x!==Z.x||U.position.y!==Z.y,U.position=Z,U.internals.positionAbsolute=re}if(F&&(V(a,!0),z&&(o||A||!x&&_))){let[W,U]=Pi({nodeId:x,dragItems:a,nodeLookup:B});o?.(z,a,W,U),A?.(z,W,U),x||_?.(z,U)}}async function N(){if(!d)return;let{transform:L,panBy:$,autoPanSpeed:z,autoPanOnNodeDrag:B}=t();if(!B){l=!1,cancelAnimationFrame(s);return}let[w,T]=id(c,d,z);(w!==0||T!==0)&&(i.x=(i.x??0)-w/L[2],i.y=(i.y??0)-T/L[2],await $({x:w,y:T})&&C(i,null)),s=requestAnimationFrame(N)}function M(L){let{nodeLookup:$,multiSelectionActive:z,nodesDraggable:B,transform:w,snapGrid:T,snapToGrid:S,selectNodesOnDrag:k,onNodeDragStart:A,onSelectionDragStart:_,unselectNodesAndEdges:P}=t();u=!0,(!k||!y)&&!z&&x&&($.get(x)?.selected||P()),y&&k&&x&&e?.(x);let V=lo(L.sourceEvent,{transform:w,snapGrid:T,snapToGrid:S,containerBounds:d});if(i=V,a=Zb($,B,V,x),a.size>0&&(n||A||!x&&_)){let[F,H]=Pi({nodeId:x,dragItems:a,nodeLookup:$});n?.(L.sourceEvent,a,F,H),A?.(L.sourceEvent,F,H),x||_?.(L.sourceEvent,H)}}let R=Qo().clickDistance(E).on("start",L=>{let{domNode:$,nodeDragThreshold:z,transform:B,snapGrid:w,snapToGrid:T}=t();d=$?.getBoundingClientRect()||null,h=!1,z===0&&M(L),i=lo(L.sourceEvent,{transform:B,snapGrid:w,snapToGrid:T,containerBounds:d}),c=ht(L.sourceEvent,d)}).on("drag",L=>{let{autoPanOnNodeDrag:$,transform:z,snapGrid:B,snapToGrid:w,nodeDragThreshold:T,nodeLookup:S}=t(),k=lo(L.sourceEvent,{transform:z,snapGrid:B,snapToGrid:w,containerBounds:d});if((L.sourceEvent.type==="touchmove"&&L.sourceEvent.touches.length>1||x&&!S.has(x))&&(h=!0),!h){if(!l&&$&&u&&(l=!0,N()),!u){let A=k.xSnapped-(i.x??0),_=k.ySnapped-(i.y??0);Math.sqrt(A*A+_*_)>T&&M(L)}(i.x!==k.xSnapped||i.y!==k.ySnapped)&&a&&u&&(c=ht(L.sourceEvent,d),C(k,L.sourceEvent))}}).on("end",L=>{if(!(!u||h)&&(l=!1,u=!1,cancelAnimationFrame(s),a.size>0)){let{nodeLookup:$,updateNodePositions:z,onNodeDragStop:B,onSelectionDragStop:w}=t();if(z(a,!1),r||B||!x&&w){let[T,S]=Pi({nodeId:x,dragItems:a,nodeLookup:$,dragging:!1});r?.(L.sourceEvent,a,T,S),B?.(L.sourceEvent,T,S),x||w?.(L.sourceEvent,S)}}}).filter(L=>{let $=L.target;return!L.button&&(!v||!Jc($,`.${v}`,b))&&(!m||Jc($,m,b))});f.call(R)}function g(){f?.on(".drag",null)}return{update:p,destroy:g}}function jb(e,t,n){let o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(let i of t.values())kn(r,Jt(i))>0&&o.push(i);return o}var Qb=250;function Jb(e,t,n,o){let r=[],i=1/0,s=jb(e,n,t+Qb);for(let a of s){let l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(let c of l){if(o.nodeId===c.nodeId&&o.type===c.type&&o.id===c.id)continue;let{x:d,y:u}=co(a,c,c.position,!0),f=Math.sqrt(Math.pow(d-e.x,2)+Math.pow(u-e.y,2));f>t||(f<i?(r=[{...c,x:d,y:u}],i=f):f===i&&r.push({...c,x:d,y:u}))}}if(!r.length)return null;if(r.length>1){let a=o.type==="source"?"target":"source";return r.find(l=>l.type===a)??r[0]}return r[0]}function gd(e,t,n,o,r,i=!1){let s=o.get(e);if(!s)return null;let a=r==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(c=>c.id===n):a?.[0])??null;return l&&i?{...l,...co(s,l,l.position,!0)}:l}function yd(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function e0(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}var bd=()=>!0;function t0(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:d,flowId:u,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:g,onConnectEnd:v,isValidConnection:m=bd,onReconnectEnd:b,updateConnection:y,getTransform:x,getFromHandle:E,autoPanSpeed:C}){let N=Qi(e.target),M=0,R,{x:L,y:$}=ht(e),z=N?.elementFromPoint(L,$),B=yd(i,z),w=a?.getBoundingClientRect();if(!w||!B)return;let T=gd(r,B,o,l,t);if(!T)return;let S=ht(e,w),k=!1,A=null,_=!1,P=null;function V(){if(!d||!w)return;let[re,se]=id(S,w,C);f({x:re,y:se}),M=requestAnimationFrame(V)}let F={...T,nodeId:r,type:B,position:T.position},H=l.get(r),U={inProgress:!0,isValid:null,from:co(H,F,X.Left,!0),fromHandle:F,fromPosition:F.position,fromNode:H,to:S,toHandle:null,toPosition:Wc[F.position],toNode:null};y(U);let Y=U;p?.(e,{nodeId:r,handleId:o,handleType:B});function q(re){if(!E()||!F){Z(re);return}let se=x();S=ht(re,w),R=Jb(Dn(S,se,!1,[1,1]),n,l,F),k||(V(),k=!0);let ae=xd(re,{handle:R,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:m,doc:N,lib:c,flowId:u,nodeLookup:l});P=ae.handleDomNode,A=ae.connection,_=e0(!!R,ae.isValid);let Q={...Y,isValid:_,to:R&&_?Gi({x:R.x,y:R.y},se):S,toHandle:ae.toHandle,toPosition:_&&ae.toHandle?ae.toHandle.position:Wc[F.position],toNode:ae.toHandle?l.get(ae.toHandle.nodeId):null};_&&R&&Y.toHandle&&Q.toHandle&&Y.toHandle.type===Q.toHandle.type&&Y.toHandle.nodeId===Q.toHandle.nodeId&&Y.toHandle.id===Q.toHandle.id&&Y.to.x===Q.to.x&&Y.to.y===Q.to.y||(y(Q),Y=Q)}function Z(re){(R||P)&&A&&_&&g?.(A);let{inProgress:se,...ae}=Y,Q={...ae,toPosition:Y.toHandle?Y.toPosition:null};v?.(re,Q),i&&b?.(re,Q),h(),cancelAnimationFrame(M),k=!1,_=!1,A=null,P=null,N.removeEventListener("mousemove",q),N.removeEventListener("mouseup",Z),N.removeEventListener("touchmove",q),N.removeEventListener("touchend",Z)}N.addEventListener("mousemove",q),N.addEventListener("mouseup",Z),N.addEventListener("touchmove",q),N.addEventListener("touchend",Z)}function xd(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=bd,nodeLookup:d}){let u=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:h,y:p}=ht(e),g=s.elementFromPoint(h,p),v=g?.classList.contains(`${a}-flow__handle`)?g:f,m={handleDomNode:v,isValid:!1,connection:null,toHandle:null};if(v){let b=yd(void 0,v),y=v.getAttribute("data-nodeid"),x=v.getAttribute("data-handleid"),E=v.classList.contains("connectable"),C=v.classList.contains("connectableend");if(!y||!b)return m;let N={source:u?y:o,sourceHandle:u?x:r,target:u?o:y,targetHandle:u?r:x};m.connection=N;let R=E&&C&&(n===pt.Strict?u&&b==="source"||!u&&b==="target":y!==o||x!==r);m.isValid=R&&c(N),m.toHandle=gd(y,b,x,d,n,!1)}return m}var Ar={onPointerDown:t0,isValid:xd};function wd({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){let r=De(e);function i({translateExtent:a,width:l,height:c,zoomStep:d=10,pannable:u=!0,zoomable:f=!0,inversePan:h=!1}){let p=y=>{let x=n();if(y.sourceEvent.type!=="wheel"||!t)return;let E=-y.sourceEvent.deltaY*(y.sourceEvent.deltaMode===1?.05:y.sourceEvent.deltaMode?1:.002)*d,C=x[2]*Math.pow(2,E);t.scaleTo(C)},g=[0,0],v=y=>{(y.sourceEvent.type==="mousedown"||y.sourceEvent.type==="touchstart")&&(g=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY])},m=y=>{let x=n();if(y.sourceEvent.type!=="mousemove"&&y.sourceEvent.type!=="touchmove"||!t)return;let E=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY],C=[E[0]-g[0],E[1]-g[1]];g=E;let N=o()*Math.max(x[2],Math.log(x[2]))*(h?-1:1),M={x:x[0]-C[0]*N,y:x[1]-C[1]*N},R=[[0,0],[l,c]];t.setViewportConstrained({x:M.x,y:M.y,zoom:x[2]},R,a)},b=wr().on("start",v).on("zoom",u?m:null).on("zoom.wheel",f?p:null);r.call(b,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:Ae}}var n0=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Lr=e=>({x:e.x,y:e.y,zoom:e.k}),Ai=({x:e,y:t,zoom:n})=>Xt.translate(e,t).scale(n),En=(e,t)=>e.target.closest(`.${t}`),vd=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Li=(e,t=0,n=()=>{})=>{let o=typeof t=="number"&&t>0;return o||n(),o?e.transition().duration(t).on("end",n):e},Sd=e=>{let t=e.ctrlKey&&po()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function o0({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return d=>{if(En(d,t))return!1;d.preventDefault(),d.stopImmediatePropagation();let u=n.property("__zoom").k||1;if(d.ctrlKey&&s){let v=Ae(d),m=Sd(d),b=u*Math.pow(2,m);o.scaleTo(n,b,v,d);return}let f=d.deltaMode===1?20:1,h=r===Et.Vertical?0:d.deltaX*f,p=r===Et.Horizontal?0:d.deltaY*f;!po()&&d.shiftKey&&r!==Et.Vertical&&(h=d.deltaY*f,p=0),o.translateBy(n,-(h/u)*i,-(p/u)*i,{internal:!0});let g=Lr(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a?.(d,g)),e.isPanScrolling&&(l?.(d,g),e.panScrollTimeout=setTimeout(()=>{c?.(d,g),e.isPanScrolling=!1},150))}}function r0({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){if(!t&&o.type==="wheel"&&!o.ctrlKey||En(o,e))return null;o.preventDefault(),n.call(this,o,r)}}function i0({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;let r=Lr(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function s0({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&vd(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,Lr(i.transform))}}function a0({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&vd(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&n0(e.prevViewport,s.transform))){let a=Lr(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,a)},n?150:0)}}}function l0({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c}){return d=>{let u=e||t,f=n&&d.ctrlKey;if(d.button===1&&d.type==="mousedown"&&(En(d,`${c}-flow__node`)||En(d,`${c}-flow__edge`)))return!0;if(!o&&!u&&!r&&!i&&!n||s||En(d,a)&&d.type==="wheel"||En(d,l)&&(d.type!=="wheel"||r&&d.type==="wheel"&&!e)||!n&&d.ctrlKey&&d.type==="wheel")return!1;if(!n&&d.type==="touchstart"&&d.touches?.length>1)return d.preventDefault(),!1;if(!u&&!r&&!f&&d.type==="wheel"||!o&&(d.type==="mousedown"||d.type==="touchstart")||Array.isArray(o)&&!o.includes(d.button)&&d.type==="mousedown")return!1;let h=Array.isArray(o)&&o.includes(d.button)||!d.button||d.button<=1;return(!d.ctrlKey||d.type==="wheel")&&h}}function Ed({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:c}){let d={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),f=wr().clickDistance(!Ze(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(r),h=De(e).call(f);y({x:i.x,y:i.y,zoom:Cn(i.zoom,t,n)},[[0,0],[u.width,u.height]],r);let p=h.on("wheel.zoom"),g=h.on("dblclick.zoom");f.wheelDelta(Sd);function v(z,B){return h?new Promise(w=>{f?.transform(Li(h,B?.duration,()=>w(!0)),z)}):Promise.resolve(!1)}function m({noWheelClassName:z,noPanClassName:B,onPaneContextMenu:w,userSelectionActive:T,panOnScroll:S,panOnDrag:k,panOnScrollMode:A,panOnScrollSpeed:_,preventScrolling:P,zoomOnPinch:V,zoomOnScroll:F,zoomOnDoubleClick:H,zoomActivationKeyPressed:W,lib:U,onTransformChange:Y}){T&&!d.isZoomingOrPanning&&b();let Z=S&&!W&&!T?o0({zoomPanValues:d,noWheelClassName:z,d3Selection:h,d3Zoom:f,panOnScrollMode:A,panOnScrollSpeed:_,zoomOnPinch:V,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:l}):r0({noWheelClassName:z,preventScrolling:P,d3ZoomHandler:p});if(h.on("wheel.zoom",Z,{passive:!1}),!T){let se=i0({zoomPanValues:d,onDraggingChange:c,onPanZoomStart:a});f.on("start",se);let ae=s0({zoomPanValues:d,panOnDrag:k,onPaneContextMenu:!!w,onPanZoom:s,onTransformChange:Y});f.on("zoom",ae);let Q=a0({zoomPanValues:d,panOnDrag:k,panOnScroll:S,onPaneContextMenu:w,onPanZoomEnd:l,onDraggingChange:c});f.on("end",Q)}let re=l0({zoomActivationKeyPressed:W,panOnDrag:k,zoomOnScroll:F,panOnScroll:S,zoomOnDoubleClick:H,zoomOnPinch:V,userSelectionActive:T,noPanClassName:B,noWheelClassName:z,lib:U});f.filter(re),H?h.on("dblclick.zoom",g):h.on("dblclick.zoom",null)}function b(){f.on("zoom",null)}async function y(z,B,w){let T=Ai(z),S=f?.constrain()(T,B,w);return S&&await v(S),new Promise(k=>k(S))}async function x(z,B){let w=Ai(z);return await v(w,B),new Promise(T=>T(w))}function E(z){if(h){let B=Ai(z),w=h.property("__zoom");(w.k!==z.zoom||w.x!==z.x||w.y!==z.y)&&f?.transform(h,B,null,{sync:!0})}}function C(){let z=h?ao(h.node()):{x:0,y:0,k:1};return{x:z.x,y:z.y,zoom:z.k}}function N(z,B){return h?new Promise(w=>{f?.scaleTo(Li(h,B?.duration,()=>w(!0)),z)}):Promise.resolve(!1)}function M(z,B){return h?new Promise(w=>{f?.scaleBy(Li(h,B?.duration,()=>w(!0)),z)}):Promise.resolve(!1)}function R(z){f?.scaleExtent(z)}function L(z){f?.translateExtent(z)}function $(z){let B=!Ze(z)||z<0?0:z;f?.clickDistance(B)}return{update:m,destroy:b,setViewport:x,setViewportConstrained:y,getViewport:C,scaleTo:N,scaleBy:M,setScaleExtent:R,setTranslateExtent:L,syncViewport:E,setClickDistance:$}}var Qt;(function(e){e.Line="line",e.Handle="handle"})(Qt||(Qt={}));function c0({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){let s=e-t,a=n-o,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&r&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function d0(e){let t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Rt(e,t){return Math.max(0,t-e)}function Ot(e,t){return Math.max(0,e-t)}function Sr(e,t,n){return Math.max(0,t-e,e-n)}function ed(e,t){return e?!t:t}function u0(e,t,n,o,r,i,s,a){let{affectsX:l,affectsY:c}=t,{isHorizontal:d,isVertical:u}=t,f=d&&u,{xSnapped:h,ySnapped:p}=n,{minWidth:g,maxWidth:v,minHeight:m,maxHeight:b}=o,{x:y,y:x,width:E,height:C,aspectRatio:N}=e,M=Math.floor(d?h-e.pointerX:0),R=Math.floor(u?p-e.pointerY:0),L=E+(l?-M:M),$=C+(c?-R:R),z=-i[0]*E,B=-i[1]*C,w=Sr(L,g,v),T=Sr($,m,b);if(s){let A=0,_=0;l&&M<0?A=Rt(y+M+z,s[0][0]):!l&&M>0&&(A=Ot(y+L+z,s[1][0])),c&&R<0?_=Rt(x+R+B,s[0][1]):!c&&R>0&&(_=Ot(x+$+B,s[1][1])),w=Math.max(w,A),T=Math.max(T,_)}if(a){let A=0,_=0;l&&M>0?A=Ot(y+M,a[0][0]):!l&&M<0&&(A=Rt(y+L,a[1][0])),c&&R>0?_=Ot(x+R,a[0][1]):!c&&R<0&&(_=Rt(x+$,a[1][1])),w=Math.max(w,A),T=Math.max(T,_)}if(r){if(d){let A=Sr(L/N,m,b)*N;if(w=Math.max(w,A),s){let _=0;!l&&!c||l&&!c&&f?_=Ot(x+B+L/N,s[1][1])*N:_=Rt(x+B+(l?M:-M)/N,s[0][1])*N,w=Math.max(w,_)}if(a){let _=0;!l&&!c||l&&!c&&f?_=Rt(x+L/N,a[1][1])*N:_=Ot(x+(l?M:-M)/N,a[0][1])*N,w=Math.max(w,_)}}if(u){let A=Sr($*N,g,v)/N;if(T=Math.max(T,A),s){let _=0;!l&&!c||c&&!l&&f?_=Ot(y+$*N+z,s[1][0])/N:_=Rt(y+(c?R:-R)*N+z,s[0][0])/N,T=Math.max(T,_)}if(a){let _=0;!l&&!c||c&&!l&&f?_=Rt(y+$*N,a[1][0])/N:_=Ot(y+(c?R:-R)*N,a[0][0])/N,T=Math.max(T,_)}}}R=R+(R<0?T:-T),M=M+(M<0?w:-w),r&&(f?L>$*N?R=(ed(l,c)?-M:M)/N:M=(ed(l,c)?-R:R)*N:d?(R=M/N,c=l):(M=R*N,l=c));let S=l?y+M:y,k=c?x+R:x;return{width:E+(l?-M:M),height:C+(c?-R:R),x:i[0]*M*(l?-1:1)+S,y:i[1]*R*(c?-1:1)+k}}var Cd={width:0,height:0,x:0,y:0},f0={...Cd,pointerX:0,pointerY:0,aspectRatio:1};function h0(e){return[[0,0],[e.measured.width,e.measured.height]]}function p0(e,t,n){let o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,l=n[1]*s;return[[o-a,r-l],[o+i-a,r+s-l]]}function _d({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){let i=De(e);function s({controlPosition:l,boundaries:c,keepAspectRatio:d,onResizeStart:u,onResize:f,onResizeEnd:h,shouldResize:p}){let g={...Cd},v={...f0},m=d0(l),b,y=null,x=[],E,C,N,M=Qo().on("start",R=>{let{nodeLookup:L,transform:$,snapGrid:z,snapToGrid:B,nodeOrigin:w,paneDomNode:T}=n();if(b=L.get(t),!b)return;y=T?.getBoundingClientRect()??null;let{xSnapped:S,ySnapped:k}=lo(R.sourceEvent,{transform:$,snapGrid:z,snapToGrid:B,containerBounds:y});g={width:b.measured.width??0,height:b.measured.height??0,x:b.position.x??0,y:b.position.y??0},v={...g,pointerX:S,pointerY:k,aspectRatio:g.width/g.height},E=void 0,b.parentId&&(b.extent==="parent"||b.expandParent)&&(E=L.get(b.parentId),C=E&&b.extent==="parent"?h0(E):void 0),x=[],N=void 0;for(let[A,_]of L)if(_.parentId===t&&(x.push({id:A,position:{..._.position},extent:_.extent}),_.extent==="parent"||_.expandParent)){let P=p0(_,b,_.origin??w);N?N=[[Math.min(P[0][0],N[0][0]),Math.min(P[0][1],N[0][1])],[Math.max(P[1][0],N[1][0]),Math.max(P[1][1],N[1][1])]]:N=P}u?.(R,{...g})}).on("drag",R=>{let{transform:L,snapGrid:$,snapToGrid:z,nodeOrigin:B}=n(),w=lo(R.sourceEvent,{transform:L,snapGrid:$,snapToGrid:z,containerBounds:y}),T=[];if(!b)return;let{x:S,y:k,width:A,height:_}=g,P={},V=b.origin??B,{width:F,height:H,x:W,y:U}=u0(v,m,w,c,d,V,C,N),Y=F!==A,q=H!==_,Z=W!==S&&Y,re=U!==k&&q;if(!Z&&!re&&!Y&&!q)return;if((Z||re||V[0]===1||V[1]===1)&&(P.x=Z?W:g.x,P.y=re?U:g.y,g.x=P.x,g.y=P.y,x.length>0)){let le=W-S,me=U-k;for(let Re of x)Re.position={x:Re.position.x-le+V[0]*(F-A),y:Re.position.y-me+V[1]*(H-_)},T.push(Re)}if((Y||q)&&(P.width=Y?F:g.width,P.height=q?H:g.height,g.width=P.width,g.height=P.height),E&&b.expandParent){let le=V[0]*(P.width??0);P.x&&P.x<le&&(g.x=le,v.x=v.x-(P.x-le));let me=V[1]*(P.height??0);P.y&&P.y<me&&(g.y=me,v.y=v.y-(P.y-me))}let se=c0({width:g.width,prevWidth:A,height:g.height,prevHeight:_,affectsX:m.affectsX,affectsY:m.affectsY}),ae={...g,direction:se};p?.(R,ae)!==!1&&(f?.(R,ae),o(P,T))}).on("end",R=>{h?.(R,{...g}),r?.()});i.call(M)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var Fd=K(he(),1),zd=K(Od(),1);var Pd=e=>{let t,n=new Set,o=(d,u)=>{let f=typeof d=="function"?d(t):d;if(!Object.is(f,t)){let h=t;t=u??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(o,r,l);return l},Ad=e=>e?Pd(e):Pd;var{useDebugValue:R0}=Fd.default,{useSyncExternalStoreWithSelector:O0}=zd.default,P0=e=>e;function ss(e,t=P0,n){let o=O0(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return R0(o),o}var Ld=(e,t)=>{let n=Ad(e),o=(r,i=t)=>ss(n,r,i);return Object.assign(o,n),o},Bd=(e,t)=>e?Ld(e,t):Ld;function ye(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let o of e)if(!t.has(o))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var A0=K(Eg()),Hr=(0,O.createContext)(null),L0=Hr.Provider,cu=Ke.error001();function ce(e,t){let n=(0,O.useContext)(Hr);if(n===null)throw new Error(cu);return ss(n,e,t)}function ge(){let e=(0,O.useContext)(Hr);if(e===null)throw new Error(cu);return(0,O.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}var $d={display:"none"},F0={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},du="react-flow__node-desc",uu="react-flow__edge-desc",z0="react-flow__aria-live",B0=e=>e.ariaLiveMessage;function $0({rfId:e}){let t=ce(B0);return(0,I.jsx)("div",{id:`${z0}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:F0,children:t})}function H0({rfId:e,disableKeyboardA11y:t}){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{id:`${du}-${e}`,style:$d,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,I.jsx)("div",{id:`${uu}-${e}`,style:$d,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&(0,I.jsx)($0,{rfId:e})]})}var V0=e=>e.userSelectionActive?"none":"all",Vr=(0,O.forwardRef)(({position:e="top-left",children:t,className:n,style:o,...r},i)=>{let s=ce(V0),a=`${e}`.split("-");return(0,I.jsx)("div",{className:be(["react-flow__panel",n,...a]),style:{...o,pointerEvents:s},ref:i,...r,children:t})});Vr.displayName="Panel";function W0({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,I.jsx)(Vr,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,I.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}var K0=e=>{let t=[],n=[];for(let[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(let[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},zr=e=>e.id;function q0(e,t){return ye(e.selectedNodes.map(zr),t.selectedNodes.map(zr))&&ye(e.selectedEdges.map(zr),t.selectedEdges.map(zr))}function U0({onSelectionChange:e}){let t=ge(),{selectedNodes:n,selectedEdges:o}=ce(K0,q0);return(0,O.useEffect)(()=>{let r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,o,e]),null}var Y0=e=>!!e.onSelectionChangeHandlers;function G0({onSelectionChange:e}){let t=ce(Y0);return e||t?(0,I.jsx)(U0,{onSelectionChange:e}):null}var fu=[0,0],X0={x:0,y:0,zoom:1},Z0=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Hd=[...Z0,"rfId"],j0=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Vd={translateExtent:Nn,nodeOrigin:fu,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Q0(e){let{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=ce(j0,ye),d=ge();(0,O.useEffect)(()=>(l(e.defaultNodes,e.defaultEdges),()=>{u.current=Vd,a()}),[]);let u=(0,O.useRef)(Vd);return(0,O.useEffect)(()=>{for(let f of Hd){let h=e[f],p=u.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?o(h):f==="maxZoom"?r(h):f==="translateExtent"?i(h):f==="nodeExtent"?s(h):f==="paneClickDistance"?c(h):f==="fitView"?d.setState({fitViewOnInit:h}):f==="fitViewOptions"?d.setState({fitViewOnInitOptions:h}):d.setState({[f]:h})))}u.current=e},Hd.map(f=>e[f])),null}function Wd(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function J0(e){let[t,n]=(0,O.useState)(e==="system"?null:e);return(0,O.useEffect)(()=>{if(e!=="system"){n(e);return}let o=Wd(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:Wd()?.matches?"dark":"light"}var Kd=typeof document<"u"?document:null;function bo(e=null,t={target:Kd,actInsideInputWithModifier:!0}){let[n,o]=(0,O.useState)(!1),r=(0,O.useRef)(!1),i=(0,O.useRef)(new Set([])),[s,a]=(0,O.useMemo)(()=>{if(e!==null){let c=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.replace("+",`
`).replace(`

`,`
+`).split(`
`)),d=c.reduce((u,f)=>u.concat(...f),[]);return[c,d]}return[[],[]]},[e]);return(0,O.useEffect)(()=>{let l=t?.target||Kd;if(e!==null){let c=f=>{if(r.current=f.ctrlKey||f.metaKey||f.shiftKey,(!r.current||r.current&&!t.actInsideInputWithModifier)&&kr(f))return!1;let p=Ud(f.code,a);i.current.add(f[p]),qd(s,i.current,!1)&&(f.preventDefault(),o(!0))},d=f=>{if((!r.current||r.current&&!t.actInsideInputWithModifier)&&kr(f))return!1;let p=Ud(f.code,a);qd(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[p]),f.key==="Meta"&&i.current.clear(),r.current=!1},u=()=>{i.current.clear(),o(!1)};return l?.addEventListener("keydown",c),l?.addEventListener("keyup",d),window.addEventListener("blur",u),window.addEventListener("contextmenu",u),()=>{l?.removeEventListener("keydown",c),l?.removeEventListener("keyup",d),window.removeEventListener("blur",u),window.removeEventListener("contextmenu",u)}}},[e,o]),n}function qd(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function Ud(e,t){return t.includes(e)?"code":"key"}var ex=()=>{let e=ge();return(0,O.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[o,r,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},fitView:t=>{let{nodeLookup:n,minZoom:o,maxZoom:r,panZoom:i,domNode:s}=e.getState();if(!i||!s)return Promise.resolve(!1);let a=Cr(n,t),{width:l,height:c}=mo(s);return _r({nodes:a,width:l,height:c,minZoom:o,maxZoom:r,panZoom:i},t)},setCenter:async(t,n,o)=>{let{width:r,height:i,maxZoom:s,panZoom:a}=e.getState(),l=typeof o?.zoom<"u"?o.zoom:s,c=r/2-t*l,d=i/2-n*l;return a?(await a.setViewport({x:c,y:d,zoom:l},{duration:o?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{let{width:o,height:r,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),l=en(t,o,r,i,s,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:o,snapGrid:r,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;let{x:a,y:l}=s.getBoundingClientRect(),c={x:t.x-a,y:t.y-l},d=n.snapGrid??r,u=n.snapToGrid??i;return Dn(c,o,u,d)},flowToScreenPosition:t=>{let{transform:n,domNode:o}=e.getState();if(!o)return t;let{x:r,y:i}=o.getBoundingClientRect(),s=Gi(t,n);return{x:s.x+r,y:s.y+i}}}),[])};function hu(e,t){let n=[],o=new Map,r=[];for(let i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")o.set(i.id,[i]);else{let s=o.get(i.id);s?s.push(i):o.set(i.id,[i])}for(let i of t){let s=o.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}let a={...i};for(let l of s)tx(l,a);n.push(a)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function tx(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??={},t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function pu(e,t){return hu(e,t)}function mu(e,t){return hu(e,t)}function tn(e,t){return{id:e,type:"select",selected:t}}function Mn(e,t=new Set,n=!1){let o=[];for(let[r,i]of e){let s=t.has(r);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),o.push(tn(i.id,s)))}return o}function Yd({items:e=[],lookup:t}){let n=[],o=new Map(e.map(r=>[r.id,r]));for(let[r,i]of e.entries()){let s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:r})}for(let[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function Gd(e){return{id:e.id,type:"remove"}}var Xd=e=>td(e),nx=e=>Hi(e);function gu(e){return(0,O.forwardRef)(e)}var ox=typeof window<"u"?O.useLayoutEffect:O.useEffect;function Zd(e){let[t,n]=(0,O.useState)(BigInt(0)),[o]=(0,O.useState)(()=>rx(()=>n(r=>r+BigInt(1))));return ox(()=>{let r=o.get();r.length&&(e(r),o.reset())},[t]),o}function rx(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}var yu=(0,O.createContext)(null);function ix({children:e}){let t=ge(),n=(0,O.useCallback)(a=>{let{nodes:l=[],setNodes:c,hasDefaultNodes:d,onNodesChange:u,nodeLookup:f}=t.getState(),h=l;for(let p of a)h=typeof p=="function"?p(h):p;d?c(h):u&&u(Yd({items:h,lookup:f}))},[]),o=Zd(n),r=(0,O.useCallback)(a=>{let{edges:l=[],setEdges:c,hasDefaultEdges:d,onEdgesChange:u,edgeLookup:f}=t.getState(),h=l;for(let p of a)h=typeof p=="function"?p(h):p;d?c(h):u&&u(Yd({items:h,lookup:f}))},[]),i=Zd(r),s=(0,O.useMemo)(()=>({nodeQueue:o,edgeQueue:i}),[]);return(0,I.jsx)(yu.Provider,{value:s,children:e})}function sx(){let e=(0,O.useContext)(yu);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}var ax=e=>!!e.panZoom;function qe(){let e=ex(),t=ge(),n=sx(),o=ce(ax),r=(0,O.useMemo)(()=>{let i=u=>t.getState().nodeLookup.get(u),s=u=>{n.nodeQueue.push(u)},a=u=>{n.edgeQueue.push(u)},l=u=>{let{nodeLookup:f,nodeOrigin:h}=t.getState(),p=Xd(u)?u:f.get(u.id),g=p.parentId?Zi(p.position,p.measured,p.parentId,f,h):p.position,v={...p,position:g,width:p.measured?.width??p.width,height:p.measured?.height??p.height};return Jt(v)},c=(u,f,h={replace:!1})=>{s(p=>p.map(g=>{if(g.id===u){let v=typeof f=="function"?f(g):f;return h.replace&&Xd(v)?v:{...g,...v}}return g}))},d=(u,f,h={replace:!1})=>{a(p=>p.map(g=>{if(g.id===u){let v=typeof f=="function"?f(g):f;return h.replace&&nx(v)?v:{...g,...v}}return g}))};return{getNodes:()=>t.getState().nodes.map(u=>({...u})),getNode:u=>i(u)?.internals.userNode,getInternalNode:i,getEdges:()=>{let{edges:u=[]}=t.getState();return u.map(f=>({...f}))},getEdge:u=>t.getState().edgeLookup.get(u),setNodes:s,setEdges:a,addNodes:u=>{let f=Array.isArray(u)?u:[u];n.nodeQueue.push(h=>[...h,...f])},addEdges:u=>{let f=Array.isArray(u)?u:[u];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{let{nodes:u=[],edges:f=[],transform:h}=t.getState(),[p,g,v]=h;return{nodes:u.map(m=>({...m})),edges:f.map(m=>({...m})),viewport:{x:p,y:g,zoom:v}}},deleteElements:async({nodes:u=[],edges:f=[]})=>{let{nodes:h,edges:p,onNodesDelete:g,onEdgesDelete:v,triggerNodeChanges:m,triggerEdgeChanges:b,onDelete:y,onBeforeDelete:x}=t.getState(),{nodes:E,edges:C}=await od({nodesToRemove:u,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:x}),N=C.length>0,M=E.length>0;if(N){let R=C.map(Gd);v?.(C),b(R)}if(M){let R=E.map(Gd);g?.(E),m(R)}return(M||N)&&y?.({nodes:E,edges:C}),{deletedNodes:E,deletedEdges:C}},getIntersectingNodes:(u,f=!0,h)=>{let p=Ui(u),g=p?u:l(u),v=h!==void 0;return g?(h||t.getState().nodes).filter(m=>{let b=t.getState().nodeLookup.get(m.id);if(b&&!p&&(m.id===u.id||!b.internals.positionAbsolute))return!1;let y=Jt(v?m:b),x=kn(y,g);return f&&x>0||x>=g.width*g.height}):[]},isNodeIntersecting:(u,f,h=!0)=>{let g=Ui(u)?u:l(u);if(!g)return!1;let v=kn(g,f);return h&&v>0||v>=g.width*g.height},updateNode:c,updateNodeData:(u,f,h={replace:!1})=>{c(u,p=>{let g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},updateEdge:d,updateEdgeData:(u,f,h={replace:!1})=>{d(u,p=>{let g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},getNodesBounds:u=>{let{nodeLookup:f,nodeOrigin:h}=t.getState();return fo(u,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:u,id:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}-${u}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:u,handleId:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}${u?f?`-${u}-${f}`:`-${u}`:""}`)?.values()??[])}},[]);return(0,O.useMemo)(()=>({...r,...e,viewportInitialized:o}),[o])}var jd=e=>e.selected,lx={actInsideInputWithModifier:!1},cx=typeof window<"u"?window:void 0;function dx({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=ge(),{deleteElements:o}=qe(),r=bo(e,lx),i=bo(t,{target:cx});(0,O.useEffect)(()=>{if(r){let{edges:s,nodes:a}=n.getState();o({nodes:a.filter(jd),edges:s.filter(jd)}),n.setState({nodesSelectionActive:!1})}},[r]),(0,O.useEffect)(()=>{n.setState({multiSelectionActive:i})},[i])}function ux(e){let t=ge();(0,O.useEffect)(()=>{let n=()=>{if(!e.current)return!1;let o=mo(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",Ke.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);let o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}var Wr={position:"absolute",width:"100%",height:"100%",top:0,left:0},fx=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function hx({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=Et.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:d,maxZoom:u,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:g,noPanClassName:v,onViewportChange:m,isControlledViewport:b,paneClickDistance:y}){let x=ge(),E=(0,O.useRef)(null),{userSelectionActive:C,lib:N}=ce(fx,ye),M=bo(f),R=(0,O.useRef)();ux(E);let L=(0,O.useCallback)($=>{m?.({x:$[0],y:$[1],zoom:$[2]}),b||x.setState({transform:$})},[m,b]);return(0,O.useEffect)(()=>{if(E.current){R.current=Ed({domNode:E.current,minZoom:d,maxZoom:u,translateExtent:c,viewport:l,paneClickDistance:y,onDraggingChange:w=>x.setState({paneDragging:w}),onPanZoomStart:(w,T)=>{let{onViewportChangeStart:S,onMoveStart:k}=x.getState();k?.(w,T),S?.(T)},onPanZoom:(w,T)=>{let{onViewportChange:S,onMove:k}=x.getState();k?.(w,T),S?.(T)},onPanZoomEnd:(w,T)=>{let{onViewportChangeEnd:S,onMoveEnd:k}=x.getState();k?.(w,T),S?.(T)}});let{x:$,y:z,zoom:B}=R.current.getViewport();return x.setState({panZoom:R.current,transform:[$,z,B],domNode:E.current.closest(".react-flow")}),()=>{R.current?.destroy()}}},[]),(0,O.useEffect)(()=>{R.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:M,preventScrolling:h,noPanClassName:v,userSelectionActive:C,noWheelClassName:g,lib:N,onTransformChange:L})},[e,t,n,o,r,i,s,a,M,h,v,C,g,N,L]),(0,I.jsx)("div",{className:"react-flow__renderer",ref:E,style:Wr,children:p})}var px=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function mx(){let{userSelectionActive:e,userSelectionRect:t}=ce(px,ye);return e&&t?(0,I.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}var as=(e,t)=>n=>{n.target===t.current&&e?.(n)},gx=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function yx({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Zt.Full,panOnDrag:o,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:d,onPaneMouseMove:u,onPaneMouseLeave:f,children:h}){let p=ge(),{userSelectionActive:g,elementsSelectable:v,dragging:m}=ce(gx,ye),b=v&&(e||g),y=(0,O.useRef)(null),x=(0,O.useRef)(),E=(0,O.useRef)(new Set),C=(0,O.useRef)(new Set),N=(0,O.useRef)(!1),M=(0,O.useRef)(!1),R=S=>{if(N.current){N.current=!1;return}a?.(S),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},L=S=>{if(Array.isArray(o)&&o?.includes(2)){S.preventDefault();return}l?.(S)},$=c?S=>c(S):void 0,z=S=>{let{resetSelectedElements:k,domNode:A}=p.getState();if(x.current=A?.getBoundingClientRect(),!v||!e||S.button!==0||S.target!==y.current||!x.current)return;S.target?.setPointerCapture?.(S.pointerId),M.current=!0,N.current=!1;let{x:_,y:P}=ht(S.nativeEvent,x.current);k(),p.setState({userSelectionRect:{width:0,height:0,startX:_,startY:P,x:_,y:P}}),i?.(S)},B=S=>{let{userSelectionRect:k,transform:A,nodeLookup:_,edgeLookup:P,connectionLookup:V,triggerNodeChanges:F,triggerEdgeChanges:H,defaultEdgeOptions:W}=p.getState();if(!x.current||!k)return;N.current=!0;let{x:U,y:Y}=ht(S.nativeEvent,x.current),{startX:q,startY:Z}=k,re={startX:q,startY:Z,x:U<q?U:q,y:Y<Z?Y:Z,width:Math.abs(U-q),height:Math.abs(Y-Z)},se=E.current,ae=C.current;E.current=new Set(Wi(_,re,A,n===Zt.Partial,!0).map(le=>le.id)),C.current=new Set;let Q=W?.selectable??!0;for(let le of E.current){let me=V.get(le);if(me)for(let{edgeId:Re}of me.values()){let Ft=P.get(Re);Ft&&(Ft.selectable??Q)&&C.current.add(Re)}}if(!ji(se,E.current)){let le=Mn(_,E.current,!0);F(le)}if(!ji(ae,C.current)){let le=Mn(P,C.current);H(le)}p.setState({userSelectionRect:re,userSelectionActive:!0,nodesSelectionActive:!1})},w=S=>{if(S.button!==0||!M.current)return;S.target?.releasePointerCapture?.(S.pointerId);let{userSelectionRect:k}=p.getState();!g&&k&&S.target===y.current&&R?.(S),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:E.current.size>0}),s?.(S),(t||r)&&(N.current=!1),M.current=!1},T=o===!0||Array.isArray(o)&&o.includes(0);return(0,I.jsxs)("div",{className:be(["react-flow__pane",{draggable:T,dragging:m,selection:e}]),onClick:b?void 0:as(R,y),onContextMenu:as(L,y),onWheel:as($,y),onPointerEnter:b?void 0:d,onPointerDown:b?z:u,onPointerMove:b?B:u,onPointerUp:b?w:void 0,onPointerLeave:f,ref:y,style:Wr,children:[h,(0,I.jsx)(mx,{})]})}function cs({id:e,store:t,unselect:n=!1,nodeRef:o}){let{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l?.("012",Ke.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function bu({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:s}){let a=ge(),[l,c]=(0,O.useState)(!1),d=(0,O.useRef)();return(0,O.useEffect)(()=>{d.current=md({getStoreItems:()=>a.getState(),onNodeMouseDown:u=>{cs({id:u,store:a,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),(0,O.useEffect)(()=>{if(t)d.current?.destroy();else if(e.current)return d.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:s}),()=>{d.current?.destroy()}},[n,o,t,i,e,r]),l}var bx=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function xu(){let e=ge();return(0,O.useCallback)(n=>{let{nodeExtent:o,snapToGrid:r,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:d}=e.getState(),u=new Map,f=bx(s),h=r?i[0]:5,p=r?i[1]:5,g=n.direction.x*h*n.factor,v=n.direction.y*p*n.factor;for(let[,m]of c){if(!f(m))continue;let b={x:m.internals.positionAbsolute.x+g,y:m.internals.positionAbsolute.y+v};r&&(b=ho(b,i));let{position:y,positionAbsolute:x}=Ki({nodeId:m.id,nextPosition:b,nodeLookup:c,nodeExtent:o,nodeOrigin:d,onError:a});m.position=y,m.internals.positionAbsolute=x,u.set(m.id,m)}l(u)},[])}var ds=(0,O.createContext)(null),xx=ds.Provider;ds.Consumer;var wu=()=>(0,O.useContext)(ds),wx=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),vx=(e,t,n)=>o=>{let{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:l,isValid:c}=s,d=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:d,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===pt.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:d&&c}};function Sx({type:e="source",position:t=X.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:u,...f},h){let p=s||null,g=e==="target",v=ge(),m=wu(),{connectOnClick:b,noPanClassName:y,rfId:x}=ce(wx,ye),{connectingFrom:E,connectingTo:C,clickConnecting:N,isPossibleEndHandle:M,connectionInProcess:R,clickConnectionInProcess:L,valid:$}=ce(vx(m,p,e),ye);m||v.getState().onError?.("010",Ke.error010());let z=T=>{let{defaultEdgeOptions:S,onConnect:k,hasDefaultEdges:A}=v.getState(),_={...S,...T};if(A){let{edges:P,setEdges:V}=v.getState();V(go(_,P))}k?.(_),a?.(_)},B=T=>{if(!m)return;let S=Ji(T.nativeEvent);if(r&&(S&&T.button===0||!S)){let k=v.getState();Ar.onPointerDown(T.nativeEvent,{autoPanOnConnect:k.autoPanOnConnect,connectionMode:k.connectionMode,connectionRadius:k.connectionRadius,domNode:k.domNode,nodeLookup:k.nodeLookup,lib:k.lib,isTarget:g,handleId:p,nodeId:m,flowId:k.rfId,panBy:k.panBy,cancelConnection:k.cancelConnection,onConnectStart:k.onConnectStart,onConnectEnd:k.onConnectEnd,updateConnection:k.updateConnection,onConnect:z,isValidConnection:n||k.isValidConnection,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,autoPanSpeed:k.autoPanSpeed})}S?d?.(T):u?.(T)},w=T=>{let{onClickConnectStart:S,onClickConnectEnd:k,connectionClickStartHandle:A,connectionMode:_,isValidConnection:P,lib:V,rfId:F,nodeLookup:H,connection:W}=v.getState();if(!m||!A&&!r)return;if(!A){S?.(T.nativeEvent,{nodeId:m,handleId:p,handleType:e}),v.setState({connectionClickStartHandle:{nodeId:m,type:e,id:p}});return}let U=Qi(T.target),Y=n||P,{connection:q,isValid:Z}=Ar.isValid(T.nativeEvent,{handle:{nodeId:m,id:p,type:e},connectionMode:_,fromNodeId:A.nodeId,fromHandleId:A.id||null,fromType:A.type,isValidConnection:Y,flowId:F,doc:U,lib:V,nodeLookup:H});Z&&q&&z(q);let re=structuredClone(W);delete re.inProgress,re.toPosition=re.toHandle?re.toHandle.position:null,k?.(T,re),v.setState({connectionClickStartHandle:null})};return(0,I.jsx)("div",{"data-handleid":p,"data-nodeid":m,"data-handlepos":t,"data-id":`${x}-${m}-${p}-${e}`,className:be(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",y,c,{source:!g,target:g,connectable:o,connectablestart:r,connectableend:i,clickconnecting:N,connectingfrom:E,connectingto:C,valid:$,connectionindicator:o&&(!R||M)&&(R||L?i:r)}]),onMouseDown:B,onTouchStart:B,onClick:b?w:void 0,ref:h,...f,children:l})}var Ct=(0,O.memo)(gu(Sx));function Ex({data:e,isConnectable:t,sourcePosition:n=X.Bottom}){return(0,I.jsxs)(I.Fragment,{children:[e?.label,(0,I.jsx)(Ct,{type:"source",position:n,isConnectable:t})]})}function Cx({data:e,isConnectable:t,targetPosition:n=X.Top,sourcePosition:o=X.Bottom}){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ct,{type:"target",position:n,isConnectable:t}),e?.label,(0,I.jsx)(Ct,{type:"source",position:o,isConnectable:t})]})}function _x(){return null}function Nx({data:e,isConnectable:t,targetPosition:n=X.Top}){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Ct,{type:"target",position:n,isConnectable:t}),e?.label]})}var $r={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Qd={input:Ex,default:Cx,output:Nx,group:_x};function Tx(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}var kx=e=>{let{width:t,height:n,x:o,y:r}=Tn(e.nodeLookup,{filter:i=>!!i.selected});return{width:Ze(t)?t:null,height:Ze(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function Dx({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let o=ge(),{width:r,height:i,transformString:s,userSelectionActive:a}=ce(kx,ye),l=xu(),c=(0,O.useRef)(null);if((0,O.useEffect)(()=>{n||c.current?.focus({preventScroll:!0})},[n]),bu({nodeRef:c}),a||!r||!i)return null;let d=e?f=>{let h=o.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,u=f=>{Object.prototype.hasOwnProperty.call($r,f.key)&&(f.preventDefault(),l({direction:$r[f.key],factor:f.shiftKey?4:1}))};return(0,I.jsx)("div",{className:be(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:(0,I.jsx)("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:u,style:{width:r,height:i}})})}var Jd=typeof window<"u"?window:void 0,Ix=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function vu({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:d,selectionMode:u,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:g,zoomActivationKeyCode:v,elementsSelectable:m,zoomOnScroll:b,zoomOnPinch:y,panOnScroll:x,panOnScrollSpeed:E,panOnScrollMode:C,zoomOnDoubleClick:N,panOnDrag:M,defaultViewport:R,translateExtent:L,minZoom:$,maxZoom:z,preventScrolling:B,onSelectionContextMenu:w,noWheelClassName:T,noPanClassName:S,disableKeyboardA11y:k,onViewportChange:A,isControlledViewport:_}){let{nodesSelectionActive:P,userSelectionActive:V}=ce(Ix),F=bo(c,{target:Jd}),H=bo(g,{target:Jd}),W=H||M,U=H||x,Y=d&&W!==!0,q=F||V||Y;return dx({deleteKeyCode:l,multiSelectionKeyCode:p}),(0,I.jsx)(hx,{onPaneContextMenu:i,elementsSelectable:m,zoomOnScroll:b,zoomOnPinch:y,panOnScroll:U,panOnScrollSpeed:E,panOnScrollMode:C,zoomOnDoubleClick:N,panOnDrag:!F&&W,defaultViewport:R,translateExtent:L,minZoom:$,maxZoom:z,zoomActivationKeyCode:v,preventScrolling:B,noWheelClassName:T,noPanClassName:S,onViewportChange:A,isControlledViewport:_,paneClickDistance:a,children:(0,I.jsxs)(yx,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:W,isSelecting:!!q,selectionMode:u,selectionKeyPressed:F,selectionOnDrag:Y,children:[e,P&&(0,I.jsx)(Dx,{onSelectionContextMenu:w,noPanClassName:S,disableKeyboardA11y:k})]})})}vu.displayName="FlowRenderer";var Mx=(0,O.memo)(vu),Rx=e=>t=>e?Wi(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function Ox(e){return ce((0,O.useCallback)(Rx(e),[e]),ye)}var Px=e=>e.updateNodeInternals;function Ax(){let e=ce(Px),[t]=(0,O.useState)(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{let o=new Map;n.forEach(r=>{let i=r.target.getAttribute("data-id");o.set(i,{id:i,nodeElement:r.target,force:!0})}),e(o)}));return(0,O.useEffect)(()=>()=>{t?.disconnect()},[t]),t}function Lx({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){let r=ge(),i=(0,O.useRef)(null),s=(0,O.useRef)(null),a=(0,O.useRef)(e.sourcePosition),l=(0,O.useRef)(e.targetPosition),c=(0,O.useRef)(t),d=n&&!!e.internals.handleBounds;return(0,O.useEffect)(()=>{i.current&&!e.hidden&&(!d||s.current!==i.current)&&(s.current&&o?.unobserve(s.current),o?.observe(i.current),s.current=i.current)},[d,e.hidden]),(0,O.useEffect)(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),(0,O.useEffect)(()=>{if(i.current){let u=c.current!==t,f=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(u||f||h)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function Fx({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:d,resizeObserver:u,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:g,nodeTypes:v,nodeClickDistance:m,onError:b}){let{node:y,internals:x,isParent:E}=ce(q=>{let Z=q.nodeLookup.get(e),re=q.parentLookup.has(e);return{node:Z,internals:Z.internals,isParent:re}},ye),C=y.type||"default",N=v?.[C]||Qd[C];N===void 0&&(b?.("003",Ke.error003(C)),C="default",N=Qd.default);let M=!!(y.draggable||a&&typeof y.draggable>"u"),R=!!(y.selectable||l&&typeof y.selectable>"u"),L=!!(y.connectable||c&&typeof y.connectable>"u"),$=!!(y.focusable||d&&typeof y.focusable>"u"),z=ge(),B=Xi(y),w=Lx({node:y,nodeType:C,hasDimensions:B,resizeObserver:u}),T=bu({nodeRef:w,disabled:y.hidden||!M,noDragClassName:f,handleSelector:y.dragHandle,nodeId:e,isSelectable:R,nodeClickDistance:m}),S=xu();if(y.hidden)return null;let k=mt(y),A=Tx(y),_=R||M||t||n||o||r,P=n?q=>n(q,{...x.userNode}):void 0,V=o?q=>o(q,{...x.userNode}):void 0,F=r?q=>r(q,{...x.userNode}):void 0,H=i?q=>i(q,{...x.userNode}):void 0,W=s?q=>s(q,{...x.userNode}):void 0,U=q=>{let{selectNodesOnDrag:Z,nodeDragThreshold:re}=z.getState();R&&(!Z||!M||re>0)&&cs({id:e,store:z,nodeRef:w}),t&&t(q,{...x.userNode})},Y=q=>{if(!(kr(q.nativeEvent)||p))if(zi.includes(q.key)&&R){let Z=q.key==="Escape";cs({id:e,store:z,unselect:Z,nodeRef:w})}else M&&y.selected&&Object.prototype.hasOwnProperty.call($r,q.key)&&(q.preventDefault(),z.setState({ariaLiveMessage:`Moved selected node ${q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~x.positionAbsolute.x}, y: ${~~x.positionAbsolute.y}`}),S({direction:$r[q.key],factor:q.shiftKey?4:1}))};return(0,I.jsx)("div",{className:be(["react-flow__node",`react-flow__node-${C}`,{[h]:M},y.className,{selected:y.selected,selectable:R,parent:E,draggable:M,dragging:T}]),ref:w,style:{zIndex:x.z,transform:`translate(${x.positionAbsolute.x}px,${x.positionAbsolute.y}px)`,pointerEvents:_?"all":"none",visibility:B?"visible":"hidden",...y.style,...A},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:P,onMouseMove:V,onMouseLeave:F,onContextMenu:H,onClick:U,onDoubleClick:W,onKeyDown:$?Y:void 0,tabIndex:$?0:void 0,role:$?"button":void 0,"aria-describedby":p?void 0:`${du}-${g}`,"aria-label":y.ariaLabel,children:(0,I.jsx)(xx,{value:e,children:(0,I.jsx)(N,{id:e,data:y.data,type:C,positionAbsoluteX:x.positionAbsolute.x,positionAbsoluteY:x.positionAbsolute.y,selected:y.selected??!1,selectable:R,draggable:M,deletable:y.deletable??!0,isConnectable:L,sourcePosition:y.sourcePosition,targetPosition:y.targetPosition,dragging:T,dragHandle:y.dragHandle,zIndex:x.z,parentId:y.parentId,...k})})})}var zx=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Su(e){let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:i}=ce(zx,ye),s=Ox(e.onlyRenderVisibleElements),a=Ax();return(0,I.jsx)("div",{className:"react-flow__nodes",style:Wr,children:s.map(l=>(0,I.jsx)(Fx,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},l))})}Su.displayName="NodeRenderer";var Bx=(0,O.memo)(Su);function $x(e){return ce((0,O.useCallback)(n=>{if(!e)return n.edges.map(r=>r.id);let o=[];if(n.width&&n.height)for(let r of n.edges){let i=n.nodeLookup.get(r.source),s=n.nodeLookup.get(r.target);i&&s&&ad({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),ye)}var Hx=({color:e="none",strokeWidth:t=1})=>(0,I.jsx)("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Vx=({color:e="none",strokeWidth:t=1})=>(0,I.jsx)("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),eu={[je.Arrow]:Hx,[je.ArrowClosed]:Vx};function Wx(e){let t=ge();return(0,O.useMemo)(()=>Object.prototype.hasOwnProperty.call(eu,e)?eu[e]:(t.getState().onError?.("009",Ke.error009(e)),null),[e])}var Kx=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{let l=Wx(t);return l?(0,I.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:(0,I.jsx)(l,{color:n,strokeWidth:s})}):null},Eu=({defaultColor:e,rfId:t})=>{let n=ce(i=>i.edges),o=ce(i=>i.defaultEdgeOptions),r=(0,O.useMemo)(()=>cd(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?(0,I.jsx)("svg",{className:"react-flow__marker",children:(0,I.jsx)("defs",{children:r.map(i=>(0,I.jsx)(Kx,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Eu.displayName="MarkerDefinitions";var qx=(0,O.memo)(Eu);function Cu({x:e,y:t,label:n,labelStyle:o={},labelShowBg:r=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d}){let[u,f]=(0,O.useState)({x:1,y:0,width:0,height:0}),h=be(["react-flow__edge-textwrapper",c]),p=(0,O.useRef)(null);return(0,O.useEffect)(()=>{if(p.current){let g=p.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:(0,I.jsxs)("g",{transform:`translate(${e-u.width/2} ${t-u.height/2})`,className:h,visibility:u.width?"visible":"hidden",...d,children:[r&&(0,I.jsx)("rect",{width:u.width+2*s[0],x:-s[0],y:-s[1],height:u.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),(0,I.jsx)("text",{className:"react-flow__edge-text",y:u.height/2,dy:"0.3em",ref:p,style:o,children:n}),l]})}Cu.displayName="EdgeText";var Ux=(0,O.memo)(Cu);function Kr({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...d}){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)("path",{...d,d:e,fill:"none",className:be(["react-flow__edge-path",d.className])}),c&&(0,I.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}),o&&Ze(t)&&Ze(n)?(0,I.jsx)(Ux,{x:t,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function tu({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===X.Left||e===X.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function _u({sourceX:e,sourceY:t,sourcePosition:n=X.Bottom,targetX:o,targetY:r,targetPosition:i=X.Top}){let[s,a]=tu({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,c]=tu({pos:i,x1:o,y1:r,x2:e,y2:t}),[d,u,f,h]=Dr({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${a} ${l},${c} ${o},${r}`,d,u,f,h]}function Nu(e){return(0,O.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:m})=>{let[b,y,x]=_u({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a}),E=e.isInternal?void 0:t;return(0,I.jsx)(Kr,{id:E,path:b,labelX:y,labelY:x,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:m})})}var Yx=Nu({isInternal:!1}),Tu=Nu({isInternal:!0});Yx.displayName="SimpleBezierEdge";Tu.displayName="SimpleBezierEdgeInternal";function ku(e){return(0,O.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,sourcePosition:h=X.Bottom,targetPosition:p=X.Top,markerEnd:g,markerStart:v,pathOptions:m,interactionWidth:b})=>{let[y,x,E]=yo({sourceX:n,sourceY:o,sourcePosition:h,targetX:r,targetY:i,targetPosition:p,borderRadius:m?.borderRadius,offset:m?.offset}),C=e.isInternal?void 0:t;return(0,I.jsx)(Kr,{id:C,path:y,labelX:x,labelY:E,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,markerEnd:g,markerStart:v,interactionWidth:b})})}var Du=ku({isInternal:!1}),Iu=ku({isInternal:!0});Du.displayName="SmoothStepEdge";Iu.displayName="SmoothStepEdgeInternal";function Mu(e){return(0,O.memo)(({id:t,...n})=>{let o=e.isInternal?void 0:t;return(0,I.jsx)(Du,{...n,id:o,pathOptions:(0,O.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}var Gx=Mu({isInternal:!1}),Ru=Mu({isInternal:!0});Gx.displayName="StepEdge";Ru.displayName="StepEdgeInternal";function Ou(e){return(0,O.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:p,interactionWidth:g})=>{let[v,m,b]=Mr({sourceX:n,sourceY:o,targetX:r,targetY:i}),y=e.isInternal?void 0:t;return(0,I.jsx)(Kr,{id:y,path:v,labelX:m,labelY:b,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:u,style:f,markerEnd:h,markerStart:p,interactionWidth:g})})}var Xx=Ou({isInternal:!1}),Pu=Ou({isInternal:!0});Xx.displayName="StraightEdge";Pu.displayName="StraightEdgeInternal";function Au(e){return(0,O.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=X.Bottom,targetPosition:a=X.Top,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,pathOptions:m,interactionWidth:b})=>{let[y,x,E]=Ir({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a,curvature:m?.curvature}),C=e.isInternal?void 0:t;return(0,I.jsx)(Kr,{id:C,path:y,labelX:x,labelY:E,label:l,labelStyle:c,labelShowBg:d,labelBgStyle:u,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:v,interactionWidth:b})})}var Zx=Au({isInternal:!1}),Lu=Au({isInternal:!0});Zx.displayName="BezierEdge";Lu.displayName="BezierEdgeInternal";var nu={default:Lu,straight:Pu,step:Ru,smoothstep:Iu,simplebezier:Tu},ou={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},jx=(e,t,n)=>n===X.Left?e-t:n===X.Right?e+t:e,Qx=(e,t,n)=>n===X.Top?e-t:n===X.Bottom?e+t:e,ru="react-flow__edgeupdater";function iu({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a}){return(0,I.jsx)("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:be([ru,`${ru}-${a}`]),cx:jx(t,o,e),cy:Qx(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function Jx({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:d,onReconnectEnd:u,setReconnecting:f,setUpdateHover:h}){let p=ge(),g=(x,E)=>{if(x.button!==0)return;let{autoPanOnConnect:C,domNode:N,isValidConnection:M,connectionMode:R,connectionRadius:L,lib:$,onConnectStart:z,onConnectEnd:B,cancelConnection:w,nodeLookup:T,rfId:S,panBy:k,updateConnection:A}=p.getState(),_=E.type==="target";f(!0),d?.(x,n,E.type);let P=(F,H)=>{f(!1),u?.(F,n,E.type,H)},V=F=>c?.(n,F);Ar.onPointerDown(x.nativeEvent,{autoPanOnConnect:C,connectionMode:R,connectionRadius:L,domNode:N,handleId:E.id,nodeId:E.nodeId,nodeLookup:T,isTarget:_,edgeUpdaterType:E.type,lib:$,flowId:S,cancelConnection:w,panBy:k,isValidConnection:M,onConnect:V,onConnectStart:z,onConnectEnd:B,onReconnectEnd:P,updateConnection:A,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},v=x=>g(x,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=x=>g(x,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),b=()=>h(!0),y=()=>h(!1);return(0,I.jsxs)(I.Fragment,{children:[(e===!0||e==="source")&&(0,I.jsx)(iu,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:v,onMouseEnter:b,onMouseOut:y,type:"source"}),(e===!0||e==="target")&&(0,I.jsx)(iu,{position:l,centerX:i,centerY:s,radius:t,onMouseDown:m,onMouseEnter:b,onMouseOut:y,type:"target"})]})}function ew({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:d,onReconnect:u,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:g,noPanClassName:v,onError:m,disableKeyboardA11y:b}){let y=ce(Q=>Q.edgeLookup.get(e)),x=ce(Q=>Q.defaultEdgeOptions);y=x?{...x,...y}:y;let E=y.type||"default",C=g?.[E]||nu[E];C===void 0&&(m?.("011",Ke.error011(E)),E="default",C=nu.default);let N=!!(y.focusable||t&&typeof y.focusable>"u"),M=typeof u<"u"&&(y.reconnectable||n&&typeof y.reconnectable>"u"),R=!!(y.selectable||o&&typeof y.selectable>"u"),L=(0,O.useRef)(null),[$,z]=(0,O.useState)(!1),[B,w]=(0,O.useState)(!1),T=ge(),{zIndex:S,sourceX:k,sourceY:A,targetX:_,targetY:P,sourcePosition:V,targetPosition:F}=ce((0,O.useCallback)(Q=>{let le=Q.nodeLookup.get(y.source),me=Q.nodeLookup.get(y.target);if(!le||!me)return{zIndex:y.zIndex,...ou};let Re=ld({id:e,sourceNode:le,targetNode:me,sourceHandle:y.sourceHandle||null,targetHandle:y.targetHandle||null,connectionMode:Q.connectionMode,onError:m});return{zIndex:sd({selected:y.selected,zIndex:y.zIndex,sourceNode:le,targetNode:me,elevateOnSelect:Q.elevateEdgesOnSelect}),...Re||ou}},[y.source,y.target,y.sourceHandle,y.targetHandle,y.selected,y.zIndex]),ye),H=(0,O.useMemo)(()=>y.markerStart?`url('#${Rr(y.markerStart,p)}')`:void 0,[y.markerStart,p]),W=(0,O.useMemo)(()=>y.markerEnd?`url('#${Rr(y.markerEnd,p)}')`:void 0,[y.markerEnd,p]);if(y.hidden||k===null||A===null||_===null||P===null)return null;let U=Q=>{let{addSelectedEdges:le,unselectNodesAndEdges:me,multiSelectionActive:Re}=T.getState();R&&(T.setState({nodesSelectionActive:!1}),y.selected&&Re?(me({nodes:[],edges:[y]}),L.current?.blur()):le([e])),r&&r(Q,y)},Y=i?Q=>{i(Q,{...y})}:void 0,q=s?Q=>{s(Q,{...y})}:void 0,Z=a?Q=>{a(Q,{...y})}:void 0,re=l?Q=>{l(Q,{...y})}:void 0,se=c?Q=>{c(Q,{...y})}:void 0,ae=Q=>{if(!b&&zi.includes(Q.key)&&R){let{unselectNodesAndEdges:le,addSelectedEdges:me}=T.getState();Q.key==="Escape"?(L.current?.blur(),le({edges:[y]})):me([e])}};return(0,I.jsx)("svg",{style:{zIndex:S},children:(0,I.jsxs)("g",{className:be(["react-flow__edge",`react-flow__edge-${E}`,y.className,v,{selected:y.selected,animated:y.animated,inactive:!R&&!r,updating:$,selectable:R}]),onClick:U,onDoubleClick:Y,onContextMenu:q,onMouseEnter:Z,onMouseMove:re,onMouseLeave:se,onKeyDown:N?ae:void 0,tabIndex:N?0:void 0,role:N?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":y.ariaLabel===null?void 0:y.ariaLabel||`Edge from ${y.source} to ${y.target}`,"aria-describedby":N?`${uu}-${p}`:void 0,ref:L,children:[!B&&(0,I.jsx)(C,{id:e,source:y.source,target:y.target,type:y.type,selected:y.selected,animated:y.animated,selectable:R,deletable:y.deletable??!0,label:y.label,labelStyle:y.labelStyle,labelShowBg:y.labelShowBg,labelBgStyle:y.labelBgStyle,labelBgPadding:y.labelBgPadding,labelBgBorderRadius:y.labelBgBorderRadius,sourceX:k,sourceY:A,targetX:_,targetY:P,sourcePosition:V,targetPosition:F,data:y.data,style:y.style,sourceHandleId:y.sourceHandle,targetHandleId:y.targetHandle,markerStart:H,markerEnd:W,pathOptions:"pathOptions"in y?y.pathOptions:void 0,interactionWidth:y.interactionWidth}),M&&(0,I.jsx)(Jx,{edge:y,isReconnectable:M,reconnectRadius:d,onReconnect:u,onReconnectStart:f,onReconnectEnd:h,sourceX:k,sourceY:A,targetX:_,targetY:P,sourcePosition:V,targetPosition:F,setUpdateHover:z,setReconnecting:w})]})})}var tw=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Fu({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,reconnectRadius:u,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:g}){let{edgesFocusable:v,edgesReconnectable:m,elementsSelectable:b,onError:y}=ce(tw,ye),x=$x(t);return(0,I.jsxs)("div",{className:"react-flow__edges",children:[(0,I.jsx)(qx,{defaultColor:e,rfId:n}),x.map(E=>(0,I.jsx)(ew,{id:E,edgesFocusable:v,edgesReconnectable:m,elementsSelectable:b,noPanClassName:r,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,reconnectRadius:u,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:y,edgeTypes:o,disableKeyboardA11y:g},E))]})}Fu.displayName="EdgeRenderer";var nw=(0,O.memo)(Fu),ow=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function rw({children:e}){let t=ce(ow);return(0,I.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function iw(e){let t=qe(),n=(0,O.useRef)(!1);(0,O.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}var sw=e=>e.panZoom?.syncViewport;function aw(e){let t=ce(sw),n=ge();return(0,O.useEffect)(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function su(e){return e.connection.inProgress?{...e.connection,to:Dn(e.connection.to,e.transform)}:{...e.connection}}function lw(e){return e?n=>{let o=su(n);return e(o)}:su}function cw(e){let t=lw(e);return ce(t,ye)}var dw=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function uw({containerStyle:e,style:t,type:n,component:o}){let{nodesConnectable:r,width:i,height:s,isValid:a,inProgress:l}=ce(dw,ye);return!(i&&r&&l)?null:(0,I.jsx)("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:(0,I.jsx)("g",{className:be(["react-flow__connection",$i(a)]),children:(0,I.jsx)(zu,{style:t,type:n,CustomComponent:o,isValid:a})})})}var zu=({style:e,type:t=He.Bezier,CustomComponent:n,isValid:o})=>{let{inProgress:r,from:i,fromNode:s,fromHandle:a,fromPosition:l,to:c,toNode:d,toHandle:u,toPosition:f}=cw();if(!r)return;if(n)return(0,I.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:f,connectionStatus:$i(o),toNode:d,toHandle:u});let h="",p={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:f};switch(t){case He.Bezier:[h]=Ir(p);break;case He.SimpleBezier:[h]=_u(p);break;case He.Step:[h]=yo({...p,borderRadius:0});break;case He.SmoothStep:[h]=yo(p);break;default:[h]=Mr(p)}return(0,I.jsx)("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};zu.displayName="ConnectionLine";var fw={};function au(e=fw){let t=(0,O.useRef)(e),n=ge();(0,O.useEffect)(()=>{},[e])}function hw(){let e=ge(),t=(0,O.useRef)(!1);(0,O.useEffect)(()=>{},[])}function Bu({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,onSelectionContextMenu:u,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:g,connectionLineComponent:v,connectionLineContainerStyle:m,selectionKeyCode:b,selectionOnDrag:y,selectionMode:x,multiSelectionKeyCode:E,panActivationKeyCode:C,zoomActivationKeyCode:N,deleteKeyCode:M,onlyRenderVisibleElements:R,elementsSelectable:L,defaultViewport:$,translateExtent:z,minZoom:B,maxZoom:w,preventScrolling:T,defaultMarkerColor:S,zoomOnScroll:k,zoomOnPinch:A,panOnScroll:_,panOnScrollSpeed:P,panOnScrollMode:V,zoomOnDoubleClick:F,panOnDrag:H,onPaneClick:W,onPaneMouseEnter:U,onPaneMouseMove:Y,onPaneMouseLeave:q,onPaneScroll:Z,onPaneContextMenu:re,paneClickDistance:se,nodeClickDistance:ae,onEdgeContextMenu:Q,onEdgeMouseEnter:le,onEdgeMouseMove:me,onEdgeMouseLeave:Re,reconnectRadius:Ft,onReconnect:ni,onReconnectStart:oi,onReconnectEnd:ri,noDragClassName:Ln,noWheelClassName:ii,noPanClassName:Fn,disableKeyboardA11y:zn,nodeExtent:si,rfId:Bn,viewport:$n,onViewportChange:Ro}){return au(e),au(t),hw(),iw(n),aw($n),(0,I.jsx)(Mx,{onPaneClick:W,onPaneMouseEnter:U,onPaneMouseMove:Y,onPaneMouseLeave:q,onPaneContextMenu:re,onPaneScroll:Z,paneClickDistance:se,deleteKeyCode:M,selectionKeyCode:b,selectionOnDrag:y,selectionMode:x,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:E,panActivationKeyCode:C,zoomActivationKeyCode:N,elementsSelectable:L,zoomOnScroll:k,zoomOnPinch:A,zoomOnDoubleClick:F,panOnScroll:_,panOnScrollSpeed:P,panOnScrollMode:V,panOnDrag:H,defaultViewport:$,translateExtent:z,minZoom:B,maxZoom:w,onSelectionContextMenu:u,preventScrolling:T,noDragClassName:Ln,noWheelClassName:ii,noPanClassName:Fn,disableKeyboardA11y:zn,onViewportChange:Ro,isControlledViewport:!!$n,children:(0,I.jsxs)(rw,{children:[(0,I.jsx)(nw,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:s,onReconnect:ni,onReconnectStart:oi,onReconnectEnd:ri,onlyRenderVisibleElements:R,onEdgeContextMenu:Q,onEdgeMouseEnter:le,onEdgeMouseMove:me,onEdgeMouseLeave:Re,reconnectRadius:Ft,defaultMarkerColor:S,noPanClassName:Fn,disableKeyboardA11y:zn,rfId:Bn}),(0,I.jsx)(uw,{style:g,type:p,component:v,containerStyle:m}),(0,I.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,I.jsx)(Bx,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:d,nodeClickDistance:ae,onlyRenderVisibleElements:R,noPanClassName:Fn,noDragClassName:Ln,disableKeyboardA11y:zn,nodeExtent:si,rfId:Bn}),(0,I.jsx)("div",{className:"react-flow__viewport-portal"})]})})}Bu.displayName="GraphView";var pw=(0,O.memo)(Bu),lu=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l}={})=>{let c=new Map,d=new Map,u=new Map,f=new Map,h=o??t??[],p=n??e??[],g=a??[0,0],v=l??Nn;rs(u,f,h),Or(p,c,d,{nodeOrigin:g,nodeExtent:v,elevateNodesOnSelect:!1});let m=[0,0,1];if(s&&r&&i){let b=Tn(c,{filter:C=>!!((C.width||C.initialWidth)&&(C.height||C.initialHeight))}),{x:y,y:x,zoom:E}=en(b,r,i,.5,2,.1);m=[y,x,E]}return{rfId:"1",width:0,height:0,transform:m,nodes:p,nodeLookup:c,parentLookup:d,edges:h,edgeLookup:f,connectionLookup:u,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:Nn,nodeExtent:v,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:pt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...Bi},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:Yi,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},mw=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l})=>Bd((c,d)=>({...lu({nodes:e,edges:t,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l,defaultNodes:n,defaultEdges:o}),setNodes:u=>{let{nodeLookup:f,parentLookup:h,nodeOrigin:p,elevateNodesOnSelect:g}=d();Or(u,f,h,{nodeOrigin:p,nodeExtent:l,elevateNodesOnSelect:g,checkEquality:!0}),c({nodes:u})},setEdges:u=>{let{connectionLookup:f,edgeLookup:h}=d();rs(f,h,u),c({edges:u})},setDefaultNodesAndEdges:(u,f)=>{if(u){let{setNodes:h}=d();h(u),c({hasDefaultNodes:!0})}if(f){let{setEdges:h}=d();h(f),c({hasDefaultEdges:!0})}},updateNodeInternals:(u,f={triggerFitView:!0})=>{let{triggerNodeChanges:h,nodeLookup:p,parentLookup:g,fitViewOnInit:v,fitViewDone:m,fitViewOnInitOptions:b,domNode:y,nodeOrigin:x,nodeExtent:E,debug:C,fitViewSync:N}=d(),{changes:M,updatedInternals:R}=fd(u,p,g,y,x,E);if(R){if(dd(p,g,{nodeOrigin:x,nodeExtent:E}),f.triggerFitView){let L=m;!m&&v&&(L=N({...b,nodes:b?.nodes})),c({fitViewDone:L})}else c({});M?.length>0&&(C&&console.log("React Flow: trigger node changes",M),h?.(M))}},updateNodePositions:(u,f=!1)=>{let h=[],p=[],{nodeLookup:g,triggerNodeChanges:v}=d();for(let[m,b]of u){let y=g.get(m),x=!!(y?.expandParent&&y?.parentId&&b?.position),E={id:m,type:"position",position:x?{x:Math.max(0,b.position.x),y:Math.max(0,b.position.y)}:b.position,dragging:f};x&&y.parentId&&h.push({id:m,parentId:y.parentId,rect:{...b.internals.positionAbsolute,width:b.measured.width??0,height:b.measured.height??0}}),p.push(E)}if(h.length>0){let{parentLookup:m,nodeOrigin:b}=d(),y=Pr(h,g,m,b);p.push(...y)}v(p)},triggerNodeChanges:u=>{let{onNodesChange:f,setNodes:h,nodes:p,hasDefaultNodes:g,debug:v}=d();if(u?.length){if(g){let m=pu(u,p);h(m)}v&&console.log("React Flow: trigger node changes",u),f?.(u)}},triggerEdgeChanges:u=>{let{onEdgesChange:f,setEdges:h,edges:p,hasDefaultEdges:g,debug:v}=d();if(u?.length){if(g){let m=mu(u,p);h(m)}v&&console.log("React Flow: trigger edge changes",u),f?.(u)}},addSelectedNodes:u=>{let{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:v}=d();if(f){let m=u.map(b=>tn(b,!0));g(m);return}g(Mn(p,new Set([...u]),!0)),v(Mn(h))},addSelectedEdges:u=>{let{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:v}=d();if(f){let m=u.map(b=>tn(b,!0));v(m);return}v(Mn(h,new Set([...u]))),g(Mn(p,new Set,!0))},unselectNodesAndEdges:({nodes:u,edges:f}={})=>{let{edges:h,nodes:p,nodeLookup:g,triggerNodeChanges:v,triggerEdgeChanges:m}=d(),b=u||p,y=f||h,x=b.map(C=>{let N=g.get(C.id);return N&&(N.selected=!1),tn(C.id,!1)}),E=y.map(C=>tn(C.id,!1));v(x),m(E)},setMinZoom:u=>{let{panZoom:f,maxZoom:h}=d();f?.setScaleExtent([u,h]),c({minZoom:u})},setMaxZoom:u=>{let{panZoom:f,minZoom:h}=d();f?.setScaleExtent([h,u]),c({maxZoom:u})},setTranslateExtent:u=>{d().panZoom?.setTranslateExtent(u),c({translateExtent:u})},setPaneClickDistance:u=>{d().panZoom?.setClickDistance(u)},resetSelectedElements:()=>{let{edges:u,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:p}=d(),g=f.reduce((m,b)=>b.selected?[...m,tn(b.id,!1)]:m,[]),v=u.reduce((m,b)=>b.selected?[...m,tn(b.id,!1)]:m,[]);h(g),p(v)},setNodeExtent:u=>{let{nodes:f,nodeLookup:h,parentLookup:p,nodeOrigin:g,elevateNodesOnSelect:v,nodeExtent:m}=d();u[0][0]===m[0][0]&&u[0][1]===m[0][1]&&u[1][0]===m[1][0]&&u[1][1]===m[1][1]||(Or(f,h,p,{nodeOrigin:g,nodeExtent:u,elevateNodesOnSelect:v,checkEquality:!1}),c({nodeExtent:u}))},panBy:u=>{let{transform:f,width:h,height:p,panZoom:g,translateExtent:v}=d();return hd({delta:u,panZoom:g,transform:f,translateExtent:v,width:h,height:p})},fitView:u=>{let{panZoom:f,width:h,height:p,minZoom:g,maxZoom:v,nodeLookup:m}=d();if(!f)return Promise.resolve(!1);let b=Cr(m,u);return _r({nodes:b,width:h,height:p,panZoom:f,minZoom:g,maxZoom:v},u)},fitViewSync:u=>{let{panZoom:f,width:h,height:p,minZoom:g,maxZoom:v,nodeLookup:m}=d();if(!f)return!1;let b=Cr(m,u);return _r({nodes:b,width:h,height:p,panZoom:f,minZoom:g,maxZoom:v},u),b.size>0},cancelConnection:()=>{c({connection:{...Bi}})},updateConnection:u=>{c({connection:u})},reset:()=>c({...lu()})}),Object.is);function us({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,fitView:s,nodeOrigin:a,nodeExtent:l,children:c}){let[d]=(0,O.useState)(()=>mw({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l}));return(0,I.jsx)(L0,{value:d,children:(0,I.jsx)(ix,{children:c})})}function gw({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:a,nodeOrigin:l,nodeExtent:c}){return(0,O.useContext)(Hr)?(0,I.jsx)(I.Fragment,{children:e}):(0,I.jsx)(us,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:a,nodeOrigin:l,nodeExtent:c,children:e})}var yw={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function bw({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:u,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:m,onNodeMouseEnter:b,onNodeMouseMove:y,onNodeMouseLeave:x,onNodeContextMenu:E,onNodeDoubleClick:C,onNodeDragStart:N,onNodeDrag:M,onNodeDragStop:R,onNodesDelete:L,onEdgesDelete:$,onDelete:z,onSelectionChange:B,onSelectionDragStart:w,onSelectionDrag:T,onSelectionDragStop:S,onSelectionContextMenu:k,onSelectionStart:A,onSelectionEnd:_,onBeforeDelete:P,connectionMode:V,connectionLineType:F=He.Bezier,connectionLineStyle:H,connectionLineComponent:W,connectionLineContainerStyle:U,deleteKeyCode:Y="Backspace",selectionKeyCode:q="Shift",selectionOnDrag:Z=!1,selectionMode:re=Zt.Full,panActivationKeyCode:se="Space",multiSelectionKeyCode:ae=po()?"Meta":"Control",zoomActivationKeyCode:Q=po()?"Meta":"Control",snapToGrid:le,snapGrid:me,onlyRenderVisibleElements:Re=!1,selectNodesOnDrag:Ft,nodesDraggable:ni,nodesConnectable:oi,nodesFocusable:ri,nodeOrigin:Ln=fu,edgesFocusable:ii,edgesReconnectable:Fn,elementsSelectable:zn=!0,defaultViewport:si=X0,minZoom:Bn=.5,maxZoom:$n=2,translateExtent:Ro=Nn,preventScrolling:Sm=!0,nodeExtent:ai,defaultMarkerColor:Em="#b1b1b7",zoomOnScroll:Cm=!0,zoomOnPinch:_m=!0,panOnScroll:Nm=!1,panOnScrollSpeed:Tm=.5,panOnScrollMode:km=Et.Free,zoomOnDoubleClick:Dm=!0,panOnDrag:Im=!0,onPaneClick:Mm,onPaneMouseEnter:Rm,onPaneMouseMove:Om,onPaneMouseLeave:Pm,onPaneScroll:Am,onPaneContextMenu:Lm,paneClickDistance:Us=0,nodeClickDistance:Fm=0,children:zm,onReconnect:Bm,onReconnectStart:$m,onReconnectEnd:Hm,onEdgeContextMenu:Vm,onEdgeDoubleClick:Wm,onEdgeMouseEnter:Km,onEdgeMouseMove:qm,onEdgeMouseLeave:Um,reconnectRadius:Ym=10,onNodesChange:Gm,onEdgesChange:Xm,noDragClassName:Zm="nodrag",noWheelClassName:jm="nowheel",noPanClassName:Ys="nopan",fitView:Gs,fitViewOptions:Qm,connectOnClick:Jm,attributionPosition:eg,proOptions:tg,defaultEdgeOptions:ng,elevateNodesOnSelect:og,elevateEdgesOnSelect:rg,disableKeyboardA11y:Xs=!1,autoPanOnConnect:ig,autoPanOnNodeDrag:sg,autoPanSpeed:ag,connectionRadius:lg,isValidConnection:cg,onError:dg,style:ug,id:Zs,nodeDragThreshold:fg,viewport:hg,onViewportChange:pg,width:mg,height:gg,colorMode:yg="light",debug:bg,onScroll:js,...xg},wg){let li=Zs||"1",vg=J0(yg),Sg=(0,O.useCallback)(Qs=>{Qs.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),js?.(Qs)},[js]);return(0,I.jsx)("div",{"data-testid":"rf__wrapper",...xg,onScroll:Sg,style:{...ug,...yw},ref:wg,className:be(["react-flow",r,vg]),id:Zs,children:(0,I.jsxs)(gw,{nodes:e,edges:t,width:mg,height:gg,fitView:Gs,nodeOrigin:Ln,nodeExtent:ai,children:[(0,I.jsx)(pw,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:b,onNodeMouseMove:y,onNodeMouseLeave:x,onNodeContextMenu:E,onNodeDoubleClick:C,nodeTypes:i,edgeTypes:s,connectionLineType:F,connectionLineStyle:H,connectionLineComponent:W,connectionLineContainerStyle:U,selectionKeyCode:q,selectionOnDrag:Z,selectionMode:re,deleteKeyCode:Y,multiSelectionKeyCode:ae,panActivationKeyCode:se,zoomActivationKeyCode:Q,onlyRenderVisibleElements:Re,defaultViewport:si,translateExtent:Ro,minZoom:Bn,maxZoom:$n,preventScrolling:Sm,zoomOnScroll:Cm,zoomOnPinch:_m,zoomOnDoubleClick:Dm,panOnScroll:Nm,panOnScrollSpeed:Tm,panOnScrollMode:km,panOnDrag:Im,onPaneClick:Mm,onPaneMouseEnter:Rm,onPaneMouseMove:Om,onPaneMouseLeave:Pm,onPaneScroll:Am,onPaneContextMenu:Lm,paneClickDistance:Us,nodeClickDistance:Fm,onSelectionContextMenu:k,onSelectionStart:A,onSelectionEnd:_,onReconnect:Bm,onReconnectStart:$m,onReconnectEnd:Hm,onEdgeContextMenu:Vm,onEdgeDoubleClick:Wm,onEdgeMouseEnter:Km,onEdgeMouseMove:qm,onEdgeMouseLeave:Um,reconnectRadius:Ym,defaultMarkerColor:Em,noDragClassName:Zm,noWheelClassName:jm,noPanClassName:Ys,rfId:li,disableKeyboardA11y:Xs,nodeExtent:ai,viewport:hg,onViewportChange:pg}),(0,I.jsx)(Q0,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:v,onClickConnectEnd:m,nodesDraggable:ni,nodesConnectable:oi,nodesFocusable:ri,edgesFocusable:ii,edgesReconnectable:Fn,elementsSelectable:zn,elevateNodesOnSelect:og,elevateEdgesOnSelect:rg,minZoom:Bn,maxZoom:$n,nodeExtent:ai,onNodesChange:Gm,onEdgesChange:Xm,snapToGrid:le,snapGrid:me,connectionMode:V,translateExtent:Ro,connectOnClick:Jm,defaultEdgeOptions:ng,fitView:Gs,fitViewOptions:Qm,onNodesDelete:L,onEdgesDelete:$,onDelete:z,onNodeDragStart:N,onNodeDrag:M,onNodeDragStop:R,onSelectionDrag:T,onSelectionDragStart:w,onSelectionDragStop:S,onMove:d,onMoveStart:u,onMoveEnd:f,noPanClassName:Ys,nodeOrigin:Ln,rfId:li,autoPanOnConnect:ig,autoPanOnNodeDrag:sg,autoPanSpeed:ag,onError:dg,connectionRadius:lg,isValidConnection:cg,selectNodesOnDrag:Ft,nodeDragThreshold:fg,onBeforeDelete:P,paneClickDistance:Us,debug:bg}),(0,I.jsx)(G0,{onSelectionChange:B}),zm,(0,I.jsx)(W0,{proOptions:tg,position:eg}),(0,I.jsx)(H0,{rfId:li,disableKeyboardA11y:Xs})]})})}var $u=gu(bw);function Hu(e){let[t,n]=(0,O.useState)(e),o=(0,O.useCallback)(r=>n(i=>pu(r,i)),[]);return[t,n,o]}function Vu(e){let[t,n]=(0,O.useState)(e),o=(0,O.useCallback)(r=>n(i=>mu(r,i)),[]);return[t,n,o]}var KD=Ke.error014();function xw({dimensions:e,lineWidth:t,variant:n,className:o}){return(0,I.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:be(["react-flow__background-pattern",n,o])})}function ww({radius:e,className:t}){return(0,I.jsx)("circle",{cx:e,cy:e,r:e,className:be(["react-flow__background-pattern","dots",t])})}var gt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(gt||(gt={}));var vw={[gt.Dots]:1,[gt.Lines]:1,[gt.Cross]:6},Sw=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Wu({id:e,variant:t=gt.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:s,bgColor:a,style:l,className:c,patternClassName:d}){let u=(0,O.useRef)(null),{transform:f,patternId:h}=ce(Sw,ye),p=o||vw[t],g=t===gt.Dots,v=t===gt.Cross,m=Array.isArray(n)?n:[n,n],b=[m[0]*f[2]||1,m[1]*f[2]||1],y=p*f[2],x=Array.isArray(i)?i:[i,i],E=v?[y,y]:b,C=[x[0]*f[2]||1+E[0]/2,x[1]*f[2]||1+E[1]/2],N=`${h}${e||""}`;return(0,I.jsxs)("svg",{className:be(["react-flow__background",c]),style:{...l,...Wr,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:u,"data-testid":"rf__background",children:[(0,I.jsx)("pattern",{id:N,x:f[0]%b[0],y:f[1]%b[1],width:b[0],height:b[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`,children:g?(0,I.jsx)(ww,{radius:y/2,className:d}):(0,I.jsx)(xw,{dimensions:E,lineWidth:r,variant:t,className:d})}),(0,I.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${N})`})]})}Wu.displayName="Background";var Ku=(0,O.memo)(Wu);function Ew(){return(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,I.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function Cw(){return(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,I.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function _w(){return(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,I.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Nw(){return(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,I.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Tw(){return(0,I.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,I.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Br({children:e,className:t,...n}){return(0,I.jsx)("button",{type:"button",className:be(["react-flow__controls-button",t]),...n,children:e})}var kw=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function qu({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:d,position:u="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){let p=ge(),{isInteractive:g,minZoomReached:v,maxZoomReached:m}=ce(kw,ye),{zoomIn:b,zoomOut:y,fitView:x}=qe(),E=()=>{b(),i?.()},C=()=>{y(),s?.()},N=()=>{x(r),a?.()},M=()=>{p.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l?.(!g)};return(0,I.jsxs)(Vr,{className:be(["react-flow__controls",f==="horizontal"?"horizontal":"vertical",c]),position:u,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(Br,{onClick:E,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:m,children:(0,I.jsx)(Ew,{})}),(0,I.jsx)(Br,{onClick:C,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:v,children:(0,I.jsx)(Cw,{})})]}),n&&(0,I.jsx)(Br,{className:"react-flow__controls-fitview",onClick:N,title:"fit view","aria-label":"fit view",children:(0,I.jsx)(_w,{})}),o&&(0,I.jsx)(Br,{className:"react-flow__controls-interactive",onClick:M,title:"toggle interactivity","aria-label":"toggle interactivity",children:g?(0,I.jsx)(Tw,{}):(0,I.jsx)(Nw,{})}),d]})}qu.displayName="Controls";var Uu=(0,O.memo)(qu);function Dw({id:e,x:t,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:u,selected:f,onClick:h}){let{background:p,backgroundColor:g}=i||{},v=s||p||g;return(0,I.jsx)("rect",{className:be(["react-flow__minimap-node",{selected:f},c]),x:t,y:n,rx:d,ry:d,width:o,height:r,style:{fill:v,stroke:a,strokeWidth:l},shapeRendering:u,onClick:h?m=>h(m,e):void 0})}var Iw=(0,O.memo)(Dw),Mw=e=>e.nodes.map(t=>t.id),ls=e=>e instanceof Function?e:()=>e;function Rw({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=Iw,onClick:s}){let a=ce(Mw,ye),l=ls(t),c=ls(e),d=ls(n),u=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return(0,I.jsx)(I.Fragment,{children:a.map(f=>(0,I.jsx)(Pw,{id:f,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:d,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:s,shapeRendering:u},f))})}function Ow({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:l}){let{node:c,x:d,y:u,width:f,height:h}=ce(p=>{let g=p.nodeLookup.get(e),{x:v,y:m}=g.internals.positionAbsolute,{width:b,height:y}=mt(g);return{node:g,x:v,y:m,width:b,height:y}},ye);return!c||c.hidden||!Xi(c)?null:(0,I.jsx)(a,{x:d,y:u,width:f,height:h,style:c.style,selected:!!c.selected,className:o(c),color:t(c),borderRadius:r,strokeColor:n(c),strokeWidth:i,shapeRendering:s,onClick:l,id:c.id})}var Pw=(0,O.memo)(Ow),Aw=(0,O.memo)(Rw),Lw=200,Fw=150,zw=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?qi(Tn(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},Bw="react-flow__minimap-desc";function Yu({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:d,maskStrokeWidth:u,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:g=!1,zoomable:v=!1,ariaLabel:m="React Flow mini map",inversePan:b,zoomStep:y=10,offsetScale:x=5}){let E=ge(),C=(0,O.useRef)(null),{boundingRect:N,viewBB:M,rfId:R,panZoom:L,translateExtent:$,flowWidth:z,flowHeight:B}=ce(zw,ye),w=e?.width??Lw,T=e?.height??Fw,S=N.width/w,k=N.height/T,A=Math.max(S,k),_=A*w,P=A*T,V=x*A,F=N.x-(_-N.width)/2-V,H=N.y-(P-N.height)/2-V,W=_+V*2,U=P+V*2,Y=`${Bw}-${R}`,q=(0,O.useRef)(0),Z=(0,O.useRef)();q.current=A,(0,O.useEffect)(()=>{if(C.current&&L)return Z.current=wd({domNode:C.current,panZoom:L,getTransform:()=>E.getState().transform,getViewScale:()=>q.current}),()=>{Z.current?.destroy()}},[L]),(0,O.useEffect)(()=>{Z.current?.update({translateExtent:$,width:z,height:B,inversePan:b,pannable:g,zoomStep:y,zoomable:v})},[g,v,b,y,$,z,B]);let re=h?ae=>{let[Q,le]=Z.current?.pointer(ae)||[0,0];h(ae,{x:Q,y:le})}:void 0,se=p?(0,O.useCallback)((ae,Q)=>{let le=E.getState().nodeLookup.get(Q);p(ae,le)},[]):void 0;return(0,I.jsx)(Vr,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-stroke-width-props":typeof u=="number"?u*A:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="string"?s:void 0},className:be(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,I.jsxs)("svg",{width:w,height:T,viewBox:`${F} ${H} ${W} ${U}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:C,onClick:re,children:[m&&(0,I.jsx)("title",{id:Y,children:m}),(0,I.jsx)(Aw,{onClick:se,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),(0,I.jsx)("path",{className:"react-flow__minimap-mask",d:`M${F-V},${H-V}h${W+V*2}v${U+V*2}h${-W-V*2}z
        M${M.x},${M.y}h${M.width}v${M.height}h${-M.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Yu.displayName="MiniMap";var Gu=(0,O.memo)(Yu);function $w({nodeId:e,position:t,variant:n=Qt.Handle,className:o,style:r={},children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:u=!1,shouldResize:f,onResizeStart:h,onResize:p,onResizeEnd:g}){let v=wu(),m=typeof e=="string"?e:v,b=ge(),y=(0,O.useRef)(null),x=n===Qt.Line?"right":"bottom-right",E=t??x,C=(0,O.useRef)(null);(0,O.useEffect)(()=>{if(!(!y.current||!m))return C.current||(C.current=_d({domNode:y.current,nodeId:m,getStoreItems:()=>{let{nodeLookup:L,transform:$,snapGrid:z,snapToGrid:B,nodeOrigin:w,domNode:T}=b.getState();return{nodeLookup:L,transform:$,snapGrid:z,snapToGrid:B,nodeOrigin:w,paneDomNode:T}},onChange:(L,$)=>{let{triggerNodeChanges:z,nodeLookup:B,parentLookup:w,nodeOrigin:T}=b.getState(),S=[],k={x:L.x,y:L.y},A=B.get(m);if(A&&A.expandParent&&A.parentId){let _=A.origin??T,P=L.width??A.measured.width??0,V=L.height??A.measured.height??0,F={id:A.id,parentId:A.parentId,rect:{width:P,height:V,...Zi({x:L.x??A.position.x,y:L.y??A.position.y},{width:P,height:V},A.parentId,B,_)}},H=Pr([F],B,w,T);S.push(...H),k.x=L.x?Math.max(_[0]*P,L.x):void 0,k.y=L.y?Math.max(_[1]*V,L.y):void 0}if(k.x!==void 0&&k.y!==void 0){let _={id:m,type:"position",position:{...k}};S.push(_)}if(L.width!==void 0&&L.height!==void 0){let _={id:m,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:L.width,height:L.height}};S.push(_)}for(let _ of $){let P={..._,type:"position"};S.push(P)}z(S)},onEnd:()=>{let L={id:m,type:"dimensions",resizing:!1};b.getState().triggerNodeChanges([L])}})),C.current.update({controlPosition:E,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:d},keepAspectRatio:u,onResizeStart:h,onResize:p,onResizeEnd:g,shouldResize:f}),()=>{C.current?.destroy()}},[E,a,l,c,d,u,h,p,g,f]);let N=E.split("-"),M=n===Qt.Line?"borderColor":"backgroundColor",R=s?{...r,[M]:s}:r;return(0,I.jsx)("div",{className:be(["react-flow__resize-control","nodrag",...N,n,o]),ref:y,style:R,children:i})}var qD=(0,O.memo)($w);var So=K(bp());var rn={getNextColumnName:e=>{let t=1;for(;e.some(n=>n.name===`column_${t}`);)t++;return`column_${t}`},getNextForeignKeyName:(e,t)=>{let n=new Set;for(let r of t)for(let i of r.foreignKeys)n.add(i.name);for(let r of e)n.add(r.name);let o=1;for(;n.has(`FK_${o}`);)o++;return`FK_${o}`},getNextTableName:e=>{let t=1;for(;e.some(n=>n.name===`table_${t}`);)t++;return`table_${t}`}},yt={getAllTables:(e,t)=>e.tables.filter(n=>!t||n.schema!==t.schema||n.name!==t.name).sort(),getTableFromDisplayName:(e,t)=>e.tables.find(n=>`${n.schema}.${n.name}`===t),tableNameValidationError:(e,t)=>{if(e.tables.find(o=>o.name.toLowerCase()===t.name.toLowerCase()&&o.schema.toLowerCase()===t.schema.toLowerCase()&&o.id!==t.id))return D.schemaDesigner.tableNameRepeatedError(t.name);if(!t.name)return D.schemaDesigner.tableNameEmptyError},createNewTable:(e,t)=>({name:rn.getNextTableName(e.tables),schema:t[0],columns:[{name:"Id",dataType:"int",maxLength:"",precision:0,scale:0,isNullable:!1,isPrimaryKey:!0,id:ut(),isIdentity:!0,identitySeed:1,identityIncrement:1,defaultValue:"",isComputed:!1,computedFormula:"",computedPersisted:!1}],foreignKeys:[],id:ut()})},Se={isColumnValid:(e,t)=>{if(t.find(o=>o.name.toLowerCase()===e.name.toLowerCase()&&o.id!==e.id&&o.dataType===e.dataType))return D.schemaDesigner.columnNameRepeatedError(e.name);if(!e.name)return D.schemaDesigner.columnNameEmptyError;if(e.isPrimaryKey&&e.isNullable)return D.schemaDesigner.columnPKCannotBeNull(e.name);if(Se.isLengthBasedType(e.dataType)){if(!e.maxLength)return D.schemaDesigner.columnMaxLengthEmptyError;if(e.maxLength&&e.maxLength!=="MAX"){let o=parseInt(e.maxLength);if(isNaN(o)||o<=0)return D.schemaDesigner.columnMaxLengthInvalid(e.maxLength)}}},isLengthBasedType:e=>["char","varchar","nchar","nvarchar","binary","varbinary","vector"].includes(e),isTimeBasedWithScale:e=>["datetime2","datetimeoffset","time"].includes(e),isPrecisionBasedType:e=>["decimal","numeric"].includes(e),isIdentityBasedType:(e,t)=>e==="decimal"||e==="numeric"?t===0:["int","bigint","smallint","tinyint"].includes(e),getDefaultLength:e=>{switch(e){case"char":case"nchar":case"binary":case"vector":return"1";case"varchar":case"nvarchar":case"varbinary":return"50";default:return"0"}},getDefaultPrecision:e=>{switch(e){case"decimal":case"numeric":return 18;default:return 0}},getDefaultScale:e=>{switch(e){case"decimal":case"numeric":return 0;default:return 0}},fillColumnDefaults:e=>(Se.isLengthBasedType(e.dataType)?e.maxLength=Se.getDefaultLength(e.dataType):e.maxLength="",Se.isPrecisionBasedType(e.dataType)?(e.precision=Se.getDefaultPrecision(e.dataType),e.scale=Se.getDefaultScale(e.dataType)):(e.precision=0,e.scale=0),Se.isTimeBasedWithScale(e.dataType)?e.scale=Se.getDefaultScale(e.dataType):e.scale=0,e),getAdvancedOptions:e=>{let t=[];return e.isPrimaryKey||t.push({label:D.schemaDesigner.allowNull,type:"checkbox",value:!1,columnProperty:"isNullable",columnModifier:(n,o)=>(n.isNullable=o,n)}),e.isComputed||(Se.isIdentityBasedType(e.dataType,e.scale)&&(!e.isNullable||e.isPrimaryKey)&&t.push({label:D.schemaDesigner.isIdentity,value:"isIdentity",type:"checkbox",columnProperty:"isIdentity",columnModifier:(n,o)=>(n.isIdentity=o,n.identitySeed=o?1:0,n.identityIncrement=o?1:0,n)}),Se.isLengthBasedType(e.dataType)&&t.push({label:D.schemaDesigner.maxLength,value:"",type:"input",columnProperty:"maxLength",columnModifier:(n,o)=>(n.maxLength=o,n.maxLength||(n.maxLength="0"),n)}),Se.isPrecisionBasedType(e.dataType)&&t.push({label:D.schemaDesigner.precision,value:"",type:"input-number",columnProperty:"precision",columnModifier:(n,o)=>(n.precision=o,n)}),(Se.isTimeBasedWithScale(e.dataType)||Se.isPrecisionBasedType(e.dataType))&&t.push({label:D.schemaDesigner.scale,value:"",type:"input-number",columnProperty:"scale",columnModifier:(n,o)=>(n.scale=o,n)}),t.push({label:D.schemaDesigner.defaultValue,value:"",type:"textarea",columnProperty:"defaultValue",columnModifier:(n,o)=>(n.defaultValue=o,n)})),t.push({label:D.schemaDesigner.isComputed,value:!1,type:"checkbox",columnProperty:"isComputed",columnModifier:(n,o)=>(n.isComputed=o,n.isPrimaryKey=!1,n.isIdentity=!1,n.identitySeed=0,n.identityIncrement=0,n.isNullable=!0,n.computedFormula=o?"1":"",n.computedPersisted=!1,n.dataType=o?"int":n.dataType,n)}),e.isComputed&&(t.push({label:D.schemaDesigner.computedFormula,value:"",type:"textarea",columnProperty:"computedFormula",columnModifier:(n,o)=>(n.computedFormula=o,n)}),t.push({label:D.schemaDesigner.isPersisted,value:!1,type:"checkbox",columnProperty:"computedPersisted",columnModifier:(n,o)=>(n.computedPersisted=o,n)})),t}},ue={areDataTypesCompatible:(e,t)=>e.dataType!==t.dataType?{isValid:!1,errorMessage:D.schemaDesigner.incompatibleDataTypes(e.dataType,e.name,t.dataType,t.name)}:Se.isLengthBasedType(e.dataType)&&e.maxLength!==t.maxLength?{isValid:!1,errorMessage:D.schemaDesigner.incompatibleLength(e.name,t.name,e.maxLength,t.maxLength)}:Se.isPrecisionBasedType(e.dataType)&&(e.precision!==t.precision||e.scale!==t.scale)?{isValid:!1,errorMessage:D.schemaDesigner.incompatiblePrecisionOrScale(e.name,t.name)}:Se.isTimeBasedWithScale(e.dataType)&&e.scale!==t.scale?{isValid:!1,errorMessage:D.schemaDesigner.incompatibleScale(e.name,t.name)}:{isValid:!0},isCyclicForeignKey:(e,t,n,o=new Set)=>{if(!t||!n||t.id===n.id&&o.size===0)return!1;if(o.has(t.id))return!0;o.add(t.id);for(let r of t.foreignKeys){let i=e.find(s=>s.name===r.referencedTableName&&s.schema===r.referencedSchemaName);if(i&&(i.id===n.id||ue.isCyclicForeignKey(e,i,n,new Set(o))))return!0}return!1},isForeignKeyValid:(e,t,n)=>{let o=e.find(s=>s.name===n.referencedTableName&&s.schema===n.referencedSchemaName);if(!o)return{isValid:!1,errorMessage:D.schemaDesigner.referencedTableNotFound(n.referencedTableName)};let r=t.foreignKeys.filter(s=>s.id!==n.id),i=new Set;for(let s of r)for(let a of s.columns)i.add(a);for(let s of n.columns){if(i.has(s))return{isValid:!1,errorMessage:D.schemaDesigner.duplicateForeignKeyColumns(s)};i.add(s)}for(let s=0;s<n.columns.length;s++){let a=t.columns.find(d=>d.name===n.columns[s]),l=o.columns.find(d=>d.name===n.referencedColumns[s]);if(!a)return{isValid:!1,errorMessage:D.schemaDesigner.columnNotFound(n.columns[s])};if(!l)return{isValid:!1,errorMessage:D.schemaDesigner.referencedColumnNotFound(n.referencedColumns[s])};let c=ue.areDataTypesCompatible(a,l);if(!c.isValid)return c;if(!l.isPrimaryKey)return{isValid:!1,errorMessage:D.schemaDesigner.referencedColumnNotPK(l.name)};if(a.isIdentity&&(n.onUpdateAction!==de.OnAction.NO_ACTION||n.onDeleteAction!==de.OnAction.NO_ACTION))return{isValid:!1,errorMessage:D.schemaDesigner.identityColumnFKConstraint(a.name)}}return{isValid:!0}},getForeignKeyWarnings:(e,t,n)=>{let o=!1,r=[],i=e.find(s=>s.name===n.referencedTableName&&s.schema===n.referencedSchemaName);return i?(n.name||(o=!0,r.push(D.schemaDesigner.foreignKeyNameEmptyWarning)),ue.isCyclicForeignKey(e,i,t)&&(o=!0,r.push(D.schemaDesigner.cyclicForeignKeyDetected(t.name,i.name))),{isValid:!o,errorMessage:o?r.join(", "):void 0}):{isValid:!1,errorMessage:D.schemaDesigner.referencedTableNotFound(n.referencedTableName)}},extractForeignKeysFromEdges:(e,t,n)=>{let o=e.filter(i=>i.source===t),r=new Map;return o.forEach(i=>{let s=n.tables.find(c=>c.id===i.source),a=n.tables.find(c=>c.id===i.target);if(!s||!a||!i.data)return;let l={id:i.data.id,columns:[...i.data.columns],name:i.data.name,onDeleteAction:i.data.onDeleteAction,onUpdateAction:i.data.onUpdateAction,referencedColumns:[...i.data.referencedColumns],referencedSchemaName:i.data.referencedSchemaName,referencedTableName:i.data.referencedTableName};if(r.has(i.data.id)){let c=r.get(i.data.id);c&&(c.columns.push(...l.columns),c.referencedColumns.push(...l.referencedColumns))}else r.set(i.data.id,l)}),Array.from(r.values())},extractColumnNameFromHandle:e=>e.replace("left-","").replace("right-",""),createForeignKeyFromConnection:(e,t,n,o,r,i)=>({id:r||ut(),name:i||`FK_${e.data.name}_${t.data.name}`,columns:[n],referencedSchemaName:t.data.schema,referencedTableName:t.data.name,referencedColumns:[o],onDeleteAction:de.OnAction.NO_ACTION,onUpdateAction:de.OnAction.NO_ACTION}),validateConnection:(e,t,n)=>{let o=t.find(l=>l.id===e.source),r=t.find(l=>l.id===e.target);if(!o||!r)return{isValid:!1,errorMessage:"Source or target table not found"};let i=e.sourceHandle?ue.extractColumnNameFromHandle(e.sourceHandle):"",s=e.targetHandle?ue.extractColumnNameFromHandle(e.targetHandle):"";if(!i||!s)return{isValid:!1,errorMessage:"Source or target column not found"};let a=ue.createForeignKeyFromConnection(o,r,i,s);return ue.isForeignKeyValid(pe.extractSchemaModel(t,n).tables,o.data,a)},getOnActionOptions:()=>[{label:D.schemaDesigner.cascade,value:de.OnAction.CASCADE},{label:D.schemaDesigner.noAction,value:de.OnAction.NO_ACTION},{label:D.schemaDesigner.setNull,value:de.OnAction.SET_NULL},{label:D.schemaDesigner.setDefault,value:de.OnAction.SET_DEFAULT}],convertStringToOnAction:e=>{switch(e){case D.schemaDesigner.cascade:return de.OnAction.CASCADE;case D.schemaDesigner.noAction:return de.OnAction.NO_ACTION;case D.schemaDesigner.setNull:return de.OnAction.SET_NULL;case D.schemaDesigner.setDefault:return de.OnAction.SET_DEFAULT;default:return de.OnAction.NO_ACTION}},convertOnActionToString:e=>{switch(e){case de.OnAction.CASCADE:return D.schemaDesigner.cascade;case de.OnAction.NO_ACTION:return D.schemaDesigner.noAction;case de.OnAction.SET_NULL:return D.schemaDesigner.setNull;case de.OnAction.SET_DEFAULT:return D.schemaDesigner.setDefault;default:return D.schemaDesigner.noAction}}},Pt={NODE_WIDTH:300,NODE_MARGIN:50,BASE_NODE_HEIGHT:70,COLUMN_HEIGHT:30,LAYOUT_OPTIONS:{rankdir:"LR",marginx:50,marginy:50,nodesep:50,ranksep:50}},pe={getTableWidth:()=>Pt.NODE_WIDTH+Pt.NODE_MARGIN,getTableHeight:e=>Pt.BASE_NODE_HEIGHT+e.columns.length*Pt.COLUMN_HEIGHT,generatePositions:(e,t)=>{let n=new So.default.graphlib.Graph().setDefaultEdgeLabel(()=>({}));n.setGraph(Pt.LAYOUT_OPTIONS);for(let r of e)r.hidden||n.setNode(r.id,{width:pe.getTableWidth(),height:pe.getTableHeight(r.data)});for(let r of t){if(r.hidden)continue;let i=e.find(a=>a.id===r.source),s=e.find(a=>a.id===r.target);!i?.hidden&&!s?.hidden&&n.setEdge(r.source,r.target)}return So.default.layout(n),{nodes:e.map(r=>{if(r.hidden)return r;let i=n.node(r.id);return{...r,position:{x:i.x-pe.getTableWidth()/2,y:i.y-pe.getTableHeight(r.data)/2}}}),edges:t}},generateSchemaDesignerFlowComponents:e=>{if(!e)return{nodes:[],edges:[]};let t=new So.default.graphlib.Graph().setDefaultEdgeLabel(()=>({}));t.setGraph(Pt.LAYOUT_OPTIONS);let n=e.tables.map(i=>({id:i.id,type:"tableNode",data:{...i}}));n.forEach(i=>{t.setNode(i.id,{width:pe.getTableWidth(),height:pe.getTableHeight(i.data)}),i.data.foreignKeys.forEach(s=>{let a=e.tables.find(l=>l.name===s.referencedTableName&&l.schema===s.referencedSchemaName);a&&t.setEdge(i.id,a.id)})}),So.default.layout(t);let o=n.map(i=>{let s=t.node(i.id);return{...i,position:{x:s.x-pe.getTableWidth()/2,y:s.y-pe.getTableHeight(i.data)/2}}}),r=[];for(let i of e.tables)for(let s of i.foreignKeys){let a=e.tables.find(l=>l.name===s.referencedTableName&&l.schema===s.referencedSchemaName);a&&s.columns.forEach((l,c)=>{let d=s.referencedColumns[c];r.push({id:`${i.name}-${a.name}-${l}-${d}`,source:i.id,target:a.id,sourceHandle:`right-${l}`,targetHandle:`left-${d}`,markerEnd:{type:je.ArrowClosed},data:{name:s.name,id:s.id,columns:[l],referencedSchemaName:s.referencedSchemaName,referencedTableName:s.referencedTableName,referencedColumns:[d],onDeleteAction:s.onDeleteAction,onUpdateAction:s.onUpdateAction},type:i.id===a.id?He.SmoothStep:void 0})})}return{nodes:o,edges:r}},extractSchemaModel:(e,t)=>{let n=e.map(o=>({...o.data,foreignKeys:[]}));return t.forEach(o=>{let r=e.find(c=>c.id===o.source),i=e.find(c=>c.id===o.target);if(!r||!i||!o.data){console.warn(`Edge ${o.id} references non-existent nodes or has no data`);return}let s={id:o.data.id,name:o.data.name,columns:[...o.data.columns],referencedSchemaName:o.data.referencedSchemaName,referencedTableName:o.data.referencedTableName,referencedColumns:[...o.data.referencedColumns],onDeleteAction:o.data.onDeleteAction,onUpdateAction:o.data.onUpdateAction},a=n.find(c=>c.id===o.source);if(!a){console.warn(`Source table ${o.source} not found`);return}let l=a.foreignKeys.find(c=>c.id===s.id);l?(l.columns.push(s.columns[0]),l.referencedColumns.push(s.referencedColumns[0])):a.foreignKeys.push(s)}),{tables:n}}};var Zr=class{listeners={};on(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)}off(t,n){this.listeners[t]=this.listeners[t]?.filter(o=>o!==n)}emit(t,...n){this.listeners[t]?.forEach(o=>o(...n))}once(t,n){let o=(...r)=>{this.off(t,o),n(...r)};this.on(t,o)}};var ZE=new Zr,ne=ZE;var jr=class{undoStack=[];redoStack=[];maxSize;currentState=null;constructor(t=100){this.maxSize=t}getCurrentState(){return this.currentState}setInitialState(t){this.currentState=t,this.clearHistory()}pushState(t,n){let o=this.currentState;JSON.stringify(o)!==JSON.stringify(t)&&(this.undoStack.push({undo:n||(()=>o),redo:()=>t}),this.currentState=t,this.redoStack=[],this.undoStack.length>this.maxSize&&this.undoStack.shift())}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){if(!this.canUndo())return null;let t=this.undoStack.pop(),n=t.undo(),o=this.currentState;return this.redoStack.push({undo:()=>o,redo:t.redo}),this.currentState=n,n}redo(){if(!this.canRedo())return null;let n=this.redoStack.pop().redo(),o=this.currentState;return this.undoStack.push({undo:()=>o,redo:()=>n}),this.currentState=n,n}clearHistory(){this.undoStack=[],this.redoStack=[]}getStackSizes(){return{undoSize:this.undoStack.length,redoSize:this.redoStack.length}}};var wp=K(ee()),fe=(0,lt.createContext)(void 0),Fe=new jr,xp=({children:e})=>{let t=Ga(),{state:n,extensionRpc:o,themeKind:r,keyBindings:i}=t,[s,a]=(0,lt.useState)([]),[l,c]=(0,lt.useState)([]),d=qe(),[u,f]=(0,lt.useState)(!1),[h,p]=(0,lt.useState)(""),[g,v]=(0,lt.useState)(!0),[m,b]=(0,lt.useState)(!1);(0,lt.useEffect)(()=>{let F=()=>{setTimeout(()=>{let U=d.toObject();Fe.pushState(U),ne.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo())},100)};ne.on("pushState",F);let H=()=>{if(!Fe.canUndo())return;let U=Fe.undo();U&&(d.setNodes(U.nodes),d.setEdges(U.edges),ne.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo()))};ne.on("undo",H);let W=()=>{if(!Fe.canRedo())return;let U=Fe.redo();U&&(d.setNodes(U.nodes),d.setEdges(U.edges),ne.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo()))};return ne.on("redo",W),()=>{ne.off("pushState",F),ne.off("undo",H),ne.off("redo",W)}},[]);let y=async()=>{let F=await o.sendRequest(de.InitializeSchemaDesignerRequest.type),{nodes:H,edges:W}=pe.generateSchemaDesignerFlowComponents(F.schema);return a(F.dataTypes),c(F.schemaNames),f(!0),setTimeout(()=>{Fe.setInitialState(d.toObject())}),{nodes:H,edges:W}},x=async()=>{let F=pe.extractSchemaModel(d.getNodes(),d.getEdges());return(await o.sendRequest(de.GetDefinitionRequest.type,{updatedSchema:F})).script},E=F=>{o.sendNotification(de.ExportToFileNotification.type,F)},C=async()=>{let F=pe.extractSchemaModel(d.getNodes(),d.getEdges());return F?await o.sendRequest(de.GetReportWebviewRequest.type,{updatedSchema:F}):void 0},N=F=>{o.sendNotification(de.CopyToClipboardNotification.type,{text:F})},M=()=>{o.sendNotification(de.OpenInEditorNotification.type)},R=()=>{o.sendNotification(de.OpenInEditorWithConnectionNotification.type)},L=()=>pe.extractSchemaModel(d.getNodes(),d.getEdges()),$=async F=>{let H=d.getNodes(),W=d.getEdges(),U=pe.extractSchemaModel(H,W);U.tables.push(F);let Y=pe.generateSchemaDesignerFlowComponents(U),q=Y.nodes.find(se=>se.id===F.id);if(!q)return console.error("Node with position not found for table:",F),!1;let Z=Y.edges.filter(se=>se.source===F.id||se.target===F.id),re=H.filter(se=>se.hidden!==!0);if(re.length===0)q.position={x:100,y:100};else{let se=re.filter(ae=>ae.hidden!==!0).reduce((ae,Q)=>{let le=Q.position.y+pe.getTableHeight(Q.data),me=ae.position.y+pe.getTableHeight(ae.data);return le>me?Q:ae});q.position={x:se.position.x,y:se.position.y+pe.getTableHeight(se.data)+50}}return q?(H.push(q),W.push(...Z),d.setNodes(H),d.setEdges(W),requestAnimationFrame(async()=>{k(q.id,!0)}),ne.emit("getScript"),!0):!1},z=async F=>{let H=d.getNodes(),W=d.getEdges(),U=H.find(Y=>Y.id===F.id);return U?(W.forEach(Y=>{Y?.data?.referencedSchemaName===U?.data?.schema&&Y?.data?.referencedTableName===U?.data?.name&&(Y.data.referencedSchemaName=F.schema,Y.data.referencedTableName=F.name)}),U.data=F,W=W.filter(Y=>Y.source!==F.id),F.foreignKeys.forEach(Y=>{let q=H.find(Z=>Z.data.schema===Y.referencedSchemaName&&Z.data.name===Y.referencedTableName);q&&Y.columns.forEach((Z,re)=>{let se=Y.referencedColumns[re];W.push({id:Y.id,source:F.id,target:q.id,sourceHandle:`right-${Z}`,targetHandle:`left-${se}`,markerEnd:{type:je.ArrowClosed},data:{...Y,referencedColumns:[se],columns:[Z]}})})}),d.setNodes(H),d.setEdges(W),requestAnimationFrame(()=>{k(F.id,!0)}),!0):!1},B=async F=>{let H=d.getNode(F.id);return H?(d.deleteElements({nodes:[H]}),ne.emit("pushState"),!0):!1},w=F=>{let H=L(),W=H.tables.find(U=>U.id===F);if(W)return W.foreignKeys=ue.extractForeignKeysFromEdges(d.getEdges(),F,H),W},T=()=>{let F=d.getNodes().filter(H=>H.selected);if(F.length>0)d.deleteElements({nodes:F});else{let H=d.getEdges().filter(W=>W.selected);d.deleteElements({nodes:[],edges:H})}},S=F=>{d.getNodes().forEach(H=>{d.updateNode(H.id,{selected:F.includes(H.id)})})},k=(F,H=!1)=>{let W=d.getNode(F);W&&d.setCenter(W.position.x+pe.getTableWidth()/2,W.position.y+pe.getTableHeight(W.data)/2,{zoom:H?1:d.getZoom(),duration:500})},A=async()=>{let F=pe.extractSchemaModel(d.getNodes(),d.getEdges());return await o.sendRequest(de.PublishSessionRequest.type,{schema:F})},_=()=>{o.sendNotification(de.CloseSchemaDesignerNotification.type)},P=()=>{Fe.clearHistory(),ne.emit("updateUndoRedoState",Fe.canUndo(),Fe.canRedo())};function V(){setTimeout(async()=>{await d.fitView({nodes:d.getNodes().filter(F=>F.hidden!==!0)})},10)}return(0,wp.jsx)(fe.Provider,{value:{...Ua(t),extensionRpc:o,state:n,themeKind:r,keyBindings:i,schemaNames:l,datatypes:s,findTableText:h,setFindTableText:p,getDefinition:x,initializeSchemaDesigner:y,saveAsFile:E,getReport:C,openInEditor:M,openInEditorWithConnection:R,copyToClipboard:N,extractSchema:L,getTableWithForeignKeys:w,updateTable:z,addTable:$,deleteTable:B,deleteSelectedNodes:T,updateSelectedNodes:S,setCenter:k,publishSession:A,isInitialized:u,closeDesigner:_,resetUndoRedoState:P,resetView:V,renderOnlyVisibleTables:g,setRenderOnlyVisibleTables:v,isExporting:m,setIsExporting:b},children:e})};var ti=K(he());var Rs=K(ee());function vp(){return(0,Rs.jsx)(te,{size:"small",appearance:"subtle",icon:(0,Rs.jsx)(ya,{}),title:D.schemaDesigner.definition,onClick:()=>{ne.emit("openCodeDrawer")},children:D.schemaDesigner.definition})}function Sp(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;let n=document.implementation.createHTMLDocument(),o=n.createElement("base"),r=n.createElement("a");return n.head.appendChild(o),n.body.appendChild(r),t&&(o.href=t),r.href=e,r.href}var Ep=(()=>{let e=0,t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Ye(e){let t=[];for(let n=0,o=e.length;n<o;n++)t.push(e[n]);return t}function Qr(e,t){let o=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return o?parseFloat(o.replace("px","")):0}function jE(e){let t=Qr(e,"border-left-width"),n=Qr(e,"border-right-width");return e.clientWidth+t+n}function QE(e){let t=Qr(e,"border-top-width"),n=Qr(e,"border-bottom-width");return e.clientHeight+t+n}function Os(e,t={}){let n=t.width||jE(e),o=t.height||QE(e);return{width:n,height:o}}function Cp(){let e,t;try{t=process}catch{}let n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}var Ue=16384;function _p(e){(e.width>Ue||e.height>Ue)&&(e.width>Ue&&e.height>Ue?e.width>e.height?(e.height*=Ue/e.width,e.width=Ue):(e.width*=Ue/e.height,e.height=Ue):e.width>Ue?(e.height*=Ue/e.width,e.width=Ue):(e.width*=Ue/e.height,e.height=Ue))}function Rn(e){return new Promise((t,n)=>{let o=new Image;o.decode=()=>t(o),o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.decoding="async",o.src=e})}async function JE(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function Np(e,t,n){let o="http://www.w3.org/2000/svg",r=document.createElementNS(o,"svg"),i=document.createElementNS(o,"foreignObject");return r.setAttribute("width",`${t}`),r.setAttribute("height",`${n}`),r.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),r.appendChild(i),i.appendChild(e),JE(r)}var Pe=(e,t)=>{if(e instanceof t)return!0;let n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||Pe(n,t)};function e1(e){let t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function t1(e){return Ye(e).map(t=>{let n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return`${t}: ${n}${o?" !important":""};`}).join(" ")}function n1(e,t,n){let o=`.${e}:${t}`,r=n.cssText?e1(n):t1(n);return document.createTextNode(`${o}{${r}}`)}function Tp(e,t,n){let o=window.getComputedStyle(e,n),r=o.getPropertyValue("content");if(r===""||r==="none")return;let i=Ep();try{t.className=`${t.className} ${i}`}catch{return}let s=document.createElement("style");s.appendChild(n1(i,n,o)),t.appendChild(s)}function kp(e,t){Tp(e,t,":before"),Tp(e,t,":after")}var Dp="application/font-woff",Ip="image/jpeg",o1={woff:Dp,woff2:Dp,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Ip,jpeg:Ip,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function r1(e){let t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function On(e){let t=r1(e).toLowerCase();return o1[t]||""}function i1(e){return e.split(/,/)[1]}function Eo(e){return e.search(/^(data:)/)!==-1}function As(e,t){return`data:${t};base64,${e}`}async function Ls(e,t,n){let o=await fetch(e,t);if(o.status===404)throw new Error(`Resource "${o.url}" not found`);let r=await o.blob();return new Promise((i,s)=>{let a=new FileReader;a.onerror=s,a.onloadend=()=>{try{i(n({res:o,result:a.result}))}catch(l){s(l)}},a.readAsDataURL(r)})}var Ps={};function s1(e,t,n){let o=e.replace(/\?.*/,"");return n&&(o=e),/ttf|otf|eot|woff2?/i.test(o)&&(o=o.replace(/.*\//,"")),t?`[${t}]${o}`:o}async function Pn(e,t,n){let o=s1(e,t,n.includeQueryParams);if(Ps[o]!=null)return Ps[o];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let r;try{let i=await Ls(e,n.fetchRequestInit,({res:s,result:a})=>(t||(t=s.headers.get("Content-Type")||""),i1(a)));r=As(i,t)}catch(i){r=n.imagePlaceholder||"";let s=`Failed to fetch resource: ${e}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return Ps[o]=r,r}async function a1(e){let t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Rn(t)}async function l1(e,t){if(e.currentSrc){let i=document.createElement("canvas"),s=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,s?.drawImage(e,0,0,i.width,i.height);let a=i.toDataURL();return Rn(a)}let n=e.poster,o=On(n),r=await Pn(n,o,t);return Rn(r)}async function c1(e){var t;try{if(!((t=e?.contentDocument)===null||t===void 0)&&t.body)return await Co(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function d1(e,t){return Pe(e,HTMLCanvasElement)?a1(e):Pe(e,HTMLVideoElement)?l1(e,t):Pe(e,HTMLIFrameElement)?c1(e):e.cloneNode(!1)}var u1=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function f1(e,t,n){var o,r;let i=[];return u1(e)&&e.assignedNodes?i=Ye(e.assignedNodes()):Pe(e,HTMLIFrameElement)&&(!((o=e.contentDocument)===null||o===void 0)&&o.body)?i=Ye(e.contentDocument.body.childNodes):i=Ye(((r=e.shadowRoot)!==null&&r!==void 0?r:e).childNodes),i.length===0||Pe(e,HTMLVideoElement)||await i.reduce((s,a)=>s.then(()=>Co(a,n)).then(l=>{l&&t.appendChild(l)}),Promise.resolve()),t}function h1(e,t){let n=t.style;if(!n)return;let o=window.getComputedStyle(e);o.cssText?(n.cssText=o.cssText,n.transformOrigin=o.transformOrigin):Ye(o).forEach(r=>{let i=o.getPropertyValue(r);r==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),Pe(e,HTMLIFrameElement)&&r==="display"&&i==="inline"&&(i="block"),r==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(r,i,o.getPropertyPriority(r))})}function p1(e,t){Pe(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Pe(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function m1(e,t){if(Pe(e,HTMLSelectElement)){let n=t,o=Array.from(n.children).find(r=>e.value===r.getAttribute("value"));o&&o.setAttribute("selected","")}}function g1(e,t){return Pe(t,Element)&&(h1(e,t),kp(e,t),p1(e,t),m1(e,t)),t}async function y1(e,t){let n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;let o={};for(let i=0;i<n.length;i++){let a=n[i].getAttribute("xlink:href");if(a){let l=e.querySelector(a),c=document.querySelector(a);!l&&c&&!o[a]&&(o[a]=await Co(c,t,!0))}}let r=Object.values(o);if(r.length){let i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";let a=document.createElementNS(i,"defs");s.appendChild(a);for(let l=0;l<r.length;l++)a.appendChild(r[l]);e.appendChild(s)}return e}async function Co(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(o=>d1(o,t)).then(o=>f1(e,o,t)).then(o=>g1(e,o)).then(o=>y1(o,t))}var Mp=/url\((['"]?)([^'"]+?)\1\)/g,b1=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,x1=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function w1(e){let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function v1(e){let t=[];return e.replace(Mp,(n,o,r)=>(t.push(r),n)),t.filter(n=>!Eo(n))}async function S1(e,t,n,o,r){try{let i=n?Sp(t,n):t,s=On(t),a;if(r){let l=await r(i);a=As(l,s)}else a=await Pn(i,s,o);return e.replace(w1(t),`$1${a}$3`)}catch{}return e}function E1(e,{preferredFontFormat:t}){return t?e.replace(x1,n=>{for(;;){let[o,,r]=b1.exec(n)||[];if(!r)return"";if(r===t)return`src: ${o};`}}):e}function Fs(e){return e.search(Mp)!==-1}async function Jr(e,t,n){if(!Fs(e))return e;let o=E1(e,n);return v1(o).reduce((i,s)=>i.then(a=>S1(a,s,t,n)),Promise.resolve(o))}async function ei(e,t,n){var o;let r=(o=t.style)===null||o===void 0?void 0:o.getPropertyValue(e);if(r){let i=await Jr(r,null,n);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function C1(e,t){await ei("background",e,t)||await ei("background-image",e,t),await ei("mask",e,t)||await ei("mask-image",e,t)}async function _1(e,t){let n=Pe(e,HTMLImageElement);if(!(n&&!Eo(e.src))&&!(Pe(e,SVGImageElement)&&!Eo(e.href.baseVal)))return;let o=n?e.src:e.href.baseVal,r=await Pn(o,On(o),t);await new Promise((i,s)=>{e.onload=i,e.onerror=s;let a=e;a.decode&&(a.decode=i),a.loading==="lazy"&&(a.loading="eager"),n?(e.srcset="",e.src=r):e.href.baseVal=r})}async function N1(e,t){let o=Ye(e.childNodes).map(r=>zs(r,t));await Promise.all(o).then(()=>e)}async function zs(e,t){Pe(e,Element)&&(await C1(e,t),await _1(e,t),await N1(e,t))}function Rp(e,t){let{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);let o=t.style;return o!=null&&Object.keys(o).forEach(r=>{n[r]=o[r]}),e}var Op={};async function Pp(e){let t=Op[e];if(t!=null)return t;let o=await(await fetch(e)).text();return t={url:e,cssText:o},Op[e]=t,t}async function Ap(e,t){let n=e.cssText,o=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async s=>{let a=s.replace(o,"$1");return a.startsWith("https://")||(a=new URL(a,e.url).href),Ls(a,t.fetchRequestInit,({result:l})=>(n=n.replace(s,`url(${l})`),[s,l]))});return Promise.all(i).then(()=>n)}function Lp(e){if(e==null)return[];let t=[],n=/(\/\*[\s\S]*?\*\/)/gi,o=e.replace(n,""),r=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let l=r.exec(o);if(l===null)break;t.push(l[0])}o=o.replace(r,"");let i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(s,"gi");for(;;){let l=i.exec(o);if(l===null){if(l=a.exec(o),l===null)break;i.lastIndex=a.lastIndex}else a.lastIndex=i.lastIndex;t.push(l[0])}return t}async function T1(e,t){let n=[],o=[];return e.forEach(r=>{if("cssRules"in r)try{Ye(r.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let a=s+1,l=i.href,c=Pp(l).then(d=>Ap(d,t)).then(d=>Lp(d).forEach(u=>{try{r.insertRule(u,u.startsWith("@import")?a+=1:r.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:u,error:f})}})).catch(d=>{console.error("Error loading remote css",d.toString())});o.push(c)}})}catch(i){let s=e.find(a=>a.href==null)||document.styleSheets[0];r.href!=null&&o.push(Pp(r.href).then(a=>Ap(a,t)).then(a=>Lp(a).forEach(l=>{s.insertRule(l,r.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",i)}}),Promise.all(o).then(()=>(e.forEach(r=>{if("cssRules"in r)try{Ye(r.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${r.href}`,i)}}),n))}function k1(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Fs(t.style.getPropertyValue("src")))}async function D1(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");let n=Ye(e.ownerDocument.styleSheets),o=await T1(n,t);return k1(o)}async function Fp(e,t){let n=await D1(e,t);return(await Promise.all(n.map(r=>{let i=r.parentStyleSheet?r.parentStyleSheet.href:null;return Jr(r.cssText,i,t)}))).join(`
`)}async function zp(e,t){let n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Fp(e,t);if(n){let o=document.createElement("style"),r=document.createTextNode(n);o.appendChild(r),e.firstChild?e.insertBefore(o,e.firstChild):e.appendChild(o)}}async function Bs(e,t={}){let{width:n,height:o}=Os(e,t),r=await Co(e,t,!0);return await zp(r,t),await zs(r,t),Rp(r,t),await Np(r,n,o)}async function Bp(e,t={}){let{width:n,height:o}=Os(e,t),r=await Bs(e,t),i=await Rn(r),s=document.createElement("canvas"),a=s.getContext("2d"),l=t.pixelRatio||Cp(),c=t.canvasWidth||n,d=t.canvasHeight||o;return s.width=c*l,s.height=d*l,t.skipAutoScale||_p(s),s.style.width=`${c}`,s.style.height=`${d}`,t.backgroundColor&&(a.fillStyle=t.backgroundColor,a.fillRect(0,0,s.width,s.height)),a.drawImage(i,0,0,s.width,s.height),s}async function $p(e,t={}){return(await Bp(e,t)).toDataURL()}async function Hp(e,t={}){return(await Bp(e,t)).toDataURL("image/jpeg",t.quality||1)}var Vp=K(he()),ct=K(ee());function Wp(){let{getNodes:e}=qe(),t=(0,Vp.useContext)(fe);async function n(o){let r=document.querySelector(".react-flow__viewport"),s=getComputedStyle(r).getPropertyValue("--vscode-editor-background");if(!t)return;t.setRenderOnlyVisibleTables(!1),t.setIsExporting(!0),await new Promise(u=>setTimeout(u,100));let a=fo(e().filter(u=>!u.hidden)),l=en(a,a.width,a.height,.5,2,50),c=a.width+100,d=a.height+100;switch(o){case"png":$p(r,{width:c,height:d,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${d}px`}}).then(u=>{t.saveAsFile({format:o,fileContents:u,width:c,height:d})});break;case"jpeg":Hp(r,{width:c,height:d,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${d}px`}}).then(u=>{t.saveAsFile({format:o,fileContents:u,width:c,height:d})});break;case"svg":Bs(r,{width:c,height:d,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${d}px`}}).then(u=>{t.saveAsFile({format:o,fileContents:u,width:c,height:d})});break}t.setRenderOnlyVisibleTables(!0),t.setIsExporting(!1)}return(0,ct.jsxs)(an,{children:[(0,ct.jsx)(cn,{disableButtonEnhancement:!0,children:(0,ct.jsx)(te,{size:"small",appearance:"subtle",icon:(0,ct.jsx)(ha,{}),title:D.schemaDesigner.export,children:D.schemaDesigner.export})}),(0,ct.jsx)(ln,{children:(0,ct.jsxs)(Po,{children:[(0,ct.jsx)($t,{onClick:()=>n("svg"),children:D.schemaDesigner.svg}),(0,ct.jsx)($t,{onClick:()=>n("png"),children:D.schemaDesigner.png}),(0,ct.jsx)($t,{onClick:()=>n("jpeg"),children:D.schemaDesigner.jpeg})]})})]})}var bt=K(he());var we=K(ee());function Kp(){let e=(0,bt.useContext)(fe),t=qe();if(!e)return;let[n,o]=(0,bt.useState)(""),[r,i]=(0,bt.useState)([]),[s,a]=(0,bt.useState)(!1),[l,c]=(0,bt.useState)(!1);function d(){let p=t.getNodes();if(p.filter(v=>v.hidden!==!0).length===p.length)i([]);else{let v=p.filter(m=>!m.hidden&&m.data.dimmed!==!0).map(m=>`${m.data.schema}.${m.data.name}`);i(v)}o("")}function u(p){if(!l||p.length===0)return[];let g=t.getEdges(),v=t.getNodes(),m=new Set;return g.forEach(b=>{let y=v.find(E=>E.id===b.source),x=v.find(E=>E.id===b.target);if(y&&x){let E=`${y.data.schema}.${y.data.name}`,C=`${x.data.schema}.${x.data.name}`;p.includes(E)&&m.add(C),p.includes(C)&&m.add(E)}}),Array.from(m)}(0,bt.useEffect)(()=>{let p=t.getNodes(),g=t.getEdges();if(r.length===0)p.forEach(v=>{t.updateNode(v.id,{...v,hidden:!1,style:{...v.style,opacity:1},data:{...v.data,dimmed:!1}})}),g.forEach(v=>{t.updateEdge(v.id,{...v,hidden:!1})});else{let v=u(r),m=[...r,...v];p.forEach(b=>{let y=`${b.data.schema}.${b.data.name}`;if(m.includes(y)){let x=r.includes(y),E=v.includes(y),C=!x&&E;t.updateNode(b.id,{...b,hidden:!1,data:{...b.data,dimmed:C}})}else t.updateNode(b.id,{...b,hidden:!0,data:{...b.data,dimmed:!1}})}),g.forEach(b=>{let y=t.getNode(b.source),x=t.getNode(b.target);y&&x&&m.includes(`${y.data.schema}.${y.data.name}`)&&m.includes(`${x.data.schema}.${x.data.name}`)?t.updateEdge(b.id,{...b,hidden:!1}):t.updateEdge(b.id,{...b,hidden:!0})})}},[r,l]),(0,bt.useEffect)(()=>{ne.on("getScript",()=>requestAnimationFrame(()=>{d()}))},[]);let f=(p,g)=>{if(!g||g.trim()==="")return(0,we.jsx)("span",{children:p});let v=new RegExp(`(${g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),m=p.split(v);return(0,we.jsx)(we.Fragment,{children:m.map((b,y)=>b.toLowerCase()===g.toLowerCase()?(0,we.jsx)("span",{style:{backgroundColor:"var(--vscode-editor-findMatchBackground)",color:"var(--vscode-editor-background)",padding:"0 2px",borderRadius:"3px"},children:b},y):(0,we.jsx)("span",{children:b},y))})};function h(){let g=t.getNodes().map(m=>`${m.data.schema}.${m.data.name}`);g.sort();let v=[];return g.forEach(m=>{let b=(0,we.jsx)(qa,{style:{lineHeight:"30px",alignItems:"center",padding:"2px",overflow:"hidden"},value:m,children:(0,we.jsx)(_e,{title:m,style:{overflow:"hidden",textOverflow:"ellipsis"},children:f(m,n)})},m);n?m.toLowerCase().includes(n.toLowerCase())&&v.push(b):v.push(b)}),v}return(0,we.jsxs)(an,{open:s,onOpenChange:(p,g)=>a(g.open),children:[(0,we.jsx)(cn,{children:(0,we.jsx)(te,{size:"small",appearance:"subtle",icon:(0,we.jsx)(Sa,{}),onClick:()=>{d(),a(!s)},children:D.schemaDesigner.filter(r.length)})}),(0,we.jsxs)(ln,{style:{width:"250px",padding:"10px"},onKeyDown:p=>{p.key==="Escape"&&a(!1)},children:[(0,we.jsx)(Ko,{size:"small",placeholder:D.schemaDesigner.searchTables,style:{marginBottom:"10px",width:"100%"},value:n,onChange:(p,g)=>{o(g.value)},onAbort:()=>{o("")}}),(0,we.jsx)(Ka,{selectionMode:"multiselect",style:{maxHeight:"150px",overflowY:"auto",padding:"5px"},selectedItems:r,onSelectionChange:(p,g)=>{i(g.selectedItems),e&&e.resetView()},children:h()}),(0,we.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"5px",justifyContent:"flex-end",padding:"5px",borderTop:"1px solid var(--vscode-editorWidget-border)",borderBottom:"1px solid var(--vscode-editorWidget-border)"},children:(0,we.jsx)(te,{size:"small",style:{},onClick:async()=>{i([]),e&&e.resetView()},appearance:"subtle",icon:(0,we.jsx)(ra,{}),children:D.schemaDesigner.clearFilter})}),(0,we.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"5px",alignItems:"center",paddingTop:"5px"},children:(0,we.jsx)(ka,{checked:l,label:D.schemaDesigner.showTableRelationships,onChange:()=>c(!l)})})]})]})}var qp=K(he());var $s=K(ee());function Up(){let e=(0,qp.useContext)(fe);if(e)return(0,$s.jsx)(te,{appearance:"subtle",icon:(0,$s.jsx)(Ca,{}),onClick:()=>{ne.emit("newTable",e.extractSchema())},size:"small",title:D.schemaDesigner.addTable,children:D.schemaDesigner.addTable})}var An=K(he());var ie=K(ee());var M1=Oe({errorSection:{marginBottom:"15px",lineHeight:1.5},sectionNumber:{fontWeight:"bold",marginRight:"5px"},surface:{width:"800px",maxWidth:"800px"}});function Yp(){let e=M1(),t=Xa(),n=(0,An.useContext)(fe),[o,r]=(0,An.useState)(!1),[i,s]=(0,An.useState)(!1);if(!n)return;let[a,l]=(0,An.useState)({report:void 0,reportError:void 0,isConfirmationChecked:!1,reportTab:"report",publishError:void 0,currentStage:"notStarted"}),c=()=>(0,ie.jsx)(te,{size:"small",appearance:"subtle",icon:(0,ie.jsx)(ba,{}),title:D.schemaDesigner.publishChanges,disabled:i,onClick:async()=>{l({...a,currentStage:"reportLoading",reportError:void 0,isConfirmationChecked:!1}),s(!0);let b=await n.getReport();b?.error?l({...a,currentStage:"reportError",reportError:b.error}):b?.report.hasSchemaChanged?l({...a,currentStage:"reportSuccessWithChanges",reportError:void 0,report:b.report,isConfirmationChecked:!1}):l({...a,currentStage:"reportSuccessNoChanges",reportError:void 0,report:b?.report}),r(!0),s(!1)},children:D.schemaDesigner.publishChanges}),d=b=>(0,ie.jsx)(Ao,{size:"large",style:{marginBottom:"10px",marginTop:"10px"},label:b,labelPosition:"below"}),u=b=>(0,ie.jsxs)("div",{className:"error-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ie.jsx)(sa,{style:{marginRight:"10px",width:"50px",height:"50px"}}),(0,ie.jsx)("div",{className:"error-body",children:(x=>{let E=x.split(/(\d+\.\s)/g),C=[];for(let N=0;N<E.length;N++)if(E[N].match(/^\d+\.\s$/)){let M=E[N],R=E[N+1]||"";C.push((0,ie.jsxs)("div",{className:e.errorSection,children:[(0,ie.jsx)("strong",{className:e.sectionNumber,children:M}),(0,ie.jsx)("span",{children:R})]},N)),N++}else E[N].trim()&&C.push((0,ie.jsx)("div",{className:e.errorSection,children:(0,ie.jsx)("span",{children:E[N]})},N));return C})(b)})]}),f=()=>(0,ie.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ie.jsx)(ta,{style:{marginRight:"10px",width:"50px",height:"50px"}}),D.schemaDesigner.changesPublishedSuccessfully]}),h=()=>(0,ie.jsx)(ie.Fragment,{children:(0,ie.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[a.report?.dacReport?.possibleDataLoss&&(0,ie.jsx)(yn,{intent:"warning",style:{marginBottom:"10px",marginTop:"10px"},children:D.schemaDesigner.possibleDataLoss}),a.report?.dacReport?.hasWarnings&&(0,ie.jsx)(yn,{intent:"warning",style:{marginBottom:"10px",marginTop:"10px"},children:D.schemaDesigner.hasWarnings}),(0,ie.jsx)("div",{style:{width:"100%",height:"500px",maxHeight:"100%",overflow:"auto"},children:(0,ie.jsx)("div",{className:t.markdownPage,children:(0,ie.jsx)(Za,{children:a?.report?.dacReport?.report??""})})}),(0,ie.jsx)(Hn,{label:D.tableDesigner.designerPreviewConfirmation,style:{margin:"5px"},required:!0,checked:a.isConfirmationChecked,onChange:(b,y)=>{l({...a,isConfirmationChecked:y.checked})},autoFocus:!0,onFocus:b=>{b.target.parentElement&&(b.target.parentElement.style.outlineStyle="solid",b.target.parentElement.style.outlineColor="var(--vscode-focusBorder)")},onBlur:b=>{b.target.parentElement&&(b.target.parentElement.style.outline="none",b.target.parentElement.style.outlineColor="")}})]})}),p=()=>{if(a.currentStage==="reportLoading")return d(D.schemaDesigner.generatingReport);if(a.currentStage==="reportError")return u(a.reportError??"");if(a.currentStage==="reportSuccessNoChanges")return(0,ie.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ie.jsx)(ea,{style:{marginRight:"10px",width:"50px",height:"50px"}}),D.schemaDesigner.noChangesDetected]});if(a.currentStage==="reportSuccessWithChanges")return h();if(a.currentStage==="publishLoading")return d(D.schemaDesigner.publishingChanges);if(a.currentStage==="publishError")return u(a.publishError??"");if(a.currentStage==="publishSuccess")return f()},g=()=>a.currentStage==="reportSuccessWithChanges",v=()=>a.currentStage==="reportSuccessWithChanges"&&a.isConfirmationChecked,m=()=>(0,ie.jsxs)(ie.Fragment,{children:[g()&&(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsx)(te,{appearance:"primary",disabled:!v(),onClick:async()=>{l({...a,currentStage:"publishLoading",publishError:void 0});let b=await n.publishSession();b.error?l({...a,currentStage:"publishError",publishError:b.error}):l({...a,currentStage:"publishSuccess"})},children:D.publishDialog.publish}),(0,ie.jsx)(te,{appearance:"secondary",disabled:!v(),onClick:()=>{n.openInEditorWithConnection()},children:D.publishDialog.openPublishScript})]}),a.currentStage==="publishSuccess"&&(0,ie.jsx)(dt,{disableButtonEnhancement:!0,children:(0,ie.jsx)(te,{appearance:"secondary",onClick:()=>{l({...a,currentStage:"notStarted"}),n.resetUndoRedoState()},children:D.schemaDesigner.continueEditing})}),a.currentStage!=="publishLoading"&&(0,ie.jsx)(dt,{disableButtonEnhancement:!0,children:(0,ie.jsx)(te,{appearance:"secondary",onClick:()=>{l({...a,isConfirmationChecked:!1}),a.currentStage==="publishSuccess"&&n.closeDesigner()},children:D.schemaDesigner.Close})})]});return(0,ie.jsxs)(dn,{open:o,onOpenChange:(b,y)=>r(y.open),children:[c(),(0,ie.jsx)(pn,{className:e.surface,children:(0,ie.jsxs)(fn,{children:[(0,ie.jsx)(hn,{children:D.publishDialog.publishChanges}),(0,ie.jsx)(mn,{children:p()}),(0,ie.jsx)(un,{children:m()})]})})]})}var Gp=K(he());var ze=K(ee());function Xp(){let e=(0,Gp.useContext)(fe),t=qe(),n=()=>{ne.emit("pushState");let o=t.getNodes(),r=t.getEdges(),i=pe.generatePositions(o,r);t.setNodes(i.nodes),t.setEdges(i.edges),e.resetView()};if(e)return(0,ze.jsxs)(dn,{children:[(0,ze.jsx)(dt,{children:(0,ze.jsx)(te,{size:"small",appearance:"subtle",icon:(0,ze.jsx)(Ea,{}),title:D.schemaDesigner.autoArrange,children:D.schemaDesigner.autoArrange})}),(0,ze.jsx)(pn,{children:(0,ze.jsxs)(fn,{children:[(0,ze.jsx)(hn,{children:D.schemaDesigner.autoArrangeConfirmation}),(0,ze.jsx)(mn,{children:D.schemaDesigner.autoArrangeConfirmationContent}),(0,ze.jsxs)(un,{children:[(0,ze.jsx)(dt,{children:(0,ze.jsx)(te,{appearance:"primary",onClick:()=>n(),children:D.schemaDesigner.autoArrange})}),(0,ze.jsx)(dt,{children:(0,ze.jsx)(te,{appearance:"secondary",onClick:()=>{},children:D.schemaDesigner.cancel})})]})]})})]})}var Zp=K(he()),Hs=K(ee());function jp(){let e=(0,Zp.useContext)(fe);return(0,Hs.jsx)(te,{size:"small",appearance:"subtle",icon:(0,Hs.jsx)(xa,{}),title:D.schemaDesigner.delete,onClick:()=>e.deleteSelectedNodes(),children:D.schemaDesigner.delete})}var _o=K(he());var Nt=K(ee());function Qp(){let[e,t]=(0,_o.useState)(!1),[n,o]=(0,_o.useState)(!1);return(0,_o.useEffect)(()=>{let r=(i,s)=>{t(i),o(s)};return ne.on("updateUndoRedoState",r),()=>{ne.off("updateUndoRedoState",r)}},[]),(0,Nt.jsxs)(Nt.Fragment,{children:[(0,Nt.jsx)(te,{size:"small",appearance:"subtle",icon:(0,Nt.jsx)(ma,{}),onClick:()=>{ne.emit("undo")},disabled:!e,title:D.schemaDesigner.undo,children:D.schemaDesigner.undo}),(0,Nt.jsx)(te,{size:"small",appearance:"subtle",icon:(0,Nt.jsx)(pa,{}),onClick:()=>{ne.emit("redo")},disabled:!n,title:D.schemaDesigner.redo,children:D.schemaDesigner.redo})]})}var Ve=K(ee());function Jp(){return(0,Ve.jsx)("div",{style:{width:"100%",height:"30px",padding:"5px 0px"},children:(0,Ve.jsxs)(Ra,{size:"small",style:{width:"100%",overflow:"hidden",overflowX:"auto",gap:"3px",alignItems:"center"},children:[(0,Ve.jsx)(Yp,{}),(0,Ve.jsx)(vp,{}),(0,Ve.jsx)(Wp,{}),(0,Ve.jsx)(gi,{}),(0,Ve.jsx)(Up,{}),(0,Ve.jsx)(Qp,{}),(0,Ve.jsx)(Xp,{}),(0,Ve.jsx)(jp,{}),(0,Ve.jsx)(gi,{}),(0,Ve.jsx)(Kp,{})]})})}var sm=K(he());var em=K(he());var No=K(ee()),R1=Oe({editorFooter:{display:"flex",flexDirection:"row",gap:"10px",borderTop:"1px solid var(--vscode-badge-background)",padding:"10px"}});function tm(){let e=(0,em.useContext)(tt);if(!e)return;let t=R1(),n=()=>{let o=0;for(let r in e.errors)e.errors[r]&&o++;return o};return(0,No.jsxs)("div",{className:t.editorFooter,children:[(0,No.jsx)(te,{appearance:"primary",onClick:()=>{e.save(),ne.emit("getScript")},disabled:n()>0,children:e.isNewTable?D.schemaDesigner.add:D.schemaDesigner.save}),(0,No.jsx)(te,{appearance:"secondary",onClick:()=>{e.cancel()},children:D.schemaDesigner.cancel})]})}var Be=K(he());var G=K(ee()),Vs=K(he()),nm=Oe({panel:{height:"100%",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",padding:"5px",gap:"10px"},scrollContainer:{flex:"1",overflowY:"auto",overflowX:"hidden"},newColumnButton:{width:"fit-content"},advancedOptionsContainer:{display:"flex",flexDirection:"column",gap:"5px"},fullWidthDivider:{width:"100vh"},columnInput:{minWidth:"150px",maxWidth:"150px",textOverflow:"ellipsis"}}),O1=({columns:e,updateColumn:t,deleteColumn:n,columnNameInputRefs:o,datatypes:r,isColumnDeletable:i})=>{let s=nm(),a=Oo({axis:"grid"}),l=(0,Be.useContext)(tt),c=[rt({columnId:"name",renderHeaderCell:()=>(0,G.jsx)(_e,{children:D.schemaDesigner.name})}),rt({columnId:"type",renderHeaderCell:()=>(0,G.jsx)(_e,{children:D.schemaDesigner.dataType})}),rt({columnId:"primaryKey",renderHeaderCell:()=>(0,G.jsx)(_e,{children:D.schemaDesigner.primaryKey})}),rt({columnId:"delete",renderHeaderCell:()=>(0,G.jsx)(_e,{})}),rt({columnId:"menu",renderHeaderCell:()=>(0,G.jsx)(_e,{})}),rt({columnId:"error",renderHeaderCell:()=>(0,G.jsx)(G.Fragment,{})})],[d]=(0,Be.useState)({error:{defaultWidth:18,minWidth:18,idealWidth:18},name:{defaultWidth:150,minWidth:150,idealWidth:150},type:{defaultWidth:150,minWidth:150,idealWidth:150},primaryKey:{defaultWidth:70,minWidth:70,idealWidth:70},delete:{defaultWidth:20,minWidth:20,idealWidth:20},menu:{defaultWidth:20,minWidth:20,idealWidth:20}}),[u]=(0,Be.useState)(c),{getRows:f,columnSizing_unstable:h,tableRef:p}=Fo({columns:u,items:e},[Lo({columnSizingOptions:d,autoFitColumns:!1,containerWidthOffset:20})]),g=(m,b)=>{let y=Se.getAdvancedOptions(m);return(0,G.jsx)("div",{className:s.advancedOptionsContainer,children:y.map(x=>{switch(x.type){case"checkbox":return(0,G.jsx)(Ge,{children:(0,G.jsx)(Hn,{size:"medium",checked:m[x.columnProperty],onChange:(E,C)=>{t(b,x.columnModifier(m,C.checked))},label:x.label})},x.label);case"input":return(0,G.jsx)(Ge,{label:{children:(0,G.jsx)(Wo,{size:"small",info:x.hint,children:x.label})},children:(0,G.jsx)(Bt,{size:"small",value:m[x.columnProperty]?.toString(),onChange:(E,C)=>{t(b,x.columnModifier(m,C.value))}})},x.label);case"input-number":return(0,G.jsx)(Ge,{label:{children:(0,G.jsx)(Wo,{size:"small",info:x.hint,children:x.label})},children:(0,G.jsx)(Bt,{size:"small",type:"number",value:m[x.columnProperty]?.toString(),onChange:(E,C)=>{t(b,x.columnModifier(m,parseInt(C.value)))}})},x.label);case"textarea":return(0,G.jsx)(Ge,{label:{children:(0,G.jsx)(Wo,{size:"small",info:x.hint,children:x.label})},children:(0,G.jsx)(Ma,{size:"small",value:m[x.columnProperty],onChange:(E,C)=>{t(b,x.columnModifier(m,C.value))}})},x.label)}return(0,G.jsx)(G.Fragment,{})})})},v=(m,b,y)=>{switch(b){case"error":return(0,G.jsx)(G.Fragment,{children:l.errors[`columns_${m.id}`]&&(0,G.jsxs)(fi,{children:[(0,G.jsx)(hi,{disableButtonEnhancement:!0,children:(0,G.jsx)(te,{icon:(0,G.jsx)(aa,{style:{color:"var(--vscode-errorForeground)"},title:l.errors[m.name]}),appearance:"transparent"})}),(0,G.jsx)(ui,{tabIndex:-1,children:(0,G.jsx)("div",{children:l.errors[`columns_${m.id}`]})})]})});case"name":return(0,G.jsx)(Bt,{size:"small",className:s.columnInput,ref:E=>{o.current&&(o.current[y]=E)},value:m.name,onChange:(E,C)=>{t(y,{...m,name:C.value})}});case"type":return(0,G.jsx)(Ht,{placeholder:"Search Schema",options:r.map(E=>({displayName:E,value:E})),selectedOption:m.isComputed?{text:"Computed",value:"Computed"}:{text:m.dataType,value:m.dataType},onSelect:E=>{let C={...m,dataType:E.value,defaultValue:""};t(y,Se.fillColumnDefaults(C))},style:{minWidth:"150px",maxWidth:"150px"},size:"small",disabled:m.isComputed,ariaLabel:`${D.schemaDesigner.dataType} for ${m.name}`});case"primaryKey":return(0,G.jsx)(Hn,{size:"medium",checked:m.isPrimaryKey,onChange:(E,C)=>{t(y,{...m,isPrimaryKey:C.checked,isNullable:C.checked?!1:m.isNullable})},disabled:m.isComputed});case"delete":return(0,G.jsx)(te,{size:"small",appearance:"subtle",disabled:!i(m),icon:(0,G.jsx)(zt,{}),onClick:()=>n(y)});case"menu":let x="schema-designer-menu-"+m.id;return(0,G.jsxs)(fi,{positioning:{position:"below"},children:[(0,G.jsx)(hi,{disableButtonEnhancement:!0,children:(0,G.jsx)(te,{size:"small",appearance:"subtle",icon:(0,G.jsx)(ca,{})})}),(0,G.jsxs)(ui,{"aria-labelledby":x,children:[(0,G.jsx)("div",{children:(0,G.jsx)("h3",{id:x,children:"Advanced options"})}),g(m,y)]})]});default:return(0,G.jsx)(_e,{children:b})}};return(0,G.jsx)(G.Fragment,{children:(0,G.jsxs)($o,{...a,as:"table",size:"extra-small",...h.getTableProps(),ref:p,children:[(0,G.jsx)(Ho,{children:(0,G.jsx)(gn,{children:c.map(m=>(0,Vs.createElement)(Vo,{...h.getTableHeaderCellProps(m.columnId),key:m.columnId},m.renderHeaderCell()))})}),(0,G.jsx)(Bo,{children:f().map((m,b)=>(0,G.jsx)(gn,{children:u.map(y=>(0,Vs.createElement)(zo,{...h.getTableCellProps(y.columnId),key:y.columnId},v(e[b],y.columnId,b)))},b))})]})})},om=()=>{let e=nm(),t=(0,Be.useContext)(tt),n=(0,Be.useRef)([]),[o,r]=(0,Be.useState)(-1),i=(0,Be.useMemo)(()=>t.dataTypes,[t.dataTypes]),s=(0,Be.useMemo)(()=>yt.getAllTables(t.schema,t.table),[t.schema,t.table]);(0,Be.useEffect)(()=>{r(-1)},[t.table]),(0,Be.useEffect)(()=>{o>=0&&n.current[o]?.focus()},[o]);let a=h=>{let p=t.table.foreignKeys.some(v=>v.columns.includes(h.name)),g=s.some(v=>v.foreignKeys.some(m=>m.referencedColumns.includes(h.name)));return!p&&!g},l=()=>{let h=[...t.table.columns];h.push({id:ut(),name:rn.getNextColumnName(h),dataType:"int",isPrimaryKey:h.length===0,isIdentity:!1,isNullable:!0,maxLength:"",precision:0,scale:0,identitySeed:1,identityIncrement:1,defaultValue:"",isComputed:!1,computedFormula:"",computedPersisted:!1}),t.setTable({...t.table,columns:h}),r(h.length-1)},c=(h,p)=>{let g=[...t.table.columns];g[h]=p,t.setTable({...t.table,columns:g})},d=h=>{let p=[...t.table.columns];p.splice(h,1),t.setTable({...t.table,columns:p})},u=h=>{t.setTable({...t.table,schema:h})},f=h=>{t.setTable({...t.table,name:h})};if(t.table)return(0,G.jsxs)("div",{className:e.panel,children:[(0,G.jsxs)(Ge,{children:[(0,G.jsx)(Tt,{children:D.schemaDesigner.schema}),(0,G.jsx)(Ht,{placeholder:"Search Schema",options:t.schemas.map(h=>({displayName:h,value:h})),selectedOption:{text:t.table.schema,value:t.table.schema},onSelect:h=>u(h.value),ariaLabel:D.schemaDesigner.schema})]}),(0,G.jsxs)(Ge,{validationMessage:t.errors[Ws],children:[(0,G.jsx)(Tt,{children:D.schemaDesigner.name}),(0,G.jsx)(Bt,{autoFocus:!0,value:t.table.name,onChange:(h,p)=>f(p.value)})]}),(0,G.jsx)(te,{appearance:"secondary",icon:(0,G.jsx)(sn,{}),className:e.newColumnButton,onClick:l,children:D.schemaDesigner.newColumn}),(0,G.jsx)("div",{className:e.scrollContainer,children:(0,G.jsx)(O1,{columns:t.table.columns,updateColumn:c,deleteColumn:d,columnNameInputRefs:n,datatypes:i,isColumnDeletable:a})})]})};var Ee=K(he());var oe=K(ee()),Ks=K(he()),rm=Oe({panel:{height:"100%",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",padding:"10px",gap:"10px"},row:{display:"flex",flexDirection:"row",flex:"1",gap:"5px",padding:"0px 5px"},cardStyle:{marginBottom:"10px"},actionButton:{width:"fit-content"},scrollContainer:{flex:"1",overflow:"auto",padding:"5px"},newForeignKeyButton:{width:"200px"},mappingTableContainer:{backgroundColor:"var(--vscode-editorGroupHeader-tabsBackground)",padding:"10px"}}),P1=({foreignKey:e,foreignKeyIndex:t,selectedTable:n,updateForeignKey:o})=>{let r=Oo({axis:"grid"}),i=[rt({columnId:"columnName",renderHeaderCell:()=>(0,oe.jsx)(_e,{children:D.schemaDesigner.columnName})}),rt({columnId:"foreignKeyColumnName",renderHeaderCell:()=>(0,oe.jsx)(_e,{children:D.schemaDesigner.foreignColumn})}),rt({columnId:"delete",renderHeaderCell:()=>(0,oe.jsx)(_e,{})})],[s]=(0,Ee.useState)({columnName:{defaultWidth:150,minWidth:150,idealWidth:150},foreignKeyColumnName:{defaultWidth:150,minWidth:150,idealWidth:150},delete:{defaultWidth:30,minWidth:30,idealWidth:30}}),a=e.columns.map((g,v)=>({columnName:g,foreignKeyColumnName:e.referencedColumns[v]})),[l]=(0,Ee.useState)(i),{getRows:c,columnSizing_unstable:d,tableRef:u}=Fo({columns:l,items:a},[Lo({columnSizingOptions:s,autoFitColumns:!1,containerWidthOffset:20})]),f=(0,Ee.useContext)(tt),h=(0,Ee.useMemo)(()=>f.schema?yt.getTableFromDisplayName(f.schema,`${e.referencedSchemaName}.${e.referencedTableName}`):{columns:[]},[f.schema,e.referencedSchemaName,e.referencedTableName]),p=(g,v)=>{switch(g){case"columnName":return(0,oe.jsx)(Ht,{placeholder:"Search Schema",options:n.columns.map(m=>({displayName:m.name,value:m.name})),selectedOption:{text:e.columns[v],value:e.columns[v]},onSelect:m=>{let b=[...e.columns];b[v]=m.value,o(t,{...e,columns:b})},style:{minWidth:"150px",maxWidth:"150px"},size:"small",ariaLabel:D.schemaDesigner.sourceColumn});case"foreignKeyColumnName":return(0,oe.jsx)(Ht,{placeholder:"Search Schema",options:h.columns.map(m=>({displayName:m.name,value:m.name})),selectedOption:{text:e.referencedColumns[v],value:e.referencedColumns[v]},onSelect:m=>{let b=[...e.referencedColumns];b[v]=m.value,o(t,{...e,referencedColumns:b})},style:{minWidth:"150px",maxWidth:"150px"},size:"small",ariaLabel:D.schemaDesigner.foreignColumn});case"delete":return(0,oe.jsx)(te,{appearance:"subtle",icon:(0,oe.jsx)(zt,{}),onClick:()=>{let m=[...e.columns],b=[...e.referencedColumns];m.splice(v,1),b.splice(v,1),o(t,{...e,columns:m,referencedColumns:b})}});default:return null}};return(0,oe.jsxs)($o,{...r,as:"table",size:"extra-small",...d.getTableProps(),ref:u,children:[(0,oe.jsx)(Ho,{children:(0,oe.jsx)(gn,{children:i.map(g=>(0,Ks.createElement)(Vo,{...d.getTableHeaderCellProps(g.columnId),key:g.columnId},g.renderHeaderCell()))})}),(0,oe.jsx)(Bo,{children:c().map((g,v)=>(0,oe.jsx)(gn,{children:i.map(m=>(0,Ks.createElement)(zo,{...d.getTableCellProps(m.columnId),key:m.columnId},p(m.columnId,v)))},`mapping-${v}`))})]})},A1=({foreignKey:e,index:t,allTables:n,onDelete:o,onUpdate:r,lastAddedForeignKeyIndex:i})=>{let s=rm(),a=(0,Ee.useContext)(tt),l=(0,Ee.useRef)(null),[c,d]=(0,Ee.useState)(""),[u,f]=(0,Ee.useState)("");(0,Ee.useEffect)(()=>{t===i&&l.current?.focus()},[t,i]);let h=()=>{if(!a.schema)return;let p={...e},g=a.table.columns[0]?.name||"",m=yt.getTableFromDisplayName(a.schema,`${e.referencedSchemaName}.${e.referencedTableName}`).columns[0]?.name||"";p.columns.push(g),p.referencedColumns.push(m),r(t,p)};return(0,Ee.useEffect)(()=>{let p=a.errors[`${To}${e.id}`];d(p||"");let g=a.warnings[`${To}${e.id}`];f(g||"")},[a.errors]),(0,oe.jsxs)(Oa,{className:s.cardStyle,children:[(0,oe.jsx)(Pa,{header:(0,oe.jsx)(_e,{children:D.schemaDesigner.foreignKeyIndex(t+1)}),action:(0,oe.jsx)(te,{appearance:"subtle",icon:(0,oe.jsx)(zt,{}),onClick:()=>o(t)})}),c&&(0,oe.jsx)(yn,{intent:"error",children:c}),u&&(0,oe.jsx)(yn,{intent:"warning",children:u}),(0,oe.jsx)("div",{className:s.row,children:(0,oe.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,oe.jsx)(Tt,{children:D.schemaDesigner.name}),(0,oe.jsx)(Bt,{size:"small",value:e.name,ref:l,onChange:(p,g)=>{r(t,{...e,name:g.value})}})]})}),(0,oe.jsx)("div",{className:s.row,children:(0,oe.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,oe.jsx)(Tt,{children:D.schemaDesigner.targetTable}),(0,oe.jsx)(Ht,{options:n.sort((p,g)=>{let v=`${p.schema}.${p.name}`,m=`${g.schema}.${g.name}`;return v.toLowerCase().localeCompare(m.toLowerCase())}).map(p=>({displayName:`${p.schema}.${p.name}`,value:`${p.schema}.${p.name}`})),selectedOption:{text:`${e.referencedSchemaName}.${e.referencedTableName}`,value:`${e.referencedSchemaName}.${e.referencedTableName}`},onSelect:p=>{if(!p.value||!a.schema)return;let g=yt.getTableFromDisplayName(a.schema,p.value),v=g.columns[0]?.name||"";r(t,{...e,referencedTableName:g.name,referencedSchemaName:g.schema,referencedColumns:[v],columns:[a.table.columns[0]?.name||""]})},style:{minWidth:"auto"},size:"small",ariaLabel:D.schemaDesigner.targetTable})]})}),(0,oe.jsxs)("div",{className:s.row,children:[(0,oe.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,oe.jsx)(Tt,{children:D.schemaDesigner.onDelete}),(0,oe.jsx)(mi,{size:"small",value:ue.convertOnActionToString(e.onDeleteAction),selectedOptions:[ue.convertOnActionToString(e.onDeleteAction)],multiselect:!1,onOptionSelect:(p,g)=>{r(t,{...e,onDeleteAction:ue.convertStringToOnAction(g.optionValue)})},style:{minWidth:"auto"},children:ue.getOnActionOptions().map((p,g)=>(0,oe.jsx)(pi,{value:p.label,children:p.label},`on-delete-option-${g}-${e.id}`))})]}),(0,oe.jsxs)(Ge,{style:{flex:1},size:"small",children:[(0,oe.jsx)(Tt,{children:D.schemaDesigner.onUpdate}),(0,oe.jsx)(mi,{size:"small",value:ue.convertOnActionToString(e.onUpdateAction),selectedOptions:[ue.convertOnActionToString(e.onUpdateAction)],multiselect:!1,onOptionSelect:(p,g)=>{r(t,{...e,onUpdateAction:ue.convertStringToOnAction(g.optionValue)})},style:{minWidth:"auto"},children:ue.getOnActionOptions().map((p,g)=>(0,oe.jsx)(pi,{value:p.label,children:p.label},`on-update-option--${g}-${e.id}`))})]})]}),(0,oe.jsxs)("div",{className:s.mappingTableContainer,children:[(0,oe.jsx)(te,{icon:(0,oe.jsx)(sn,{}),className:s.actionButton,onClick:h,size:"small",children:D.schemaDesigner.newColumnMapping}),(0,oe.jsx)(P1,{foreignKey:e,foreignKeyIndex:t,selectedTable:a.table,updateForeignKey:r})]})]},`fk-card-${t}`)},im=()=>{let e=rm(),t=(0,Ee.useContext)(tt),n=(0,Ee.useRef)([]),[o,r]=(0,Ee.useState)(-1),i=(0,Ee.useMemo)(()=>t.schema?yt.getAllTables(t.schema):[],[t.table]);if((0,Ee.useEffect)(()=>{t.table&&r(-1)},[t.table]),(0,Ee.useEffect)(()=>{o>=0&&n.current[o]?.focus()},[o]),!t.table)return;let s=()=>{if(!i.length)return;let c=i[0],d={id:ut(),name:rn.getNextForeignKeyName(t.table.foreignKeys,t.schema.tables),columns:[t.table.columns[0]?.name||""],referencedSchemaName:c.schema,referencedTableName:c.name,referencedColumns:[c.columns[0]?.name||""],onDeleteAction:de.OnAction.CASCADE,onUpdateAction:de.OnAction.CASCADE},u=[...t.table.foreignKeys,d];t.setTable({...t.table,foreignKeys:u}),r(u.length-1)},a=c=>{let d=[...t.table.foreignKeys];d.splice(c,1),t.setTable({...t.table,foreignKeys:d})},l=(c,d)=>{let u=[...t.table.foreignKeys];u[c]=d,t.setTable({...t.table,foreignKeys:u})};return(0,oe.jsxs)("div",{className:e.panel,children:[(0,oe.jsx)(te,{icon:(0,oe.jsx)(sn,{}),className:e.newForeignKeyButton,onClick:s,children:D.schemaDesigner.newForeignKey}),(0,oe.jsx)("div",{className:e.scrollContainer,children:t.table.foreignKeys.map((c,d)=>(0,oe.jsx)(A1,{foreignKey:c,index:d,allTables:i,onDelete:a,onUpdate:l,lastAddedForeignKeyIndex:o},`foreign-key-${c.id}`))})]})};var nt=K(ee()),L1=Oe({editor:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},editorPanel:{flex:"1",overflow:"hidden"},tablePanel:{display:"flex",flexDirection:"column",padding:"5px 0px",gap:"5px",overflow:"hidden",maxHeight:"calc(100% - 10px)"},tablePanelRow:{display:"flex",flexDirection:"row",flex:"1",gap:"5px",padding:"0px 5px"},dataTypeDropdown:{minWidth:"110px",maxWidth:"110px","> button":{textOverflow:"ellipsis"}},foreignKeyContainer:{display:"flex",flexDirection:"column",gap:"5px",padding:"5px",borderTop:"1px solid"}}),am=()=>{let e=L1(),t=(0,sm.useContext)(tt);if(!t)return;let n=i=>Object.keys(t.errors).filter(s=>s.includes(`${i}_`)&&t.errors[s]).length,o=i=>Object.keys(t.warnings).filter(s=>s.includes(`${i}_`)&&t.warnings[s]).length;if(!t.table)return;let r=i=>(0,nt.jsx)(Da,{value:i,children:(0,nt.jsxs)("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[D.schemaDesigner[i],(0,nt.jsx)(di,{size:"small",count:n(i),style:{backgroundColor:"var(--vscode-inputValidation-errorBackground)",color:"var(--vscode-problemsErrorIcon-foreground)",border:"1px solid var(--vscode-inputValidation-errorBorder)"},title:D.schemaDesigner.nErrors(n(i))}),(0,nt.jsx)(di,{size:"small",count:o(i),style:{backgroundColor:"var(--vscode-inputValidation-warningBackground)",color:"var(--vscode-problemsWarningIcon-foreground)",border:"1px solid var(--vscode-inputValidation-warningBorder)"},title:D.schemaDesigner.nWarnings(o(i))})]})});return(0,nt.jsxs)("div",{className:e.editor,children:[(0,nt.jsxs)(Ia,{selectedValue:t.selectedTabValue,onTabSelect:(i,s)=>t.setSelectedTabValue(s.value),children:[r("table"),r("foreignKeys")]}),(0,nt.jsxs)("div",{className:e.editorPanel,children:[t.selectedTabValue==="table"&&(0,nt.jsx)(om,{}),t.selectedTabValue==="foreignKeys"&&(0,nt.jsx)(im,{})]}),(0,nt.jsx)(tm,{})]})};var Ie=K(he());var xt=K(ee()),tt=(0,Ie.createContext)(void 0);var Ws="table_name",To="foreignKeys_fk_",lm=()=>{let e=(0,Ie.useContext)(fe);if(!e)return;let[t,n]=(0,Ie.useState)(!1),[o,r]=(0,Ie.useState)({tables:[]}),[i,s]=(0,Ie.useState)({name:"",columns:[],schema:"",foreignKeys:[],id:""}),[a,l]=(0,Ie.useState)(!1),[c,d]=(0,Ie.useState)({}),[u,f]=(0,Ie.useState)({}),[h,p]=(0,Ie.useState)([]),[g,v]=(0,Ie.useState)([]),[m,b]=(0,Ie.useState)("table");(0,Ie.useEffect)(()=>{p(e.schemaNames),v(e.datatypes)},[e]),(0,Ie.useEffect)(()=>{let x=(C,N,M)=>{let R=e.getTableWithForeignKeys(C.id)||C;n(!0),r(N),s(R),l(!1),b(M?"foreignKeys":"table")},E=C=>{r(C),s(yt.createNewTable(C,h)),l(!0),n(!0),b("table")};return ne.on("editTable",x),ne.on("newTable",E),()=>{ne.off("editTable",x),ne.off("newTable",E)}},[h,g]);let y=async()=>{let x=!1;a?x=await e.addTable(i):x=await e.updateTable(i),x&&(n(!1),ne.emit("getScript"),ne.emit("pushState"))};return(0,Ie.useEffect)(()=>{(()=>{let E={},C={},N=yt.tableNameValidationError(o,i);E[Ws]=N??"";for(let M of i.columns){let R=Se.isColumnValid(M,i.columns);R&&(E[`columns_${M.id}`]=R??"")}i.foreignKeys.forEach(M=>{let R=ue.isForeignKeyValid(o.tables,i,M);R&&(E[`${To}${M.id}`]=R.errorMessage??"");let L=ue.getForeignKeyWarnings(o.tables,i,M);L&&(C[`${To}${M.id}`]=L.errorMessage??"")}),d(E),f(C)})()},[i]),(0,xt.jsx)($a,{position:"end",open:t,onOpenChange:(x,{open:E})=>n(E),onKeyDown:x=>{x.key==="Backspace"&&x.stopPropagation()},style:{width:"600px"},children:(0,xt.jsxs)(tt.Provider,{value:{schemas:h,dataTypes:g,schema:o,table:i,setTable:s,isEditDrawerOpen:t,setIsEditDrawerOpen:n,save:y,cancel:()=>n(!1),isNewTable:a,errors:c,warnings:u,selectedTabValue:m,setSelectedTabValue:b},children:[(0,xt.jsx)(Va,{children:(0,xt.jsx)(Wa,{action:(0,xt.jsx)(te,{appearance:"subtle","aria-label":"Close",icon:(0,xt.jsx)(va,{}),onClick:()=>n(!1)}),children:a?D.schemaDesigner.addTable:D.schemaDesigner.editTable})}),(0,xt.jsx)(Ha,{children:(0,xt.jsx)(am,{})})]})})};var At=K(he());var dm=K(ee()),cm=()=>{let e=(0,At.useContext)(fe),[t,n]=(0,At.useState)(""),o=(0,At.useRef)(null);return(0,At.useEffect)(()=>{ne.on("getScript",()=>{setTimeout(async()=>{let r=await e.getDefinition();n(r)},0)}),ne.on("openCodeDrawer",()=>{setTimeout(async()=>{let r=await e.getDefinition();n(r)},0),o.current&&(o.current.isCollapsed()?o.current.openPanel(25):o.current.closePanel())})},[]),(0,dm.jsx)(el,{ref:o,script:t,themeKind:e?.themeKind,openInEditor:e?.openInEditor,copyToClipboard:e?.copyToClipboard,activeTab:"script"})};var Lt=K(he());var We=K(he());var ko=K(ee()),um=({className:e})=>(0,ko.jsxs)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,ko.jsx)("path",{d:"M2.75 7.5C2.75 7.08579 3.08579 6.75 3.5 6.75C3.91421 6.75 4.25 7.08579 4.25 7.5C4.25 7.91421 3.91421 8.25 3.5 8.25C3.08579 8.25 2.75 7.91421 2.75 7.5Z",fill:"currentColor"}),(0,ko.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.68364 10.4942C3.23159 10.8262 3.86023 11.0011 4.50089 11C5.22295 10.9987 5.92683 10.7735 6.51552 10.3554C7.00557 10.0073 7.39571 9.53989 7.6506 8.99999L13.5 9C13.6326 9 13.7598 8.94732 13.8536 8.85355L14.8536 7.85355C15.0488 7.65829 15.0488 7.3417 14.8536 7.14644L12.8536 5.14644C12.6583 4.95118 12.3417 4.95118 12.1464 5.14644L11.5 5.79289L10.8536 5.14644C10.6583 4.95118 10.3417 4.95118 10.1464 5.14644L9.5 5.79289L8.85355 5.14644C8.65829 4.95118 8.34171 4.95118 8.14645 5.14644L7.52652 5.76637C7.3135 5.39491 7.03313 5.06418 6.69799 4.792C6.20067 4.38811 5.60191 4.12869 4.96713 4.04208C4.33236 3.95547 3.68598 4.04501 3.09865 4.30091C2.51132 4.55681 2.00562 4.96922 1.63682 5.49308C1.26802 6.01695 1.05031 6.6321 1.00748 7.27133C0.964642 7.91055 1.09833 8.54925 1.39394 9.11764C1.68955 9.68602 2.1357 10.1622 2.68364 10.4942ZM4.49911 10C4.04176 10.0008 3.59298 9.8759 3.20182 9.63891C2.81065 9.40193 2.49216 9.06198 2.28113 8.65623C2.0701 8.25047 1.97466 7.79451 2.00524 7.33819C2.03582 6.88186 2.19123 6.44271 2.45451 6.06874C2.71779 5.69477 3.07879 5.40035 3.49808 5.21767C3.91736 5.03499 4.37879 4.97107 4.83195 5.0329C5.2851 5.09473 5.71254 5.27993 6.06756 5.56825C6.42258 5.85658 6.69152 6.23694 6.84499 6.66777C6.91595 6.86697 7.10454 6.99999 7.316 6.99999L7.5 6.99999C7.63261 6.99999 7.75979 6.94732 7.85355 6.85355L8.5 6.2071L9.14645 6.85355C9.34171 7.04881 9.65829 7.04881 9.85355 6.85355L10.5 6.2071L11.1464 6.85355C11.3417 7.04881 11.6583 7.04881 11.8536 6.85355L12.5 6.2071L13.7929 7.5L13.2929 8L7.316 7.99999C7.10367 7.99999 6.9145 8.13409 6.8442 8.33444C6.67363 8.82055 6.35648 9.24178 5.93647 9.54008C5.51646 9.83839 5.01427 9.99907 4.49911 10Z",fill:"currentColor"})]});var Do=K(ee()),fm=({className:e})=>(0,Do.jsxs)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,Do.jsx)("path",{d:"M11 6C11.5523 6 12 5.55228 12 5C12 4.44772 11.5523 4 11 4C10.4477 4 10 4.44772 10 5C10 5.55228 10.4477 6 11 6Z",fill:"currentColor"}),(0,Do.jsx)("path",{d:"M7.5 12V11.5H8.5C8.77614 11.5 9 11.2761 9 11V10H10C12.2091 10 14 8.20914 14 6C14 3.79086 12.2091 2 10 2C7.79086 2 6 3.79086 6 6C6 6.39211 6.05656 6.77171 6.16219 7.13071L2.29289 11C2.10536 11.1875 2 11.4419 2 11.7071V13C2 13.5523 2.44772 14 3 14H5C5.55229 14 6 13.5523 6 13V12.5H7C7.27614 12.5 7.5 12.2761 7.5 12ZM7 6C7 4.34315 8.34315 3 10 3C11.6569 3 13 4.34315 13 6C13 7.65685 11.6569 9 10 9H8.5C8.22386 9 8 9.22386 8 9.5V10.5H7C6.72386 10.5 6.5 10.7239 6.5 11V11.5H5.5C5.22386 11.5 5 11.7239 5 12V13H3V11.7071L7.08898 7.61813C7.22904 7.47807 7.27321 7.26854 7.20163 7.08386C7.07157 6.74835 7 6.38313 7 6Z",fill:"currentColor"})]});var j=K(ee()),F1=e=>{let[t,n]=(0,We.useState)(!1),o=(0,We.useRef)(null);return(0,We.useEffect)(()=>{let r=()=>{if(o.current){let s=o.current.scrollWidth>o.current.clientWidth;n(s)}},i=setTimeout(r,0);return window.addEventListener("resize",r),()=>{clearTimeout(i),window.removeEventListener("resize",r)}},[e]),{isOverflowing:t,textRef:o}},hm=({content:e,children:t,...n})=>{let{isOverflowing:o,textRef:r}=F1(e),i=(0,We.cloneElement)(t,{ref:r,...t.props});return o?(0,j.jsx)(_a,{relationship:"label",content:e,...n,children:i}):i},Io=Oe({tableNodeContainer:{width:`${Pt.NODE_WIDTH}px`,backgroundColor:"var(--vscode-editor-background)",borderRadius:"5px",display:"flex",flexDirection:"column",gap:"5px"},tableHeader:{width:"100%",display:"flex",minHeight:"50px",flexDirection:"column"},tableHeaderRow:{width:"100%",display:"flex",height:"30px",flexDirection:"row",alignItems:"center",gap:"5px",paddingTop:"10px"},tableIcon:{padding:"0 5px",width:"20px",height:"20px"},tableTitle:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis",fontWeight:"600"},tableTitleExporting:{flexGrow:1,fontWeight:"600",overflowWrap:"anywhere",whiteSpace:"normal",hyphens:"auto"},tableSubtitle:{fontSize:"11px",paddingLeft:"35px"},columnName:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},columnNameExporting:{flexGrow:1},columnType:{fontSize:"12px",color:"var(--vscode-descriptionForeground)"},handleLeft:{marginLeft:"2px"},handleRight:{marginRight:"2px"},keyIcon:{padding:"0 5px",width:"16px",height:"16px"},actionButton:{marginLeft:"auto"},collapseButton:{width:"100%"},tableOverlay:{position:"absolute",inset:0,backgroundColor:"var(--vscode-editor-background)",opacity:.4,pointerEvents:"none",zIndex:10}}),z1=({table:e})=>{let t=(0,We.useContext)(fe),n=Io(),o=()=>{let s=t.extractSchema();if(!s.tables.find(c=>c.id===e.id))return;let l={...e};ne.emit("editTable",l,s)},r=()=>{t.deleteTable(e)},i=()=>{let s=t.extractSchema();if(!s.tables.find(c=>c.id===e.id))return;let l={...e};ne.emit("editTable",l,s,!0)};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(te,{appearance:"subtle",icon:(0,j.jsx)(ia,{}),onClick:o,className:n.actionButton,size:"small"}),(0,j.jsxs)(an,{children:[(0,j.jsx)(cn,{disableButtonEnhancement:!0,children:(0,j.jsx)(Na,{icon:(0,j.jsx)(da,{}),className:n.actionButton,size:"small",appearance:"subtle"})}),(0,j.jsx)(ln,{children:(0,j.jsxs)(Po,{children:[(0,j.jsx)($t,{icon:(0,j.jsx)(la,{}),onClick:i,children:D.schemaDesigner.manageRelationships}),(0,j.jsx)($t,{icon:(0,j.jsx)(zt,{}),onClick:r,children:D.schemaDesigner.delete})]})})]})]})},B1=({table:e})=>{let t=Io(),n=(0,We.useContext)(fe),o=r=>{if(!n.findTableText||n.findTableText.trim()==="")return(0,j.jsx)("span",{children:r});let i=new RegExp(`(${n.findTableText.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),s=r.split(i);return(0,j.jsx)(j.Fragment,{children:s.map((a,l)=>a.toLowerCase()===n.findTableText.toLowerCase()?(0,j.jsx)("span",{style:{backgroundColor:"var(--vscode-editor-findMatchBackground)",color:"var(--vscode-editor-background)",padding:"0 2px",borderRadius:"3px"},children:a},l):(0,j.jsx)("span",{children:a},l))})};return(0,j.jsxs)("div",{className:t.tableHeader,children:[(0,j.jsxs)("div",{className:t.tableHeaderRow,children:[(0,j.jsx)(ua,{className:t.tableIcon}),(0,j.jsx)(hm,{content:`${e.schema}.${e.name}`,relationship:"label",children:(0,j.jsx)(_e,{className:n.isExporting?t.tableTitleExporting:t.tableTitle,children:n.isExporting?`${e.schema}.${e.name}`:o(`${e.schema}.${e.name}`)})}),!n.isExporting&&(0,j.jsx)(z1,{table:e})]}),(0,j.jsx)("div",{className:t.tableSubtitle,children:D.schemaDesigner.tableNodeSubText(e.columns.length)})]})},$1=({column:e,table:t})=>{let n=Io(),o=(0,We.useContext)(fe),r=t.foreignKeys.some(i=>i.columns.includes(e.name));return(0,j.jsxs)("div",{className:"column",children:[(0,j.jsx)(Ct,{type:"source",position:X.Left,id:`left-${e.name}`,isConnectable:!0,className:n.handleLeft}),e.isPrimaryKey&&(0,j.jsx)(fm,{className:n.keyIcon}),!e.isPrimaryKey&&r&&(0,j.jsx)(um,{className:n.keyIcon}),(0,j.jsx)(hm,{content:e.name,relationship:"label",children:(0,j.jsx)(_e,{className:o.isExporting?n.columnNameExporting:n.columnName,style:{paddingLeft:e.isPrimaryKey||r?"0px":"30px"},children:e.name})}),(0,j.jsx)(_e,{className:n.columnType,children:e.isComputed?"COMPUTED":e.dataType?.toUpperCase()}),(0,j.jsx)(Ct,{type:"source",position:X.Right,id:`right-${e.name}`,isConnectable:!0,className:n.handleRight})]},e.name)},H1=({hiddenColumns:e})=>(0,j.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"32px",pointerEvents:"none",zIndex:1},children:e.map(t=>(0,j.jsxs)("div",{children:[(0,j.jsx)(Ct,{type:"source",position:X.Left,id:`left-${t.name}`,isConnectable:!0,style:{visibility:"hidden",position:"absolute",left:0,top:"50%",transform:"translateY(-50%)"}}),(0,j.jsx)(Ct,{type:"source",position:X.Right,id:`right-${t.name}`,isConnectable:!0,style:{visibility:"hidden",position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"}})]},t.name))}),V1=({columns:e,table:t,isCollapsed:n,onToggleCollapse:o})=>{let r=Io(),a=((0,We.useContext)(fe).state?.enableExpandCollapseButtons??!0)&&e.length>10,l=a&&n?e.slice(0,10):e,c=a&&n?e.slice(10):[],d=ci("Expand"),u=ci("Collapse");return(0,j.jsxs)("div",{style:{position:"relative"},children:[c.length>0&&(0,j.jsx)(H1,{hiddenColumns:c}),l.map((f,h)=>(0,j.jsx)($1,{column:f,table:t},`${h}-${f.name}`)),a&&(0,j.jsx)(te,{className:r.collapseButton,onClick:o,appearance:"subtle",icon:n?(0,j.jsx)(na,{}):(0,j.jsx)(oa,{}),tabIndex:0,children:n?(0,j.jsx)("span",{children:d}):(0,j.jsx)("span",{children:u})})]})},pm=e=>{let t=Io(),n=e.data,[o,r]=(0,We.useState)(n.columns.length>10),i=()=>{r(!o)};return(0,j.jsxs)("div",{className:t.tableNodeContainer,children:[e.data?.dimmed&&(0,j.jsx)("div",{className:t.tableOverlay}),(0,j.jsx)(B1,{table:n}),(0,j.jsx)(Ta,{}),(0,j.jsx)(V1,{columns:n.columns,table:n,isCollapsed:o,onToggleCollapse:i})]})};var Ce=K(ee()),W1={tableNode:pm},mm=()=>{let e=Js("toaster"),{dispatchToast:t}=Aa(e),n=(0,Lt.useContext)(fe),[o,r,i]=Hu([]),[s,a,l]=Vu([]),c=(0,Lt.useRef)(void 0),[d,u]=(0,Lt.useState)(!1);(0,Lt.useEffect)(()=>{(async()=>{let{nodes:b,edges:y}=await n.initializeSchemaDesigner();r(b),a(y)})()},[]);let f=m=>t((0,Ce.jsxs)(Fa,{appearance:"inverted",children:[(0,Ce.jsx)(za,{children:"Failed to create foreign key"}),(0,Ce.jsx)(Ba,{children:m})]}),{pauseOnHover:!0,intent:"error"}),h=m=>{let b=o.find(z=>z.id===m.source),y=o.find(z=>z.id===m.target);if(!b||!y||!m.sourceHandle||!m.targetHandle)return;let x=ue.extractColumnNameFromHandle(m.sourceHandle),E=ue.extractColumnNameFromHandle(m.targetHandle),C=b.data.columns.find(z=>z.name===x),N=y.data.columns.find(z=>z.name===E);if(!C||!N)return;let M=pe.extractSchemaModel(o,s),R=ue.extractForeignKeysFromEdges(s,b.data.id,M),L=ue.createForeignKeyFromConnection(b,y,C.name,N.name,ut(),rn.getNextForeignKeyName(R,M.tables)),$={id:`${b.id}-${y.id}-${C.name}-${N.name}`,source:b.id,target:y.id,sourceHandle:m.sourceHandle,targetHandle:m.targetHandle,markerEnd:{type:je.ArrowClosed},data:L,type:b.id===y.id?He.SmoothStep:void 0};a(z=>go($,z)),ne.emit("getScript"),ne.emit("pushState")},p=(m,b)=>{if(!b.isValid){if(!b.fromHandle||!b.toHandle||!b.fromNode||!b.toNode||!b.fromHandle.id||!b.toHandle.id)return;let y=ue.extractColumnNameFromHandle(b.fromHandle.id),x=ue.extractColumnNameFromHandle(b.toHandle.id),E=ue.createForeignKeyFromConnection(b.fromNode,b.toNode,y,x),C=ue.isForeignKeyValid(pe.extractSchemaModel(o,s).tables,b.fromNode.data,E);C.errorMessage&&f(C.errorMessage)}},g=m=>ue.validateConnection(m,o,s).isValid,v=async()=>(u(!0),await new Promise(b=>{c.current=b}));return(0,Ce.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[(0,Ce.jsx)(La,{toasterId:e,position:"top-end"}),(0,Ce.jsxs)($u,{nodes:o,edges:s,nodeTypes:W1,onNodesChange:i,onEdgesChange:l,onConnect:h,onConnectEnd:p,onlyRenderVisibleElements:n.renderOnlyVisibleTables,proOptions:{hideAttribution:!0},isValidConnection:g,connectionMode:pt.Loose,onDelete:()=>{ne.emit("getScript"),ne.emit("pushState")},onNodeDragStop:()=>{ne.emit("pushState")},onBeforeDelete:async m=>m.nodes.length===0&&m.edges.length===0?!0:await v(),minZoom:.05,fitView:!0,children:[(0,Ce.jsx)(Uu,{}),(0,Ce.jsx)(Gu,{pannable:!0,zoomable:!0}),(0,Ce.jsx)(Ku,{variant:gt.Dots,gap:12,size:1})]}),(0,Ce.jsx)(dn,{open:d,onOpenChange:(m,b)=>{u(b.open)},children:(0,Ce.jsx)(pn,{children:(0,Ce.jsxs)(fn,{children:[(0,Ce.jsx)(hn,{children:D.schemaDesigner.deleteConfirmation}),(0,Ce.jsx)(mn,{children:D.schemaDesigner.deleteConfirmationContent}),(0,Ce.jsxs)(un,{children:[(0,Ce.jsx)(dt,{disableButtonEnhancement:!0,children:(0,Ce.jsx)(te,{appearance:"primary",onClick:()=>{c.current&&c.current(!0)},children:D.schemaDesigner.delete})}),(0,Ce.jsx)(dt,{disableButtonEnhancement:!0,children:(0,Ce.jsx)(te,{appearance:"secondary",onClick:()=>{c.current&&c.current(!1)},children:D.schemaDesigner.cancel})})]})]})})})]})};var ym=K(he());var Ne=K(he());var ot=K(ee()),K1=Oe({floatingContainer:{position:"absolute",right:"16px",top:"0px",display:"flex",flexDirection:"row",alignItems:"center",backgroundColor:"var(--vscode-editorWidget-background)",boxShadow:"0 0 8px 2px var(--vscode-widget-shadow)",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",paddingLeft:"4px",paddingRight:"4px",paddingTop:"0px",paddingBottom:"0px",zIndex:"35",transform:"translateY(-10px)",opacity:"0",transition:"opacity 0.2s ease, transform 0.2s ease",overflow:"hidden",borderLeft:"3px solid var(--vscode-editorWidget-border)",height:"33px",gap:"3px"},visible:{opacity:"1",transform:"translateY(0)"},invisible:{display:"none"},srOnly:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}});function gm({getItems:e,onItemSelected:t,onSearch:n,placeholder:o=D.common.find,searchLabel:r="Search items",nextLabel:i=D.common.findNext,previousLabel:s=D.common.findPrevious,width:a="200px",emitSearchEvent:l,disabled:c=!1,parentRef:d,zIndex:u=1e3}){let[f,h]=(0,Ne.useState)(e()),[p,g]=(0,Ne.useState)(""),[v,m]=(0,Ne.useState)(D.common.noResults),[b,y]=(0,Ne.useState)([]),[x,E]=(0,Ne.useState)(0),[C,N]=(0,Ne.useState)(!1),M=(0,Ne.useRef)(null),R=(0,Ne.useRef)(null),L=(0,Ne.useRef)(null),$=(0,Ne.useRef)(null),z=K1(),B=_=>_.trim()?f.filter(P=>P.getSearchableText().toLowerCase().includes(_.toLowerCase())):[];(0,Ne.useEffect)(()=>{let _=D.common.noResults;b.length>0&&(_=D.common.searchResultSummary(x+1,b.length)),m(_),L.current&&(L.current.textContent=p?`${_}${b.length>0?`. Found "${p}" in ${b[x]?.getDisplayText()}`:""}`:"Search cleared"),b.length>0&&t&&t(b[x]),l&&l(p)},[b,x,p,t,l]);let w=_=>{if(g(_),_.trim().length===0)m(D.common.noResults),y([]),E(0);else{let P=B(_);y(P),E((P.length>0,0))}n&&n(_)},T=()=>{if(b.length===0)return;let _=(x+1)%b.length;E(_)},S=()=>{if(b.length===0)return;let _=(x-1+b.length)%b.length;E(_)},k=(0,Ne.useCallback)(()=>{$.current=document.activeElement,N(!0),requestAnimationFrame(()=>{M.current&&M.current.focus()})},[]),A=(0,Ne.useCallback)(()=>{N(!1),g(""),y([]),$.current?.focus()},[]);return(0,Ne.useEffect)(()=>{if(c)return;let _=P=>{if(!d?.current?.contains(document.activeElement))return;let V=P.ctrlKey&&P.key==="f";if(navigator.userAgent.includes("Macintosh")&&(V=P.metaKey&&P.key==="f"),V)if(P.preventDefault(),C)M.current&&M.current.focus();else{k();let H=window.getSelection()?.toString();H&&w(H)}else P.key==="Escape"&&C&&(A(),d?.current&&d.current.focus(),P.preventDefault())};return document.addEventListener("keydown",P=>{_(P)}),()=>{document.removeEventListener("keydown",P=>{_(P)})}},[c,C,k,A,d]),(0,Ne.useEffect)(()=>{h(e())},[e,C]),(0,Ne.useEffect)(()=>{if(p){let _=B(p);y(_),E((_.length>0,0))}},[f,p]),(0,ot.jsxs)("div",{ref:R,role:"search","aria-label":r,className:`${z.floatingContainer} ${C?z.visible:z.invisible}`,style:{zIndex:u},children:[(0,ot.jsx)(Ko,{size:"small",placeholder:o,value:p,onChange:(_,P)=>w(P.value),style:{width:a,maxWidth:a,marginLeft:"17px"},ref:M,"aria-label":r,"aria-controls":"search-results-status",onKeyDown:_=>{_.key==="Enter"?_.shiftKey?(S(),_.preventDefault()):(T(),_.preventDefault()):_.key==="Escape"&&(A(),_.preventDefault())}}),(0,ot.jsx)(_e,{size:200,style:{marginLeft:"5px",color:b.length===0&&p?"var(--vscode-errorForeground)":"",minWidth:"70px"},id:"search-results-count","aria-live":"polite",children:v}),(0,ot.jsx)("div",{ref:L,id:"search-results-status","aria-live":"polite",className:z.srOnly}),(0,ot.jsx)(te,{size:"small",icon:(0,ot.jsx)(fa,{}),appearance:"subtle",disabled:b.length===0,onClick:T,title:i,"aria-label":i}),(0,ot.jsx)(te,{size:"small",icon:(0,ot.jsx)(ga,{}),appearance:"subtle",disabled:b.length===0,onClick:S,title:s,"aria-label":s}),(0,ot.jsx)(te,{size:"small",icon:(0,ot.jsx)(wa,{}),appearance:"subtle",onClick:A,title:D.common.closeFind,"aria-label":D.common.closeFind})]})}var xm=K(ee()),qs=class{node;constructor(t){this.node=t}get id(){return this.node.id}getDisplayText(){return`${this.node.data.schema||""}.${this.node.data.name}`}getSearchableText(){return this.getDisplayText()}getNode(){return this.node}},bm=({parentRef:e})=>{let t=qe(),n=(0,ym.useContext)(fe);return(0,xm.jsx)(gm,{getItems:()=>t.getNodes().filter(s=>!s.hidden&&s.data&&s.data.name).map(s=>new qs(s)),onItemSelected:i=>{n.updateSelectedNodes([i.id]),n.setCenter(i.id,!0)},searchLabel:D.common.find,width:"200px",emitSearchEvent:i=>{n.setFindTableText(i)},parentRef:e})};var Te=K(ee()),q1=Oe({resizeHandle:{height:"2px",backgroundColor:"var(--vscode-editorWidget-border)"}}),wm=()=>{let e=(0,ti.useContext)(fe),t=q1();if(e)return(0,Te.jsxs)(Te.Fragment,{children:[(0,Te.jsx)(lm,{}),(0,Te.jsxs)(U1,{children:[(0,Te.jsxs)(Qa,{direction:"vertical",children:[(0,Te.jsx)(ja,{defaultSize:100,children:(0,Te.jsxs)(Y1,{children:[(0,Te.jsx)(Jp,{}),(0,Te.jsx)(mm,{})]})}),(0,Te.jsx)(Ja,{className:t.resizeHandle}),(0,Te.jsx)(cm,{})]}),!e.isInitialized&&(0,Te.jsx)(G1,{})]})]})},U1=({children:e})=>{let t=(0,ti.useRef)(null);return(0,Te.jsxs)("div",{tabIndex:0,ref:t,style:{height:"100%",width:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[(0,Te.jsx)(bm,{parentRef:t}),e]})},Y1=({children:e})=>(0,Te.jsx)("div",{style:{flex:1,width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:e}),G1=()=>(0,Te.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Te.jsx)(Ao,{label:D.schemaDesigner.loadingSchemaDesigner,labelPosition:"below"})});var Mo=K(ee());vm.default.createRoot(document.getElementById("root")).render((0,Mo.jsx)(Ya,{children:(0,Mo.jsx)(us,{children:(0,Mo.jsx)(xp,{children:(0,Mo.jsx)(wm,{})})})}));
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
