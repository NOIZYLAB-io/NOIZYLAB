"use strict";(self.webpackChunkcollection_workbench=self.webpackChunkcollection_workbench||[]).push([[6541],{56541:(e,t,i)=>{i.d(t,{Z:()=>ji});var n=i(40540),o=i.n(n),r=i(59530),s=i.n(r),a=i(58560),l=i(69019),c=i(35736),d=i(82196),u=i(64495),p=i(80429),h=i(81397),m=i(26246),g=i(98276),v=i(1540),b=i(60607),f=i(98283),y=i(78476);const x="New Collection";var w=i(50297);function k(){const e=pe();return[e.preRequestStore.content,e.setPreRequestScript]}function S(){const e=pe();return[e.testScriptStore.content,e.setTests]}function C(){const e=pe();return[e.preRequestStore.packages,e.onPreRequestScriptPackageChange]}function j(){const e=pe();return[e.testScriptStore.packages,e.onTestScriptPackageChange]}var I=i(52322);const _=s().div.withConfig({displayName:"indicator-dot__Dot",componentId:"sc-2j0bxu-0"})(["display:inline-flex;width:calc(0.5 * var(--spacing-m));height:calc(0.5 * var(--spacing-m));margin-left:var(--spacing-xs);border-radius:calc(0.5 * var(--spacing-m));background-color:var(--base-color-success);&.error{background-color:var(--base-color-error);}"]),E=({isError:e=!1})=>(0,I.jsx)(_,{"aria-label":e?"tab with errors":"tab with active values",className:e?"error":"","data-testid":"tab-indicator-dot"}),T=(0,w.observer)((()=>{const[e]=k(),[t]=S(),i=!(!t&&!e);return(0,I.jsxs)(a.Z,{alignItems:"center",children:["Scripts",i&&(0,I.jsx)(E,{})]})})),P="prerequest",A="collection";var N=i(63622),L=i(20856),R=i(39245);const z=s().div.withConfig({displayName:"script-tile__Indicator",componentId:"sc-1qqijps-0"})(["width:4px;height:4px;position:absolute;right:6px;border-radius:6px;background-color:",";"],(({hasError:e})=>e?"var(--base-color-error)":"var(--content-color-tertiary)")),Z=s().div.withConfig({displayName:"script-tile__ScriptItemContainer",componentId:"sc-1qqijps-1"})(["display:flex;flex-direction:row;position:relative;align-items:center;box-sizing:border-box;cursor:pointer;padding:var(--spacing-s) var(--spacing-s) var(--spacing-s) var(--spacing-l);color:var( "," );background-color:var( "," );"],(({isActive:e})=>e?"--content-color-primary":"--content-color-secondary"),(({isActive:e})=>e?"--background-color-tertiary":"--background-color-primary")),V=s()(N.ZP).withConfig({displayName:"script-tile__ScriptLabel",componentId:"sc-1qqijps-2"})(["user-select:none;"]),O=s().div.withConfig({displayName:"script-tile__StyledContainer",componentId:"sc-1qqijps-3"})(["margin:var(--spacing-xs);"]),D=({script:e,setActiveScriptKey:t,activeScriptKey:i})=>(0,I.jsx)(L.ZP,{placement:"bottom-start",maxWidth:240,position:"bottom-start",triggerEvent:"mouseenter",delay:1e3,xOffset:60,trigger:(0,I.jsxs)(Z,{onClick:()=>t(e.key),isActive:e.key===i,"data-testid":`request-script-tile-${e.key}`,children:[(0,I.jsx)(a.Z,{grow:1,children:(0,I.jsx)(V,{type:"body-medium",children:e.label})}),e.hasValue&&(0,I.jsx)(z,{})]}),children:(0,I.jsxs)(O,{children:[(0,I.jsx)(N.ZP,{children:e.tooltipText}),(0,I.jsx)("br",{}),(0,I.jsx)(R.Link,{to:e.tooltipLearnMoreLink,target:"_blank",children:(0,I.jsx)(N.ZP,{type:"link-default",isExternal:!0,children:"Learn more"})})]})});var q=i(38053),M=i(49709),W=i.n(M);const F=["type"],U=(0,n.forwardRef)(((e,t)=>{let{type:i}=e,n=(0,f.Z)(e,F);const o=pe(),r={fileName:o.name,entityId:o.metadata.id||"",entityType:"collection"};return(0,I.jsx)(v.ScriptEditor,Object.assign({ref:t,nativeEditorProps:r,type:i},n))}));U.displayName="ScriptEditorWrapper";const H=U,K=s().div.withConfig({displayName:"pre-request-script-panel__EditorContainer",componentId:"sc-fhgknz-0"})(["height:calc(100% - var(--spacing-xxl));width:100%;position:relative;"]),B=W().getExamples("prerequest").map(((e,t)=>Object.assign({},e,{id:`prerequest-${t+1}`,category:"workflows"}))),$=(0,w.observer)((function({isScriptWidthNarrow:e=!1}){const t=(0,n.useRef)(null),[i,o]=k(),[r,s]=C(),{isEnabled:a}=(0,q.useIsPackageEnabled)(),{isEnabled:l}=(0,q.useIsExternalPackageEnabled)(),c=(0,n.useCallback)((e=>{var i;null==(i=t.current)||i.insertTextBlock(e.code)}),[]),d=(0,n.useCallback)((()=>{var e;null==(e=t.current)||e.beautifyContent()}),[]);return(0,I.jsxs)(K,{children:[(0,I.jsx)(H,{ref:t,content:i,onChange:o,onSetPackages:s,isInternalPackagesEnabled:a,isExternalPackagesEnabled:l}),(0,I.jsx)(v.EditorToolbar,{selectedPackages:r,snippets:B,handleSnippetSelect:c,handleAddPackages:(e,i)=>{var n;const o=null==(n=t.current)?void 0:n.editor;o&&(0,v.addPackagesToEditor)(e,i,o)},isPackageLibraryEnabled:a,mode:"prerequest",isScriptWidthNarrow:e,handleBeautifyContent:d,entityType:A})]})})),G=s().div.withConfig({displayName:"test-script-panel__EditorContainer",componentId:"sc-97n8f1-0"})(["height:calc(100% - var(--spacing-xxl));width:100%;position:relative;"]),J=W().getExamples("test").map(((e,t)=>Object.assign({},e,{id:`test-${t+1}`,category:"workflows"}))),Q=(0,w.observer)((function({isScriptWidthNarrow:e=!1}){const t=(0,n.useRef)(null),[i,o]=S(),[r,s]=j(),{isEnabled:a}=(0,q.useIsPackageEnabled)(),{isEnabled:l}=(0,q.useIsExternalPackageEnabled)(),c=(0,n.useCallback)((e=>{var i;null==(i=t.current)||i.insertTextBlock(e.code)}),[]),d=(0,n.useCallback)((()=>{var e;null==(e=t.current)||e.beautifyContent()}),[]);return(0,I.jsxs)(G,{children:[(0,I.jsx)(H,{ref:t,content:i,onChange:o,onSetPackages:s,isInternalPackagesEnabled:a,isExternalPackagesEnabled:l,type:"tests-script"}),(0,I.jsx)(v.EditorToolbar,{selectedPackages:r,snippets:J,handleSnippetSelect:c,handleAddPackages:(e,i)=>{var n;const o=null==(n=t.current)?void 0:n.editor;o&&(0,v.addPackagesToEditor)(e,i,o)},isPackageLibraryEnabled:a,mode:"test",isScriptWidthNarrow:e,handleBeautifyContent:d,entityType:A})]})})),Y=s()(a.Z).withConfig({displayName:"scripts-panel__ScriptList",componentId:"sc-1xmbkuu-0"})(["width:",";border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"],(({isScriptWidthNarrow:e})=>e?"81px":"115px")),X=s()(a.Z).withConfig({displayName:"scripts-panel__ScriptContainer",componentId:"sc-1xmbkuu-1"})(["flex:1 1 auto;min-width:0;"]),ee=(0,w.observer)((({isScriptWidthNarrow:e})=>{const[t,i]=(0,n.useState)(P),[o]=k(),[r]=S(),s=[{key:P,label:e?"Pre-req":"Pre-request",hasValue:!!o,tooltipText:"Runs before each request is sent. Use it to create API workflows by configuring the requests dynamically.",tooltipLearnMoreLink:"https://go.pstmn.io/docs-prerequest-scripts"},{key:"postresponse",label:e?"Post-res":"Post-response",hasValue:!!r,tooltipText:"Runs after a response is received for each request. Use it to write tests.",tooltipLearnMoreLink:"https://go.pstmn.io/docs-test-scripts"}];return(0,I.jsxs)(a.Z,{width:"100%",height:"100%",padding:{paddingTop:"spacing-s"},children:[(0,I.jsx)(Y,{isScriptWidthNarrow:e,direction:"column",children:s.map((e=>(0,I.jsx)(D,{script:e,setActiveScriptKey:i,activeScriptKey:t},e.key)))}),(0,I.jsx)(X,{children:t===P?(0,I.jsx)($,{isScriptWidthNarrow:e}):(0,I.jsx)(Q,{isScriptWidthNarrow:e})})]})}));var te=i(60398);class ie{parsePayload(e){const t=null==e?void 0:e.find((e=>e.listen===this.type));return t?t.script.exec.join("\n"):""}parsePackages(e){var t,i;const n=null==e?void 0:e.find((e=>e.listen===this.type));return null!=(t=null==n||null==(i=n.script)?void 0:i.packages)?t:{}}eagerFetchExternalPackages(){if(0!==Object.keys(this.packages).length)for(const[e]of Object.entries(this.packages))(0,v.isExternalPackageValid)(e)&&(0,v.addExternalPackage)(e,!1)}constructor(e,t){this.type=void 0,this.content="",this.packages={},this.update=e=>{this.content=this.parsePayload(e),this.packages=this.parsePackages(e)},this.setContent=e=>{this.content=e},this.setPackages=e=>{this.packages=e},this.type=e,this.content=this.parsePayload(t),this.packages=this.parsePackages(t),this.eagerFetchExternalPackages(),(0,y.makeObservable)(this,{content:!0,packages:!0,setContent:y.action,setPackages:y.action})}getPayload(){return this.content?[{listen:this.type,script:{id:(0,te.v4)(),exec:this.content.split("\n"),type:"text/javascript",packages:this.packages}}]:[]}}var ne=i(53186),oe=i(97201),re=i(85692),se=i(18767);function ae(e,t){var i,n,o,r;if(e===t)return!0;if(!e||!t)return!1;const s=(null==(i=e.find((e=>"test"===e.listen)))?void 0:i.script.exec)||[],a=(null==(n=t.find((e=>"test"===e.listen)))?void 0:n.script.exec)||[],l=(null==(o=e.find((e=>"prerequest"===e.listen)))?void 0:o.script.exec)||[],c=(null==(r=t.find((e=>"prerequest"===e.listen)))?void 0:r.script.exec)||[];return Array.isArray(s)&&Array.isArray(a)&&JSON.stringify(s)===JSON.stringify(a)&&Array.isArray(l)&&Array.isArray(c)&&JSON.stringify(l)===JSON.stringify(c)}const le=["activeAuthType"];class ce{constructor({collectionId:e}){var t=this;this.collectionId=void 0,this.isLoading=!0,this.error=null,this.unsubscribeFromCollectionCache=void 0,this.unsubscribeFromVariableSessionUpdates=null,this.metadata={},this.preRequestScript="",this.tests="",this.initialValues=[],this.sessionValues=[],this.preRequestStore=new ie("prerequest",[]),this.testScriptStore=new ie("test",[]),this.collectionAuthState=Object.assign({activeAuthType:"noauth",type:"noauth"},se.initialAuthState),this.collectionAuthSessionState=se.defaultAuthSession,this.trackedState={},this.isConflicted=!1,this.isSaving=!1,this.permissions={},this.cachedCollectionItem=void 0,this.isDeleted=!1,this.startListeningToCollectionCache=()=>{const e=new oe.MultiCacheObserver(oe.cacheClient,[(0,ne.collectionFindOneQuery)({collectionId:this.collectionId}),(0,ne.collectionPermissionsQuery)({collectionId:this.collectionId})]);this.unsubscribeFromCollectionCache=e.subscribe((e=>{this.onCollectionCacheUpdate(e[0]),this.onCollectionPermissionsUpdate(e[1])}))},this.startListeningToSessionStorage=async function(){t.unsubscribeFromVariableSessionUpdates=(0,re.subscribeToSession)({model:"collection",modelId:t.collectionId},(e=>t.onVariableSessionStorageUpdate(e))),t.onVariableSessionStorageUpdate(await(0,re.getSession)({model:"collection",modelId:t.collectionId}))},this.setTrackedState=(e,t)=>{e&&(this.trackedState=Object.assign({},this.trackedState,{[e]:t}))},this.setIsDeleted=e=>{this.isDeleted=e},this.setMetadata=e=>{this.metadata=e},this.setDescription=e=>{(0,y.transaction)((()=>{this.metadata.description=e,this.setTrackedState("description",this.metadata.description)}))},this.setPreRequestScript=e=>{(0,y.transaction)((()=>{this.preRequestStore.setContent(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)}))},this.setTests=e=>{(0,y.transaction)((()=>{this.testScriptStore.setContent(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)}))},this.onPreRequestScriptPackageChange=e=>{this.preRequestStore.setPackages(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)},this.onTestScriptPackageChange=e=>{this.testScriptStore.setPackages(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)},this.setCollectionAuthState=e=>{(0,y.transaction)((()=>{this.collectionAuthState=e;const{activeAuthType:t}=e,i=(0,f.Z)(e,le),n=Object.assign({},i,{type:t});this.setTrackedState("auth",n)}))},this.setCollectionAuthSessionState=e=>{this.collectionAuthSessionState=e},this.setVariables=e=>{const{initialValues:t,sessionValues:i}=(0,g.unZipVariables)(e);(0,y.transaction)((()=>{this.initialValues=t,this.sessionValues=i,this.setTrackedState("initialValues",t),this.setTrackedState("sessionValues",i)}))},this.setIsSaving=e=>{this.isSaving=e},this.onCollectionCacheUpdate=e=>{var t,i;const n=null==(t=e.data)?void 0:t.data,o=null==(i=e.data)?void 0:i.meta.forkedFrom;if(this.isLoading=!n&&!e.error,this.error=e.error,!n)return;const{incomingChanges:r,isConflicted:s}=function(e,t,i,n){const o={};let r=!1;if(!t)return{incomingChanges:e,isConflicted:r};for(const n of["name","auth","variables","events"])switch(n){case"events":ae(e[n],t[n])||(i[n]?r=!0:o[n]=e[n]);break;case"auth":case"name":e[n]!==t[n]&&n in i?r=!0:e[n]!==t[n]&&(o[n]=e[n]);break;case"variables":e[n]!==t.initialValues&&"initialValues"in i?r=!0:e[n]!==t.initialValues&&(o[n]=e[n])}return{incomingChanges:o,isConflicted:r}}(n,this.cachedCollectionItem,this.trackedState);this.isDirty&&s&&(0,y.runInAction)((()=>{this.isConflicted=!0})),r&&Object.keys(r).length>0&&(0,y.runInAction)((()=>{var e,t,i,r,s,a;this.collectionAuthState=n.auth&&(a=null!=(e=this.trackedState.auth)?e:n.auth)?Object.assign({},se.initialAuthState,a,{activeAuthType:a.type||"noauth"}):Object.assign({activeAuthType:"noauth",type:"noauth"},se.initialAuthState),this.initialValues=null!=(t=null!=(i=this.trackedState.initialValues)?i:n.variables)?t:[],this.preRequestStore.update(null!=(r=this.trackedState.events)?r:n.events),this.testScriptStore.update(null!=(s=this.trackedState.events)?s:n.events),this.cachedCollectionItem=n,this.metadata={id:n.id,name:n.name,description:n.description,createdAt:n.createdAt,forkInfo:o?Object.assign({label:null==o?void 0:o.forkName},o):this.metadata.forkInfo,owner:n.owner}}))},this.onCollectionPermissionsUpdate=e=>{const t=e.data;t&&(0,y.runInAction)((()=>{this.permissions=t}))},this.collectionId=e,(0,y.makeObservable)(this,{isLoading:!0,error:!0,breadcrumbs:y.computed,metadata:y.observable.ref,name:y.computed,metaInfo:y.computed,setMetadata:y.action,preRequestScript:!0,setPreRequestScript:y.action,collectionAuthState:!0,setCollectionAuthState:y.action,collectionAuthSessionState:!0,setCollectionAuthSessionState:y.action,tests:!0,setTests:y.action,variables:y.computed,initialValues:!0,sessionValues:!0,setVariables:y.action,onCollectionCacheUpdate:y.action,isDirty:y.computed,trackedState:!0,setTrackedState:y.action,isConflicted:!0,setIsSaving:y.action,isSaving:!0,permissions:!0,isForked:y.computed,isDeleted:!0,setIsDeleted:y.action,onPreRequestScriptPackageChange:y.action,onTestScriptPackageChange:y.action}),this.startListeningToCollectionCache(),this.startListeningToSessionStorage()}async onVariableSessionStorageUpdate(e){e&&(0,y.runInAction)((()=>{var t;this.sessionValues=null!=(t=null==e?void 0:e.values)?t:[]}))}get isForked(){var e;return!(null==(e=this.metadata.forkInfo)||!e.label)}get isDirty(){return Object.keys(this.trackedState).length>0}get breadcrumbs(){return null!=(e=this.metadata)&&e.name?[{name:e.name,id:e.id}]:[{id:"DEFAULT",name:x}];var e}get name(){var e;return null!=(e=this.metadata.name)?e:x}get metaInfo(){var e,t;return{createdAt:null!=(e=null==(t=this.metadata)?void 0:t.createdAt)?e:null,id:this.collectionId}}get variables(){const{initialValues:e,sessionValues:t}=this;return(0,g.zipVariables)(e,t)}resetTrackedState(){(0,y.runInAction)((()=>{this.trackedState={},this.isConflicted=!1}))}rollbackUpdates(e,t){(0,y.runInAction)((()=>{this.trackedState=e,this.isConflicted=t}))}destroy(){var e,t;null==(e=this.unsubscribeFromCollectionCache)||e.call(this),null==(t=this.unsubscribeFromVariableSessionUpdates)||t.call(this),this.trackedState={}}}const de=(0,n.createContext)({}),ue=({children:e})=>{if(!(0,b.useInRouterContext)())throw new Error("CollectionEditorProvider must be used within a Router");const{collectionId:t}=(0,b.useParams)(),i=(0,n.useMemo)((()=>new ce({collectionId:t})),[]);return(0,n.useEffect)((()=>()=>i.destroy()),[]),(0,I.jsx)(de.Provider,{value:i,children:e})},pe=()=>{const e=o().useContext(de);if(!e)throw new Error("useCollectionEditorStore should be used within a CollectionEditorContext.Provider");return e},he=()=>pe().name,me=()=>{const e=pe();return[e.metadata,e.setMetadata]};var ge=i(49886),ve=i(24502);const be=()=>{const e=pe();return{isDirty:e.isDirty,isSaving:e.isSaving,isConflicted:e.isConflicted}};var fe=i(19578);const ye=["collectionId","patch"],xe=["sessionValues","initialValues"],we=["mutate"],ke=(0,ne.updateCollectionMutation)(),Se=(e,t)=>Object.assign({},e,{values:e.values.map(((e,i)=>{var n;return null===e.value||void 0===e.value?Object.assign({},e,{value:null==(n=t[i])?void 0:n.value}):e}))}),Ce=Object.assign({},ke,{mutationFn:async e=>{let{collectionId:t,patch:i}=e,n=(0,f.Z)(e,ye);const{sessionValues:o,initialValues:r}=i,s=(0,f.Z)(i,xe),[a]=await Promise.all([ke.mutationFn(Object.assign({collectionId:t},n,{patch:Object.assign({},s,{variables:r}),options:{avoidSession:!0}})),o&&(0,re.setSession)({model:"collection",modelId:t},Se({values:o},null!=r?r:[]))]);return a}}),je=()=>{const e=pe(),t=(0,oe.useMutation)(Ce),{mutate:i}=t,n=(0,f.Z)(t,we);return Object.assign({mutate:t=>{const n=e.trackedState,o=e.isConflicted;return t&&(n.name=t),e.resetTrackedState(),e.setIsSaving(!0),i({collectionId:e.collectionId,patch:n},{onError:()=>{e.rollbackUpdates(n,o),fe.Toast.getToasts().addToast({title:"Unable to save changes",description:"Could not save changes. Please try again.",status:"error"})},onSettled:()=>{e.setIsSaving(!1)}})}},n)},Ie=je,_e=new Set(["Alt","Meta","Control","Shift"]),Ee=()=>{var e,t;const i=pe();return 0===Object.keys(i.permissions).length?{canEdit:!0,canDelete:!0}:{canEdit:null==(e=i.permissions[ne.CollectionPermissionNames.UPDATE_COLLECTION])?void 0:e.allowed,canDelete:null==(t=i.permissions[ne.CollectionPermissionNames.DELETE_COLLECTION])?void 0:t.allowed}};var Te=i(37691);const Pe=s().div.withConfig({displayName:"fork-label__ForkLabelWrapper",componentId:"sc-1m28191-0"})(["display:flex;align-items:center;overflow:hidden;"]),Ae=s().p.withConfig({displayName:"fork-label__LabelContainer",componentId:"sc-1m28191-1"})(["display:inline-block;white-space:nowrap;overflow:hidden;margin-left:var(--spacing-xs);font-size:var(--text-size-s);font-weight:var(--text-weight-regular);text-overflow:ellipsis;color:var(--content-color-tertiary);"]),Ne=({label:e})=>(0,I.jsxs)(Pe,{children:[(0,I.jsx)(Te.Z,{color:"content-color-tertiary",size:"small"}),(0,I.jsx)(Ae,{children:e})]});var Le=i(38394),Re=i(95617),ze=i(26663),Ze=i.n(ze);const Ve=({pathname:e})=>{const[t,i]=(0,n.useState)(!1),o=(0,n.useRef)(),r=(0,n.useCallback)((()=>{const t=Ze().ARTEMIS_URL;navigator.clipboard.writeText(t+e).then((()=>{i(!0),null!=o&&o.current&&clearTimeout(o.current),o.current=setTimeout((()=>{i(!1)}),1500)}))}),[e,o]);return(0,I.jsx)(p.Z,{type:"tertiary",size:"small",className:"copy-link-btn",icon:t?(0,I.jsx)(Le.Z,{size:"small",color:"base-color-success"}):(0,I.jsx)(Re.Z,{size:"small"}),onClick:r,tooltip:"Copy link to collection"})},Oe=()=>pe().metaInfo;var De=i(10099),qe=i(1590),Me=i(83354),We=i(12244);const Fe=(0,n.lazy)((0,qe.loadRemoteModule)("collection-runner/RunCollectionButton")),Ue=s().div.withConfig({displayName:"collection-meta-header__CollectionMetaHeaderContainer",componentId:"sc-5l62ez-0"})(["display:flex;flex-direction:'row';justify-content:space-between;box-sizing:border-box;height:48px;padding:var(--spacing-s) var(--spacing-s);border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"]),He=s().div.withConfig({displayName:"collection-meta-header__BreadcrumbContainer",componentId:"sc-5l62ez-1"})(["color:var(--content-color-primary);font-weight:var(--text-weight-medium);width:100%;nav{.copy-link-btn{display:none;}:hover{.copy-link-btn{display:inline-flex;}}}"]),Ke=s()(a.Z).withConfig({displayName:"collection-meta-header__LeftSectionRow",componentId:"sc-5l62ez-2"})(["width:100%;padding:var(--spacing-xs);overflow:hidden;"]),Be=(0,w.observer)((()=>{const e=pe().breadcrumbs,t=he(),{isDirty:i,isConflicted:o}=be(),{canEdit:r}=Ee(),{mutate:s}=je(),[l]=me(),{pathname:p}=(0,R.useLocation)(),h=(0,n.useRef)(null),{rename:m}=(0,R.useAdditionalRouteContext)();(0,n.useEffect)((()=>{var e;m&&(null==(e=h.current)||e.triggerRenameMode())}),[m]);const{setTabTitle:g}=(0,R.useTabTitleMeta)();(0,n.useEffect)((()=>{g(t,"collection",{isDirty:i,isConflicted:o})}),[t,i,o]);const v=null==l?void 0:l.forkInfo,b=e=>{e!==t&&s(e)};return null!=l&&l.name?(0,I.jsx)(Ke,{direction:"row",shrink:"1",grow:"0",alignItems:"center",gap:"spacing-s",children:(0,I.jsx)(He,{children:(0,I.jsx)(d.aG,{appendActions:(0,I.jsx)(Ve,{pathname:p}),metaInfo:{custom:(0,I.jsxs)(a.Z,{alignItems:"center",gap:"spacing-s",children:[(null==v?void 0:v.label)&&(0,I.jsx)(Ne,{label:v.label}),!r&&(0,I.jsx)(ge.Z,{title:"You do not have permissions to edit this collection"})]})},ref:h,children:e.map((e=>(0,I.jsx)(u.Z,{enableRename:r,renameInputConfig:{onSubmit:b,value:t},itemData:e,children:e.name},e.name)))})})}):(0,I.jsx)(c.Z,{})})),$e=(0,w.observer)((()=>{const{isDirty:e,isSaving:t,isConflicted:i}=be(),{mutate:o}=je(),{canEdit:r}=Ee(),s=(0,De.useActiveWorkspaceId)(),{userCanRunCollection:l}=(0,ne.useWorkspacePermissions)(s),d=Oe(),{data:u}=(0,We.useGetGitLinkedEntity)({entityId:d.id,entityType:"collection"}),b=r&&e&&!(null!=u&&u.data),f=he(),y=m.Modals.getModals(),[x]=j(),[w]=C(),k=fe.Toast.getToasts(),S=async()=>{if(!b&&null!=u&&u.data)return void k.addToast({title:"Unable to save changes",description:"This collection is connected to a Git repository. To make changes, use Postman Web/Desktop App.",status:"error"});if(!r||!e)return;if(!i)return(0,v.trackPackagesSaved)(w,x,A),o();const t=await y.showWarningDialog({uid:"collections-workbench-tab-conflict-confirmation",subject:"DO YOU WANT TO SAVE?",message:`This tab ${f} has been modified from another tab. Saving these changes will overwrite this collection.`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Save and overwrite",isPrimary:!0}]});return t&&"Save and overwrite"===t.title?((0,v.trackPackagesSaved)(w,x,A),o()):void 0},_=()=>!b&&null!=u&&u.data?"This collection is connected to a Git repository. To make changes, use Postman Web/Desktop App.":"";return(({ctrlKey:e,shiftKey:t,altKey:i,keys:o,callback:r})=>{const s=(0,n.useRef)([]),a=(0,n.useRef)(!1),l=(0,n.useRef)(!1),c=(0,n.useRef)(!1),d=(0,n.useRef)(null),u=(0,n.useRef)(r);u.current=r,(0,n.useEffect)((()=>{const n=n=>{if((n.ctrlKey||n.metaKey)&&(a.current=!0),n.shiftKey&&(l.current=!0),n.altKey&&(c.current=!0),!_e.has(n.key)&&Array.isArray(o)){const e=o.findIndex((e=>e.toLowerCase()===n.key.toLowerCase()));-1!==e&&(s.current[e]=n.key)}const r=!e||a.current,p=!t||l.current,h=!i||c.current;if(d.current=setTimeout((()=>{a.current=!1,l.current=!1,c.current=!1,s.current=[]}),2500),r&&p&&h){if(Array.isArray(o)&&((e,t)=>{let i=0;for(const o of e){var n;if(o.toLowerCase()!==(null==(n=t[i])?void 0:n.toLowerCase()))return!1;i++}return!0})(o,s.current))return u.current();if(o===n.key)return u.current()}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n),d.current&&clearTimeout(d.current)}}),[e,t,i,o])})({ctrlKey:!0,keys:"s",callback:S}),(0,I.jsxs)(a.Z,{className:"request-meta-header-right-section",direction:"row",alignItems:"center",gap:"spacing-s",children:[(0,I.jsx)(n.Suspense,{fallback:(0,I.jsx)(c.Z,{}),children:(0,I.jsx)(Fe,{isDisabled:!l,collectionId:d.id})}),(0,I.jsx)(p.Z,Object.assign({type:"tertiary",text:t?"Saving...":"Save",isDisabled:!b||t,onClick:S,icon:(0,I.jsx)(ve.Z,{})},_()?{tooltip:(0,I.jsx)(h.Z,{content:_()})}:{})),(0,I.jsx)(Me.ShareButton,{entityType:"collection",entityId:d.id,entityName:f}),(0,I.jsx)(g.ActiveEnvironmentSelector,{})]})})),Ge=()=>(0,I.jsxs)(Ue,{children:[(0,I.jsx)(Be,{}),(0,I.jsx)($e,{})]});var Je=i(15761),Qe=i(27366),Ye=i(71132),Xe=i(27162),et=i(5246);const tt=()=>{const e=pe();return[e.variables,e.setVariables]},it=(0,w.observer)((()=>{const[e]=tt();return(0,I.jsxs)(I.Fragment,{children:["Variables",e.length>0&&(0,I.jsx)(E,{})]})})),nt=()=>{const e=pe();return[e.collectionAuthState,e.setCollectionAuthState]},ot=(0,w.observer)((()=>{const[e]=nt();return(0,I.jsxs)(I.Fragment,{children:["Authorization",e.activeAuthType&&"noauth"!==e.activeAuthType&&(0,I.jsx)(E,{})]})}));var rt=i(71453);const st=s()(a.Z).withConfig({displayName:"collection-no-auth__NoAuthContainer",componentId:"sc-1ajyu6r-0"})(["width:100%;height:100%;align-items:center;justify-content:center;text-align:center;"]),at=s()(R.Link).withConfig({displayName:"collection-no-auth__AuthorizationLink",componentId:"sc-1ajyu6r-1"})(["display:inline-flex;align-items:center;text-decoration:underline;color:var(--content-color-secondary);"]),lt=()=>(0,I.jsxs)(at,{type:"link-default",to:"https://go.pstmn.io/docs-auth",target:"_blank",rel:"noopener noreferer",children:["authorization",(0,I.jsx)(rt.Z,{})]}),ct=()=>(0,I.jsx)(st,{children:(0,I.jsxs)("div",{children:["This collection does not use any authorization. Learn more aboutÂ ",(0,I.jsx)(lt,{})]})}),dt=(0,w.observer)((function(){const[e,t]=nt(),[i,o]=(()=>{const e=pe(),[t]=me(),{value:i,setValue:o}=(0,se.useAuthSessionSafe)({model:"collection",modelId:t.id});return(0,n.useEffect)((()=>{i&&e.setCollectionAuthSessionState(i)}),[i,e]),[e.collectionAuthSessionState,(t,i)=>{const n=Object.assign({},e.collectionAuthSessionState);n.oauth2||(n.oauth2=[]),n.oauth2=n.oauth2.filter((e=>"token_id"!==e.key)),n.oauth2.push({key:t,value:i}),o(n)}]})();return(0,I.jsx)(se.AuthPanel,{authState:e,authSessionState:i,authDescriptions:{noauth:(0,I.jsx)(ct,{})},disabledAuthTypes:["inherit"],setAuthState:t,setAuthSessionState:o})}));var ut=i(19956);const pt=["entityType","isEditable","bleed","onChange","values"],ht=s().div.withConfig({displayName:"variable-editor__StyledVariablesEditor",componentId:"sc-bsbj66-0"})(["flex:1;display:flex;flex-direction:column;overflow:hidden;padding:0 var(--spacing-l);"]),mt=function(e){const{entityType:t="collection",isEditable:i=!0,bleed:n=!1,onChange:o,values:r}=e,s=(0,f.Z)(e,pt);return(0,I.jsx)(ht,{children:(0,I.jsx)(ut.KeyValueEditor,Object.assign({enableScroll:!0,tableName:`Variables Editor - ${t}`,entityType:t,keyHeading:"Variable",valueHeading:"Initial value",sessionHeading:"Current value",keyPlaceholder:"Add new variable",valuePlaceholder:"",values:r,onChange:o,showColumns:["key","value","sessionValue"],allowedColumns:["key","value","sessionValue"],containment:{bleed:n},nonEditableKeys:!i,nonEditableValues:!i,nonEditableToggles:!i,nonEditableVariableTypes:!i,enableFiltering:!0,disableMultilineKey:!0,disableMultilineValue:!0,disallowDuplicates:!0},s))})},gt=s().div.withConfig({displayName:"variables-table__StyledHeading",componentId:"sc-vxmldj-0"})(["display:flex;flex-direction:column;justify-content:center;box-sizing:border-box;height:var(--size-m);font-size:var(--text-size-m);color:var(--content-color-secondary);font-weight:var(--text-weight-medium);margin:var(--spacing-xs) var(--spacing-zero);padding:var(--spacing-zero) var(--spacing-l);"]),vt=(0,w.observer)((()=>{const[e,t]=tt();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(gt,{children:"Variables"}),(0,I.jsx)(mt,{values:e,onChange:t})]})})),bt=vt;var ft=i(83701),yt=i(74962),xt=i(91214),wt=i(80809);const kt="collection-workbench-description-paint-time",St="collection-workbench-author-paint-time",Ct="collection-workbench-description-paint-mark",jt="collection-workbench-author-paint-mark",{PerformanceMarkPaint:It}=wt.perfComponents,_t=()=>{performance.measure(St,{},jt),(0,wt.sendMeasureEvent)({name:St})},Et=s().div.withConfig({displayName:"entity-meta-info-view__EntityMetaInfoContainer",componentId:"sc-39k1zh-0"})(["display:flex;flex-direction:column;gap:var(--spacing-l);padding-bottom:var(--spacing-xl);"]),Tt=s()(yt.Z).withConfig({displayName:"entity-meta-info-view__ItemLabel",componentId:"sc-39k1zh-1"})(["display:flex;margin-bottom:var(--spacing-xs);cursor:default;user-select:none;"]),Pt=s().div.withConfig({displayName:"entity-meta-info-view__ItemContent",componentId:"sc-39k1zh-2"})(["display:flex;align-items:center;overflow:hidden;"]),At=s()(Pt).withConfig({displayName:"entity-meta-info-view__OwnerItemContent",componentId:"sc-39k1zh-3"})(["display:flex;gap:var(--spacing-s);"]),Nt=e=>{const t=`/users/${e}`;return Ze().ARTEMIS_URL+t};function Lt({info:e}){const[t,i]=(0,n.useState)(),{createdAt:o}=e||{},r=o&&new Date(o),s=r&&`${r.toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"})}, ${r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`;return(0,n.useEffect)((()=>{(async()=>{if(e.owner){const t=await(0,ne.getUserInfo)({userIds:[e.owner],type:"user"}),n=t&&t[e.owner];i(n)}})()}),[e.owner]),(0,I.jsxs)(Et,{"data-testid":"entity-meta-info",children:[t&&(0,I.jsx)(It,{markName:jt,callback:_t,children:(0,I.jsxs)("div",{children:[(0,I.jsx)(Tt,{type:"h6",text:"Created by",color:"content-color-secondary"}),(0,I.jsxs)(At,{className:"entity-meta-info__item__content",children:[(0,I.jsx)(xt.Z,{type:"user",userId:t.is_accessible?t.id:null,src:t.is_accessible?t.profile_pic_url:null,size:"m"}),(0,I.jsx)(R.Link,{to:Nt(t.id),target:"_blank",children:(0,I.jsx)(N.ZP,{type:"body-medium",color:"content-color-primary",children:String(window.USER_ID)===String(t.id)?"You":t.name})})]})]})}),o&&s&&(0,I.jsxs)("div",{children:[(0,I.jsx)(Tt,{type:"h6",text:"Created on",color:"content-color-secondary"}),(0,I.jsx)(Pt,{className:"entity-meta-info__item__content",children:(0,I.jsx)("div",{className:"entity-meta-info__item__content__date",title:s,children:(0,I.jsx)(N.ZP,{type:"body-medium",color:"content-color-primary",children:s})})})]})]})}const Rt=s()(R.Link).withConfig({displayName:"view-full-documentation-link__StyledLink",componentId:"sc-fakxit-0"})(["z-index:1;box-sizing:border-box;bottom:0;display:flex;align-self:end;align-items:center;cursor:pointer;font-size:var(--text-size-m);color:var(--content-color-link);font-weight:var(--text-weight-regular);background:var(--background-color-primary);padding:var(--spacing-s);flex-shrink:0;> i{margin-left:var(--spacing-xs);}"]),zt=s()(a.Z).withConfig({displayName:"view-full-documentation-link__StyledFlex",componentId:"sc-fakxit-1"})(["border-top:var(--border-style-solid) var(--border-width-default) var(--border-color-default);margin-right:var(--spacing-l);padding-left:var(--spacing-s);padding-bottom:var(--spacing-l);"]),Zt=(e,t)=>`/workspace/${t}/documentation/${e}`;function Vt({collectionId:e}){const t=(0,De.useActiveWorkspaceId)();return(0,I.jsx)(zt,{alignItems:"center",gap:"spacing-s",justifyContent:"space-between",children:(0,I.jsxs)(Rt,{to:Zt(e,t),customNavEvent:"VIEW_COLLECTION_FOLDER_REQUEST",children:[(0,I.jsx)("span",{children:"View complete documentation"}),(0,I.jsx)(rt.Z,{color:"content-color-link"})]})})}function Ot(e){const t=(0,n.useRef)();return t.current=e,(0,n.useCallback)(((...e)=>{const i=t.current;if(!i)throw new Error("Event handler wrapped in `useEventHandler` called during render, it may only be called in effects or at any other time.");return i(...e)}),[])}var Dt=i(43753);const qt=(0,n.lazy)((0,qe.loadRemoteModule)("mimir-editor/MimirEditor")),Mt=o().forwardRef(((e,t)=>(0,I.jsx)(n.Suspense,{fallback:(0,I.jsx)(c.Z,{}),children:(0,I.jsx)(qt,Object.assign({},e,{ref:t}))})));var Wt=i(21180),Ft=i(56880);const Ut="Postman editor",Ht="context-view",Kt=s()(ft.Z).withConfig({displayName:"collection-description-editor__DocumentationResponsiveContainer",componentId:"sc-mzrzsv-0"})(["position:relative;font-size:var(--text-size-m);line-height:var(--line-height-m);width:100%;cursor:text;box-sizing:border-box;margin-top:",";border-radius:var(--border-radius-default);border:var(--border-width-default) var(--border-style-solid) transparent;"," &:hover{background-color:var(--background-color-secondary);background-color:",";}& .description-preview{padding:0;&__placeholder{padding:var(--spacing-m);}&__markdown{padding:var(--spacing-m);}}& .mimir{min-height:","px !important;& .editor__container{margin-top:6px;height:fit-content;& div[data-slate-editor='true']{min-height:","px !important;padding:var(--spacing-m);max-height:fit-content;width:auto;box-sizing:border-box;}}& .toolbar__anchor{height:auto;background:var(--background-color-primary);display:",";align-items:center;z-index:100;position:sticky;top:0;margin-top:-36px;background-color:transparent;border-radius:var(--border-radius-default);& .slate-HeadingToolbar{width:100%;min-height:unset;border-radius:var(--border-radius-default) var(--border-radius-default);border:var(--border-width-default) solid var(--border-color-strong);box-shadow:",";height:28px;.toolbar__wrapper{padding-right:0;}.toolbar__info{display:none;}.toolbar__list{height:fit-content;}.toolbar__dropdown{top:30px;}.toolbar__dropdown__heading{cursor:pointer;}& .toolbar__toggle{display:flex;padding-right:",";& > button{height:22px;padding:0 4px;margin-top:3px;}& .aether-dropdown__control{background:transparent;height:28px;border:none;&--is-focused{border:none;box-shadow:none;&:hover{border:none;box-shadow:none;}}}}}}","}"," ",""],(e=>e.source===Ht?"34px":"0"),(e=>e.editable&&e.editMode&&(0,r.css)(["border-color:var(--base-color-info);"])),(e=>e.editable&&!e.editMode?"var(--background-color-secondary)":"transparent"),(e=>e.minimumEditorHeight),(e=>e.minimumEditorHeight),(e=>e.isInViewPort?"flex":"none"),(e=>"0px 2px 4px "+(e.theme["content-color-primary"]===Dt.dark["content-color-primary"]?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.05)")),(e=>e.source===Ht?"var(--spacing-s)":"0"),(e=>!e.editMode&&(0,r.css)(["a{cursor:pointer;}.slate-codeblock-wrapper{cursor:pointer;& pre{cursor:text;}}.image-balloon-container,.image-handle.handle-right,.image-handle.handle-left,.link-balloon-container.edit,.media-balloon-container,.link-balloon-container{display:none;}.image-element.selected .image-item{opacity:1;box-shadow:unset;}"])),(e=>!e.editMode&&(0,r.css)(["[contenteditable] ~ grammarly-extension,input ~ grammarly-extension,textarea ~ grammarly-extension{display:none;}"])),(e=>e.editMode?(0,r.css)(["figure{.image-caption::placeholder{visibility:visible;}}"]):(0,r.css)(["figure{.image-caption::placeholder{visibility:hidden;}}"]))),Bt=s().div.withConfig({displayName:"collection-description-editor__SavingLoader",componentId:"sc-mzrzsv-1"})(["position:absolute;inset:0;background-color:var(--background-color-primary);opacity:0.75;z-index:1;transition:opacity 100ms ease-in-out;"]),$t=({source:e,onSave:t,editable:i,isOffline:o,entityType:r,placeholder:s,entityDescription:a,modelDetails:l,isEntityLoading:c,resolvedEntityDescription:d,minimumEditorHeight:u=75,disableMarkdownEditor:p=!1,updateParentAboutContainerDimension:h,isBigFontSize:m=!1})=>{var g,v;const b=(0,n.useRef)(),f=(0,n.useRef)(!1),[y,x]=(0,n.useState)(!1),[w,k]=(0,n.useState)(a),[S,C]=(0,n.useState)(Ut),j=Ut,[_,E]=(0,n.useState)(null!=d?d:a);(0,n.useEffect)((()=>{k(a),E(d)}),[a,d]);const T=Ot((()=>{i&&(C(j),x(!0))})),[P,A]=((e,t,i)=>{const o=(0,n.useRef)(null),r=(0,n.useRef)(0),s=(0,n.useRef)(),a=(0,n.useRef)(!1),l=(0,n.useRef)(!1),[c,d]=(0,n.useState)(!1),u=Ot((t=>{const i=t.target,n=null!==i.closest(".slate-codeblock-wrapper")&&null==i.closest("pre"),s=void 0!==i.ownerSVGElement,l=null!==i.closest(".markdown-editor")||null!==i.closest(".toolbar__toggle")||null!==i.closest(".team-usage-error"),c=null!==i.closest(".media-element"),d=i.closest("[data-entity-id='click-to-expand-button']");if(n||s||l||d)return;c&&(t.preventDefault(),t.stopPropagation());const u=null!==i.closest("a");if(u){var p;t.preventDefault();const e=i.closest("a"),n=null==e?void 0:e.href,r=null==(p=o.current)?void 0:p.querySelector(":focus");null==r||r.blur(),n&&(0,R.openExternalLink)(n)}a.current||r.current>1||u||e()})),p=Ot((t=>{if(2!==t.button){if(""===i)return e();r.current=t.detail,l.current=!0,s.current&&(clearTimeout(s.current),s.current=void 0),s.current=setTimeout((()=>{1===r.current&&u(t),r.current=0}),300)}})),h=Ot((e=>{2!==e.button&&(l.current=!1)})),m=Ot((()=>{a.current=!!l.current})),g=Ot((t=>{const i=t.target,n=null!==(null==i?void 0:i.closest(".markdown-editor"))||null!==(null==i?void 0:i.closest(".toolbar__toggle"));(t.ctrlKey||t.metaKey)&&"c"===t.key||n||!o.current||t.target!==o.current&&!o.current.contains(t.target)||1!==t.key.length&&"Backspace"!==t.key&&"Delete"!==t.key&&"Enter"!==t.key&&"Tab"!==t.key||e()}));return(0,n.useEffect)((()=>{if(t)return;const e=o.current;return null==e||e.addEventListener("mouseup",h),null==e||e.addEventListener("mousedown",p),null==e||e.addEventListener("mousemove",m),null==e||e.addEventListener("keydown",g),()=>{null==e||e.removeEventListener("mouseup",h),null==e||e.removeEventListener("mousedown",p),null==e||e.removeEventListener("mousemove",m),null==e||e.removeEventListener("keydown",g)}}),[t]),(0,n.useEffect)((()=>{const e=new IntersectionObserver((([e])=>d(e.isIntersecting)),{threshold:0});return o.current&&e.observe(o.current),()=>{o.current&&e.unobserve(o.current)}}),[]),[o,c]})(T,y,w),N=Ot((e=>{P.current&&(P.current.style.minHeight=`${e}px`,h&&h(e))})),L=Ot((e=>{f.current=!!e})),z=(0,n.useCallback)((async()=>{if(!f.current&&!o&&t&&b.current){var e,i;const n=null!=a?a:"",o=null!=(e=null==(i=b.current)?void 0:i.slateToMD())?e:"",r=n!==o;try{r&&(await t(o),Ft.AnalyticsService.addEventV2({category:"documentation",action:"save",label:"overview",value:1,entityType:"collection"})),x(!1)}catch(e){T()}}}),[o,a,null==b?void 0:b.current,null==f?void 0:f.current]);return(0,I.jsx)(Wt.CustomErrorBoundary,{appId:"collection-workbench",errorElementId:"collection-description-editor",fallback:(0,I.jsx)(Wt.GenericErrorMessage,{title:"Couldn't load documentation",description:"Just a faulty wire. Try reloading.",illustration:"illustration-internal-server-error"}),children:(0,I.jsxs)(Kt,{ref:P,isInViewPort:A,type:"column",span:8,mobile:12,overflow:"unset",editMode:y,minimumEditorHeight:u,editable:i,width:null==(g=P.current)?void 0:g.offsetWidth,positionFromTop:null==(v=P.current)?void 0:v.offsetTop,className:"entity-description-container",editor:S,source:e,children:[c&&(0,I.jsx)(Bt,{}),(0,I.jsx)(Mt,{ref:b,source:e,autoFocus:!1,readOnly:!i,showToolbar:y,isOffline:o,initialValue:y?w:_,modelDetails:l,onChange:z,context:"wysiwyg",enableAutoSaveOnBlur:i,inputFormat:"markdown",onEditorHeightChange:N,updateMediaUploadStatus:L,showEditorToggle:!p&&y,isEnvironmentResolutionEnabled:!0,isBigFontSize:m,placeholder:i?null!=s?s:`Add ${r?r+" ":""}description`:`This ${r||"item"} doesn't have a description.`})]})})},Gt=(0,n.memo)($t);var Jt=i(21466);const{PerformanceMarkPaint:Qt}=wt.perfComponents,Yt=()=>{performance.measure(kt,{},Ct),(0,wt.sendMeasureEvent)({name:kt})},Xt=s()(a.Z).withConfig({displayName:"collection-overview__Container",componentId:"sc-1u4lecz-0"})(["overflow-y:auto;padding-top:var(--spacing-xxxl);padding-left:var(--spacing-l);height:100%;"]),ei=s()(ft.Z).withConfig({displayName:"collection-overview__ParentResponsiveContainer",componentId:"sc-1u4lecz-1"})(["width:100%;height:100%;"]),ti=s()(ft.Z).withConfig({displayName:"collection-overview__DocumentationResponsiveContainer",componentId:"sc-1u4lecz-2"})(["font-size:var(--text-size-m);line-height:var(--line-height-m);grid-template-rows:1fr auto;box-sizing:border-box;position:relative;row-gap:12px;height:100%;min-height:unset;padding-bottom:var(--spacing-zero);overflow:visible;.description-preview{overflow:auto;height:fit-content;max-height:100%;flex:1;&__markdown{word-break:break-word;}}.entity-description-container{width:100%;margin-bottom:var(--spacing-zero);& .mimir{.toolbar__anchor{top:-48px;.toolbar__wrapper{padding-right:var(--spacing-zero);}}}}"]),ii=s()(a.Z).withConfig({displayName:"collection-overview__CollectionDescriptionEditorContainer",componentId:"sc-1u4lecz-3"})(["overflow:visible;"]),ni=(0,w.observer)((function(){const[e]=me(),{canEdit:t}=Ee(),{mutate:i}=Ie(),[o,r]=(()=>{const e=pe();return[e.metadata.description,e.setDescription]})(),s=Oe(),{collectionId:l}=(0,b.useParams)(),{data:c}=(0,g.useActiveVariables)(),[d,u]=(0,n.useState)(o);return(0,n.useMemo)((()=>{const e=(0,te.v4)();Jt.VSCodeCommunicationsService.postMessageToExtension({type:"RESOLVE_VARIABLES",payload:{objectToResolve:{description:JSON.parse(JSON.stringify(o))},variables:c,id:e}}),Jt.VSCodeCommunicationsService.subscribe("RESOLVED_VARIABLES",(t=>{if(!t)return;const{id:i,resolvedObject:n}=t;i===e&&n&&u(n.description)}))}),[o,c]),(0,I.jsx)(Xt,{children:(0,I.jsxs)(ei,{type:"row",maxWidth:"container-width-medium",overflow:"unset",children:[(0,I.jsx)(ti,{type:"column",span:8,mobile:12,minHeight:"100%",children:(0,I.jsx)(Qt,{markName:Ct,callback:Yt,children:(0,I.jsxs)(ii,{direction:"column","data-testid":"collection-description-editor-container",children:[(0,I.jsx)(Gt,{entityId:l,onSave:e=>{r(e),i()},entityType:"collection",editable:t,entityDescription:o,resolvedEntityDescription:null!=d?d:"",source:"collection-overview",isEntityLoading:!1,minimumEditorHeight:120,isOffline:!1,modelDetails:{model:"collection",modelId:l},updateParentAboutContainerDimension:()=>{},placeholder:"Make things easier for your teammates with a complete collection description."}),l&&(0,I.jsx)(Vt,{collectionId:l})]})})}),s&&(0,I.jsx)(ft.Z,{type:"column",span:3,mobile:12,padding:{paddingRight:"spacing-s",paddingLeft:"spacing-s"},overflow:"unset",children:(0,I.jsx)(a.Z,{gap:"spacing-l",direction:"column",children:(0,I.jsx)(Lt,{info:{createdAt:null==s?void 0:s.createdAt,owner:e.owner}})})})]})})})),oi=(0,n.lazy)((0,qe.loadRemoteModule)("collection-runner/CollectionRunsHistory")),ri=s()(fe.PaneContent).withConfig({displayName:"collection-editor__StyledPaneContent",componentId:"sc-3bbfa0-0"})(["box-sizing:border-box;height:100%;width:100%;overflow:hidden;"]),si=s()(Je.Z).withConfig({displayName:"collection-editor__StyledTabHeaders",componentId:"sc-3bbfa0-1"})(["box-sizing:border-box;padding:var(--spacing-zero) var(--spacing-s);width:100%;"]),ai=s()(Je.Z).withConfig({displayName:"collection-editor__StyledTabs",componentId:"sc-3bbfa0-2"})(["box-sizing:border-box;padding:var(--spacing-zero) var(--spacing-s);&,> div,> div > div{display:flex;flex-direction:column;flex:1;overflow:hidden;}"]),li=s().div.withConfig({displayName:"collection-editor__StyledDiv",componentId:"sc-3bbfa0-3"})(["width:100%;height:100%;"]),ci=()=>(0,I.jsx)(fe.PaneHeader,{defaultLayout:"horizontal",horizontalComponent:null,width:{default:400,collapsed:33,uncollapsed:400,min:300,resizableByDefault:!0},verticalComponent:(0,I.jsx)(fe.PaneLabel,{layout:"vertical",label:"Collection Editor",arrowDirection:"right"})}),di=s()(a.Z).withConfig({displayName:"collection-editor__TabHeadersWrapper",componentId:"sc-3bbfa0-4"})(["padding-inline-end:var(--spacing-l);"]),ui=["overview","authorization","scripts","variables","runs"],pi=()=>{const[e]=(0,R.useSearchParams)(),t=e.get("tab"),i=t&&ui.includes(t)?ui.indexOf(t):0,[r,s]=o().useState(i),[a,l]=(0,n.useState)(0),c=o().useRef(null);return(0,n.useEffect)((()=>{const e=()=>{c.current&&l(c.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,I.jsxs)(li,{ref:c,children:[(0,I.jsx)(hi,{switchTab:s}),(0,I.jsx)(ri,{children:(0,I.jsx)(mi,{activeTabIndex:r,containerWidth:a})})]})},hi=e=>{const[t]=(0,R.useSearchParams)(),i=t.get("tab"),n=i&&ui.includes(i)?ui.indexOf(i):0,[r,s]=o().useState(n);return(0,I.jsx)(di,{children:(0,I.jsx)(si,{activeTabIndex:r,onChange:function(t){s(t),e.switchTab(t)},type:"primary",incrementallyCreateTabs:!0,destroyInactiveTabs:!0,"data-testid":"collection-tab-panel",children:(0,I.jsxs)(Qe.Z,{children:[(0,I.jsx)(Ye.Z,{label:"Overview"}),(0,I.jsx)(Ye.Z,{label:(0,I.jsx)(ot,{})}),(0,I.jsx)(Ye.Z,{label:(0,I.jsx)(T,{})}),(0,I.jsx)(Ye.Z,{label:(0,I.jsx)(it,{})}),(0,I.jsx)(Ye.Z,{label:"Runs"})]})})})},mi=e=>(0,I.jsx)(ai,{activeTabIndex:e.activeTabIndex,incrementallyCreateTabs:!0,destroyInactiveTabs:!0,children:(0,I.jsxs)(Xe.Z,{children:[(0,I.jsx)(et.Z,{children:(0,I.jsx)(ni,{})}),(0,I.jsx)(et.Z,{children:(0,I.jsx)(dt,{})}),(0,I.jsx)(et.Z,{children:(0,I.jsx)(ee,{isScriptWidthNarrow:e.containerWidth<800})}),(0,I.jsx)(et.Z,{children:(0,I.jsx)(bt,{})}),(0,I.jsx)(et.Z,{children:(0,I.jsx)(n.Suspense,{fallback:(0,I.jsx)(c.Z,{}),children:(0,I.jsx)(oi,{})})})]})}),gi=e=>Object.assign({},(0,ne.collectionFindOneQuery)({collectionId:e}),{select:e=>e.data}),vi=({children:e})=>{const t=(0,De.useActiveWorkspaceId)(),{collectionId:i}=(0,b.useParams)(),n=new g.VariablesContextStore({collectionFetchOptions:gi(i)},{workspaceId:t});return(0,I.jsx)(g.VariablesContextProvider,{store:n,children:e})};var bi=i(49437),fi=i(80047);const yi=s()(a.Z).withConfig({displayName:"coming-soon__ComingSoonWrapper",componentId:"sc-a70trz-0"})(["overflow:hidden;"]);function xi({description:e}){return(0,I.jsx)(yi,{direction:"column",height:"100%",justifyContent:"center",alignItems:"center",children:(0,I.jsx)(bi.Z,{title:"Coming Soon",description:e,children:(0,I.jsx)(fi.Z,{name:"illustration-no-custom-domain"})})})}const wi=()=>{const{isDeleted:e,setIsDeleted:t}=(0,n.useContext)(de);return[e,t]},ki=s()(a.Z).withConfig({displayName:"workbench-wrapper__CollectionWorkbenchContainer",componentId:"sc-x3rbex-0"})(["height:var(--wp-workbench-height);width:100vw;min-width:650px;max-width:100%;background-color:var(--background-color-primary);color:var(--content-color-primary);overflow:hidden;"]),Si=(0,w.observer)((({children:e})=>{const[t]=wi(),{isLoading:i,error:n}=(()=>{const e=pe();return{isLoading:e.isLoading,error:e.error}})(),o=(0,b.useParams)().collectionId,r=(()=>{const[,e]=wi(),t=Oe();return i=>{var n;const o=i.data;if("update_elements"===(null==(n=i.meta)?void 0:n.action))for(const i of o){const n=i.op,o=i.value,r=i.path;"remove"===n&&r.includes("/elements/collections")&&t.id===o&&e(!0)}}})();if((0,De.useWorkspaceSubscription)(o,r),(0,ne.useCollectionSubscription)({collectionId:o||"",workspaceId:(0,De.useActiveWorkspaceId)()}),!i&&n)throw n;return t?(0,I.jsx)(Wt.GenericErrorMessage,{title:"Couldn't find the collection",description:"It might have been moved or deleted.",illustration:"illustration-unable-to-load"}):(0,I.jsx)(ki,{direction:"column",children:i?(0,I.jsx)(c.Z,{size:"large",description:"Loading Collection"}):e})})),Ci=s()(a.Z).withConfig({displayName:"collection-workbench__PaneWrapper",componentId:"sc-1i28mc1-0"})(["overflow:hidden;flex:1;min-width:650px;max-width:100%;"]),ji=()=>{const e=(0,I.jsx)(ue,{children:(0,I.jsx)(vi,{children:(0,I.jsx)(l.VW,{children:(0,I.jsx)(fe.Toast.Ui.ToastEventEmitter,{children:(0,I.jsxs)(Si,{children:[(0,I.jsx)(Ge,{}),(0,I.jsxs)(Ci,{direction:"column",children:[(0,I.jsx)(ci,{}),(0,I.jsx)(pi,{})]})]})})})})});return ne.ENABLE_COLLECTIONS?e:(0,I.jsx)(xi,{description:"Collections coming soon"})}}}]);
//# sourceMappingURL=6541.267eac85fd5d85c5.js.map