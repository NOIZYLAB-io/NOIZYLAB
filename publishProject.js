import{a as Le}from"./chunk-ZULJAP3W.js";import{b as Ie}from"./chunk-QSSPXKNC.js";import{a as je,b as Ve,c as Be}from"./chunk-ZI34IKBE.js";import{a as Re}from"./chunk-FOF4SQ2Y.js";import"./chunk-FFE62TXH.js";import{Ab as Se,Cb as J,Pc as Te,Qc as Ae,Sc as Ee,Tc as Oe,Uc as ke,Wc as Fe,Xa as fe,Z as xe,_ as be,ad as j,bd as K,c as m,d as z,f as to,gc as ae,ha as he,hc as ie,ic as qe,jc as De,k as F,kc as we,lc as le,mb as Ce,nb as ye,nc as Ne,p as P,sb as ve,t as me,tb as N,u as ue,wb as M,xb as Z,y as ge,yb as ne,zb as Pe}from"./chunk-M3U674VW.js";var Ye=m(to());var oe=m(z());var Y=m(z());var Me=m(P()),A=(0,Y.createContext)(void 0),ze=({children:e})=>{let{extensionRpc:t}=Ve(),r=(0,Y.useMemo)(()=>({formAction:o=>t.action("formAction",{event:o}),publishNow:o=>t.action("publishNow",o??{}),generatePublishScript:()=>t.action("generatePublishScript"),selectPublishProfile:()=>t.action("selectPublishProfile"),savePublishProfile:o=>t.action("savePublishProfile",{publishProfileName:o}),openConnectionDialog:()=>t.action("openConnectionDialog"),closeMessage:()=>t.action("closeMessage"),updateDeploymentOptions:o=>t.action("updateDeploymentOptions",{deploymentOptions:o}),updateSqlCmdVariables:o=>t.action("updateSqlCmdVariables",{variables:o}),revertSqlCmdVariables:()=>t.action("revertSqlCmdVariables"),extensionRpc:t}),[t]);return(0,Me.jsx)(A.Provider,{value:r,children:e})};var Qe="microsoft-sovereign-cloud",so="environment",ro="customEnvironment",ho=`${Qe}.${so}`,fo=`${Qe}.${ro}`;var He="1433";var h={PublishProfilePath:"publishProfilePath",ServerName:"serverName",DatabaseName:"databaseName",PublishTarget:"publishTarget",SqlCmdVariables:"sqlCmdVariables",ContainerPort:"containerPort",ContainerAdminPassword:"containerAdminPassword",ContainerAdminPasswordConfirm:"containerAdminPasswordConfirm",ContainerImageTag:"containerImageTag",AcceptContainerLicense:"acceptContainerLicense"},Co=[h.ContainerPort,h.ContainerAdminPassword,h.ContainerAdminPasswordConfirm,h.ContainerImageTag,h.AcceptContainerLicense],_e=He;function l(e,t){return Be(e,t)}var G=m(z());var v=m(P());function ee(e){return e?e.isValid?"none":"error":"none"}function V(e,t,r,o){if(!e||e.hidden||e.type!=="input"&&e.type!=="password")return;let a=e.type==="password",n=u=>{o?.onChange?.(u),r&&r.formAction({propertyName:e.propertyName,isAction:!1,value:u,updateValidation:!0})},x=u=>{r&&r.formAction({propertyName:e.propertyName,isAction:!1,value:u,updateValidation:!0})};return(0,v.jsx)(M,{required:e.required,label:e.label,validationMessage:e.validation?.validationMessage,validationState:ee(e.validation),orientation:"horizontal",children:(0,v.jsx)(J,{size:"small",type:a?o?.showPassword?"text":"password":"text",value:t,placeholder:e.placeholder??"",required:e.required,readOnly:o?.readOnly,onChange:(u,k)=>n(k.value),onBlur:u=>x(u.target.value),contentAfter:o?.contentAfter?o.contentAfter:a&&o?.onTogglePassword?(0,v.jsx)(N,{onClick:o.onTogglePassword,icon:o.showPassword?(0,v.jsx)(xe,{}):(0,v.jsx)(be,{}),appearance:"transparent",size:"small","aria-label":o.showPassword?K.common.hidePassword:K.common.showPassword,title:o.showPassword?K.common.hidePassword:K.common.showPassword}):void 0})},e.propertyName)}function ce(e,t,r,o){if(!e||e.hidden||e.type!=="dropdown"||!e.options)return;let a=n=>{r&&r.formAction({propertyName:e.propertyName,isAction:!1,value:n,updateValidation:o?.validateOnChange??!1})};return(0,v.jsx)(M,{required:e.required,label:e.label,validationMessage:e.validation?.validationMessage,validationState:ee(e.validation),orientation:"horizontal",children:(0,v.jsx)(Se,{size:"small",selectedOptions:t?[t]:[],value:e.options.find(n=>n.value===t)?.displayName||"",placeholder:e.placeholder??"",onOptionSelect:(n,x)=>{x.optionValue&&a(x.optionValue)},"aria-label":e.label,children:e.options.map((n,x)=>(0,v.jsx)(ne,{value:n.value,color:n.color,children:n.displayName},n.value+x))})},e.propertyName)}function We(e,t,r,o){if(!(!e||e.hidden)&&e.type==="dropdown"&&!(!r&&!e.options))return(0,v.jsx)(M,{required:e.required,label:e.label,validationMessage:e.validation?.validationMessage,validationState:ee(e.validation),orientation:"horizontal",children:(0,v.jsx)(Pe,{size:"small",freeform:r||!1,value:t||"",placeholder:e.placeholder??"",onOptionSelect:(a,n)=>{n.optionValue&&o(n.optionValue)},onChange:a=>{o(a.currentTarget.value)},children:e.options?.map((a,n)=>(0,v.jsx)(ne,{value:a.value,text:a.displayName,children:a.displayName},a.value+n))})},e.propertyName)}function Ge(e,t,r,o){if(!e||e.hidden)return;let a=x=>{r&&r.formAction({propertyName:e.propertyName,isAction:!1,value:x,updateValidation:o?.validateOnChange??!1})},n=o?.label??(typeof e.label=="string"?(0,v.jsx)("span",{dangerouslySetInnerHTML:{__html:e.label}}):e.label);return(0,v.jsx)(M,{required:e.required,validationMessage:e.validation?.validationMessage,validationState:ee(e.validation),children:(0,v.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",whiteSpace:"nowrap"},children:[(0,v.jsx)(Z,{size:"medium",checked:t,onChange:(x,u)=>a(u.checked===!0)}),(0,v.jsxs)("span",{style:{whiteSpace:"normal"},children:[n,e.required&&(0,v.jsx)("span",{style:{color:"red",marginLeft:"4px"},children:"*"})]})]})},e.propertyName)}var Q=m(P()),io=F({root:{display:"flex",flexDirection:"column",alignItems:"stretch",gap:"8px",maxWidth:"640px",width:"100%"},buttons:{display:"flex",flexDirection:"row",gap:"8px",paddingBottom:"4px",alignSelf:"flex-end"},fieldContainer:{flexGrow:1,minWidth:0}}),Ue=()=>{let e=io(),t=j.getInstance().publishProject,r=(0,G.useContext)(A),o=l(u=>u.formComponents.publishProfilePath),a=l(u=>u.formState.publishProfilePath),[n,x]=(0,G.useState)(a||"");if((0,G.useEffect)(()=>x(a||""),[a]),!(!r||!o||o.hidden)&&o.type==="input")return(0,Q.jsxs)("div",{className:e.root,children:[(0,Q.jsx)("div",{className:e.fieldContainer,children:V(o,n,r,{readOnly:!0})}),(0,Q.jsxs)("div",{className:e.buttons,children:[(0,Q.jsx)(N,{size:"small",appearance:"secondary",onClick:()=>r.selectPublishProfile?.(),children:t.SelectPublishProfile}),(0,Q.jsx)(N,{size:"small",appearance:"secondary",onClick:()=>r.savePublishProfile?.(""),children:t.SaveAs})]})]})};var L=m(z());var pe=m(P()),lo=F({root:{display:"flex",flexDirection:"column",gap:"16px",maxWidth:"640px",width:"100%"},containerGroup:{display:"flex",flexDirection:"column",gap:"16px",paddingLeft:"16px",borderLeft:"2px solid var(--vscode-editorWidget-border, #8883)"}}),Xe=()=>{let e=lo(),t=(0,L.useContext)(A),[r,o]=(0,L.useState)(!1),[a,n]=(0,L.useState)(!1),[x,u]=(0,L.useState)(""),[k,q]=(0,L.useState)(""),b=l(d=>d.formComponents[h.PublishTarget]),D=l(d=>d.formState[h.PublishTarget]),i=D==="localContainer",p=l(d=>d.formComponents[h.ContainerPort]),T=l(d=>d.formState[h.ContainerPort]),I=l(d=>d.formComponents[h.ContainerAdminPassword]),H=l(d=>d.formState[h.ContainerAdminPassword]),se=l(d=>d.formComponents[h.ContainerAdminPasswordConfirm]),_=l(d=>d.formState[h.ContainerAdminPasswordConfirm]),W=l(d=>d.formComponents[h.ContainerImageTag]),U=l(d=>d.formState[h.ContainerImageTag]),re=l(d=>d.formComponents[h.AcceptContainerLicense]),$=l(d=>d.formState[h.AcceptContainerLicense]);if((0,L.useEffect)(()=>{!t||!i||(T||t.formAction({propertyName:h.ContainerPort,isAction:!1,value:_e,updateValidation:!0}),!U&&W?.options?.[0]&&t.formAction({propertyName:h.ContainerImageTag,isAction:!1,value:W.options[0].value,updateValidation:!0}))},[i,T,U,W,t]),(0,L.useEffect)(()=>{!t||!i||_!==void 0&&_!==""&&t.formAction({propertyName:h.ContainerAdminPasswordConfirm,isAction:!1,value:_,updateValidation:!0})},[i,H,_,t]),!(!t||!b))return(0,pe.jsxs)("div",{className:e.root,children:[ce(b,D,t),i&&(0,pe.jsxs)("div",{className:e.containerGroup,children:[V(p,T?.toString()||"",t),V(I,x,t,{showPassword:r,onTogglePassword:()=>o(!r),onChange:u}),V(se,k,t,{showPassword:a,onTogglePassword:()=>n(!a),onChange:q}),ce(W,U?.toString(),t,{validateOnChange:!0}),Ge(re,!!$,t,{validateOnChange:!0})]})]})};var B=m(z());var X=m(P()),co=F({root:{display:"flex",flexDirection:"column",gap:"16px",maxWidth:"640px",width:"100%"}}),$e=()=>{let e=(0,B.useContext)(A),t=co(),r=l(i=>i.formComponents.serverName),o=l(i=>i.formComponents.databaseName),a=l(i=>i.formState.serverName),n=l(i=>i.formState.databaseName),x=l(i=>i.formState.publishTarget),[u,k]=(0,B.useState)(a||""),[q,b]=(0,B.useState)(n||"");if((0,B.useEffect)(()=>k(a||""),[a]),(0,B.useEffect)(()=>b(n||""),[n]),!e)return;let D=i=>{b(i),o&&e.formAction({propertyName:o.propertyName,isAction:!1,value:i})};return(0,X.jsxs)("div",{className:t.root,children:[V(r,u,e,{readOnly:!0,contentAfter:(0,X.jsx)(N,{size:"small","aria-label":"Connect to server",icon:(0,X.jsx)(he,{}),appearance:"transparent",onClick:()=>{e.openConnectionDialog()}})}),We(o,q,x==="localContainer",D)]})};var E=m(z());var f=m(P()),po=F({tableContainer:{width:"100%",maxWidth:"640px",maxHeight:"368px",overflowY:"auto",border:"1px solid var(--vscode-panel-border)"},table:{width:"100%",borderCollapse:"collapse"},tableHeader:{position:"sticky",top:"0",backgroundColor:"var(--vscode-editor-background, var(--vscode-sideBar-background))",borderBottom:"2px solid var(--vscode-panel-border)",zIndex:1},tableCell:{borderRight:"1px solid var(--vscode-panel-border)",borderBottom:"1px solid var(--vscode-panel-border)",padding:"4px 8px","&:last-child":{borderRight:"none"}},valueHeaderContent:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",position:"relative"},revertButton:{minWidth:"20px",height:"20px",padding:"2px",position:"absolute",right:"0"}}),Ze=()=>{let e=po(),t=j.getInstance().publishProject,r=(0,E.useContext)(A),o=l(p=>p.formState.sqlCmdVariables),a=l(p=>p.formComponents.sqlCmdVariables),n=l(p=>p.defaultSqlCmdVariables),[x,u]=(0,E.useState)(o||{});(0,E.useEffect)(()=>{u(o||{})},[o]);let k=(0,E.useMemo)(()=>Object.entries(o||{}),[o]),q=(0,E.useMemo)(()=>{if(!n||!o)return!1;for(let p in o)if((o[p]||"")!==(n[p]||""))return!0;for(let p in n)if(!(p in o))return!0;return!1},[o,n]),b=(0,E.useCallback)((p,T)=>{if(!r)return;u(H=>({...H,[p]:T}));let I={...o,[p]:T};r.updateSqlCmdVariables(I)},[o,r]),D=(0,E.useCallback)((p,T)=>{if(!r)return;let I={...o,[p]:T};r.updateSqlCmdVariables(I)},[o,r]),i=(0,E.useCallback)(()=>{r&&r.revertSqlCmdVariables()},[r]);if(!(!r||!o||!a||a.hidden)&&k.length!==0)return(0,f.jsx)(M,{label:a.label,required:a.required,orientation:"horizontal",children:(0,f.jsx)("div",{className:e.tableContainer,children:(0,f.jsxs)(De,{className:e.table,size:"extra-small","aria-label":t.SqlCmdVariablesLabel,children:[(0,f.jsx)(we,{className:e.tableHeader,children:(0,f.jsxs)(ie,{children:[(0,f.jsx)(le,{className:e.tableCell,children:(0,f.jsx)("div",{style:{textAlign:"center",width:"100%"},children:t.SqlCmdVariableNameColumn})}),(0,f.jsx)(le,{className:e.tableCell,children:(0,f.jsxs)("div",{className:e.valueHeaderContent,children:[(0,f.jsx)("span",{children:t.SqlCmdVariableValueColumn}),(0,f.jsx)(ve,{content:t.RevertSqlCmdVariablesToDefaults,relationship:"label",children:(0,f.jsx)(N,{appearance:"subtle",size:"small",className:e.revertButton,disabled:!q,onClick:i,icon:(0,f.jsx)(ge,{}),"aria-label":t.RevertSqlCmdVariablesToDefaults})})]})})]})}),(0,f.jsx)(qe,{children:k.map(([p])=>(0,f.jsxs)(ie,{children:[(0,f.jsx)(ae,{className:e.tableCell,children:(0,f.jsx)(Ne,{children:p})}),(0,f.jsx)(ae,{className:e.tableCell,children:(0,f.jsx)(J,{size:"small",style:{width:"100%"},value:x[p]||"",onChange:(T,I)=>b(p,I.value),onBlur:T=>D(p,T.currentTarget.value),"aria-label":`Value for ${p}`})})]},p))})]})})})};var O=m(z());var C=m(P()),mo=F({optionsList:{display:"flex",flexDirection:"column",gap:"8px"},drawerContent:{display:"flex",flexDirection:"column",height:"100%"},scrollableContent:{flex:1,overflow:"auto",paddingBottom:"16px"},stickyFooter:{position:"sticky",bottom:"0",backgroundColor:"var(--colorNeutralBackground1)",borderTop:"1px solid var(--colorNeutralStroke2)",padding:"16px 0",display:"flex",justifyContent:"flex-end",gap:"8px",marginTop:"auto"}}),Je=({isAdvancedDrawerOpen:e,setIsAdvancedDrawerOpen:t})=>{let r=mo(),o=Re(),a=(0,O.useContext)(A),[n,x]=(0,O.useState)(""),[u,k]=(0,O.useState)(["General"]),q=j.getInstance(),b=l(s=>s),[D,i]=(0,O.useState)([]),[p,T]=(0,O.useState)(D);(0,O.useEffect)(()=>{e&&T([...D])},[e]);let I=(0,O.useCallback)((s,c)=>{let y=D.find(w=>w.optionName===s);return y?y.value:c},[D]),H=(0,O.useMemo)(()=>{if(!b.deploymentOptions)return[];let s=[];if(b.deploymentOptions.booleanOptionsDictionary){let c=Object.entries(b.deploymentOptions.booleanOptionsDictionary).map(([g,R])=>({key:g,displayName:R.displayName,description:R.description,value:I(g,R.value)})),y=c.filter(g=>!g.displayName.startsWith("Ignore")).sort((g,R)=>g.displayName.localeCompare(R.displayName)),w=c.filter(g=>g.displayName.startsWith("Ignore")).sort((g,R)=>g.displayName.localeCompare(R.displayName));y.length>0&&s.push({key:"General",label:q.publishProject.generalOptions,entries:y}),w.length>0&&s.push({key:"Ignore",label:q.publishProject.ignoreOptions,entries:w})}if(b.deploymentOptions.objectTypesDictionary){let c=b.deploymentOptions.excludeObjectTypes?.value||[],y=Object.entries(b.deploymentOptions.objectTypesDictionary).map(([w,g])=>{let R=c.some(oo=>oo.toLowerCase()===w.toLowerCase());return{key:w,displayName:g||w,description:"",value:I(w,R)}}).filter(w=>w.displayName).sort((w,g)=>w.displayName.localeCompare(g.displayName));y.length>0&&s.push({key:"Exclude",label:q.publishProject.excludeObjectTypes,entries:y})}return s},[b.deploymentOptions,I,q]),se=(s,c)=>{i(y=>y.find(g=>g.optionName===s)?y.filter(g=>g.optionName!==s):[...y,{optionName:s,value:c}])},_=D.length===0,W=()=>{b.defaultDeploymentOptions&&a?.updateDeploymentOptions(b.defaultDeploymentOptions),i([])},U=()=>{if(!b.deploymentOptions||D.length===0){t(!1);return}let s=structuredClone(b.deploymentOptions);D.forEach(({optionName:c,value:y})=>{if(s.booleanOptionsDictionary?.[c]){s.booleanOptionsDictionary[c].value=y;return}s.objectTypesDictionary?.[c]&&s.excludeObjectTypes&&re(s.excludeObjectTypes.value,c,y)}),a?.updateDeploymentOptions(s),t(!1)},re=(s,c,y)=>{let w=s.some(g=>g.toLowerCase()===c.toLowerCase());if(y&&!w)s.push(c);else if(!y&&w){let g=s.findIndex(R=>R.toLowerCase()===c.toLowerCase());g!==-1&&s.splice(g,1)}},$=()=>{i(p),t(!1)},d=s=>{if(!n)return!0;let c=n.toLowerCase();return s.displayName.toLowerCase().includes(c)},eo=s=>(0,C.jsx)(Z,{checked:s.value,onChange:(c,y)=>se(s.key,y.checked===!0),label:s.description?(0,C.jsx)(Te,{info:s.description,children:s.displayName}):s.displayName},s.key);if(a)return(0,C.jsxs)(Ae,{position:"end",size:"medium",open:e,onOpenChange:(s,{open:c})=>!c&&$(),children:[(0,C.jsx)(Oe,{children:(0,C.jsx)(ke,{action:(0,C.jsx)(N,{appearance:"subtle","aria-label":"Close",icon:(0,C.jsx)(fe,{}),onClick:$}),children:q.publishProject.advancedPublishSettings})}),(0,C.jsx)(Ee,{children:(0,C.jsxs)("div",{className:r.drawerContent,children:[(0,C.jsxs)("div",{className:r.scrollableContent,children:[(0,C.jsx)(Fe,{size:"medium",style:{width:"100%",maxWidth:"100%",marginBottom:"16px"},placeholder:q.connectionDialog.searchSettings,onChange:(s,c)=>x(c.value??""),value:n}),(0,C.jsx)(me,{multiple:!0,collapsible:!0,onToggle:(s,c)=>{n||k(c.openItems)},openItems:n?H.map(s=>s.key):u,children:H.filter(s=>s.entries.some(c=>d(c))).map(s=>(0,C.jsxs)(ue,{value:s.key,className:o.accordionItem,children:[(0,C.jsx)(Ce,{children:s.label}),(0,C.jsx)(ye,{children:(0,C.jsx)("div",{className:r.optionsList,children:s.entries.filter(c=>d(c)).map(c=>eo(c))})})]},s.key))})]}),(0,C.jsxs)("div",{className:r.stickyFooter,children:[(0,C.jsx)(N,{appearance:"secondary",onClick:W,disabled:_,children:q.schemaCompare.reset}),(0,C.jsx)(N,{appearance:"primary",onClick:U,children:q.objectExplorerFiltering.ok})]})]})})]})};var S=m(P()),uo=F({rightButton:{width:"150px",marginLeft:"10px",marginRight:"0px"}});function go(){let e=uo(),t=Ie(),r=j.getInstance().publishProject,o=(0,oe.useContext)(A),[a,n]=(0,oe.useState)(!1),x=l(i=>i.formState),u=l(i=>i.inProgress),k=l(i=>i.hasFormErrors),q=l(i=>i.formMessage),b=!!o&&!!x,D=!b||u||k;return b?(0,S.jsxs)("form",{className:t.formRoot,onSubmit:i=>i.preventDefault(),children:[(0,S.jsxs)("div",{className:t.formDiv,style:{overflow:"auto"},children:[q&&(0,S.jsx)("div",{children:(0,S.jsx)(Le,{message:q,onMessageButtonClicked:()=>{},onCloseMessage:o.closeMessage})}),(0,S.jsx)(Xe,{}),(0,S.jsx)(Ue,{}),(0,S.jsx)($e,{}),(0,S.jsx)(Ze,{}),(0,S.jsxs)("div",{className:t.formNavTray,children:[(0,S.jsx)(N,{appearance:"secondary",className:t.formNavTrayButton,onClick:()=>n(!a),children:r.advancedOptions}),(0,S.jsxs)("div",{className:t.formNavTrayRight,children:[(0,S.jsx)(N,{appearance:"secondary",className:e.rightButton,disabled:D||x?.publishTarget!=="existingServer",onClick:()=>o.generatePublishScript(),children:r.generateScript}),(0,S.jsx)(N,{appearance:"primary",className:e.rightButton,disabled:D,onClick:()=>o.publishNow(),children:r.publish})]})]})]}),(0,S.jsx)(Je,{isAdvancedDrawerOpen:a,setIsAdvancedDrawerOpen:n})]}):(0,S.jsx)("div",{children:"Loading..."})}function de(){return(0,S.jsx)(go,{})}var te=m(P());Ye.default.createRoot(document.getElementById("root")).render((0,te.jsx)(je,{children:(0,te.jsx)(ze,{children:(0,te.jsx)(de,{})})}));
