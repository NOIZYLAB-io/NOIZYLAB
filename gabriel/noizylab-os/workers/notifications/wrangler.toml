name = "notifications-worker"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

[vars]
ENVIRONMENT = "development"

[[d1_databases]]
binding = "DB"
database_name = "noizylab-db"
database_id = "YOUR_D1_DATABASE_ID"

[[kv_namespaces]]
binding = "NOTIFICATIONS_KV"
id = "YOUR_KV_NAMESPACE_ID"

[[queues.producers]]
binding = "NOTIFICATIONS_QUEUE"
queue = "notifications-queue"

[[queues.consumers]]
queue = "notifications-queue"
max_batch_size = 10
max_batch_timeout = 30

[ai]
binding = "AI"

# Process scheduled notifications every minute + daily digest at 8 AM
[triggers]
crons = ["* * * * *", "0 8 * * *"]

[env.production]
vars = { ENVIRONMENT = "production" }
