name = "noizylab-os"
main = "src/worker.ts"
compatibility_date = "2024-01-01"

# D1 Database
[[d1_databases]]
binding = "DB"
database_name = "noizylab-os"
database_id = "YOUR_D1_ID"  # wrangler d1 create noizylab-os

# R2 Storage
[[r2_buckets]]
binding = "UPLOADS"
bucket_name = "noizylab-uploads"

# Durable Objects
[durable_objects]
bindings = [{ name = "ROOMS", class_name = "RoomDO" }]

[[migrations]]
tag = "v1"
new_classes = ["RoomDO"]

# AI
[ai]
binding = "AI"

# RealtimeKit REST config
[vars]
CF_ACCOUNT_ID = "REPLACE_ME"
RTK_APP_ID = "REPLACE_ME"
CF_API_TOKEN = "REPLACE_ME" # Cloudflare API token with Realtime permissions
RTK_PRESET_STAFF = "admin"  # change to your preset_name
RTK_PRESET_CLIENT = "viewer" # change to your preset_name

# Cron Triggers (UTC)
[triggers]
crons = ["*/5 * * * *"] # every 5 minutes

# Queues (producer)
[[queues.producers]]
queue = "noizylab-ops"
binding = "OPS_QUEUE"

# Queues (consumer)
[[queues.consumers]]
queue = "noizylab-ops"
max_batch_size = 10
max_batch_timeout = 5
max_retries = 5
dead_letter_queue = "noizylab-ops-dlq"

# Secrets: TURNSTILE_SECRET, ACCESS_AUD, STRIPE_SECRET_KEY, STRIPE_WEBHOOK_SECRET
