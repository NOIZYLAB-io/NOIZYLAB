"use strict";exports.id=5173,exports.ids=[5173],exports.modules={15173:(X,w,s)=>{s.d(w,{fromHttp:()=>J});var R=s(27650),y=s(38084),l=s(73230),C=s(91943),S=s.n(C);const Y="127.0.0.0/8",q="::1/128",I="169.254.170.2",p="169.254.170.23",g="[fd00:ec2::23]",N=(e,n)=>{if(e.protocol!=="https:"&&!(e.hostname===I||e.hostname===p||e.hostname===g)){if(e.hostname.includes("[")){if(e.hostname==="[::1]"||e.hostname==="[0000:0000:0000:0000:0000:0000:0000:0001]")return}else{if(e.hostname==="localhost")return;const o=e.hostname.split("."),r=t=>{const a=parseInt(t,10);return 0<=a&&a<=255};if(o[0]==="127"&&r(o[1])&&r(o[2])&&r(o[3])&&o.length===4)return}throw new l.C(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:n})}};var b=s(25818),O=s(22093),v=s(29804),B=s(92696),f=s(2203),L=s(95557);const U=async e=>typeof Blob=="function"&&e instanceof Blob||e.constructor?.name==="Blob"?Blob.prototype.arrayBuffer!==void 0?new Uint8Array(await e.arrayBuffer()):x(e):_(e);async function x(e){const n=await D(e),o=(0,L.E)(n);return new Uint8Array(o)}async function _(e){const n=[],o=e.getReader();let r=!1,t=0;for(;!r;){const{done:c,value:d}=await o.read();d&&(n.push(d),t+=d.length),r=c}const a=new Uint8Array(t);let i=0;for(const c of n)a.set(c,i),i+=c.length;return a}function D(e){return new Promise((n,o)=>{const r=new FileReader;r.onloadend=()=>{if(r.readyState!==2)return o(new Error("Reader aborted too early"));const t=r.result??"",a=t.indexOf(","),i=a>-1?a+1:t.length;n(t.substring(i))},r.onabort=()=>o(new Error("Read aborted")),r.onerror=()=>o(r.error),r.readAsDataURL(e)})}var K=s(71816),F=s(49222),H=s(35952);const m=e=>typeof ReadableStream=="function"&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),ee=e=>typeof Blob=="function"&&(e?.constructor?.name===Blob.name||e instanceof Blob),T="The stream has already been transformed.",P=e=>{if(!E(e)&&!m(e)){const t=e?.__proto__?.constructor?.name||e;throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${t}`)}let n=!1;const o=async()=>{if(n)throw new Error(T);return n=!0,await U(e)},r=t=>{if(typeof t.stream!="function")throw new Error(`Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.
If you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body`);return t.stream()};return Object.assign(e,{transformToByteArray:o,transformToString:async t=>{const a=await o();if(t==="base64")return(0,K.n)(a);if(t==="hex")return(0,F.n)(a);if(t===void 0||t==="utf8"||t==="utf-8")return(0,H.P)(a);if(typeof TextDecoder=="function")return new TextDecoder(t).decode(a);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(n)throw new Error(T);if(n=!0,E(e))return r(e);if(m(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})},E=e=>typeof Blob=="function"&&e instanceof Blob,A="The stream has already been transformed.",W=e=>{if(!(e instanceof f.Readable))try{return P(e)}catch{const t=e?.__proto__?.constructor?.name||e;throw new Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${t}`)}let n=!1;const o=async()=>{if(n)throw new Error(A);return n=!0,await(0,v.k)(e)};return Object.assign(e,{transformToByteArray:o,transformToString:async r=>{const t=await o();return r===void 0||Buffer.isEncoding(r)?(0,B.Q)(t.buffer,t.byteOffset,t.byteLength).toString(r):new TextDecoder(r).decode(t)},transformToWebStream:()=>{if(n)throw new Error(A);if(e.readableFlowing!==null)throw new Error("The stream has been consumed by other callbacks.");if(typeof f.Readable.toWeb!="function")throw new Error("Readable.toWeb() is not supported. Please ensure a polyfill is available.");return n=!0,f.Readable.toWeb(e)}})};function k(e){return new b.K({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce((n,[o,r])=>(n[o]=r,n),{}),fragment:e.hash})}async function M(e,n){const r=await W(e.body).transformToString();if(e.statusCode===200){const t=JSON.parse(r);if(typeof t.AccessKeyId!="string"||typeof t.SecretAccessKey!="string"||typeof t.Token!="string"||typeof t.Expiration!="string")throw new l.C("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:n});return{accessKeyId:t.AccessKeyId,secretAccessKey:t.SecretAccessKey,sessionToken:t.Token,expiration:(0,O.EI)(t.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let t={};try{t=JSON.parse(r)}catch{}throw Object.assign(new l.C(`Server responded with status: ${e.statusCode}`,{logger:n}),{Code:t.Code,Message:t.Message})}throw new l.C(`Server responded with status: ${e.statusCode}`,{logger:n})}const z=(e,n,o)=>async()=>{for(let r=0;r<n;++r)try{return await e()}catch{await new Promise(a=>setTimeout(a,o))}return await e()},$="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",Z="http://169.254.170.2",G="AWS_CONTAINER_CREDENTIALS_FULL_URI",V="AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE",j="AWS_CONTAINER_AUTHORIZATION_TOKEN",J=(e={})=>{e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let n;const o=e.awsContainerCredentialsRelativeUri??process.env[$],r=e.awsContainerCredentialsFullUri??process.env[G],t=e.awsContainerAuthorizationToken??process.env[j],a=e.awsContainerAuthorizationTokenFile??process.env[V],i=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?.warn?console.warn:e.logger.warn.bind(e.logger);if(o&&r&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),i("awsContainerCredentialsFullUri will take precedence.")),t&&a&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),i("awsContainerAuthorizationToken will take precedence.")),r)n=r;else if(o)n=`${Z}${o}`;else throw new l.C(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});const c=new URL(n);N(c,e.logger);const d=new y.$({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return z(async()=>{const u=k(c);t?u.headers.Authorization=t:a&&(u.headers.Authorization=(await S().readFile(a)).toString());try{const h=await d.handle(u);return M(h.response).then(Q=>(0,R.g)(Q,"CREDENTIALS_HTTP","z"))}catch(h){throw new l.C(String(h),{logger:e.logger})}},e.maxRetries??3,e.timeout??1e3)}}};
