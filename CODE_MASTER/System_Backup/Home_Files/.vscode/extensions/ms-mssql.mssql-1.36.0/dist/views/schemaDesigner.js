import{a as Gl}from"./chunk-KGCYESDM.js";import{a as on}from"./chunk-KR6XSNEV.js";import{a as ql,b as Ul}from"./chunk-OJNDYEPL.js";import{c as Yl}from"./chunk-ZULDP422.js";import{$a as Vi,$c as Wl,A as Ya,Aa as dl,Ab as Dl,Ac as gr,B as Xa,Bb as kl,Bc as Ll,Cb as ve,Dc as Fl,Ea as Hi,Ec as $l,F as Za,Fb as Tl,Fc as Bl,Gb as In,Hb as vt,Hc as yr,Ia as fl,Ib as Pn,Ic as Hl,J as ja,Ja as hl,Jb as Rn,Jc as Vl,Kb as Mn,La as pl,Lb as zn,Mb as On,Na as ml,Nb as lr,O as en,Oa as gl,Oc as T,P as Qa,Pa as yl,Pb as Yi,Pc as Uy,Qb as cr,Ra as bl,Rb as ur,Sb as ht,T as Ja,Ta as xl,Tb as dr,Ua as wl,Ub as An,V as el,Vb as fr,W as tl,Wa as vl,Wb as hr,Xa as Sl,Xb as pr,Yb as mr,Z as nl,a as re,aa as ol,ab as Wi,ba as rl,bb as Ki,c as X,cb as qi,d as me,db as El,dd as Kl,e as Ky,eb as ne,f as qy,fb as Cl,gb as Ht,h as Bi,hb as ot,ib as lo,jb as Ui,k as ze,lb as Gi,mb as _l,n as Ga,na as il,nb as tn,oc as Il,p as ie,pc as Pl,q as ir,qa as sl,qb as Dn,qc as Rl,rb as nn,rc as Ml,sa as al,sc as zl,tb as sr,tc as Ol,ub as kn,uc as Al,va as ll,vb as Tn,w as Nn,wa as cl,wc as Ln,xa as ul,yb as ar,zb as Nl}from"./chunk-V3XRZIHQ.js";var vd=re(wd=>{"use strict";var Zn=me();function Ax(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Lx=typeof Object.is=="function"?Object.is:Ax,Fx=Zn.useState,$x=Zn.useEffect,Bx=Zn.useLayoutEffect,Hx=Zn.useDebugValue;function Vx(e,t){var n=t(),o=Fx({inst:{value:n,getSnapshot:t}}),r=o[0].inst,i=o[1];return Bx(function(){r.value=n,r.getSnapshot=t,Ls(r)&&i({inst:r})},[e,n,t]),$x(function(){return Ls(r)&&i({inst:r}),e(function(){Ls(r)&&i({inst:r})})},[e]),Hx(n),n}function Ls(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Lx(e,n)}catch{return!0}}function Wx(e,t){return t()}var Kx=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Wx:Vx;wd.useSyncExternalStore=Zn.useSyncExternalStore!==void 0?Zn.useSyncExternalStore:Kx});var Ed=re((kP,Sd)=>{"use strict";Sd.exports=vd()});var _d=re(Cd=>{"use strict";var ui=me(),qx=Ed();function Ux(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Gx=typeof Object.is=="function"?Object.is:Ux,Yx=qx.useSyncExternalStore,Xx=ui.useRef,Zx=ui.useEffect,jx=ui.useMemo,Qx=ui.useDebugValue;Cd.useSyncExternalStoreWithSelector=function(e,t,n,o,r){var i=Xx(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=jx(function(){function l(h){if(!c){if(c=!0,u=h,h=o(h),r!==void 0&&s.hasValue){var p=s.value;if(r(p,h))return d=p}return d=h}if(p=d,Gx(u,h))return p;var g=o(h);return r!==void 0&&r(p,g)?(u=h,p):(u=h,d=g)}var c=!1,u,d,f=n===void 0?null:n;return[function(){return l(t())},f===null?void 0:function(){return l(f())}]},[t,n,o,r]);var a=Yx(e,i[0],i[1]);return Zx(function(){s.hasValue=!0,s.value=a},[a]),Qx(a),a}});var Dd=re((IP,Nd)=>{"use strict";Nd.exports=_d()});var bi=re((QP,Gf)=>{"use strict";var lS="\0",xn="\0",Kf="",qs=class{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(t){t&&(this._isDirected=Object.hasOwn(t,"directed")?t.directed:!0,this._isMultigraph=Object.hasOwn(t,"multigraph")?t.multigraph:!1,this._isCompound=Object.hasOwn(t,"compound")?t.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[xn]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return this._defaultNodeLabelFn=t,typeof t!="function"&&(this._defaultNodeLabelFn=()=>t),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var t=this;return this.nodes().filter(n=>Object.keys(t._in[n]).length===0)}sinks(){var t=this;return this.nodes().filter(n=>Object.keys(t._out[n]).length===0)}setNodes(t,n){var o=arguments,r=this;return t.forEach(function(i){o.length>1?r.setNode(i,n):r.setNode(i)}),this}setNode(t,n){return Object.hasOwn(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=xn,this._children[t]={},this._children[xn][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return Object.hasOwn(this._nodes,t)}removeNode(t){var n=this;if(Object.hasOwn(this._nodes,t)){var o=r=>n.removeEdge(n._edgeObjs[r]);delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],this.children(t).forEach(function(r){n.setParent(r)}),delete this._children[t]),Object.keys(this._in[t]).forEach(o),delete this._in[t],delete this._preds[t],Object.keys(this._out[t]).forEach(o),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=xn;else{n+="";for(var o=n;o!==void 0;o=this.parent(o))if(o===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var n=this._parent[t];if(n!==xn)return n}}children(t=xn){if(this._isCompound){var n=this._children[t];if(n)return Object.keys(n)}else{if(t===xn)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var n=this._preds[t];if(n)return Object.keys(n)}successors(t){var n=this._sucs[t];if(n)return Object.keys(n)}neighbors(t){var n=this.predecessors(t);if(n){let r=new Set(n);for(var o of this.successors(t))r.add(o);return Array.from(r.values())}}isLeaf(t){var n;return this.isDirected()?n=this.successors(t):n=this.neighbors(t),n.length===0}filterNodes(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var o=this;Object.entries(this._nodes).forEach(function([s,a]){t(s)&&n.setNode(s,a)}),Object.values(this._edgeObjs).forEach(function(s){n.hasNode(s.v)&&n.hasNode(s.w)&&n.setEdge(s,o.edge(s))});var r={};function i(s){var a=o.parent(s);return a===void 0||n.hasNode(a)?(r[s]=a,a):a in r?r[a]:i(a)}return this._isCompound&&n.nodes().forEach(s=>n.setParent(s,i(s))),n}setDefaultEdgeLabel(t){return this._defaultEdgeLabelFn=t,typeof t!="function"&&(this._defaultEdgeLabelFn=()=>t),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(t,n){var o=this,r=arguments;return t.reduce(function(i,s){return r.length>1?o.setEdge(i,s,n):o.setEdge(i,s),s}),this}setEdge(){var t,n,o,r,i=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,n=s.w,o=s.name,arguments.length===2&&(r=arguments[1],i=!0)):(t=s,n=arguments[1],o=arguments[3],arguments.length>2&&(r=arguments[2],i=!0)),t=""+t,n=""+n,o!==void 0&&(o=""+o);var a=Bo(this._isDirected,t,n,o);if(Object.hasOwn(this._edgeLabels,a))return i&&(this._edgeLabels[a]=r),this;if(o!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?r:this._defaultEdgeLabelFn(t,n,o);var l=cS(this._isDirected,t,n,o);return t=l.v,n=l.w,Object.freeze(l),this._edgeObjs[a]=l,qf(this._preds[n],t),qf(this._sucs[t],n),this._in[n][a]=l,this._out[t][a]=l,this._edgeCount++,this}edge(t,n,o){var r=arguments.length===1?Ks(this._isDirected,arguments[0]):Bo(this._isDirected,t,n,o);return this._edgeLabels[r]}edgeAsObj(){let t=this.edge(...arguments);return typeof t!="object"?{label:t}:t}hasEdge(t,n,o){var r=arguments.length===1?Ks(this._isDirected,arguments[0]):Bo(this._isDirected,t,n,o);return Object.hasOwn(this._edgeLabels,r)}removeEdge(t,n,o){var r=arguments.length===1?Ks(this._isDirected,arguments[0]):Bo(this._isDirected,t,n,o),i=this._edgeObjs[r];return i&&(t=i.v,n=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],Uf(this._preds[n],t),Uf(this._sucs[t],n),delete this._in[n][r],delete this._out[t][r],this._edgeCount--),this}inEdges(t,n){var o=this._in[t];if(o){var r=Object.values(o);return n?r.filter(i=>i.v===n):r}}outEdges(t,n){var o=this._out[t];if(o){var r=Object.values(o);return n?r.filter(i=>i.w===n):r}}nodeEdges(t,n){var o=this.inEdges(t,n);if(o)return o.concat(this.outEdges(t,n))}};function qf(e,t){e[t]?e[t]++:e[t]=1}function Uf(e,t){--e[t]||delete e[t]}function Bo(e,t,n,o){var r=""+t,i=""+n;if(!e&&r>i){var s=r;r=i,i=s}return r+Kf+i+Kf+(o===void 0?lS:o)}function cS(e,t,n,o){var r=""+t,i=""+n;if(!e&&r>i){var s=r;r=i,i=s}var a={v:r,w:i};return o&&(a.name=o),a}function Ks(e,t){return Bo(e,t.v,t.w,t.name)}Gf.exports=qs});var Xf=re((JP,Yf)=>{"use strict";Yf.exports="2.2.4"});var jf=re((eR,Zf)=>{"use strict";Zf.exports={Graph:bi(),version:Xf()}});var Jf=re((tR,Qf)=>{"use strict";var uS=bi();Qf.exports={write:dS,read:pS};function dS(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:fS(e),edges:hS(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function fS(e){return e.nodes().map(function(t){var n=e.node(t),o=e.parent(t),r={v:t};return n!==void 0&&(r.value=n),o!==void 0&&(r.parent=o),r})}function hS(e){return e.edges().map(function(t){var n=e.edge(t),o={v:t.v,w:t.w};return t.name!==void 0&&(o.name=t.name),n!==void 0&&(o.value=n),o})}function pS(e){var t=new uS(e.options).setGraph(e.value);return e.nodes.forEach(function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),e.edges.forEach(function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}});var th=re((nR,eh)=>{"use strict";eh.exports=mS;function mS(e){var t={},n=[],o;function r(i){Object.hasOwn(t,i)||(t[i]=!0,o.push(i),e.successors(i).forEach(r),e.predecessors(i).forEach(r))}return e.nodes().forEach(function(i){o=[],r(i),o.length&&n.push(o)}),n}});var Gs=re((oR,nh)=>{"use strict";var Us=class{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(t){return t.key})}has(t){return Object.hasOwn(this._keyIndices,t)}priority(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(t,n){var o=this._keyIndices;if(t=String(t),!Object.hasOwn(o,t)){var r=this._arr,i=r.length;return o[t]=i,r.push({key:t,priority:n}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key}decrease(t,n){var o=this._keyIndices[t];if(n>this._arr[o].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[o].priority+" New: "+n);this._arr[o].priority=n,this._decrease(o)}_heapify(t){var n=this._arr,o=2*t,r=o+1,i=t;o<n.length&&(i=n[o].priority<n[i].priority?o:i,r<n.length&&(i=n[r].priority<n[i].priority?r:i),i!==t&&(this._swap(t,i),this._heapify(i)))}_decrease(t){for(var n=this._arr,o=n[t].priority,r;t!==0&&(r=t>>1,!(n[r].priority<o));)this._swap(t,r),t=r}_swap(t,n){var o=this._arr,r=this._keyIndices,i=o[t],s=o[n];o[t]=s,o[n]=i,r[s.key]=t,r[i.key]=n}};nh.exports=Us});var Ys=re((rR,oh)=>{"use strict";var gS=Gs();oh.exports=bS;var yS=()=>1;function bS(e,t,n,o){return xS(e,String(t),n||yS,o||function(r){return e.outEdges(r)})}function xS(e,t,n,o){var r={},i=new gS,s,a,l=function(c){var u=c.v!==s?c.v:c.w,d=r[u],f=n(c),h=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+c+" Weight: "+f);h<d.distance&&(d.distance=h,d.predecessor=s,i.decrease(u,h))};for(e.nodes().forEach(function(c){var u=c===t?0:Number.POSITIVE_INFINITY;r[c]={distance:u},i.add(c,u)});i.size()>0&&(s=i.removeMin(),a=r[s],a.distance!==Number.POSITIVE_INFINITY);)o(s).forEach(l);return r}});var ih=re((iR,rh)=>{"use strict";var wS=Ys();rh.exports=vS;function vS(e,t,n){return e.nodes().reduce(function(o,r){return o[r]=wS(e,r,t,n),o},{})}});var Xs=re((sR,sh)=>{"use strict";sh.exports=SS;function SS(e){var t=0,n=[],o={},r=[];function i(s){var a=o[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(u){Object.hasOwn(o,u)?o[u].onStack&&(a.lowlink=Math.min(a.lowlink,o[u].index)):(i(u),a.lowlink=Math.min(a.lowlink,o[u].lowlink))}),a.lowlink===a.index){var l=[],c;do c=n.pop(),o[c].onStack=!1,l.push(c);while(s!==c);r.push(l)}}return e.nodes().forEach(function(s){Object.hasOwn(o,s)||i(s)}),r}});var lh=re((aR,ah)=>{"use strict";var ES=Xs();ah.exports=CS;function CS(e){return ES(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}});var uh=re((lR,ch)=>{"use strict";ch.exports=NS;var _S=()=>1;function NS(e,t,n){return DS(e,t||_S,n||function(o){return e.outEdges(o)})}function DS(e,t,n){var o={},r=e.nodes();return r.forEach(function(i){o[i]={},o[i][i]={distance:0},r.forEach(function(s){i!==s&&(o[i][s]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var a=s.v===i?s.w:s.v,l=t(s);o[i][a]={distance:l,predecessor:i}})}),r.forEach(function(i){var s=o[i];r.forEach(function(a){var l=o[a];r.forEach(function(c){var u=l[i],d=s[c],f=l[c],h=u.distance+d.distance;h<f.distance&&(f.distance=h,f.predecessor=d.predecessor)})})}),o}});var Zs=re((cR,fh)=>{"use strict";function dh(e){var t={},n={},o=[];function r(i){if(Object.hasOwn(n,i))throw new Ho;Object.hasOwn(t,i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(r),delete n[i],o.push(i))}if(e.sinks().forEach(r),Object.keys(t).length!==e.nodeCount())throw new Ho;return o}var Ho=class extends Error{constructor(){super(...arguments)}};fh.exports=dh;dh.CycleException=Ho});var mh=re((uR,ph)=>{"use strict";var hh=Zs();ph.exports=kS;function kS(e){try{hh(e)}catch(t){if(t instanceof hh.CycleException)return!1;throw t}return!0}});var js=re((dR,yh)=>{"use strict";yh.exports=TS;function TS(e,t,n){Array.isArray(t)||(t=[t]);var o=e.isDirected()?a=>e.successors(a):a=>e.neighbors(a),r=n==="post"?IS:PS,i=[],s={};return t.forEach(a=>{if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);r(a,o,s,i)}),i}function IS(e,t,n,o){for(var r=[[e,!1]];r.length>0;){var i=r.pop();i[1]?o.push(i[0]):Object.hasOwn(n,i[0])||(n[i[0]]=!0,r.push([i[0],!0]),gh(t(i[0]),s=>r.push([s,!1])))}}function PS(e,t,n,o){for(var r=[e];r.length>0;){var i=r.pop();Object.hasOwn(n,i)||(n[i]=!0,o.push(i),gh(t(i),s=>r.push(s)))}}function gh(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}});var xh=re((fR,bh)=>{"use strict";var RS=js();bh.exports=MS;function MS(e,t){return RS(e,t,"post")}});var vh=re((hR,wh)=>{"use strict";var zS=js();wh.exports=OS;function OS(e,t){return zS(e,t,"pre")}});var Eh=re((pR,Sh)=>{"use strict";var AS=bi(),LS=Gs();Sh.exports=FS;function FS(e,t){var n=new AS,o={},r=new LS,i;function s(l){var c=l.v===i?l.w:l.v,u=r.priority(c);if(u!==void 0){var d=t(l);d<u&&(o[c]=i,r.decrease(c,d))}}if(e.nodeCount()===0)return n;e.nodes().forEach(function(l){r.add(l,Number.POSITIVE_INFINITY),n.setNode(l)}),r.decrease(e.nodes()[0],0);for(var a=!1;r.size()>0;){if(i=r.removeMin(),Object.hasOwn(o,i))n.setEdge(i,o[i]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(i).forEach(s)}return n}});var _h=re((mR,Ch)=>{"use strict";Ch.exports={components:th(),dijkstra:Ys(),dijkstraAll:ih(),findCycles:lh(),floydWarshall:uh(),isAcyclic:mh(),postorder:xh(),preorder:vh(),prim:Eh(),tarjan:Xs(),topsort:Zs()}});var at=re((gR,Dh)=>{"use strict";var Nh=jf();Dh.exports={Graph:Nh.Graph,json:Jf(),alg:_h(),version:Nh.version}});var Ih=re((yR,Th)=>{"use strict";var Qs=class{constructor(){let t={};t._next=t._prev=t,this._sentinel=t}dequeue(){let t=this._sentinel,n=t._prev;if(n!==t)return kh(n),n}enqueue(t){let n=this._sentinel;t._prev&&t._next&&kh(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n}toString(){let t=[],n=this._sentinel,o=n._prev;for(;o!==n;)t.push(JSON.stringify(o,$S)),o=o._prev;return"["+t.join(", ")+"]"}};function kh(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function $S(e,t){if(e!=="_next"&&e!=="_prev")return t}Th.exports=Qs});var Rh=re((bR,Ph)=>{"use strict";var BS=at().Graph,HS=Ih();Ph.exports=WS;var VS=()=>1;function WS(e,t){if(e.nodeCount()<=1)return[];let n=qS(e,t||VS);return KS(n.graph,n.buckets,n.zeroIdx).flatMap(r=>e.outEdges(r.v,r.w))}function KS(e,t,n){let o=[],r=t[t.length-1],i=t[0],s;for(;e.nodeCount();){for(;s=i.dequeue();)Js(e,t,n,s);for(;s=r.dequeue();)Js(e,t,n,s);if(e.nodeCount()){for(let a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){o=o.concat(Js(e,t,n,s,!0));break}}}return o}function Js(e,t,n,o,r){let i=r?[]:void 0;return e.inEdges(o.v).forEach(s=>{let a=e.edge(s),l=e.node(s.v);r&&i.push({v:s.v,w:s.w}),l.out-=a,ea(t,n,l)}),e.outEdges(o.v).forEach(s=>{let a=e.edge(s),l=s.w,c=e.node(l);c.in-=a,ea(t,n,c)}),e.removeNode(o.v),i}function qS(e,t){let n=new BS,o=0,r=0;e.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),e.edges().forEach(a=>{let l=n.edge(a.v,a.w)||0,c=t(a),u=l+c;n.setEdge(a.v,a.w,u),r=Math.max(r,n.node(a.v).out+=c),o=Math.max(o,n.node(a.w).in+=c)});let i=US(r+o+3).map(()=>new HS),s=o+1;return n.nodes().forEach(a=>{ea(i,s,n.node(a))}),{graph:n,buckets:i,zeroIdx:s}}function ea(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function US(e){let t=[];for(let n=0;n<e;n++)t.push(n);return t}});var Ne=re((xR,$h)=>{"use strict";var Mh=at().Graph;$h.exports={addBorderNode:tE,addDummyNode:zh,applyWithChunking:xi,asNonCompoundGraph:YS,buildLayerMatrix:QS,intersectRect:jS,mapValues:lE,maxRank:Ah,normalizeRanks:JS,notime:iE,partition:oE,pick:aE,predecessorWeights:ZS,range:Fh,removeEmptyRanks:eE,simplify:GS,successorWeights:XS,time:rE,uniqueId:Lh,zipObject:ta};function zh(e,t,n,o){let r;do r=Lh(o);while(e.hasNode(r));return n.dummy=t,e.setNode(r,n),r}function GS(e){let t=new Mh().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let o=t.edge(n.v,n.w)||{weight:0,minlen:1},r=e.edge(n);t.setEdge(n.v,n.w,{weight:o.weight+r.weight,minlen:Math.max(o.minlen,r.minlen)})}),t}function YS(e){let t=new Mh({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function XS(e){let t=e.nodes().map(n=>{let o={};return e.outEdges(n).forEach(r=>{o[r.w]=(o[r.w]||0)+e.edge(r).weight}),o});return ta(e.nodes(),t)}function ZS(e){let t=e.nodes().map(n=>{let o={};return e.inEdges(n).forEach(r=>{o[r.v]=(o[r.v]||0)+e.edge(r).weight}),o});return ta(e.nodes(),t)}function jS(e,t){let n=e.x,o=e.y,r=t.x-n,i=t.y-o,s=e.width/2,a=e.height/2;if(!r&&!i)throw new Error("Not possible to find intersection inside of the rectangle");let l,c;return Math.abs(i)*s>Math.abs(r)*a?(i<0&&(a=-a),l=a*r/i,c=a):(r<0&&(s=-s),l=s,c=s*i/r),{x:n+l,y:o+c}}function QS(e){let t=Fh(Ah(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let o=e.node(n),r=o.rank;r!==void 0&&(t[r][o.order]=n)}),t}function JS(e){let t=e.nodes().map(o=>{let r=e.node(o).rank;return r===void 0?Number.MAX_VALUE:r}),n=xi(Math.min,t);e.nodes().forEach(o=>{let r=e.node(o);Object.hasOwn(r,"rank")&&(r.rank-=n)})}function eE(e){let t=e.nodes().map(s=>e.node(s).rank),n=xi(Math.min,t),o=[];e.nodes().forEach(s=>{let a=e.node(s).rank-n;o[a]||(o[a]=[]),o[a].push(s)});let r=0,i=e.graph().nodeRankFactor;Array.from(o).forEach((s,a)=>{s===void 0&&a%i!==0?--r:s!==void 0&&r&&s.forEach(l=>e.node(l).rank+=r)})}function tE(e,t,n,o){let r={width:0,height:0};return arguments.length>=4&&(r.rank=n,r.order=o),zh(e,"border",r,t)}function nE(e,t=Oh){let n=[];for(let o=0;o<e.length;o+=t){let r=e.slice(o,o+t);n.push(r)}return n}var Oh=65535;function xi(e,t){if(t.length>Oh){let n=nE(t);return e.apply(null,n.map(o=>e.apply(null,o)))}else return e.apply(null,t)}function Ah(e){let n=e.nodes().map(o=>{let r=e.node(o).rank;return r===void 0?Number.MIN_VALUE:r});return xi(Math.max,n)}function oE(e,t){let n={lhs:[],rhs:[]};return e.forEach(o=>{t(o)?n.lhs.push(o):n.rhs.push(o)}),n}function rE(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function iE(e,t){return t()}var sE=0;function Lh(e){var t=++sE;return toString(e)+t}function Fh(e,t,n=1){t==null&&(t=e,e=0);let o=i=>i<t;n<0&&(o=i=>t<i);let r=[];for(let i=e;o(i);i+=n)r.push(i);return r}function aE(e,t){let n={};for(let o of t)e[o]!==void 0&&(n[o]=e[o]);return n}function lE(e,t){let n=t;return typeof t=="string"&&(n=o=>o[t]),Object.entries(e).reduce((o,[r,i])=>(o[r]=n(i,r),o),{})}function ta(e,t){return e.reduce((n,o,r)=>(n[o]=t[r],n),{})}});var Hh=re((wR,Bh)=>{"use strict";var cE=Rh(),uE=Ne().uniqueId;Bh.exports={run:dE,undo:hE};function dE(e){(e.graph().acyclicer==="greedy"?cE(e,n(e)):fE(e)).forEach(o=>{let r=e.edge(o);e.removeEdge(o),r.forwardName=o.name,r.reversed=!0,e.setEdge(o.w,o.v,r,uE("rev"))});function n(o){return r=>o.edge(r).weight}}function fE(e){let t=[],n={},o={};function r(i){Object.hasOwn(o,i)||(o[i]=!0,n[i]=!0,e.outEdges(i).forEach(s=>{Object.hasOwn(n,s.w)?t.push(s):r(s.w)}),delete n[i])}return e.nodes().forEach(r),t}function hE(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let o=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,o)}})}});var Wh=re((vR,Vh)=>{"use strict";var pE=Ne();Vh.exports={run:mE,undo:yE};function mE(e){e.graph().dummyChains=[],e.edges().forEach(t=>gE(e,t))}function gE(e,t){let n=t.v,o=e.node(n).rank,r=t.w,i=e.node(r).rank,s=t.name,a=e.edge(t),l=a.labelRank;if(i===o+1)return;e.removeEdge(t);let c,u,d;for(d=0,++o;o<i;++d,++o)a.points=[],u={width:0,height:0,edgeLabel:a,edgeObj:t,rank:o},c=pE.addDummyNode(e,"edge",u,"_d"),o===l&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),e.setEdge(n,c,{weight:a.weight},s),d===0&&e.graph().dummyChains.push(c),n=c;e.setEdge(n,r,{weight:a.weight},s)}function yE(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),o=n.edgeLabel,r;for(e.setEdge(n.edgeObj,o);n.dummy;)r=e.successors(t)[0],e.removeNode(t),o.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(o.x=n.x,o.y=n.y,o.width=n.width,o.height=n.height),t=r,n=e.node(t)})}});var Vo=re((SR,Kh)=>{"use strict";var{applyWithChunking:bE}=Ne();Kh.exports={longestPath:xE,slack:wE};function xE(e){var t={};function n(o){var r=e.node(o);if(Object.hasOwn(t,o))return r.rank;t[o]=!0;let i=e.outEdges(o).map(a=>a==null?Number.POSITIVE_INFINITY:n(a.w)-e.edge(a).minlen);var s=bE(Math.min,i);return s===Number.POSITIVE_INFINITY&&(s=0),r.rank=s}e.sources().forEach(n)}function wE(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}});var na=re((ER,qh)=>{"use strict";var vE=at().Graph,wi=Vo().slack;qh.exports=SE;function SE(e){var t=new vE({directed:!1}),n=e.nodes()[0],o=e.nodeCount();t.setNode(n,{});for(var r,i;EE(t,e)<o;)r=CE(t,e),i=t.hasNode(r.v)?wi(e,r):-wi(e,r),_E(t,e,i);return t}function EE(e,t){function n(o){t.nodeEdges(o).forEach(r=>{var i=r.v,s=o===i?r.w:i;!e.hasNode(s)&&!wi(t,r)&&(e.setNode(s,{}),e.setEdge(o,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function CE(e,t){return t.edges().reduce((o,r)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(r.v)!==e.hasNode(r.w)&&(i=wi(t,r)),i<o[0]?[i,r]:o},[Number.POSITIVE_INFINITY,null])[1]}function _E(e,t,n){e.nodes().forEach(o=>t.node(o).rank+=n)}});var ep=re((CR,Jh)=>{"use strict";var NE=na(),Uh=Vo().slack,DE=Vo().longestPath,kE=at().alg.preorder,TE=at().alg.postorder,IE=Ne().simplify;Jh.exports=wn;wn.initLowLimValues=ra;wn.initCutValues=oa;wn.calcCutValue=Yh;wn.leaveEdge=Zh;wn.enterEdge=jh;wn.exchangeEdges=Qh;function wn(e){e=IE(e),DE(e);var t=NE(e);ra(t),oa(t,e);for(var n,o;n=Zh(t);)o=jh(t,e,n),Qh(t,e,n,o)}function oa(e,t){var n=TE(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(o=>PE(e,t,o))}function PE(e,t,n){var o=e.node(n),r=o.parent;e.edge(n,r).cutvalue=Yh(e,t,n)}function Yh(e,t,n){var o=e.node(n),r=o.parent,i=!0,s=t.edge(n,r),a=0;return s||(i=!1,s=t.edge(r,n)),a=s.weight,t.nodeEdges(n).forEach(l=>{var c=l.v===n,u=c?l.w:l.v;if(u!==r){var d=c===i,f=t.edge(l).weight;if(a+=d?f:-f,ME(e,n,u)){var h=e.edge(n,u).cutvalue;a+=d?-h:h}}}),a}function ra(e,t){arguments.length<2&&(t=e.nodes()[0]),Xh(e,{},1,t)}function Xh(e,t,n,o,r){var i=n,s=e.node(o);return t[o]=!0,e.neighbors(o).forEach(a=>{Object.hasOwn(t,a)||(n=Xh(e,t,n,a,o))}),s.low=i,s.lim=n++,r?s.parent=r:delete s.parent,n}function Zh(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function jh(e,t,n){var o=n.v,r=n.w;t.hasEdge(o,r)||(o=n.w,r=n.v);var i=e.node(o),s=e.node(r),a=i,l=!1;i.lim>s.lim&&(a=s,l=!0);var c=t.edges().filter(u=>l===Gh(e,e.node(u.v),a)&&l!==Gh(e,e.node(u.w),a));return c.reduce((u,d)=>Uh(t,d)<Uh(t,u)?d:u)}function Qh(e,t,n,o){var r=n.v,i=n.w;e.removeEdge(r,i),e.setEdge(o.v,o.w,{}),ra(e),oa(e,t),RE(e,t)}function RE(e,t){var n=e.nodes().find(r=>!t.node(r).parent),o=kE(e,n);o=o.slice(1),o.forEach(r=>{var i=e.node(r).parent,s=t.edge(r,i),a=!1;s||(s=t.edge(i,r),a=!0),t.node(r).rank=t.node(i).rank+(a?s.minlen:-s.minlen)})}function ME(e,t,n){return e.hasEdge(t,n)}function Gh(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}});var rp=re((_R,op)=>{"use strict";var zE=Vo(),np=zE.longestPath,OE=na(),AE=ep();op.exports=LE;function LE(e){switch(e.graph().ranker){case"network-simplex":tp(e);break;case"tight-tree":$E(e);break;case"longest-path":FE(e);break;default:tp(e)}}var FE=np;function $E(e){np(e),OE(e)}function tp(e){AE(e)}});var sp=re((NR,ip)=>{"use strict";ip.exports=BE;function BE(e){let t=VE(e);e.graph().dummyChains.forEach(n=>{let o=e.node(n),r=o.edgeObj,i=HE(e,t,r.v,r.w),s=i.path,a=i.lca,l=0,c=s[l],u=!0;for(;n!==r.w;){if(o=e.node(n),u){for(;(c=s[l])!==a&&e.node(c).maxRank<o.rank;)l++;c===a&&(u=!1)}if(!u){for(;l<s.length-1&&e.node(c=s[l+1]).minRank<=o.rank;)l++;c=s[l]}e.setParent(n,c),n=e.successors(n)[0]}})}function HE(e,t,n,o){let r=[],i=[],s=Math.min(t[n].low,t[o].low),a=Math.max(t[n].lim,t[o].lim),l,c;l=n;do l=e.parent(l),r.push(l);while(l&&(t[l].low>s||a>t[l].lim));for(c=l,l=o;(l=e.parent(l))!==c;)i.push(l);return{path:r.concat(i.reverse()),lca:c}}function VE(e){let t={},n=0;function o(r){let i=n;e.children(r).forEach(o),t[r]={low:i,lim:n++}}return e.children().forEach(o),t}});var cp=re((DR,lp)=>{"use strict";var vi=Ne();lp.exports={run:WE,cleanup:UE};function WE(e){let t=vi.addDummyNode(e,"root",{},"_root"),n=KE(e),o=Object.values(n),r=vi.applyWithChunking(Math.max,o)-1,i=2*r+1;e.graph().nestingRoot=t,e.edges().forEach(a=>e.edge(a).minlen*=i);let s=qE(e)+1;e.children().forEach(a=>ap(e,t,i,s,r,n,a)),e.graph().nodeRankFactor=i}function ap(e,t,n,o,r,i,s){let a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}let l=vi.addBorderNode(e,"_bt"),c=vi.addBorderNode(e,"_bb"),u=e.node(s);e.setParent(l,s),u.borderTop=l,e.setParent(c,s),u.borderBottom=c,a.forEach(d=>{ap(e,t,n,o,r,i,d);let f=e.node(d),h=f.borderTop?f.borderTop:d,p=f.borderBottom?f.borderBottom:d,g=f.borderTop?o:2*o,w=h!==p?1:r-i[s]+1;e.setEdge(l,h,{weight:g,minlen:w,nestingEdge:!0}),e.setEdge(p,c,{weight:g,minlen:w,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,l,{weight:0,minlen:r+i[s]})}function KE(e){var t={};function n(o,r){var i=e.children(o);i&&i.length&&i.forEach(s=>n(s,r+1)),t[o]=r}return e.children().forEach(o=>n(o,1)),t}function qE(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function UE(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{var o=e.edge(n);o.nestingEdge&&e.removeEdge(n)})}});var fp=re((kR,dp)=>{"use strict";var GE=Ne();dp.exports=YE;function YE(e){function t(n){let o=e.children(n),r=e.node(n);if(o.length&&o.forEach(t),Object.hasOwn(r,"minRank")){r.borderLeft=[],r.borderRight=[];for(let i=r.minRank,s=r.maxRank+1;i<s;++i)up(e,"borderLeft","_bl",n,r,i),up(e,"borderRight","_br",n,r,i)}}e.children().forEach(t)}function up(e,t,n,o,r,i){let s={width:0,height:0,rank:i,borderType:t},a=r[t][i-1],l=GE.addDummyNode(e,"border",s,n);r[t][i]=l,e.setParent(l,o),a&&e.setEdge(a,l,{weight:1})}});var gp=re((TR,mp)=>{"use strict";mp.exports={adjust:XE,undo:ZE};function XE(e){let t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&pp(e)}function ZE(e){let t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&jE(e),(t==="lr"||t==="rl")&&(QE(e),pp(e))}function pp(e){e.nodes().forEach(t=>hp(e.node(t))),e.edges().forEach(t=>hp(e.edge(t)))}function hp(e){let t=e.width;e.width=e.height,e.height=t}function jE(e){e.nodes().forEach(t=>ia(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(ia),Object.hasOwn(n,"y")&&ia(n)})}function ia(e){e.y=-e.y}function QE(e){e.nodes().forEach(t=>sa(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(sa),Object.hasOwn(n,"x")&&sa(n)})}function sa(e){let t=e.x;e.x=e.y,e.y=t}});var xp=re((IR,bp)=>{"use strict";var yp=Ne();bp.exports=JE;function JE(e){let t={},n=e.nodes().filter(l=>!e.children(l).length),o=n.map(l=>e.node(l).rank),r=yp.applyWithChunking(Math.max,o),i=yp.range(r+1).map(()=>[]);function s(l){if(t[l])return;t[l]=!0;let c=e.node(l);i[c.rank].push(l),e.successors(l).forEach(s)}return n.sort((l,c)=>e.node(l).rank-e.node(c).rank).forEach(s),i}});var vp=re((PR,wp)=>{"use strict";var e1=Ne().zipObject;wp.exports=t1;function t1(e,t){let n=0;for(let o=1;o<t.length;++o)n+=n1(e,t[o-1],t[o]);return n}function n1(e,t,n){let o=e1(n,n.map((c,u)=>u)),r=t.flatMap(c=>e.outEdges(c).map(u=>({pos:o[u.w],weight:e.edge(u).weight})).sort((u,d)=>u.pos-d.pos)),i=1;for(;i<n.length;)i<<=1;let s=2*i-1;i-=1;let a=new Array(s).fill(0),l=0;return r.forEach(c=>{let u=c.pos+i;a[u]+=c.weight;let d=0;for(;u>0;)u%2&&(d+=a[u+1]),u=u-1>>1,a[u]+=c.weight;l+=c.weight*d}),l}});var Ep=re((RR,Sp)=>{"use strict";Sp.exports=o1;function o1(e,t=[]){return t.map(n=>{let o=e.inEdges(n);if(o.length){let r=o.reduce((i,s)=>{let a=e.edge(s),l=e.node(s.v);return{sum:i.sum+a.weight*l.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:r.sum/r.weight,weight:r.weight}}else return{v:n}})}});var _p=re((MR,Cp)=>{"use strict";var r1=Ne();Cp.exports=i1;function i1(e,t){let n={};e.forEach((r,i)=>{let s=n[r.v]={indegree:0,in:[],out:[],vs:[r.v],i};r.barycenter!==void 0&&(s.barycenter=r.barycenter,s.weight=r.weight)}),t.edges().forEach(r=>{let i=n[r.v],s=n[r.w];i!==void 0&&s!==void 0&&(s.indegree++,i.out.push(n[r.w]))});let o=Object.values(n).filter(r=>!r.indegree);return s1(o)}function s1(e){let t=[];function n(r){return i=>{i.merged||(i.barycenter===void 0||r.barycenter===void 0||i.barycenter>=r.barycenter)&&a1(r,i)}}function o(r){return i=>{i.in.push(r),--i.indegree===0&&e.push(i)}}for(;e.length;){let r=e.pop();t.push(r),r.in.reverse().forEach(n(r)),r.out.forEach(o(r))}return t.filter(r=>!r.merged).map(r=>r1.pick(r,["vs","i","barycenter","weight"]))}function a1(e,t){let n=0,o=0;e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),t.weight&&(n+=t.barycenter*t.weight,o+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/o,e.weight=o,e.i=Math.min(t.i,e.i),t.merged=!0}});var kp=re((zR,Dp)=>{"use strict";var l1=Ne();Dp.exports=c1;function c1(e,t){let n=l1.partition(e,u=>Object.hasOwn(u,"barycenter")),o=n.lhs,r=n.rhs.sort((u,d)=>d.i-u.i),i=[],s=0,a=0,l=0;o.sort(u1(!!t)),l=Np(i,r,l),o.forEach(u=>{l+=u.vs.length,i.push(u.vs),s+=u.barycenter*u.weight,a+=u.weight,l=Np(i,r,l)});let c={vs:i.flat(!0)};return a&&(c.barycenter=s/a,c.weight=a),c}function Np(e,t,n){let o;for(;t.length&&(o=t[t.length-1]).i<=n;)t.pop(),e.push(o.vs),n++;return n}function u1(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}});var Pp=re((OR,Ip)=>{"use strict";var d1=Ep(),f1=_p(),h1=kp();Ip.exports=Tp;function Tp(e,t,n,o){let r=e.children(t),i=e.node(t),s=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,l={};s&&(r=r.filter(f=>f!==s&&f!==a));let c=d1(e,r);c.forEach(f=>{if(e.children(f.v).length){let h=Tp(e,f.v,n,o);l[f.v]=h,Object.hasOwn(h,"barycenter")&&m1(f,h)}});let u=f1(c,n);p1(u,l);let d=h1(u,o);if(s&&(d.vs=[s,d.vs,a].flat(!0),e.predecessors(s).length)){let f=e.node(e.predecessors(s)[0]),h=e.node(e.predecessors(a)[0]);Object.hasOwn(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+h.order)/(d.weight+2),d.weight+=2}return d}function p1(e,t){e.forEach(n=>{n.vs=n.vs.flatMap(o=>t[o]?t[o].vs:o)})}function m1(e,t){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}});var Mp=re((AR,Rp)=>{"use strict";var g1=at().Graph,y1=Ne();Rp.exports=b1;function b1(e,t,n){let o=x1(e),r=new g1({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{let s=e.node(i),a=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(r.setNode(i),r.setParent(i,a||o),e[n](i).forEach(l=>{let c=l.v===i?l.w:l.v,u=r.edge(c,i),d=u!==void 0?u.weight:0;r.setEdge(c,i,{weight:e.edge(l).weight+d})}),Object.hasOwn(s,"minRank")&&r.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),r}function x1(e){for(var t;e.hasNode(t=y1.uniqueId("_root")););return t}});var Op=re((LR,zp)=>{"use strict";zp.exports=w1;function w1(e,t,n){let o={},r;n.forEach(i=>{let s=e.parent(i),a,l;for(;s;){if(a=e.parent(s),a?(l=o[a],o[a]=s):(l=r,r=s),l&&l!==s){t.setEdge(l,s);return}s=a}})}});var Bp=re((FR,$p)=>{"use strict";var v1=xp(),S1=vp(),E1=Pp(),C1=Mp(),_1=Op(),N1=at().Graph,Si=Ne();$p.exports=Fp;function Fp(e,t){if(t&&typeof t.customOrder=="function"){t.customOrder(e,Fp);return}let n=Si.maxRank(e),o=Ap(e,Si.range(1,n+1),"inEdges"),r=Ap(e,Si.range(n-1,-1,-1),"outEdges"),i=v1(e);if(Lp(e,i),t&&t.disableOptimalOrderHeuristic)return;let s=Number.POSITIVE_INFINITY,a;for(let l=0,c=0;c<4;++l,++c){D1(l%2?o:r,l%4>=2),i=Si.buildLayerMatrix(e);let u=S1(e,i);u<s&&(c=0,a=Object.assign({},i),s=u)}Lp(e,a)}function Ap(e,t,n){return t.map(function(o){return C1(e,o,n)})}function D1(e,t){let n=new N1;e.forEach(function(o){let r=o.graph().root,i=E1(o,r,n,t);i.vs.forEach((s,a)=>o.node(s).order=a),_1(o,n,i.vs)})}function Lp(e,t){Object.values(t).forEach(n=>n.forEach((o,r)=>e.node(o).order=r))}});var Zp=re(($R,Xp)=>{"use strict";var k1=at().Graph,At=Ne();Xp.exports={positionX:P1,findType1Conflicts:Hp,findType2Conflicts:Vp,addConflict:aa,hasConflict:Wp,verticalAlignment:Kp,horizontalCompaction:qp,alignCoordinates:Gp,findSmallestWidthAlignment:Up,balance:Yp};function Hp(e,t){let n={};function o(r,i){let s=0,a=0,l=r.length,c=i[i.length-1];return i.forEach((u,d)=>{let f=T1(e,u),h=f?e.node(f).order:l;(f||u===c)&&(i.slice(a,d+1).forEach(p=>{e.predecessors(p).forEach(g=>{let w=e.node(g),m=w.order;(m<s||h<m)&&!(w.dummy&&e.node(p).dummy)&&aa(n,g,p)})}),a=d+1,s=h)}),i}return t.length&&t.reduce(o),n}function Vp(e,t){let n={};function o(i,s,a,l,c){let u;At.range(s,a).forEach(d=>{u=i[d],e.node(u).dummy&&e.predecessors(u).forEach(f=>{let h=e.node(f);h.dummy&&(h.order<l||h.order>c)&&aa(n,f,u)})})}function r(i,s){let a=-1,l,c=0;return s.forEach((u,d)=>{if(e.node(u).dummy==="border"){let f=e.predecessors(u);f.length&&(l=e.node(f[0]).order,o(s,c,d,a,l),c=d,a=l)}o(s,c,s.length,l,i.length)}),s}return t.length&&t.reduce(r),n}function T1(e,t){if(e.node(t).dummy)return e.predecessors(t).find(n=>e.node(n).dummy)}function aa(e,t,n){if(t>n){let r=t;t=n,n=r}let o=e[t];o||(e[t]=o={}),o[n]=!0}function Wp(e,t,n){if(t>n){let o=t;t=n,n=o}return!!e[t]&&Object.hasOwn(e[t],n)}function Kp(e,t,n,o){let r={},i={},s={};return t.forEach(a=>{a.forEach((l,c)=>{r[l]=l,i[l]=l,s[l]=c})}),t.forEach(a=>{let l=-1;a.forEach(c=>{let u=o(c);if(u.length){u=u.sort((f,h)=>s[f]-s[h]);let d=(u.length-1)/2;for(let f=Math.floor(d),h=Math.ceil(d);f<=h;++f){let p=u[f];i[c]===c&&l<s[p]&&!Wp(n,c,p)&&(i[p]=c,i[c]=r[c]=r[p],l=s[p])}}})}),{root:r,align:i}}function qp(e,t,n,o,r){let i={},s=I1(e,t,n,r),a=r?"borderLeft":"borderRight";function l(d,f){let h=s.nodes(),p=h.pop(),g={};for(;p;)g[p]?d(p):(g[p]=!0,h.push(p),h=h.concat(f(p))),p=h.pop()}function c(d){i[d]=s.inEdges(d).reduce((f,h)=>Math.max(f,i[h.v]+s.edge(h)),0)}function u(d){let f=s.outEdges(d).reduce((p,g)=>Math.min(p,i[g.w]-s.edge(g)),Number.POSITIVE_INFINITY),h=e.node(d);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[d]=Math.max(i[d],f))}return l(c,s.predecessors.bind(s)),l(u,s.successors.bind(s)),Object.keys(o).forEach(d=>i[d]=i[n[d]]),i}function I1(e,t,n,o){let r=new k1,i=e.graph(),s=R1(i.nodesep,i.edgesep,o);return t.forEach(a=>{let l;a.forEach(c=>{let u=n[c];if(r.setNode(u),l){var d=n[l],f=r.edge(d,u);r.setEdge(d,u,Math.max(s(e,c,l),f||0))}l=c})}),r}function Up(e,t){return Object.values(t).reduce((n,o)=>{let r=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;Object.entries(o).forEach(([a,l])=>{let c=M1(e,a)/2;r=Math.max(l+c,r),i=Math.min(l-c,i)});let s=r-i;return s<n[0]&&(n=[s,o]),n},[Number.POSITIVE_INFINITY,null])[1]}function Gp(e,t){let n=Object.values(t),o=At.applyWithChunking(Math.min,n),r=At.applyWithChunking(Math.max,n);["u","d"].forEach(i=>{["l","r"].forEach(s=>{let a=i+s,l=e[a];if(l===t)return;let c=Object.values(l),u=o-At.applyWithChunking(Math.min,c);s!=="l"&&(u=r-At.applyWithChunking(Math.max,c)),u&&(e[a]=At.mapValues(l,d=>d+u))})})}function Yp(e,t){return At.mapValues(e.ul,(n,o)=>{if(t)return e[t.toLowerCase()][o];{let r=Object.values(e).map(i=>i[o]).sort((i,s)=>i-s);return(r[1]+r[2])/2}})}function P1(e){let t=At.buildLayerMatrix(e),n=Object.assign(Hp(e,t),Vp(e,t)),o={},r;["u","d"].forEach(s=>{r=s==="u"?t:Object.values(t).reverse(),["l","r"].forEach(a=>{a==="r"&&(r=r.map(d=>Object.values(d).reverse()));let l=(s==="u"?e.predecessors:e.successors).bind(e),c=Kp(e,r,n,l),u=qp(e,r,c.root,c.align,a==="r");a==="r"&&(u=At.mapValues(u,d=>-d)),o[s+a]=u})});let i=Up(e,o);return Gp(o,i),Yp(o,e.graph().align)}function R1(e,t,n){return(o,r,i)=>{let s=o.node(r),a=o.node(i),l=0,c;if(l+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":c=-s.width/2;break;case"r":c=s.width/2;break}if(c&&(l+=n?c:-c),c=0,l+=(s.dummy?t:e)/2,l+=(a.dummy?t:e)/2,l+=a.width/2,Object.hasOwn(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":c=a.width/2;break;case"r":c=-a.width/2;break}return c&&(l+=n?c:-c),c=0,l}}function M1(e,t){return e.node(t).width}});var Jp=re((BR,Qp)=>{"use strict";var jp=Ne(),z1=Zp().positionX;Qp.exports=O1;function O1(e){e=jp.asNonCompoundGraph(e),A1(e),Object.entries(z1(e)).forEach(([t,n])=>e.node(t).x=n)}function A1(e){let t=jp.buildLayerMatrix(e),n=e.graph().ranksep,o=0;t.forEach(r=>{let i=r.reduce((s,a)=>{let l=e.node(a).height;return s>l?s:l},0);r.forEach(s=>e.node(s).y=o+i/2),o+=i+n})}});var sm=re((HR,im)=>{"use strict";var em=Hh(),tm=Wh(),L1=rp(),F1=Ne().normalizeRanks,$1=sp(),B1=Ne().removeEmptyRanks,nm=cp(),H1=fp(),om=gp(),V1=Bp(),W1=Jp(),lt=Ne(),K1=at().Graph;im.exports=q1;function q1(e,t){let n=t&&t.debugTiming?lt.time:lt.notime;n("layout",()=>{let o=n("  buildLayoutGraph",()=>tC(e));n("  runLayout",()=>U1(o,n,t)),n("  updateInputGraph",()=>G1(e,o))})}function U1(e,t,n){t("    makeSpaceForEdgeLabels",()=>nC(e)),t("    removeSelfEdges",()=>dC(e)),t("    acyclic",()=>em.run(e)),t("    nestingGraph.run",()=>nm.run(e)),t("    rank",()=>L1(lt.asNonCompoundGraph(e))),t("    injectEdgeLabelProxies",()=>oC(e)),t("    removeEmptyRanks",()=>B1(e)),t("    nestingGraph.cleanup",()=>nm.cleanup(e)),t("    normalizeRanks",()=>F1(e)),t("    assignRankMinMax",()=>rC(e)),t("    removeEdgeLabelProxies",()=>iC(e)),t("    normalize.run",()=>tm.run(e)),t("    parentDummyChains",()=>$1(e)),t("    addBorderSegments",()=>H1(e)),t("    order",()=>V1(e,n)),t("    insertSelfEdges",()=>fC(e)),t("    adjustCoordinateSystem",()=>om.adjust(e)),t("    position",()=>W1(e)),t("    positionSelfEdges",()=>hC(e)),t("    removeBorderNodes",()=>uC(e)),t("    normalize.undo",()=>tm.undo(e)),t("    fixupEdgeLabelCoords",()=>lC(e)),t("    undoCoordinateSystem",()=>om.undo(e)),t("    translateGraph",()=>sC(e)),t("    assignNodeIntersects",()=>aC(e)),t("    reversePoints",()=>cC(e)),t("    acyclic.undo",()=>em.undo(e))}function G1(e,t){e.nodes().forEach(n=>{let o=e.node(n),r=t.node(n);o&&(o.x=r.x,o.y=r.y,o.rank=r.rank,t.children(n).length&&(o.width=r.width,o.height=r.height))}),e.edges().forEach(n=>{let o=e.edge(n),r=t.edge(n);o.points=r.points,Object.hasOwn(r,"x")&&(o.x=r.x,o.y=r.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var Y1=["nodesep","edgesep","ranksep","marginx","marginy"],X1={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},Z1=["acyclicer","ranker","rankdir","align"],j1=["width","height"],rm={width:0,height:0},Q1=["minlen","weight","width","height","labeloffset"],J1={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},eC=["labelpos"];function tC(e){let t=new K1({multigraph:!0,compound:!0}),n=ca(e.graph());return t.setGraph(Object.assign({},X1,la(n,Y1),lt.pick(n,Z1))),e.nodes().forEach(o=>{let r=ca(e.node(o)),i=la(r,j1);Object.keys(rm).forEach(s=>{i[s]===void 0&&(i[s]=rm[s])}),t.setNode(o,i),t.setParent(o,e.parent(o))}),e.edges().forEach(o=>{let r=ca(e.edge(o));t.setEdge(o,Object.assign({},J1,la(r,Q1),lt.pick(r,eC)))}),t}function nC(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let o=e.edge(n);o.minlen*=2,o.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?o.width+=o.labeloffset:o.height+=o.labeloffset)})}function oC(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let o=e.node(t.v),i={rank:(e.node(t.w).rank-o.rank)/2+o.rank,e:t};lt.addDummyNode(e,"edge-proxy",i,"_ep")}})}function rC(e){let t=0;e.nodes().forEach(n=>{let o=e.node(n);o.borderTop&&(o.minRank=e.node(o.borderTop).rank,o.maxRank=e.node(o.borderBottom).rank,t=Math.max(t,o.maxRank))}),e.graph().maxRank=t}function iC(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function sC(e){let t=Number.POSITIVE_INFINITY,n=0,o=Number.POSITIVE_INFINITY,r=0,i=e.graph(),s=i.marginx||0,a=i.marginy||0;function l(c){let u=c.x,d=c.y,f=c.width,h=c.height;t=Math.min(t,u-f/2),n=Math.max(n,u+f/2),o=Math.min(o,d-h/2),r=Math.max(r,d+h/2)}e.nodes().forEach(c=>l(e.node(c))),e.edges().forEach(c=>{let u=e.edge(c);Object.hasOwn(u,"x")&&l(u)}),t-=s,o-=a,e.nodes().forEach(c=>{let u=e.node(c);u.x-=t,u.y-=o}),e.edges().forEach(c=>{let u=e.edge(c);u.points.forEach(d=>{d.x-=t,d.y-=o}),Object.hasOwn(u,"x")&&(u.x-=t),Object.hasOwn(u,"y")&&(u.y-=o)}),i.width=n-t+s,i.height=r-o+a}function aC(e){e.edges().forEach(t=>{let n=e.edge(t),o=e.node(t.v),r=e.node(t.w),i,s;n.points?(i=n.points[0],s=n.points[n.points.length-1]):(n.points=[],i=r,s=o),n.points.unshift(lt.intersectRect(o,i)),n.points.push(lt.intersectRect(r,s))})}function lC(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function cC(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function uC(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),o=e.node(n.borderTop),r=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),s=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(s.x-i.x),n.height=Math.abs(r.y-o.y),n.x=i.x+n.width/2,n.y=o.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy==="border"&&e.removeNode(t)})}function dC(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function fC(e){var t=lt.buildLayerMatrix(e);t.forEach(n=>{var o=0;n.forEach((r,i)=>{var s=e.node(r);s.order=i+o,(s.selfEdges||[]).forEach(a=>{lt.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:i+ ++o,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function hC(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy==="selfedge"){var o=e.node(n.e.v),r=o.x+o.width/2,i=o.y,s=n.x-r,a=o.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:r+2*s/3,y:i-a},{x:r+5*s/6,y:i-a},{x:r+s,y:i},{x:r+5*s/6,y:i+a},{x:r+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function la(e,t){return lt.mapValues(lt.pick(e,t),Number)}function ca(e){var t={};return e&&Object.entries(e).forEach(([n,o])=>{typeof n=="string"&&(n=n.toLowerCase()),t[n]=o}),t}});var lm=re((VR,am)=>{"use strict";var pC=Ne(),mC=at().Graph;am.exports={debugOrdering:gC};function gC(e){let t=pC.buildLayerMatrix(e),n=new mC({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(o=>{n.setNode(o,{label:o}),n.setParent(o,"layer"+e.node(o).rank)}),e.edges().forEach(o=>n.setEdge(o.v,o.w,{},o.name)),t.forEach((o,r)=>{let i="layer"+r;n.setNode(i,{rank:"same"}),o.reduce((s,a)=>(n.setEdge(s,a,{style:"invis"}),a))}),n}});var um=re((WR,cm)=>{"use strict";cm.exports="1.1.4"});var fm=re((KR,dm)=>{"use strict";dm.exports={graphlib:at(),layout:sm(),debug:lm(),util:{time:Ne().time,notime:Ne().notime},version:um()}});var Vg=X(qy());var bt=X(me());var pt=X(Uy()),he;(d=>{let e;(w=>(w[w.CASCADE=0]="CASCADE",w[w.NO_ACTION=1]="NO_ACTION",w[w.SET_NULL=2]="SET_NULL",w[w.SET_DEFAULT=3]="SET_DEFAULT"))(e=d.OnAction||={});let t;(g=>(g[g.Created=0]="Created",g[g.Updated=1]="Updated",g[g.Dropped=2]="Dropped"))(t=d.SchemaDesignerReportTableState||={});let n;(h=>h.type=new pt.RequestType("publishSession"))(n=d.PublishSessionRequest||={});let o;(h=>h.type=new pt.NotificationType("closeDesigner"))(o=d.CloseSchemaDesignerNotification||={});let r;(h=>h.type=new pt.NotificationType("openInEditorWithConnection"))(r=d.OpenInEditorWithConnectionNotification||={});let i;(h=>h.type=new pt.NotificationType("openInEditor"))(i=d.OpenInEditorNotification||={});let s;(h=>h.type=new pt.NotificationType("copyToClipboard"))(s=d.CopyToClipboardNotification||={});let a;(h=>h.type=new pt.RequestType("getReport"))(a=d.GetReportWebviewRequest||={});let l;(h=>h.type=new pt.NotificationType("exportToFile"))(l=d.ExportToFileNotification||={});let c;(h=>h.type=new pt.RequestType("getDefinition"))(c=d.GetDefinitionRequest||={});let u;(h=>h.type=new pt.RequestType("initializeSchemaDesigner"))(u=d.InitializeSchemaDesignerRequest||={})})(he||={});var M=X(ie()),B=X(me());function Se(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=Se(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Gy={value:()=>{}};function Zl(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new br(n)}function br(e){this._=e}function Yy(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}br.prototype=Zl.prototype={constructor:br,on:function(e,t){var n=this._,o=Yy(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=Xy(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=Xl(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Xl(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new br(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function Xy(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function Xl(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=Gy,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var rn=Zl;var xr="http://www.w3.org/1999/xhtml",Xi={svg:"http://www.w3.org/2000/svg",xhtml:xr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Pt(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Xi.hasOwnProperty(t)?{space:Xi[t],local:e}:e}function Zy(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xr&&t.documentElement.namespaceURI===xr?t.createElement(e):t.createElementNS(n,e)}}function jy(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function wr(e){var t=Pt(e);return(t.local?jy:Zy)(t)}function Qy(){}function sn(e){return e==null?Qy:function(){return this.querySelector(e)}}function jl(e){typeof e!="function"&&(e=sn(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),l,c,u=0;u<s;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new Ee(o,this._parents)}function Zi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Jy(){return[]}function co(e){return e==null?Jy:function(){return this.querySelectorAll(e)}}function eb(e){return function(){return Zi(e.apply(this,arguments))}}function Ql(e){typeof e=="function"?e=eb(e):e=co(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&(o.push(e.call(l,l.__data__,c,s)),r.push(l));return new Ee(o,r)}function uo(e){return function(){return this.matches(e)}}function vr(e){return function(t){return t.matches(e)}}var tb=Array.prototype.find;function nb(e){return function(){return tb.call(this.children,e)}}function ob(){return this.firstElementChild}function Jl(e){return this.select(e==null?ob:nb(typeof e=="function"?e:vr(e)))}var rb=Array.prototype.filter;function ib(){return Array.from(this.children)}function sb(e){return function(){return rb.call(this.children,e)}}function ec(e){return this.selectAll(e==null?ib:sb(typeof e=="function"?e:vr(e)))}function tc(e){typeof e!="function"&&(e=uo(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Ee(o,this._parents)}function Sr(e){return new Array(e.length)}function nc(){return new Ee(this._enter||this._groups.map(Sr),this._parents)}function fo(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}fo.prototype={constructor:fo,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function oc(e){return function(){return e}}function ab(e,t,n,o,r,i){for(var s=0,a,l=t.length,c=i.length;s<c;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new fo(e,i[s]);for(;s<l;++s)(a=t[s])&&(r[s]=a)}function lb(e,t,n,o,r,i,s){var a,l,c=new Map,u=t.length,d=i.length,f=new Array(u),h;for(a=0;a<u;++a)(l=t[a])&&(f[a]=h=s.call(l,l.__data__,a,t)+"",c.has(h)?r[a]=l:c.set(h,l));for(a=0;a<d;++a)h=s.call(e,i[a],a,i)+"",(l=c.get(h))?(o[a]=l,l.__data__=i[a],c.delete(h)):n[a]=new fo(e,i[a]);for(a=0;a<u;++a)(l=t[a])&&c.get(f[a])===l&&(r[a]=l)}function cb(e){return e.__data__}function rc(e,t){if(!arguments.length)return Array.from(this,cb);var n=t?lb:ab,o=this._parents,r=this._groups;typeof e!="function"&&(e=oc(e));for(var i=r.length,s=new Array(i),a=new Array(i),l=new Array(i),c=0;c<i;++c){var u=o[c],d=r[c],f=d.length,h=ub(e.call(u,u&&u.__data__,c,o)),p=h.length,g=a[c]=new Array(p),w=s[c]=new Array(p),m=l[c]=new Array(f);n(u,d,g,w,m,h,t);for(var x=0,y=0,b,C;x<p;++x)if(b=g[x]){for(x>=y&&(y=x+1);!(C=w[y])&&++y<p;);b._next=C||null}}return s=new Ee(s,o),s._enter=a,s._exit=l,s}function ub(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ic(){return new Ee(this._exit||this._groups.map(Sr),this._parents)}function sc(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function ac(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),l=0;l<s;++l)for(var c=n[l],u=o[l],d=c.length,f=a[l]=new Array(d),h,p=0;p<d;++p)(h=c[p]||u[p])&&(f[p]=h);for(;l<r;++l)a[l]=n[l];return new Ee(a,this._parents)}function lc(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function cc(e){e||(e=db);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,l=r[i]=new Array(a),c,u=0;u<a;++u)(c=s[u])&&(l[u]=c);l.sort(t)}return new Ee(r,this._parents).order()}function db(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function uc(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function dc(){return Array.from(this)}function fc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function hc(){let e=0;for(let t of this)++e;return e}function pc(){return!this.node()}function mc(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function fb(e){return function(){this.removeAttribute(e)}}function hb(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pb(e,t){return function(){this.setAttribute(e,t)}}function mb(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function gb(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function yb(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function gc(e,t){var n=Pt(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?hb:fb:typeof t=="function"?n.local?yb:gb:n.local?mb:pb)(n,t))}function Er(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bb(e){return function(){this.style.removeProperty(e)}}function xb(e,t,n){return function(){this.style.setProperty(e,t,n)}}function wb(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function yc(e,t,n){return arguments.length>1?this.each((t==null?bb:typeof t=="function"?wb:xb)(e,t,n??"")):Vt(this.node(),e)}function Vt(e,t){return e.style.getPropertyValue(t)||Er(e).getComputedStyle(e,null).getPropertyValue(t)}function vb(e){return function(){delete this[e]}}function Sb(e,t){return function(){this[e]=t}}function Eb(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function bc(e,t){return arguments.length>1?this.each((t==null?vb:typeof t=="function"?Eb:Sb)(e,t)):this.node()[e]}function xc(e){return e.trim().split(/^|\s+/)}function ji(e){return e.classList||new wc(e)}function wc(e){this._node=e,this._names=xc(e.getAttribute("class")||"")}wc.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function vc(e,t){for(var n=ji(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function Sc(e,t){for(var n=ji(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function Cb(e){return function(){vc(this,e)}}function _b(e){return function(){Sc(this,e)}}function Nb(e,t){return function(){(t.apply(this,arguments)?vc:Sc)(this,e)}}function Ec(e,t){var n=xc(e+"");if(arguments.length<2){for(var o=ji(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Nb:t?Cb:_b)(n,t))}function Db(){this.textContent=""}function kb(e){return function(){this.textContent=e}}function Tb(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Cc(e){return arguments.length?this.each(e==null?Db:(typeof e=="function"?Tb:kb)(e)):this.node().textContent}function Ib(){this.innerHTML=""}function Pb(e){return function(){this.innerHTML=e}}function Rb(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function _c(e){return arguments.length?this.each(e==null?Ib:(typeof e=="function"?Rb:Pb)(e)):this.node().innerHTML}function Mb(){this.nextSibling&&this.parentNode.appendChild(this)}function Nc(){return this.each(Mb)}function zb(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Dc(){return this.each(zb)}function kc(e){var t=typeof e=="function"?e:wr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ob(){return null}function Tc(e,t){var n=typeof e=="function"?e:wr(e),o=t==null?Ob:typeof t=="function"?t:sn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Ab(){var e=this.parentNode;e&&e.removeChild(this)}function Ic(){return this.each(Ab)}function Lb(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fb(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Pc(e){return this.select(e?Fb:Lb)}function Rc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function $b(e){return function(t){e.call(this,t,this.__data__)}}function Bb(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Hb(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function Vb(e,t,n){return function(){var o=this.__on,r,i=$b(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function Mc(e,t,n){var o=Bb(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(r=0,u=a[l];r<i;++r)if((s=o[r]).type===u.type&&s.name===u.name)return u.value}return}for(a=t?Vb:Hb,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function zc(e,t,n){var o=Er(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Wb(e,t){return function(){return zc(this,e,t)}}function Kb(e,t){return function(){return zc(this,e,t.apply(this,arguments))}}function Oc(e,t){return this.each((typeof t=="function"?Kb:Wb)(e,t))}function*Ac(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Qi=[null];function Ee(e,t){this._groups=e,this._parents=t}function Lc(){return new Ee([[document.documentElement]],Qi)}function qb(){return this}Ee.prototype=Lc.prototype={constructor:Ee,select:jl,selectAll:Ql,selectChild:Jl,selectChildren:ec,filter:tc,data:rc,enter:nc,exit:ic,join:sc,merge:ac,selection:qb,order:lc,sort:cc,call:uc,nodes:dc,node:fc,size:hc,empty:pc,each:mc,attr:gc,style:yc,property:bc,classed:Ec,text:Cc,html:_c,raise:Nc,lower:Dc,append:kc,insert:Tc,remove:Ic,clone:Pc,datum:Rc,on:Mc,dispatch:Oc,[Symbol.iterator]:Ac};var Rt=Lc;function Oe(e){return typeof e=="string"?new Ee([[document.querySelector(e)]],[document.documentElement]):new Ee([[e]],Qi)}function Fc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function He(e,t){if(e=Fc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}var $c={passive:!1},an={capture:!0,passive:!1};function Cr(e){e.stopImmediatePropagation()}function Wt(e){e.preventDefault(),e.stopImmediatePropagation()}function ho(e){var t=e.document.documentElement,n=Oe(e).on("dragstart.drag",Wt,an);"onselectstart"in t?n.on("selectstart.drag",Wt,an):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function po(e,t){var n=e.document.documentElement,o=Oe(e).on("dragstart.drag",null);t&&(o.on("click.drag",Wt,an),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var mo=e=>()=>e;function go(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}go.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ub(e){return!e.ctrlKey&&!e.button}function Gb(){return this.parentNode}function Yb(e,t){return t??{x:e.x,y:e.y}}function Xb(){return navigator.maxTouchPoints||"ontouchstart"in this}function _r(){var e=Ub,t=Gb,n=Yb,o=Xb,r={},i=rn("start","drag","end"),s=0,a,l,c,u,d=0;function f(b){b.on("mousedown.drag",h).filter(o).on("touchstart.drag",w).on("touchmove.drag",m,$c).on("touchend.drag touchcancel.drag",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(b,C){if(!(u||!e.call(this,b,C))){var E=y(this,t.call(this,b,C),b,C,"mouse");E&&(Oe(b.view).on("mousemove.drag",p,an).on("mouseup.drag",g,an),ho(b.view),Cr(b),c=!1,a=b.clientX,l=b.clientY,E("start",b))}}function p(b){if(Wt(b),!c){var C=b.clientX-a,E=b.clientY-l;c=C*C+E*E>d}r.mouse("drag",b)}function g(b){Oe(b.view).on("mousemove.drag mouseup.drag",null),po(b.view,c),Wt(b),r.mouse("end",b)}function w(b,C){if(e.call(this,b,C)){var E=b.changedTouches,_=t.call(this,b,C),I=E.length,R,O;for(R=0;R<I;++R)(O=y(this,_,b,C,E[R].identifier,E[R]))&&(Cr(b),O("start",b,E[R]))}}function m(b){var C=b.changedTouches,E=C.length,_,I;for(_=0;_<E;++_)(I=r[C[_].identifier])&&(Wt(b),I("drag",b,C[_]))}function x(b){var C=b.changedTouches,E=C.length,_,I;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),_=0;_<E;++_)(I=r[C[_].identifier])&&(Cr(b),I("end",b,C[_]))}function y(b,C,E,_,I,R){var O=i.copy(),q=He(R||E,C),L,U,v;if((v=n.call(b,new go("beforestart",{sourceEvent:E,target:f,identifier:I,active:s,x:q[0],y:q[1],dx:0,dy:0,dispatch:O}),_))!=null)return L=v.x-q[0]||0,U=v.y-q[1]||0,function N(S,k,A){var D=q,F;switch(S){case"start":r[I]=N,F=s++;break;case"end":delete r[I],--s;case"drag":q=He(A||k,C),F=s;break}O.call(S,b,new go(S,{sourceEvent:k,subject:v,target:f,identifier:I,active:F,x:q[0]+L,y:q[1]+U,dx:q[0]-D[0],dy:q[1]-D[1],dispatch:O}),_)}}return f.filter=function(b){return arguments.length?(e=typeof b=="function"?b:mo(!!b),f):e},f.container=function(b){return arguments.length?(t=typeof b=="function"?b:mo(b),f):t},f.subject=function(b){return arguments.length?(n=typeof b=="function"?b:mo(b),f):n},f.touchable=function(b){return arguments.length?(o=typeof b=="function"?b:mo(!!b),f):o},f.on=function(){var b=i.on.apply(i,arguments);return b===i?f:b},f.clickDistance=function(b){return arguments.length?(d=(b=+b)*b,f):Math.sqrt(d)},f}function Nr(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ji(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function xo(){}var yo=.7,Tr=1/yo,Fn="\\s*([+-]?\\d+)\\s*",bo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",St="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Zb=/^#([0-9a-f]{3,8})$/,jb=new RegExp(`^rgb\\(${Fn},${Fn},${Fn}\\)$`),Qb=new RegExp(`^rgb\\(${St},${St},${St}\\)$`),Jb=new RegExp(`^rgba\\(${Fn},${Fn},${Fn},${bo}\\)$`),e0=new RegExp(`^rgba\\(${St},${St},${St},${bo}\\)$`),t0=new RegExp(`^hsl\\(${bo},${St},${St}\\)$`),n0=new RegExp(`^hsla\\(${bo},${St},${St},${bo}\\)$`),Bc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Nr(xo,Kt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Hc,formatHex:Hc,formatHex8:o0,formatHsl:r0,formatRgb:Vc,toString:Vc});function Hc(){return this.rgb().formatHex()}function o0(){return this.rgb().formatHex8()}function r0(){return Yc(this).formatHsl()}function Vc(){return this.rgb().formatRgb()}function Kt(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Zb.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Wc(t):n===3?new Ue(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Dr(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Dr(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jb.exec(e))?new Ue(t[1],t[2],t[3],1):(t=Qb.exec(e))?new Ue(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Jb.exec(e))?Dr(t[1],t[2],t[3],t[4]):(t=e0.exec(e))?Dr(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=t0.exec(e))?Uc(t[1],t[2]/100,t[3]/100,1):(t=n0.exec(e))?Uc(t[1],t[2]/100,t[3]/100,t[4]):Bc.hasOwnProperty(e)?Wc(Bc[e]):e==="transparent"?new Ue(NaN,NaN,NaN,0):null}function Wc(e){return new Ue(e>>16&255,e>>8&255,e&255,1)}function Dr(e,t,n,o){return o<=0&&(e=t=n=NaN),new Ue(e,t,n,o)}function i0(e){return e instanceof xo||(e=Kt(e)),e?(e=e.rgb(),new Ue(e.r,e.g,e.b,e.opacity)):new Ue}function $n(e,t,n,o){return arguments.length===1?i0(e):new Ue(e,t,n,o??1)}function Ue(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}Nr(Ue,$n,Ji(xo,{brighter(e){return e=e==null?Tr:Math.pow(Tr,e),new Ue(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yo:Math.pow(yo,e),new Ue(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ue(cn(this.r),cn(this.g),cn(this.b),Ir(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Kc,formatHex:Kc,formatHex8:s0,formatRgb:qc,toString:qc}));function Kc(){return`#${ln(this.r)}${ln(this.g)}${ln(this.b)}`}function s0(){return`#${ln(this.r)}${ln(this.g)}${ln(this.b)}${ln((isNaN(this.opacity)?1:this.opacity)*255)}`}function qc(){let e=Ir(this.opacity);return`${e===1?"rgb(":"rgba("}${cn(this.r)}, ${cn(this.g)}, ${cn(this.b)}${e===1?")":`, ${e})`}`}function Ir(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function cn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ln(e){return e=cn(e),(e<16?"0":"")+e.toString(16)}function Uc(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new mt(e,t,n,o)}function Yc(e){if(e instanceof mt)return new mt(e.h,e.s,e.l,e.opacity);if(e instanceof xo||(e=Kt(e)),!e)return new mt;if(e instanceof mt)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,l=(i+r)/2;return a?(t===i?s=(n-o)/a+(n<o)*6:n===i?s=(o-t)/a+2:s=(t-n)/a+4,a/=l<.5?i+r:2-i-r,s*=60):a=l>0&&l<1?0:s,new mt(s,a,l,e.opacity)}function Xc(e,t,n,o){return arguments.length===1?Yc(e):new mt(e,t,n,o??1)}function mt(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}Nr(mt,Xc,Ji(xo,{brighter(e){return e=e==null?Tr:Math.pow(Tr,e),new mt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yo:Math.pow(yo,e),new mt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new Ue(es(e>=240?e-240:e+120,r,o),es(e,r,o),es(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new mt(Gc(this.h),kr(this.s),kr(this.l),Ir(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Ir(this.opacity);return`${e===1?"hsl(":"hsla("}${Gc(this.h)}, ${kr(this.s)*100}%, ${kr(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Gc(e){return e=(e||0)%360,e<0?e+360:e}function kr(e){return Math.max(0,Math.min(1,e||0))}function es(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}function ts(e,t,n,o,r){var i=e*e,s=i*e;return((1-3*e+3*i-s)*t+(4-6*i+3*s)*n+(1+3*e+3*i-3*s)*o+s*r)/6}function Zc(e){var t=e.length-1;return function(n){var o=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[o],i=e[o+1],s=o>0?e[o-1]:2*r-i,a=o<t-1?e[o+2]:2*i-r;return ts((n-o/t)*t,s,r,i,a)}}function jc(e){var t=e.length;return function(n){var o=Math.floor(((n%=1)<0?++n:n)*t),r=e[(o+t-1)%t],i=e[o%t],s=e[(o+1)%t],a=e[(o+2)%t];return ts((n-o/t)*t,r,i,s,a)}}var ns=e=>()=>e;function a0(e,t){return function(n){return e+n*t}}function l0(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function Qc(e){return(e=+e)==1?Pr:function(t,n){return n-t?l0(t,n,e):ns(isNaN(t)?n:t)}}function Pr(e,t){var n=t-e;return n?a0(e,n):ns(isNaN(e)?t:e)}var Rr=function e(t){var n=Qc(t);function o(r,i){var s=n((r=$n(r)).r,(i=$n(i)).r),a=n(r.g,i.g),l=n(r.b,i.b),c=Pr(r.opacity,i.opacity);return function(u){return r.r=s(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return o.gamma=e,o}(1);function Jc(e){return function(t){var n=t.length,o=new Array(n),r=new Array(n),i=new Array(n),s,a;for(s=0;s<n;++s)a=$n(t[s]),o[s]=a.r||0,r[s]=a.g||0,i[s]=a.b||0;return o=e(o),r=e(r),i=e(i),a.opacity=1,function(l){return a.r=o(l),a.g=r(l),a.b=i(l),a+""}}}var c0=Jc(Zc),u0=Jc(jc);function rt(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var rs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,os=new RegExp(rs.source,"g");function d0(e){return function(){return e}}function f0(e){return function(t){return e(t)+""}}function is(e,t){var n=rs.lastIndex=os.lastIndex=0,o,r,i,s=-1,a=[],l=[];for(e=e+"",t=t+"";(o=rs.exec(e))&&(r=os.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(o=o[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:rt(o,r)})),n=os.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?f0(l[0].x):d0(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}var eu=180/Math.PI,Mr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ss(e,t,n,o,r,i){var s,a,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*o)&&(n-=e*l,o-=t*l),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,l/=a),e*o<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*eu,skewX:Math.atan(l)*eu,scaleX:s,scaleY:a}}var zr;function tu(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Mr:ss(t.a,t.b,t.c,t.d,t.e,t.f)}function nu(e){return e==null?Mr:(zr||(zr=document.createElementNS("http://www.w3.org/2000/svg","g")),zr.setAttribute("transform",e),(e=zr.transform.baseVal.consolidate())?(e=e.matrix,ss(e.a,e.b,e.c,e.d,e.e,e.f)):Mr)}function ou(e,t,n,o){function r(c){return c.length?c.pop()+" ":""}function i(c,u,d,f,h,p){if(c!==d||u!==f){var g=h.push("translate(",null,t,null,n);p.push({i:g-4,x:rt(c,d)},{i:g-2,x:rt(u,f)})}else(d||f)&&h.push("translate("+d+t+f+n)}function s(c,u,d,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:d.push(r(d)+"rotate(",null,o)-2,x:rt(c,u)})):u&&d.push(r(d)+"rotate("+u+o)}function a(c,u,d,f){c!==u?f.push({i:d.push(r(d)+"skewX(",null,o)-2,x:rt(c,u)}):u&&d.push(r(d)+"skewX("+u+o)}function l(c,u,d,f,h,p){if(c!==d||u!==f){var g=h.push(r(h)+"scale(",null,",",null,")");p.push({i:g-4,x:rt(c,d)},{i:g-2,x:rt(u,f)})}else(d!==1||f!==1)&&h.push(r(h)+"scale("+d+","+f+")")}return function(c,u){var d=[],f=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,f),s(c.rotate,u.rotate,d,f),a(c.skewX,u.skewX,d,f),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,f),c=u=null,function(h){for(var p=-1,g=f.length,w;++p<g;)d[(w=f[p]).i]=w.x(h);return d.join("")}}}var as=ou(tu,"px, ","px)","deg)"),ls=ou(nu,", ",")",")");var h0=1e-12;function ru(e){return((e=Math.exp(e))+1/e)/2}function p0(e){return((e=Math.exp(e))-1/e)/2}function m0(e){return((e=Math.exp(2*e))-1)/(e+1)}var cs=function e(t,n,o){function r(i,s){var a=i[0],l=i[1],c=i[2],u=s[0],d=s[1],f=s[2],h=u-a,p=d-l,g=h*h+p*p,w,m;if(g<h0)m=Math.log(f/c)/t,w=function(_){return[a+_*h,l+_*p,c*Math.exp(t*_*m)]};else{var x=Math.sqrt(g),y=(f*f-c*c+o*g)/(2*c*n*x),b=(f*f-c*c-o*g)/(2*f*n*x),C=Math.log(Math.sqrt(y*y+1)-y),E=Math.log(Math.sqrt(b*b+1)-b);m=(E-C)/t,w=function(_){var I=_*m,R=ru(C),O=c/(n*x)*(R*m0(t*I+C)-p0(C));return[a+O*h,l+O*p,c*R/ru(t*I+C)]}}return w.duration=m*1e3*t/Math.SQRT2,w}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,l=a*a;return e(s,a,l)},r}(Math.SQRT2,2,4);var Bn=0,vo=0,wo=0,su=1e3,Or,So,Ar=0,un=0,Lr=0,Eo=typeof performance=="object"&&performance.now?performance:Date,au=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function _o(){return un||(au(g0),un=Eo.now()+Lr)}function g0(){un=0}function Co(){this._call=this._time=this._next=null}Co.prototype=Fr.prototype={constructor:Co,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?_o():+n)+(t==null?0:+t),!this._next&&So!==this&&(So?So._next=this:Or=this,So=this),this._call=e,this._time=n,us()},stop:function(){this._call&&(this._call=null,this._time=1/0,us())}};function Fr(e,t,n){var o=new Co;return o.restart(e,t,n),o}function lu(){_o(),++Bn;for(var e=Or,t;e;)(t=un-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Bn}function iu(){un=(Ar=Eo.now())+Lr,Bn=vo=0;try{lu()}finally{Bn=0,b0(),un=0}}function y0(){var e=Eo.now(),t=e-Ar;t>su&&(Lr-=t,Ar=e)}function b0(){for(var e,t=Or,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Or=n);So=e,us(o)}function us(e){if(!Bn){vo&&(vo=clearTimeout(vo));var t=e-un;t>24?(e<1/0&&(vo=setTimeout(iu,e-Eo.now()-Lr)),wo&&(wo=clearInterval(wo))):(wo||(Ar=Eo.now(),wo=setInterval(y0,su)),Bn=1,au(iu))}}function $r(e,t,n){var o=new Co;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var x0=rn("start","end","cancel","interrupt"),w0=[],du=0,cu=1,Hr=2,Br=3,uu=4,Vr=5,No=6;function qt(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;v0(e,n,{name:t,index:o,group:r,on:x0,tween:w0,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:du})}function Do(e,t){var n=Re(e,t);if(n.state>du)throw new Error("too late; already scheduled");return n}function Le(e,t){var n=Re(e,t);if(n.state>Br)throw new Error("too late; already running");return n}function Re(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function v0(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=Fr(i,0,n.time);function i(c){n.state=cu,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,d,f,h;if(n.state!==cu)return l();for(u in o)if(h=o[u],h.name===n.name){if(h.state===Br)return $r(s);h.state===uu?(h.state=No,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete o[u]):+u<t&&(h.state=No,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete o[u])}if($r(function(){n.state===Br&&(n.state=uu,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Hr,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Hr){for(n.state=Br,r=new Array(f=n.tween.length),u=0,d=-1;u<f;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++d]=h);r.length=d+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Vr,1),d=-1,f=r.length;++d<f;)r[d].call(e,u);n.state===Vr&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=No,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function dn(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>Hr&&o.state<Vr,o.state=No,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function fu(e){return this.each(function(){dn(this,e)})}function S0(e,t){var n,o;return function(){var r=Le(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function E0(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=Le(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===t){r[l]=a;break}l===c&&r.push(a)}i.tween=r}}function hu(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=Re(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?S0:E0)(n,e,t))}function Hn(e,t,n){var o=e._id;return e.each(function(){var r=Le(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return Re(r,o).value[t]}}function Wr(e,t){var n;return(typeof t=="number"?rt:t instanceof Kt?Rr:(n=Kt(t))?(t=n,Rr):is)(e,t)}function C0(e){return function(){this.removeAttribute(e)}}function _0(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N0(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function D0(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function k0(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function T0(e,t,n){var o,r,i;return function(){var s,a=n(this),l;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),l=a+"",s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a)))}}function pu(e,t){var n=Pt(e),o=n==="transform"?ls:Wr;return this.attrTween(e,typeof t=="function"?(n.local?T0:k0)(n,o,Hn(this,"attr."+e,t)):t==null?(n.local?_0:C0)(n):(n.local?D0:N0)(n,o,t))}function I0(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function P0(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function R0(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&P0(e,i)),n}return r._value=t,r}function M0(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&I0(e,i)),n}return r._value=t,r}function mu(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=Pt(e);return this.tween(n,(o.local?R0:M0)(o,t))}function z0(e,t){return function(){Do(this,e).delay=+t.apply(this,arguments)}}function O0(e,t){return t=+t,function(){Do(this,e).delay=t}}function gu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?z0:O0)(t,e)):Re(this.node(),t).delay}function A0(e,t){return function(){Le(this,e).duration=+t.apply(this,arguments)}}function L0(e,t){return t=+t,function(){Le(this,e).duration=t}}function yu(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?A0:L0)(t,e)):Re(this.node(),t).duration}function F0(e,t){if(typeof t!="function")throw new Error;return function(){Le(this,e).ease=t}}function bu(e){var t=this._id;return arguments.length?this.each(F0(t,e)):Re(this.node(),t).ease}function $0(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Le(this,e).ease=n}}function xu(e){if(typeof e!="function")throw new Error;return this.each($0(this._id,e))}function wu(e){typeof e!="function"&&(e=uo(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],l,c=0;c<s;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&a.push(l);return new Ve(o,this._parents,this._name,this._id)}function vu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var l=t[a],c=n[a],u=l.length,d=s[a]=new Array(u),f,h=0;h<u;++h)(f=l[h]||c[h])&&(d[h]=f);for(;a<o;++a)s[a]=t[a];return new Ve(s,this._parents,this._name,this._id)}function B0(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function H0(e,t,n){var o,r,i=B0(t)?Do:Le;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function Su(e,t){var n=this._id;return arguments.length<2?Re(this.node(),n).on.on(e):this.each(H0(n,e,t))}function V0(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Eu(){return this.on("end.remove",V0(this._id))}function Cu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=sn(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],l=a.length,c=i[s]=new Array(l),u,d,f=0;f<l;++f)(u=a[f])&&(d=e.call(u,u.__data__,f,a))&&("__data__"in u&&(d.__data__=u.__data__),c[f]=d,qt(c[f],t,n,f,c,Re(u,n)));return new Ve(i,this._parents,t,n)}function _u(e){var t=this._name,n=this._id;typeof e!="function"&&(e=co(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var l=o[a],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var f=e.call(u,u.__data__,d,l),h,p=Re(u,n),g=0,w=f.length;g<w;++g)(h=f[g])&&qt(h,t,n,g,f,p);i.push(f),s.push(u)}return new Ve(i,s,t,n)}var W0=Rt.prototype.constructor;function Nu(){return new W0(this._groups,this._parents)}function K0(e,t){var n,o,r;return function(){var i=Vt(this,e),s=(this.style.removeProperty(e),Vt(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function Du(e){return function(){this.style.removeProperty(e)}}function q0(e,t,n){var o,r=n+"",i;return function(){var s=Vt(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function U0(e,t,n){var o,r,i;return function(){var s=Vt(this,e),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(e),Vt(this,e))),s===l?null:s===o&&l===r?i:(r=l,i=t(o=s,a))}}function G0(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var l=Le(this,e),c=l.on,u=l.value[i]==null?a||(a=Du(t)):void 0;(c!==n||r!==u)&&(o=(n=c).copy()).on(s,r=u),l.on=o}}function ku(e,t,n){var o=(e+="")=="transform"?as:Wr;return t==null?this.styleTween(e,K0(e,o)).on("end.style."+e,Du(e)):typeof t=="function"?this.styleTween(e,U0(e,o,Hn(this,"style."+e,t))).each(G0(this._id,e)):this.styleTween(e,q0(e,o,t),n).on("end.style."+e,null)}function Y0(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function X0(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&Y0(e,s,n)),o}return i._value=t,i}function Tu(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,X0(e,t,n??""))}function Z0(e){return function(){this.textContent=e}}function j0(e){return function(){var t=e(this);this.textContent=t??""}}function Iu(e){return this.tween("text",typeof e=="function"?j0(Hn(this,"text",e)):Z0(e==null?"":e+""))}function Q0(e){return function(t){this.textContent=e.call(this,t)}}function J0(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Q0(r)),t}return o._value=e,o}function Pu(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,J0(e))}function Ru(){for(var e=this._name,t=this._id,n=Kr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)if(l=s[c]){var u=Re(l,t);qt(l,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ve(o,this._parents,e,n)}function Mu(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},l={value:function(){--r===0&&i()}};n.each(function(){var c=Le(this,o),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(l)),c.on=t}),r===0&&i()})}var ex=0;function Ve(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function zu(e){return Rt().transition(e)}function Kr(){return++ex}var Mt=Rt.prototype;Ve.prototype=zu.prototype={constructor:Ve,select:Cu,selectAll:_u,selectChild:Mt.selectChild,selectChildren:Mt.selectChildren,filter:wu,merge:vu,selection:Nu,transition:Ru,call:Mt.call,nodes:Mt.nodes,node:Mt.node,size:Mt.size,empty:Mt.empty,each:Mt.each,on:Su,attr:pu,attrTween:mu,style:ku,styleTween:Tu,text:Iu,textTween:Pu,remove:Eu,tween:hu,delay:gu,duration:yu,ease:bu,easeVarying:xu,end:Mu,[Symbol.iterator]:Mt[Symbol.iterator]};function qr(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var tx={time:null,delay:0,duration:250,ease:qr};function nx(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Ou(e){var t,n;e instanceof Ve?(t=e._id,e=e._name):(t=Kr(),(n=tx).time=_o(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,l,c=0;c<a;++c)(l=s[c])&&qt(l,e,t,c,s,n||nx(l,t));return new Ve(o,this._parents,e,t)}Rt.prototype.interrupt=fu;Rt.prototype.transition=Ou;var ko=e=>()=>e;function ds(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function gt(e,t,n){this.k=e,this.x=t,this.y=n}gt.prototype={constructor:gt,scale:function(e){return e===1?this:new gt(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new gt(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fn=new gt(1,0,0);To.prototype=gt.prototype;function To(e){for(;!e.__zoom;)if(!(e=e.parentNode))return fn;return e.__zoom}function Ur(e){e.stopImmediatePropagation()}function Vn(e){e.preventDefault(),e.stopImmediatePropagation()}function ox(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function rx(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Au(){return this.__zoom||fn}function ix(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function sx(){return navigator.maxTouchPoints||"ontouchstart"in this}function ax(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Gr(){var e=ox,t=rx,n=ax,o=ix,r=sx,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,l=cs,c=rn("start","zoom","end"),u,d,f,h=500,p=150,g=0,w=10;function m(v){v.property("__zoom",Au).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",O).filter(r).on("touchstart.zoom",q).on("touchmove.zoom",L).on("touchend.zoom touchcancel.zoom",U).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(v,N,S,k){var A=v.selection?v.selection():v;A.property("__zoom",Au),v!==A?C(v,N,S,k):A.interrupt().each(function(){E(this,arguments).event(k).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},m.scaleBy=function(v,N,S,k){m.scaleTo(v,function(){var A=this.__zoom.k,D=typeof N=="function"?N.apply(this,arguments):N;return A*D},S,k)},m.scaleTo=function(v,N,S,k){m.transform(v,function(){var A=t.apply(this,arguments),D=this.__zoom,F=S==null?b(A):typeof S=="function"?S.apply(this,arguments):S,z=D.invert(F),W=typeof N=="function"?N.apply(this,arguments):N;return n(y(x(D,W),F,z),A,s)},S,k)},m.translateBy=function(v,N,S,k){m.transform(v,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),s)},null,k)},m.translateTo=function(v,N,S,k,A){m.transform(v,function(){var D=t.apply(this,arguments),F=this.__zoom,z=k==null?b(D):typeof k=="function"?k.apply(this,arguments):k;return n(fn.translate(z[0],z[1]).scale(F.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof S=="function"?-S.apply(this,arguments):-S),D,s)},k,A)};function x(v,N){return N=Math.max(i[0],Math.min(i[1],N)),N===v.k?v:new gt(N,v.x,v.y)}function y(v,N,S){var k=N[0]-S[0]*v.k,A=N[1]-S[1]*v.k;return k===v.x&&A===v.y?v:new gt(v.k,k,A)}function b(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function C(v,N,S,k){v.on("start.zoom",function(){E(this,arguments).event(k).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(k).end()}).tween("zoom",function(){var A=this,D=arguments,F=E(A,D).event(k),z=t.apply(A,D),W=S==null?b(z):typeof S=="function"?S.apply(A,D):S,P=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),H=A.__zoom,V=typeof N=="function"?N.apply(A,D):N,K=l(H.invert(W).concat(P/H.k),V.invert(W).concat(P/V.k));return function($){if($===1)$=V;else{var G=K($),Y=P/G[2];$=new gt(Y,W[0]-G[0]*Y,W[1]-G[1]*Y)}F.zoom(null,$)}})}function E(v,N,S){return!S&&v.__zooming||new _(v,N)}function _(v,N){this.that=v,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(v,N),this.taps=0}_.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,N){return this.mouse&&v!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var N=Oe(this.that).datum();c.call(v,this.that,new ds(v,{sourceEvent:this.sourceEvent,target:m,type:v,transform:this.that.__zoom,dispatch:c}),N)}};function I(v,...N){if(!e.apply(this,arguments))return;var S=E(this,N).event(v),k=this.__zoom,A=Math.max(i[0],Math.min(i[1],k.k*Math.pow(2,o.apply(this,arguments)))),D=He(v);if(S.wheel)(S.mouse[0][0]!==D[0]||S.mouse[0][1]!==D[1])&&(S.mouse[1]=k.invert(S.mouse[0]=D)),clearTimeout(S.wheel);else{if(k.k===A)return;S.mouse=[D,k.invert(D)],dn(this),S.start()}Vn(v),S.wheel=setTimeout(F,p),S.zoom("mouse",n(y(x(k,A),S.mouse[0],S.mouse[1]),S.extent,s));function F(){S.wheel=null,S.end()}}function R(v,...N){if(f||!e.apply(this,arguments))return;var S=v.currentTarget,k=E(this,N,!0).event(v),A=Oe(v.view).on("mousemove.zoom",W,!0).on("mouseup.zoom",P,!0),D=He(v,S),F=v.clientX,z=v.clientY;ho(v.view),Ur(v),k.mouse=[D,this.__zoom.invert(D)],dn(this),k.start();function W(H){if(Vn(H),!k.moved){var V=H.clientX-F,K=H.clientY-z;k.moved=V*V+K*K>g}k.event(H).zoom("mouse",n(y(k.that.__zoom,k.mouse[0]=He(H,S),k.mouse[1]),k.extent,s))}function P(H){A.on("mousemove.zoom mouseup.zoom",null),po(H.view,k.moved),Vn(H),k.event(H).end()}}function O(v,...N){if(e.apply(this,arguments)){var S=this.__zoom,k=He(v.changedTouches?v.changedTouches[0]:v,this),A=S.invert(k),D=S.k*(v.shiftKey?.5:2),F=n(y(x(S,D),k,A),t.apply(this,N),s);Vn(v),a>0?Oe(this).transition().duration(a).call(C,F,k,v):Oe(this).call(m.transform,F,k,v)}}function q(v,...N){if(e.apply(this,arguments)){var S=v.touches,k=S.length,A=E(this,N,v.changedTouches.length===k).event(v),D,F,z,W;for(Ur(v),F=0;F<k;++F)z=S[F],W=He(z,this),W=[W,this.__zoom.invert(W),z.identifier],A.touch0?!A.touch1&&A.touch0[2]!==W[2]&&(A.touch1=W,A.taps=0):(A.touch0=W,D=!0,A.taps=1+!!u);u&&(u=clearTimeout(u)),D&&(A.taps<2&&(d=W[0],u=setTimeout(function(){u=null},h)),dn(this),A.start())}}function L(v,...N){if(this.__zooming){var S=E(this,N).event(v),k=v.changedTouches,A=k.length,D,F,z,W;for(Vn(v),D=0;D<A;++D)F=k[D],z=He(F,this),S.touch0&&S.touch0[2]===F.identifier?S.touch0[0]=z:S.touch1&&S.touch1[2]===F.identifier&&(S.touch1[0]=z);if(F=S.that.__zoom,S.touch1){var P=S.touch0[0],H=S.touch0[1],V=S.touch1[0],K=S.touch1[1],$=($=V[0]-P[0])*$+($=V[1]-P[1])*$,G=(G=K[0]-H[0])*G+(G=K[1]-H[1])*G;F=x(F,Math.sqrt($/G)),z=[(P[0]+V[0])/2,(P[1]+V[1])/2],W=[(H[0]+K[0])/2,(H[1]+K[1])/2]}else if(S.touch0)z=S.touch0[0],W=S.touch0[1];else return;S.zoom("touch",n(y(F,z,W),S.extent,s))}}function U(v,...N){if(this.__zooming){var S=E(this,N).event(v),k=v.changedTouches,A=k.length,D,F;for(Ur(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),D=0;D<A;++D)F=k[D],S.touch0&&S.touch0[2]===F.identifier?delete S.touch0:S.touch1&&S.touch1[2]===F.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(F=He(F,this),Math.hypot(d[0]-F[0],d[1]-F[1])<w)){var z=Oe(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return m.wheelDelta=function(v){return arguments.length?(o=typeof v=="function"?v:ko(+v),m):o},m.filter=function(v){return arguments.length?(e=typeof v=="function"?v:ko(!!v),m):e},m.touchable=function(v){return arguments.length?(r=typeof v=="function"?v:ko(!!v),m):r},m.extent=function(v){return arguments.length?(t=typeof v=="function"?v:ko([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),m):t},m.scaleExtent=function(v){return arguments.length?(i[0]=+v[0],i[1]=+v[1],m):[i[0],i[1]]},m.translateExtent=function(v){return arguments.length?(s[0][0]=+v[0][0],s[1][0]=+v[1][0],s[0][1]=+v[0][1],s[1][1]=+v[1][1],m):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},m.constrain=function(v){return arguments.length?(n=v,m):n},m.duration=function(v){return arguments.length?(a=+v,m):a},m.interpolate=function(v){return arguments.length?(l=v,m):l},m.on=function(){var v=c.on.apply(c,arguments);return v===c?m:v},m.clickDistance=function(v){return arguments.length?(g=(v=+v)*v,m):Math.sqrt(g)},m.tapDistance=function(v){return arguments.length?(w=+v,m):w},m}var Ze={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Un=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],gs=["Enter"," ","Escape"],Ct;(function(e){e.Strict="strict",e.Loose="loose"})(Ct||(Ct={}));var zt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(zt||(zt={}));var hn;(function(e){e.Partial="partial",e.Full="full"})(hn||(hn={}));var ys={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null},Ge;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ge||(Ge={}));var st;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(st||(st={}));var J;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(J||(J={}));var Lu={[J.Left]:J.Right,[J.Right]:J.Left,[J.Top]:J.Bottom,[J.Bottom]:J.Top};function bs(e){return e===null?null:e?"valid":"invalid"}var xs=e=>"id"in e&&"source"in e&&"target"in e,Xu=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),ws=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e);var Ro=(e,t=[0,0])=>{let{width:n,height:o}=_t(e),r=e.origin??t,i=n*r[0],s=o*r[1];return{x:e.position.x-i,y:e.position.y-s}},Mo=(e,t={nodeOrigin:[0,0],nodeLookup:void 0})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};let n=e.reduce((o,r)=>{let i=typeof r=="string",s=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(r):ws(r)?r:t.nodeLookup.get(r.id));let a=s?Zr(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Jr(o,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return ei(n)},Gn=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(o=>{if(t.filter===void 0||t.filter(o)){let r=Zr(o);n=Jr(n,r)}}),ei(n)},vs=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1)=>{let a={...Xn(t,[n,o,r]),width:t.width/r,height:t.height/r},l=[];for(let c of e.values()){let{measured:u,selectable:d=!0,hidden:f=!1}=c;if(s&&!d||f)continue;let h=u.width??c.width??c.initialWidth??null,p=u.height??c.height??c.initialHeight??null,g=Yn(a,gn(c)),w=(h??0)*(p??0),m=i&&g>0;(!c.internals.handleBounds||m||g>=w||c.dragging)&&l.push(c)}return l},Zu=(e,t)=>{let n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function jr(e,t){let n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function Qr({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(e.size===0)return Promise.resolve(!1);let a=Gn(e),l=yn(a,t,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(l,{duration:s?.duration}),Promise.resolve(!0)}function Ss({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){let s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:l,y:c}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??o,d=r;if(s.extent==="parent"&&!s.expandParent)if(!a)i?.("005",Ze.error005());else{let h=a.measured.width,p=a.measured.height;h&&p&&(d=[[l,c],[l+h,c+p]])}else a&&qn(s.extent)&&(d=[[s.extent[0][0]+l,s.extent[0][1]+c],[s.extent[1][0]+l,s.extent[1][1]+c]]);let f=qn(d)?pn(t,d,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",Ze.error015()),{position:{x:f.x-l+(s.measured.width??0)*u[0],y:f.y-c+(s.measured.height??0)*u[1]},positionAbsolute:f}}async function ju({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){let i=new Set(e.map(f=>f.id)),s=[];for(let f of n){if(f.deletable===!1)continue;let h=i.has(f.id),p=!h&&f.parentId&&s.find(g=>g.id===f.parentId);(h||p)&&s.push(f)}let a=new Set(t.map(f=>f.id)),l=o.filter(f=>f.deletable!==!1),u=Zu(s,l);for(let f of l)a.has(f.id)&&!u.find(p=>p.id===f.id)&&u.push(f);if(!r)return{edges:u,nodes:s};let d=await r({nodes:s,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:s}:{edges:[],nodes:[]}:d}var Kn=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),pn=(e={x:0,y:0},t,n)=>({x:Kn(e.x,t[0][0],t[1][0]-(n?.width??0)),y:Kn(e.y,t[0][1],t[1][1]-(n?.height??0))});function Qu(e,t,n){let{width:o,height:r}=_t(n),{x:i,y:s}=n.internals.positionAbsolute;return pn(e,[[i,s],[i+o,s+r]],t)}var Fu=(e,t,n)=>e<t?Kn(Math.abs(e-t),1,t)/t:e>n?-Kn(Math.abs(e-n),1,t)/t:0,Ju=(e,t,n=15,o=40)=>{let r=Fu(e.x,o,t.width-o)*n,i=Fu(e.y,o,t.height-o)*n;return[r,i]},Jr=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),ms=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),ei=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),gn=(e,t=[0,0])=>{let{x:n,y:o}=ws(e)?e.internals.positionAbsolute:Ro(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},Zr=(e,t=[0,0])=>{let{x:n,y:o}=ws(e)?e.internals.positionAbsolute:Ro(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},Es=(e,t)=>ei(Jr(ms(e),ms(t))),Yn=(e,t)=>{let n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Cs=e=>it(e.width)&&it(e.height)&&it(e.x)&&it(e.y),it=e=>!isNaN(e)&&isFinite(e),_s=(e,t)=>{},zo=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Xn=({x:e,y:t},[n,o,r],i=!1,s=[1,1])=>{let a={x:(e-n)/r,y:(t-o)/r};return i?zo(a,s):a},Ns=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o}),yn=(e,t,n,o,r,i)=>{let s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),l=Math.min(s,a),c=Kn(l,o,r),u=e.x+e.width/2,d=e.y+e.height/2,f=t/2-u*c,h=n/2-d*c;return{x:f,y:h,zoom:c}},Oo=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function qn(e){return e!==void 0&&e!=="parent"}function _t(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function Ds(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function ks(e,t={width:0,height:0},n,o,r){let i={...e},s=o.get(n);if(s){let a=s.origin||r;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function Ts(e,t){if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}function Io(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){let{x:i,y:s}=Et(e),a=Xn({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:l,y:c}=n?zo(a,t):a;return{xSnapped:l,ySnapped:c,...a}}var Ao=e=>({width:e.offsetWidth,height:e.offsetHeight}),Is=e=>e?.getRootNode?.()||window?.document,lx=["INPUT","SELECT","TEXTAREA"];function ti(e){let t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:lx.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}var Ps=e=>"clientX"in e,Et=(e,t)=>{let n=Ps(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},$u=(e,t,n,o,r)=>{let i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{let a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:r,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/o,y:(a.top-n.top)/o,...Ao(s)}})};function ni({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){let l=e*.125+r*.375+s*.375+n*.125,c=t*.125+i*.375+a*.375+o*.125,u=Math.abs(l-e),d=Math.abs(c-t);return[l,c,u,d]}function Yr(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Bu({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case J.Left:return[t-Yr(t-o,i),n];case J.Right:return[t+Yr(o-t,i),n];case J.Top:return[t,n-Yr(n-r,i)];case J.Bottom:return[t,n+Yr(r-n,i)]}}function oi({sourceX:e,sourceY:t,sourcePosition:n=J.Bottom,targetX:o,targetY:r,targetPosition:i=J.Top,curvature:s=.25}){let[a,l]=Bu({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[c,u]=Bu({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[d,f,h,p]=ni({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:u});return[`M${e},${t} C${a},${l} ${c},${u} ${o},${r}`,d,f,h,p]}function Rs({sourceX:e,sourceY:t,targetX:n,targetY:o}){let r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,a=o<t?o+s:o-s;return[i,a,r,s]}function ed({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o=0,elevateOnSelect:r=!1}){if(!r)return o;let i=n||t.selected||e.selected,s=Math.max(e.internals.z||0,t.internals.z||0,1e3);return o+(i?s:0)}function td({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){let i=Jr(Zr(e),Zr(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);let s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return Yn(s,ei(i))>0}var cx=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,ux=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Lo=(e,t)=>{if(!e.source||!e.target)return _s("006",Ze.error006()),t;let n;return xs(e)?n={...e}:n={...e,id:cx(e)},ux(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function ri({sourceX:e,sourceY:t,targetX:n,targetY:o}){let[r,i,s,a]=Rs({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,a]}var Hu={[J.Left]:{x:-1,y:0},[J.Right]:{x:1,y:0},[J.Top]:{x:0,y:-1},[J.Bottom]:{x:0,y:1}},dx=({source:e,sourcePosition:t=J.Bottom,target:n})=>t===J.Left||t===J.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Vu=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function fx({source:e,sourcePosition:t=J.Bottom,target:n,targetPosition:o=J.Top,center:r,offset:i}){let s=Hu[t],a=Hu[o],l={x:e.x+s.x*i,y:e.y+s.y*i},c={x:n.x+a.x*i,y:n.y+a.y*i},u=dx({source:l,sourcePosition:t,target:c}),d=u.x!==0?"x":"y",f=u[d],h=[],p,g,w={x:0,y:0},m={x:0,y:0},[x,y,b,C]=Rs({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){p=r.x??x,g=r.y??y;let _=[{x:p,y:l.y},{x:p,y:c.y}],I=[{x:l.x,y:g},{x:c.x,y:g}];s[d]===f?h=d==="x"?_:I:h=d==="x"?I:_}else{let _=[{x:l.x,y:c.y}],I=[{x:c.x,y:l.y}];if(d==="x"?h=s.x===f?I:_:h=s.y===f?_:I,t===o){let U=Math.abs(e[d]-n[d]);if(U<=i){let v=Math.min(i-1,i-U);s[d]===f?w[d]=(l[d]>e[d]?-1:1)*v:m[d]=(c[d]>n[d]?-1:1)*v}}if(t!==o){let U=d==="x"?"y":"x",v=s[d]===a[U],N=l[U]>c[U],S=l[U]<c[U];(s[d]===1&&(!v&&N||v&&S)||s[d]!==1&&(!v&&S||v&&N))&&(h=d==="x"?_:I)}let R={x:l.x+w.x,y:l.y+w.y},O={x:c.x+m.x,y:c.y+m.y},q=Math.max(Math.abs(R.x-h[0].x),Math.abs(O.x-h[0].x)),L=Math.max(Math.abs(R.y-h[0].y),Math.abs(O.y-h[0].y));q>=L?(p=(R.x+O.x)/2,g=h[0].y):(p=h[0].x,g=(R.y+O.y)/2)}return[[e,{x:l.x+w.x,y:l.y+w.y},...h,{x:c.x+m.x,y:c.y+m.y},n],p,g,b,C]}function hx(e,t,n,o){let r=Math.min(Vu(e,t)/2,Vu(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){let c=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+r*c},${s}Q ${i},${s} ${i},${s+r*u}`}let a=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${s+r*l}Q ${i},${s} ${i+r*a},${s}`}function Fo({sourceX:e,sourceY:t,sourcePosition:n=J.Bottom,targetX:o,targetY:r,targetPosition:i=J.Top,borderRadius:s=5,centerX:a,centerY:l,offset:c=20}){let[u,d,f,h,p]=fx({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:l},offset:c});return[u.reduce((w,m,x)=>{let y="";return x>0&&x<u.length-1?y=hx(u[x-1],m,u[x+1],s):y=`${x===0?"M":"L"}${m.x} ${m.y}`,w+=y,w},""),d,f,h,p]}function Wu(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function nd(e){let{sourceNode:t,targetNode:n}=e;if(!Wu(t)||!Wu(n))return null;let o=t.internals.handleBounds||Ku(t.handles),r=n.internals.handleBounds||Ku(n.handles),i=qu(o?.source??[],e.sourceHandle),s=qu(e.connectionMode===Ct.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",Ze.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;let a=i?.position||J.Bottom,l=s?.position||J.Top,c=Po(t,i,a),u=Po(n,s,l);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:l}}function Ku(e){if(!e)return null;let t=[],n=[];for(let o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Po(e,t,n=J.Left,o=!1){let r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??_t(e);if(o)return{x:r+s/2,y:i+a/2};switch(t?.position??n){case J.Top:return{x:r+s/2,y:i};case J.Right:return{x:r+s,y:i+a/2};case J.Bottom:return{x:r+s/2,y:i+a};case J.Left:return{x:r,y:i+a/2}}}function qu(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function ii(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function od(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){let i=new Set;return e.reduce((s,a)=>([a.markerStart||o,a.markerEnd||r].forEach(l=>{if(l&&typeof l=="object"){let c=ii(l,t);i.has(c)||(s.push({id:c,color:l.color||n,...l}),i.add(c))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}var Ms={nodeOrigin:[0,0],nodeExtent:Un,elevateNodesOnSelect:!0,defaults:{}},px={...Ms,checkEquality:!0};function zs(e,t){let n={...e};for(let o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function rd(e,t,n){let o=zs(Ms,n);for(let r of e.values())if(r.parentId)Os(r,e,t,o);else{let i=Ro(r,o.nodeOrigin),s=qn(r.extent)?r.extent:o.nodeExtent,a=pn(i,s,_t(r));r.internals.positionAbsolute=a}}function si(e,t,n,o){let r=zs(px,o),i=new Map(t),s=r?.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(let a of e){let l=i.get(a.id);if(r.checkEquality&&a===l?.internals.userNode)t.set(a.id,l);else{let c=Ro(a,r.nodeOrigin),u=qn(a.extent)?a.extent:r.nodeExtent,d=pn(c,u,_t(a));l={...r.defaults,...a,measured:{width:a.measured?.width,height:a.measured?.height},internals:{positionAbsolute:d,handleBounds:a.measured?l?.internals.handleBounds:void 0,z:id(a,s),userNode:a}},t.set(a.id,l)}a.parentId&&Os(l,t,n,o)}}function mx(e,t){if(!e.parentId)return;let n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function Os(e,t,n,o){let{elevateNodesOnSelect:r,nodeOrigin:i,nodeExtent:s}=zs(Ms,o),a=e.parentId,l=t.get(a);if(!l){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}mx(e,n);let c=r?1e3:0,{x:u,y:d,z:f}=gx(e,l,i,s,c),{positionAbsolute:h}=e.internals,p=u!==h.x||d!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:u,y:d}:h,z:f}})}function id(e,t){return(it(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function gx(e,t,n,o,r){let{x:i,y:s}=t.internals.positionAbsolute,a=_t(e),l=Ro(e,n),c=qn(e.extent)?pn(l,e.extent,a):l,u=pn({x:i+c.x,y:s+c.y},o,a);e.extent==="parent"&&(u=Qu(u,a,t));let d=id(e,r),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>d?f:d}}function ai(e,t,n,o=[0,0]){let r=[],i=new Map;for(let s of e){let a=t.get(s.parentId);if(!a)continue;let l=i.get(s.parentId)?.expandedRect??gn(a),c=Es(l,s.rect);i.set(s.parentId,{expandedRect:c,parent:a})}return i.size>0&&i.forEach(({expandedRect:s,parent:a},l)=>{let c=a.internals.positionAbsolute,u=_t(a),d=a.origin??o,f=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,h=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,p=Math.max(u.width,Math.round(s.width)),g=Math.max(u.height,Math.round(s.height)),w=(p-u.width)*d[0],m=(g-u.height)*d[1];(f>0||h>0||w||m)&&(r.push({id:l,type:"position",position:{x:a.position.x-f+w,y:a.position.y-h+m}}),n.get(l)?.forEach(x=>{e.some(y=>y.id===x.id)||r.push({id:x.id,type:"position",position:{x:x.position.x+f,y:x.position.y+h}})})),(u.width<s.width||u.height<s.height||f||h)&&r.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:p+(f?d[0]*f-w:0),height:g+(h?d[1]*h-m:0)}})}),r}function sd(e,t,n,o,r,i){let s=o?.querySelector(".xyflow__viewport"),a=!1;if(!s)return{changes:[],updatedInternals:a};let l=[],c=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(c.transform),d=[];for(let f of e.values()){let h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}let p=Ao(f.nodeElement),g=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(g||!h.internals.handleBounds||f.force))){let m=f.nodeElement.getBoundingClientRect(),x=qn(h.extent)?h.extent:i,{positionAbsolute:y}=h.internals;h.parentId&&h.extent==="parent"?y=Qu(y,p,t.get(h.parentId)):x&&(y=pn(y,x,p));let b={...h,measured:p,internals:{...h.internals,positionAbsolute:y,handleBounds:{source:$u("source",f.nodeElement,m,u,h.id),target:$u("target",f.nodeElement,m,u,h.id)}}};t.set(h.id,b),h.parentId&&Os(b,t,n,{nodeOrigin:r}),a=!0,g&&(l.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:gn(b,r)}))}}if(d.length>0){let f=ai(d,t,n,r);l.push(...f)}return{changes:l,updatedInternals:a}}async function ad({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);let s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function Uu(e,t,n,o,r,i){let s=r,a=o.get(s)||new Map;o.set(s,a.set(n,t)),s=`${r}-${e}`;let l=o.get(s)||new Map;if(o.set(s,l.set(n,t)),i){s=`${r}-${e}-${i}`;let c=o.get(s)||new Map;o.set(s,c.set(n,t))}}function As(e,t,n){e.clear(),t.clear();for(let o of n){let{source:r,target:i,sourceHandle:s=null,targetHandle:a=null}=o,l={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:a},c=`${r}-${s}--${i}-${a}`,u=`${i}-${a}--${r}-${s}`;Uu("source",l,u,e,r,s),Uu("target",l,c,e,i,a),t.set(o.id,o)}}function ld(e,t){if(!e.parentId)return!1;let n=t.get(e.parentId);return n?n.selected?!0:ld(n,t):!1}function Gu(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function yx(e,t,n,o){let r=new Map;for(let[i,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!ld(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){let a=e.get(i);a&&r.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return r}function fs({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){let r=[];for(let[s,a]of t){let l=n.get(s)?.internals.userNode;l&&r.push({...l,position:a.position,dragging:o})}if(!e)return[r[0],r];let i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function cd({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,a=new Map,l=!1,c={x:0,y:0},u=null,d=!1,f=null,h=!1;function p({noDragClassName:w,handleSelector:m,domNode:x,isSelectable:y,nodeId:b,nodeClickDistance:C=0}){f=Oe(x);function E({x:O,y:q},L){let{nodeLookup:U,nodeExtent:v,snapGrid:N,snapToGrid:S,nodeOrigin:k,onNodeDrag:A,onSelectionDrag:D,onError:F,updateNodePositions:z}=t();i={x:O,y:q};let W=!1,P={x:0,y:0,x2:0,y2:0};if(a.size>1&&v){let H=Gn(a);P=ms(H)}for(let[H,V]of a){if(!U.has(H))continue;let K={x:O-V.distance.x,y:q-V.distance.y};S&&(K=zo(K,N));let $=[[v[0][0],v[0][1]],[v[1][0],v[1][1]]];if(a.size>1&&v&&!V.extent){let{positionAbsolute:oe}=V.internals,le=oe.x-P.x+v[0][0],j=oe.x+V.measured.width-P.x2+v[1][0],ee=oe.y-P.y+v[0][1],de=oe.y+V.measured.height-P.y2+v[1][1];$=[[le,ee],[j,de]]}let{position:G,positionAbsolute:Y}=Ss({nodeId:H,nextPosition:K,nodeLookup:U,nodeExtent:$,nodeOrigin:k,onError:F});W=W||V.position.x!==G.x||V.position.y!==G.y,V.position=G,V.internals.positionAbsolute=Y}if(W&&(z(a,!0),L&&(o||A||!b&&D))){let[H,V]=fs({nodeId:b,dragItems:a,nodeLookup:U});o?.(L,a,H,V),A?.(L,H,V),b||D?.(L,V)}}async function _(){if(!u)return;let{transform:O,panBy:q,autoPanSpeed:L,autoPanOnNodeDrag:U}=t();if(!U){l=!1,cancelAnimationFrame(s);return}let[v,N]=Ju(c,u,L);(v!==0||N!==0)&&(i.x=(i.x??0)-v/O[2],i.y=(i.y??0)-N/O[2],await q({x:v,y:N})&&E(i,null)),s=requestAnimationFrame(_)}function I(O){let{nodeLookup:q,multiSelectionActive:L,nodesDraggable:U,transform:v,snapGrid:N,snapToGrid:S,selectNodesOnDrag:k,onNodeDragStart:A,onSelectionDragStart:D,unselectNodesAndEdges:F}=t();d=!0,(!k||!y)&&!L&&b&&(q.get(b)?.selected||F()),y&&k&&b&&e?.(b);let z=Io(O.sourceEvent,{transform:v,snapGrid:N,snapToGrid:S,containerBounds:u});if(i=z,a=yx(q,U,z,b),a.size>0&&(n||A||!b&&D)){let[W,P]=fs({nodeId:b,dragItems:a,nodeLookup:q});n?.(O.sourceEvent,a,W,P),A?.(O.sourceEvent,W,P),b||D?.(O.sourceEvent,P)}}let R=_r().clickDistance(C).on("start",O=>{let{domNode:q,nodeDragThreshold:L,transform:U,snapGrid:v,snapToGrid:N}=t();u=q?.getBoundingClientRect()||null,h=!1,L===0&&I(O),i=Io(O.sourceEvent,{transform:U,snapGrid:v,snapToGrid:N,containerBounds:u}),c=Et(O.sourceEvent,u)}).on("drag",O=>{let{autoPanOnNodeDrag:q,transform:L,snapGrid:U,snapToGrid:v,nodeDragThreshold:N,nodeLookup:S}=t(),k=Io(O.sourceEvent,{transform:L,snapGrid:U,snapToGrid:v,containerBounds:u});if((O.sourceEvent.type==="touchmove"&&O.sourceEvent.touches.length>1||b&&!S.has(b))&&(h=!0),!h){if(!l&&q&&d&&(l=!0,_()),!d){let A=k.xSnapped-(i.x??0),D=k.ySnapped-(i.y??0);Math.sqrt(A*A+D*D)>N&&I(O)}(i.x!==k.xSnapped||i.y!==k.ySnapped)&&a&&d&&(c=Et(O.sourceEvent,u),E(k,O.sourceEvent))}}).on("end",O=>{if(!(!d||h)&&(l=!1,d=!1,cancelAnimationFrame(s),a.size>0)){let{nodeLookup:q,updateNodePositions:L,onNodeDragStop:U,onSelectionDragStop:v}=t();if(L(a,!1),r||U||!b&&v){let[N,S]=fs({nodeId:b,dragItems:a,nodeLookup:q,dragging:!1});r?.(O.sourceEvent,a,N,S),U?.(O.sourceEvent,N,S),b||v?.(O.sourceEvent,S)}}}).filter(O=>{let q=O.target;return!O.button&&(!w||!Gu(q,`.${w}`,x))&&(!m||Gu(q,m,x))});f.call(R)}function g(){f?.on(".drag",null)}return{update:p,destroy:g}}function bx(e,t,n){let o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(let i of t.values())Yn(r,gn(i))>0&&o.push(i);return o}var xx=250;function wx(e,t,n,o){let r=[],i=1/0,s=bx(e,n,t+xx);for(let a of s){let l=[...a.internals.handleBounds?.source??[],...a.internals.handleBounds?.target??[]];for(let c of l){if(o.nodeId===c.nodeId&&o.type===c.type&&o.id===c.id)continue;let{x:u,y:d}=Po(a,c,c.position,!0),f=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(d-e.y,2));f>t||(f<i?(r=[{...c,x:u,y:d}],i=f):f===i&&r.push({...c,x:u,y:d}))}}if(!r.length)return null;if(r.length>1){let a=o.type==="source"?"target":"source";return r.find(l=>l.type===a)??r[0]}return r[0]}function ud(e,t,n,o,r,i=!1){let s=o.get(e);if(!s)return null;let a=r==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],l=(n?a?.find(c=>c.id===n):a?.[0])??null;return l&&i?{...l,...Po(s,l,l.position,!0)}:l}function dd(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function vx(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}var fd=()=>!0;function Sx(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:l,lib:c,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:g,onConnectEnd:w,isValidConnection:m=fd,onReconnectEnd:x,updateConnection:y,getTransform:b,getFromHandle:C,autoPanSpeed:E}){let _=Is(e.target),I=0,R,{x:O,y:q}=Et(e),L=_?.elementFromPoint(O,q),U=dd(i,L),v=a?.getBoundingClientRect();if(!v||!U)return;let N=ud(r,U,o,l,t);if(!N)return;let S=Et(e,v),k=!1,A=null,D=!1,F=null;function z(){if(!u||!v)return;let[Y,oe]=Ju(S,v,E);f({x:Y,y:oe}),I=requestAnimationFrame(z)}let W={...N,nodeId:r,type:U,position:N.position},P=l.get(r),V={inProgress:!0,isValid:null,from:Po(P,W,J.Left,!0),fromHandle:W,fromPosition:W.position,fromNode:P,to:S,toHandle:null,toPosition:Lu[W.position],toNode:null};y(V);let K=V;p?.(e,{nodeId:r,handleId:o,handleType:U});function $(Y){if(!C()||!W){G(Y);return}let oe=b();S=Et(Y,v),R=wx(Xn(S,oe,!1,[1,1]),n,l,W),k||(z(),k=!0);let le=hd(Y,{handle:R,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:m,doc:_,lib:c,flowId:d,nodeLookup:l});F=le.handleDomNode,A=le.connection,D=vx(!!R,le.isValid);let j={...K,isValid:D,to:R&&D?Ns({x:R.x,y:R.y},oe):S,toHandle:le.toHandle,toPosition:D&&le.toHandle?le.toHandle.position:Lu[W.position],toNode:le.toHandle?l.get(le.toHandle.nodeId):null};D&&R&&K.toHandle&&j.toHandle&&K.toHandle.type===j.toHandle.type&&K.toHandle.nodeId===j.toHandle.nodeId&&K.toHandle.id===j.toHandle.id&&K.to.x===j.to.x&&K.to.y===j.to.y||(y(j),K=j)}function G(Y){(R||F)&&A&&D&&g?.(A);let{inProgress:oe,...le}=K,j={...le,toPosition:K.toHandle?K.toPosition:null};w?.(Y,j),i&&x?.(Y,j),h(),cancelAnimationFrame(I),k=!1,D=!1,A=null,F=null,_.removeEventListener("mousemove",$),_.removeEventListener("mouseup",G),_.removeEventListener("touchmove",$),_.removeEventListener("touchend",G)}_.addEventListener("mousemove",$),_.addEventListener("mouseup",G),_.addEventListener("touchmove",$),_.addEventListener("touchend",G)}function hd(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:a,flowId:l,isValidConnection:c=fd,nodeLookup:u}){let d=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${l}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:h,y:p}=Et(e),g=s.elementFromPoint(h,p),w=g?.classList.contains(`${a}-flow__handle`)?g:f,m={handleDomNode:w,isValid:!1,connection:null,toHandle:null};if(w){let x=dd(void 0,w),y=w.getAttribute("data-nodeid"),b=w.getAttribute("data-handleid"),C=w.classList.contains("connectable"),E=w.classList.contains("connectableend");if(!y||!x)return m;let _={source:d?y:o,sourceHandle:d?b:r,target:d?o:y,targetHandle:d?r:b};m.connection=_;let R=C&&E&&(n===Ct.Strict?d&&x==="source"||!d&&x==="target":y!==o||b!==r);m.isValid=R&&c(_),m.toHandle=ud(y,x,b,u,n,!1)}return m}var li={onPointerDown:Sx,isValid:hd};function pd({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){let r=Oe(e);function i({translateExtent:a,width:l,height:c,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){let p=y=>{let b=n();if(y.sourceEvent.type!=="wheel"||!t)return;let C=-y.sourceEvent.deltaY*(y.sourceEvent.deltaMode===1?.05:y.sourceEvent.deltaMode?1:.002)*u,E=b[2]*Math.pow(2,C);t.scaleTo(E)},g=[0,0],w=y=>{(y.sourceEvent.type==="mousedown"||y.sourceEvent.type==="touchstart")&&(g=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY])},m=y=>{let b=n();if(y.sourceEvent.type!=="mousemove"&&y.sourceEvent.type!=="touchmove"||!t)return;let C=[y.sourceEvent.clientX??y.sourceEvent.touches[0].clientX,y.sourceEvent.clientY??y.sourceEvent.touches[0].clientY],E=[C[0]-g[0],C[1]-g[1]];g=C;let _=o()*Math.max(b[2],Math.log(b[2]))*(h?-1:1),I={x:b[0]-E[0]*_,y:b[1]-E[1]*_},R=[[0,0],[l,c]];t.setViewportConstrained({x:I.x,y:I.y,zoom:b[2]},R,a)},x=Gr().on("start",w).on("zoom",d?m:null).on("zoom.wheel",f?p:null);r.call(x,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:He}}var Ex=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,ci=e=>({x:e.x,y:e.y,zoom:e.k}),hs=({x:e,y:t,zoom:n})=>fn.translate(e,t).scale(n),Wn=(e,t)=>e.target.closest(`.${t}`),md=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ps=(e,t=0,n=()=>{})=>{let o=typeof t=="number"&&t>0;return o||n(),o?e.transition().duration(t).on("end",n):e},gd=e=>{let t=e.ctrlKey&&Oo()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function Cx({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:l,onPanZoomEnd:c}){return u=>{if(Wn(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();let d=n.property("__zoom").k||1;if(u.ctrlKey&&s){let w=He(u),m=gd(u),x=d*Math.pow(2,m);o.scaleTo(n,x,w,u);return}let f=u.deltaMode===1?20:1,h=r===zt.Vertical?0:u.deltaX*f,p=r===zt.Horizontal?0:u.deltaY*f;!Oo()&&u.shiftKey&&r!==zt.Vertical&&(h=u.deltaY*f,p=0),o.translateBy(n,-(h/d)*i,-(p/d)*i,{internal:!0});let g=ci(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a?.(u,g)),e.isPanScrolling&&(l?.(u,g),e.panScrollTimeout=setTimeout(()=>{c?.(u,g),e.isPanScrolling=!1},150))}}function _x({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){if(!t&&o.type==="wheel"&&!o.ctrlKey||Wn(o,e))return null;o.preventDefault(),n.call(this,o,r)}}function Nx({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;let r=ci(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function Dx({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&md(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,ci(i.transform))}}function kx({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&md(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r&&Ex(e.prevViewport,s.transform))){let a=ci(s.transform);e.prevViewport=a,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,a)},n?150:0)}}}function Tx({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:l,lib:c}){return u=>{let d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&(Wn(u,`${c}-flow__node`)||Wn(u,`${c}-flow__edge`)))return!0;if(!o&&!d&&!r&&!i&&!n||s||Wn(u,a)&&u.type==="wheel"||Wn(u,l)&&(u.type!=="wheel"||r&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&u.touches?.length>1)return u.preventDefault(),!1;if(!d&&!r&&!f&&u.type==="wheel"||!o&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(o)&&!o.includes(u.button)&&u.type==="mousedown")return!1;let h=Array.isArray(o)&&o.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function yd({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:o,translateExtent:r,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:l,onDraggingChange:c}){let u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=Gr().clickDistance(!it(o)||o<0?0:o).scaleExtent([t,n]).translateExtent(r),h=Oe(e).call(f);y({x:i.x,y:i.y,zoom:Kn(i.zoom,t,n)},[[0,0],[d.width,d.height]],r);let p=h.on("wheel.zoom"),g=h.on("dblclick.zoom");f.wheelDelta(gd);function w(L,U){return h?new Promise(v=>{f?.transform(ps(h,U?.duration,()=>v(!0)),L)}):Promise.resolve(!1)}function m({noWheelClassName:L,noPanClassName:U,onPaneContextMenu:v,userSelectionActive:N,panOnScroll:S,panOnDrag:k,panOnScrollMode:A,panOnScrollSpeed:D,preventScrolling:F,zoomOnPinch:z,zoomOnScroll:W,zoomOnDoubleClick:P,zoomActivationKeyPressed:H,lib:V,onTransformChange:K}){N&&!u.isZoomingOrPanning&&x();let G=S&&!H&&!N?Cx({zoomPanValues:u,noWheelClassName:L,d3Selection:h,d3Zoom:f,panOnScrollMode:A,panOnScrollSpeed:D,zoomOnPinch:z,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:l}):_x({noWheelClassName:L,preventScrolling:F,d3ZoomHandler:p});if(h.on("wheel.zoom",G,{passive:!1}),!N){let oe=Nx({zoomPanValues:u,onDraggingChange:c,onPanZoomStart:a});f.on("start",oe);let le=Dx({zoomPanValues:u,panOnDrag:k,onPaneContextMenu:!!v,onPanZoom:s,onTransformChange:K});f.on("zoom",le);let j=kx({zoomPanValues:u,panOnDrag:k,panOnScroll:S,onPaneContextMenu:v,onPanZoomEnd:l,onDraggingChange:c});f.on("end",j)}let Y=Tx({zoomActivationKeyPressed:H,panOnDrag:k,zoomOnScroll:W,panOnScroll:S,zoomOnDoubleClick:P,zoomOnPinch:z,userSelectionActive:N,noPanClassName:U,noWheelClassName:L,lib:V});f.filter(Y),P?h.on("dblclick.zoom",g):h.on("dblclick.zoom",null)}function x(){f.on("zoom",null)}async function y(L,U,v){let N=hs(L),S=f?.constrain()(N,U,v);return S&&await w(S),new Promise(k=>k(S))}async function b(L,U){let v=hs(L);return await w(v,U),new Promise(N=>N(v))}function C(L){if(h){let U=hs(L),v=h.property("__zoom");(v.k!==L.zoom||v.x!==L.x||v.y!==L.y)&&f?.transform(h,U,null,{sync:!0})}}function E(){let L=h?To(h.node()):{x:0,y:0,k:1};return{x:L.x,y:L.y,zoom:L.k}}function _(L,U){return h?new Promise(v=>{f?.scaleTo(ps(h,U?.duration,()=>v(!0)),L)}):Promise.resolve(!1)}function I(L,U){return h?new Promise(v=>{f?.scaleBy(ps(h,U?.duration,()=>v(!0)),L)}):Promise.resolve(!1)}function R(L){f?.scaleExtent(L)}function O(L){f?.translateExtent(L)}function q(L){let U=!it(L)||L<0?0:L;f?.clickDistance(U)}return{update:m,destroy:x,setViewport:b,setViewportConstrained:y,getViewport:E,scaleTo:_,scaleBy:I,setScaleExtent:R,setTranslateExtent:O,syncViewport:C,setClickDistance:q}}var mn;(function(e){e.Line="line",e.Handle="handle"})(mn||(mn={}));function Ix({width:e,prevWidth:t,height:n,prevHeight:o,affectsX:r,affectsY:i}){let s=e-t,a=n-o,l=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&r&&(l[0]=l[0]*-1),a&&i&&(l[1]=l[1]*-1),l}function Px(e){let t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),o=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:o,affectsY:r}}function Ut(e,t){return Math.max(0,t-e)}function Gt(e,t){return Math.max(0,e-t)}function Xr(e,t,n){return Math.max(0,t-e,e-n)}function Yu(e,t){return e?!t:t}function Rx(e,t,n,o,r,i,s,a){let{affectsX:l,affectsY:c}=t,{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:h,ySnapped:p}=n,{minWidth:g,maxWidth:w,minHeight:m,maxHeight:x}=o,{x:y,y:b,width:C,height:E,aspectRatio:_}=e,I=Math.floor(u?h-e.pointerX:0),R=Math.floor(d?p-e.pointerY:0),O=C+(l?-I:I),q=E+(c?-R:R),L=-i[0]*C,U=-i[1]*E,v=Xr(O,g,w),N=Xr(q,m,x);if(s){let A=0,D=0;l&&I<0?A=Ut(y+I+L,s[0][0]):!l&&I>0&&(A=Gt(y+O+L,s[1][0])),c&&R<0?D=Ut(b+R+U,s[0][1]):!c&&R>0&&(D=Gt(b+q+U,s[1][1])),v=Math.max(v,A),N=Math.max(N,D)}if(a){let A=0,D=0;l&&I>0?A=Gt(y+I,a[0][0]):!l&&I<0&&(A=Ut(y+O,a[1][0])),c&&R>0?D=Gt(b+R,a[0][1]):!c&&R<0&&(D=Ut(b+q,a[1][1])),v=Math.max(v,A),N=Math.max(N,D)}if(r){if(u){let A=Xr(O/_,m,x)*_;if(v=Math.max(v,A),s){let D=0;!l&&!c||l&&!c&&f?D=Gt(b+U+O/_,s[1][1])*_:D=Ut(b+U+(l?I:-I)/_,s[0][1])*_,v=Math.max(v,D)}if(a){let D=0;!l&&!c||l&&!c&&f?D=Ut(b+O/_,a[1][1])*_:D=Gt(b+(l?I:-I)/_,a[0][1])*_,v=Math.max(v,D)}}if(d){let A=Xr(q*_,g,w)/_;if(N=Math.max(N,A),s){let D=0;!l&&!c||c&&!l&&f?D=Gt(y+q*_+L,s[1][0])/_:D=Ut(y+(c?R:-R)*_+L,s[0][0])/_,N=Math.max(N,D)}if(a){let D=0;!l&&!c||c&&!l&&f?D=Ut(y+q*_,a[1][0])/_:D=Gt(y+(c?R:-R)*_,a[0][0])/_,N=Math.max(N,D)}}}R=R+(R<0?N:-N),I=I+(I<0?v:-v),r&&(f?O>q*_?R=(Yu(l,c)?-I:I)/_:I=(Yu(l,c)?-R:R)*_:u?(R=I/_,c=l):(I=R*_,l=c));let S=l?y+I:y,k=c?b+R:b;return{width:C+(l?-I:I),height:E+(c?-R:R),x:i[0]*I*(l?-1:1)+S,y:i[1]*R*(c?-1:1)+k}}var bd={width:0,height:0,x:0,y:0},Mx={...bd,pointerX:0,pointerY:0,aspectRatio:1};function zx(e){return[[0,0],[e.measured.width,e.measured.height]]}function Ox(e,t,n){let o=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,l=n[1]*s;return[[o-a,r-l],[o+i-a,r+s-l]]}function xd({domNode:e,nodeId:t,getStoreItems:n,onChange:o,onEnd:r}){let i=Oe(e);function s({controlPosition:l,boundaries:c,keepAspectRatio:u,onResizeStart:d,onResize:f,onResizeEnd:h,shouldResize:p}){let g={...bd},w={...Mx},m=Px(l),x,y=null,b=[],C,E,_,I=_r().on("start",R=>{let{nodeLookup:O,transform:q,snapGrid:L,snapToGrid:U,nodeOrigin:v,paneDomNode:N}=n();if(x=O.get(t),!x)return;y=N?.getBoundingClientRect()??null;let{xSnapped:S,ySnapped:k}=Io(R.sourceEvent,{transform:q,snapGrid:L,snapToGrid:U,containerBounds:y});g={width:x.measured.width??0,height:x.measured.height??0,x:x.position.x??0,y:x.position.y??0},w={...g,pointerX:S,pointerY:k,aspectRatio:g.width/g.height},C=void 0,x.parentId&&(x.extent==="parent"||x.expandParent)&&(C=O.get(x.parentId),E=C&&x.extent==="parent"?zx(C):void 0),b=[],_=void 0;for(let[A,D]of O)if(D.parentId===t&&(b.push({id:A,position:{...D.position},extent:D.extent}),D.extent==="parent"||D.expandParent)){let F=Ox(D,x,D.origin??v);_?_=[[Math.min(F[0][0],_[0][0]),Math.min(F[0][1],_[0][1])],[Math.max(F[1][0],_[1][0]),Math.max(F[1][1],_[1][1])]]:_=F}d?.(R,{...g})}).on("drag",R=>{let{transform:O,snapGrid:q,snapToGrid:L,nodeOrigin:U}=n(),v=Io(R.sourceEvent,{transform:O,snapGrid:q,snapToGrid:L,containerBounds:y}),N=[];if(!x)return;let{x:S,y:k,width:A,height:D}=g,F={},z=x.origin??U,{width:W,height:P,x:H,y:V}=Rx(w,m,v,c,u,z,E,_),K=W!==A,$=P!==D,G=H!==S&&K,Y=V!==k&&$;if(!G&&!Y&&!K&&!$)return;if((G||Y||z[0]===1||z[1]===1)&&(F.x=G?H:g.x,F.y=Y?V:g.y,g.x=F.x,g.y=F.y,b.length>0)){let ee=H-S,de=V-k;for(let we of b)we.position={x:we.position.x-ee+z[0]*(W-A),y:we.position.y-de+z[1]*(P-D)},N.push(we)}if((K||$)&&(F.width=K?W:g.width,F.height=$?P:g.height,g.width=F.width,g.height=F.height),C&&x.expandParent){let ee=z[0]*(F.width??0);F.x&&F.x<ee&&(g.x=ee,w.x=w.x-(F.x-ee));let de=z[1]*(F.height??0);F.y&&F.y<de&&(g.y=de,w.y=w.y-(F.y-de))}let oe=Ix({width:g.width,prevWidth:A,height:g.height,prevHeight:D,affectsX:m.affectsX,affectsY:m.affectsY}),le={...g,direction:oe};p?.(R,le)!==!1&&(f?.(R,le),o(F,N))}).on("end",R=>{h?.(R,{...g}),r?.()});i.call(I)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var Pd=X(me(),1),Rd=X(Dd(),1);var kd=e=>{let t,n=new Set,o=(u,d)=>{let f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){let h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},r=()=>t,l={setState:o,getState:r,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=t=e(o,r,l);return l},Td=e=>e?kd(e):kd;var{useDebugValue:Jx}=Pd.default,{useSyncExternalStoreWithSelector:ew}=Rd.default,tw=e=>e;function Fs(e,t=tw,n){let o=ew(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Jx(o),o}var Id=(e,t)=>{let n=Td(e),o=(r,i=t)=>Fs(n,r,i);return Object.assign(o,n),o},Md=(e,t)=>e?Id(e,t):Id;function xe(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let o of e)if(!t.has(o))return!1;return!0}let n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var nw=X(Ky()),pi=(0,B.createContext)(null),ow=pi.Provider,of=Ze.error001();function fe(e,t){let n=(0,B.useContext)(pi);if(n===null)throw new Error(of);return Fs(n,e,t)}function be(){let e=(0,B.useContext)(pi);if(e===null)throw new Error(of);return(0,B.useMemo)(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}var zd={display:"none"},rw={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},rf="react-flow__node-desc",sf="react-flow__edge-desc",iw="react-flow__aria-live",sw=e=>e.ariaLiveMessage;function aw({rfId:e}){let t=fe(sw);return(0,M.jsx)("div",{id:`${iw}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:rw,children:t})}function lw({rfId:e,disableKeyboardA11y:t}){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)("div",{id:`${rf}-${e}`,style:zd,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,M.jsx)("div",{id:`${sf}-${e}`,style:zd,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&(0,M.jsx)(aw,{rfId:e})]})}var cw=e=>e.userSelectionActive?"none":"all",mi=(0,B.forwardRef)(({position:e="top-left",children:t,className:n,style:o,...r},i)=>{let s=fe(cw),a=`${e}`.split("-");return(0,M.jsx)("div",{className:Se(["react-flow__panel",n,...a]),style:{...o,pointerEvents:s},ref:i,...r,children:t})});mi.displayName="Panel";function uw({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:(0,M.jsx)(mi,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,M.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}var dw=e=>{let t=[],n=[];for(let[,o]of e.nodeLookup)o.selected&&t.push(o.internals.userNode);for(let[,o]of e.edgeLookup)o.selected&&n.push(o);return{selectedNodes:t,selectedEdges:n}},di=e=>e.id;function fw(e,t){return xe(e.selectedNodes.map(di),t.selectedNodes.map(di))&&xe(e.selectedEdges.map(di),t.selectedEdges.map(di))}function hw({onSelectionChange:e}){let t=be(),{selectedNodes:n,selectedEdges:o}=fe(dw,fw);return(0,B.useEffect)(()=>{let r={nodes:n,edges:o};e?.(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,o,e]),null}var pw=e=>!!e.onSelectionChangeHandlers;function mw({onSelectionChange:e}){let t=fe(pw);return e||t?(0,M.jsx)(hw,{onSelectionChange:e}):null}var af=[0,0],gw={x:0,y:0,zoom:1},yw=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance"],Od=[...yw,"rfId"],bw=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Ad={translateExtent:Un,nodeOrigin:af,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function xw(e){let{setNodes:t,setEdges:n,setMinZoom:o,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:l,setPaneClickDistance:c}=fe(bw,xe),u=be();(0,B.useEffect)(()=>(l(e.defaultNodes,e.defaultEdges),()=>{d.current=Ad,a()}),[]);let d=(0,B.useRef)(Ad);return(0,B.useEffect)(()=>{for(let f of Od){let h=e[f],p=d.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?o(h):f==="maxZoom"?r(h):f==="translateExtent"?i(h):f==="nodeExtent"?s(h):f==="paneClickDistance"?c(h):f==="fitView"?u.setState({fitViewOnInit:h}):f==="fitViewOptions"?u.setState({fitViewOnInitOptions:h}):u.setState({[f]:h})))}d.current=e},Od.map(f=>e[f])),null}function Ld(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function ww(e){let[t,n]=(0,B.useState)(e==="system"?null:e);return(0,B.useEffect)(()=>{if(e!=="system"){n(e);return}let o=Ld(),r=()=>n(o?.matches?"dark":"light");return r(),o?.addEventListener("change",r),()=>{o?.removeEventListener("change",r)}},[e]),t!==null?t:Ld()?.matches?"dark":"light"}var Fd=typeof document<"u"?document:null;function $o(e=null,t={target:Fd,actInsideInputWithModifier:!0}){let[n,o]=(0,B.useState)(!1),r=(0,B.useRef)(!1),i=(0,B.useRef)(new Set([])),[s,a]=(0,B.useMemo)(()=>{if(e!==null){let c=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=c.reduce((d,f)=>d.concat(...f),[]);return[c,u]}return[[],[]]},[e]);return(0,B.useEffect)(()=>{let l=t?.target||Fd;if(e!==null){let c=f=>{if(r.current=f.ctrlKey||f.metaKey||f.shiftKey,(!r.current||r.current&&!t.actInsideInputWithModifier)&&ti(f))return!1;let p=Bd(f.code,a);i.current.add(f[p]),$d(s,i.current,!1)&&(f.preventDefault(),o(!0))},u=f=>{if((!r.current||r.current&&!t.actInsideInputWithModifier)&&ti(f))return!1;let p=Bd(f.code,a);$d(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[p]),f.key==="Meta"&&i.current.clear(),r.current=!1},d=()=>{i.current.clear(),o(!1)};return l?.addEventListener("keydown",c),l?.addEventListener("keyup",u),window.addEventListener("blur",d),window.addEventListener("contextmenu",d),()=>{l?.removeEventListener("keydown",c),l?.removeEventListener("keyup",u),window.removeEventListener("blur",d),window.removeEventListener("contextmenu",d)}}},[e,o]),n}function $d(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function Bd(e,t){return t.includes(e)?"code":"key"}var vw=()=>{let e=be();return(0,B.useMemo)(()=>({zoomIn:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomOut:t=>{let{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t?.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{let{panZoom:o}=e.getState();return o?o.scaleTo(t,{duration:n?.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{let{transform:[o,r,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??o,y:t.y??r,zoom:t.zoom??i},{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{let[t,n,o]=e.getState().transform;return{x:t,y:n,zoom:o}},fitView:t=>{let{nodeLookup:n,minZoom:o,maxZoom:r,panZoom:i,domNode:s}=e.getState();if(!i||!s)return Promise.resolve(!1);let a=jr(n,t),{width:l,height:c}=Ao(s);return Qr({nodes:a,width:l,height:c,minZoom:o,maxZoom:r,panZoom:i},t)},setCenter:async(t,n,o)=>{let{width:r,height:i,maxZoom:s,panZoom:a}=e.getState(),l=typeof o?.zoom<"u"?o.zoom:s,c=r/2-t*l,u=i/2-n*l;return a?(await a.setViewport({x:c,y:u,zoom:l},{duration:o?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},fitBounds:async(t,n)=>{let{width:o,height:r,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),l=yn(t,o,r,i,s,n?.padding??.1);return a?(await a.setViewport(l,{duration:n?.duration}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{let{transform:o,snapGrid:r,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;let{x:a,y:l}=s.getBoundingClientRect(),c={x:t.x-a,y:t.y-l},u=n.snapGrid??r,d=n.snapToGrid??i;return Xn(c,o,d,u)},flowToScreenPosition:t=>{let{transform:n,domNode:o}=e.getState();if(!o)return t;let{x:r,y:i}=o.getBoundingClientRect(),s=Ns(t,n);return{x:s.x+r,y:s.y+i}}}),[])};function lf(e,t){let n=[],o=new Map,r=[];for(let i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")o.set(i.id,[i]);else{let s=o.get(i.id);s?s.push(i):o.set(i.id,[i])}for(let i of t){let s=o.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}let a={...i};for(let l of s)Sw(l,a);n.push(a)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function Sw(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??={},t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&(t.width=e.dimensions.width,t.height=e.dimensions.height)),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function cf(e,t){return lf(e,t)}function uf(e,t){return lf(e,t)}function bn(e,t){return{id:e,type:"select",selected:t}}function jn(e,t=new Set,n=!1){let o=[];for(let[r,i]of e){let s=t.has(r);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),o.push(bn(i.id,s)))}return o}function Hd({items:e=[],lookup:t}){let n=[],o=new Map(e.map(r=>[r.id,r]));for(let[r,i]of e.entries()){let s=t.get(i.id),a=s?.internals?.userNode??s;a!==void 0&&a!==i&&n.push({id:i.id,item:i,type:"replace"}),a===void 0&&n.push({item:i,type:"add",index:r})}for(let[r]of t)o.get(r)===void 0&&n.push({id:r,type:"remove"});return n}function Vd(e){return{id:e.id,type:"remove"}}var Wd=e=>Xu(e),Ew=e=>xs(e);function df(e){return(0,B.forwardRef)(e)}var Cw=typeof window<"u"?B.useLayoutEffect:B.useEffect;function Kd(e){let[t,n]=(0,B.useState)(BigInt(0)),[o]=(0,B.useState)(()=>_w(()=>n(r=>r+BigInt(1))));return Cw(()=>{let r=o.get();r.length&&(e(r),o.reset())},[t]),o}function _w(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}var ff=(0,B.createContext)(null);function Nw({children:e}){let t=be(),n=(0,B.useCallback)(a=>{let{nodes:l=[],setNodes:c,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f}=t.getState(),h=l;for(let p of a)h=typeof p=="function"?p(h):p;u?c(h):d&&d(Hd({items:h,lookup:f}))},[]),o=Kd(n),r=(0,B.useCallback)(a=>{let{edges:l=[],setEdges:c,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState(),h=l;for(let p of a)h=typeof p=="function"?p(h):p;u?c(h):d&&d(Hd({items:h,lookup:f}))},[]),i=Kd(r),s=(0,B.useMemo)(()=>({nodeQueue:o,edgeQueue:i}),[]);return(0,M.jsx)(ff.Provider,{value:s,children:e})}function Dw(){let e=(0,B.useContext)(ff);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}var kw=e=>!!e.panZoom;function je(){let e=vw(),t=be(),n=Dw(),o=fe(kw),r=(0,B.useMemo)(()=>{let i=d=>t.getState().nodeLookup.get(d),s=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},l=d=>{let{nodeLookup:f,nodeOrigin:h}=t.getState(),p=Wd(d)?d:f.get(d.id),g=p.parentId?ks(p.position,p.measured,p.parentId,f,h):p.position,w={...p,position:g,width:p.measured?.width??p.width,height:p.measured?.height??p.height};return gn(w)},c=(d,f,h={replace:!1})=>{s(p=>p.map(g=>{if(g.id===d){let w=typeof f=="function"?f(g):f;return h.replace&&Wd(w)?w:{...g,...w}}return g}))},u=(d,f,h={replace:!1})=>{a(p=>p.map(g=>{if(g.id===d){let w=typeof f=="function"?f(g):f;return h.replace&&Ew(w)?w:{...g,...w}}return g}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>i(d)?.internals.userNode,getInternalNode:i,getEdges:()=>{let{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:s,setEdges:a,addNodes:d=>{let f=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{let f=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{let{nodes:d=[],edges:f=[],transform:h}=t.getState(),[p,g,w]=h;return{nodes:d.map(m=>({...m})),edges:f.map(m=>({...m})),viewport:{x:p,y:g,zoom:w}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{let{nodes:h,edges:p,onNodesDelete:g,onEdgesDelete:w,triggerNodeChanges:m,triggerEdgeChanges:x,onDelete:y,onBeforeDelete:b}=t.getState(),{nodes:C,edges:E}=await ju({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:b}),_=E.length>0,I=C.length>0;if(_){let R=E.map(Vd);w?.(E),x(R)}if(I){let R=C.map(Vd);g?.(C),m(R)}return(I||_)&&y?.({nodes:C,edges:E}),{deletedNodes:C,deletedEdges:E}},getIntersectingNodes:(d,f=!0,h)=>{let p=Cs(d),g=p?d:l(d),w=h!==void 0;return g?(h||t.getState().nodes).filter(m=>{let x=t.getState().nodeLookup.get(m.id);if(x&&!p&&(m.id===d.id||!x.internals.positionAbsolute))return!1;let y=gn(w?m:x),b=Yn(y,g);return f&&b>0||b>=g.width*g.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{let g=Cs(d)?d:l(d);if(!g)return!1;let w=Yn(g,f);return h&&w>0||w>=g.width*g.height},updateNode:c,updateNodeData:(d,f,h={replace:!1})=>{c(d,p=>{let g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},updateEdge:u,updateEdgeData:(d,f,h={replace:!1})=>{u(d,p=>{let g=typeof f=="function"?f(p):f;return h.replace?{...p,data:g}:{...p,data:{...p.data,...g}}},h)},getNodesBounds:d=>{let{nodeLookup:f,nodeOrigin:h}=t.getState();return Mo(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`)?.values()??[]),getNodeConnections:({type:d,handleId:f,nodeId:h})=>Array.from(t.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`)?.values()??[])}},[]);return(0,B.useMemo)(()=>({...r,...e,viewportInitialized:o}),[o])}var qd=e=>e.selected,Tw={actInsideInputWithModifier:!1},Iw=typeof window<"u"?window:void 0;function Pw({deleteKeyCode:e,multiSelectionKeyCode:t}){let n=be(),{deleteElements:o}=je(),r=$o(e,Tw),i=$o(t,{target:Iw});(0,B.useEffect)(()=>{if(r){let{edges:s,nodes:a}=n.getState();o({nodes:a.filter(qd),edges:s.filter(qd)}),n.setState({nodesSelectionActive:!1})}},[r]),(0,B.useEffect)(()=>{n.setState({multiSelectionActive:i})},[i])}function Rw(e){let t=be();(0,B.useEffect)(()=>{let n=()=>{if(!e.current)return!1;let o=Ao(e.current);(o.height===0||o.width===0)&&t.getState().onError?.("004",Ze.error004()),t.setState({width:o.width||500,height:o.height||500})};if(e.current){n(),window.addEventListener("resize",n);let o=new ResizeObserver(()=>n());return o.observe(e.current),()=>{window.removeEventListener("resize",n),o&&e.current&&o.unobserve(e.current)}}},[])}var gi={position:"absolute",width:"100%",height:"100%",top:0,left:0},Mw=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function zw({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:o=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=zt.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:l,translateExtent:c,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:g,noPanClassName:w,onViewportChange:m,isControlledViewport:x,paneClickDistance:y}){let b=be(),C=(0,B.useRef)(null),{userSelectionActive:E,lib:_}=fe(Mw,xe),I=$o(f),R=(0,B.useRef)();Rw(C);let O=(0,B.useCallback)(q=>{m?.({x:q[0],y:q[1],zoom:q[2]}),x||b.setState({transform:q})},[m,x]);return(0,B.useEffect)(()=>{if(C.current){R.current=yd({domNode:C.current,minZoom:u,maxZoom:d,translateExtent:c,viewport:l,paneClickDistance:y,onDraggingChange:v=>b.setState({paneDragging:v}),onPanZoomStart:(v,N)=>{let{onViewportChangeStart:S,onMoveStart:k}=b.getState();k?.(v,N),S?.(N)},onPanZoom:(v,N)=>{let{onViewportChange:S,onMove:k}=b.getState();k?.(v,N),S?.(N)},onPanZoomEnd:(v,N)=>{let{onViewportChangeEnd:S,onMoveEnd:k}=b.getState();k?.(v,N),S?.(N)}});let{x:q,y:L,zoom:U}=R.current.getViewport();return b.setState({panZoom:R.current,transform:[q,L,U],domNode:C.current.closest(".react-flow")}),()=>{R.current?.destroy()}}},[]),(0,B.useEffect)(()=>{R.current?.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:o,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:I,preventScrolling:h,noPanClassName:w,userSelectionActive:E,noWheelClassName:g,lib:_,onTransformChange:O})},[e,t,n,o,r,i,s,a,I,h,w,E,g,_,O]),(0,M.jsx)("div",{className:"react-flow__renderer",ref:C,style:gi,children:p})}var Ow=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Aw(){let{userSelectionActive:e,userSelectionRect:t}=fe(Ow,xe);return e&&t?(0,M.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}var $s=(e,t)=>n=>{n.target===t.current&&e?.(n)},Lw=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging});function Fw({isSelecting:e,selectionKeyPressed:t,selectionMode:n=hn.Full,panOnDrag:o,selectionOnDrag:r,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:l,onPaneScroll:c,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:h}){let p=be(),{userSelectionActive:g,elementsSelectable:w,dragging:m}=fe(Lw,xe),x=w&&(e||g),y=(0,B.useRef)(null),b=(0,B.useRef)(),C=(0,B.useRef)(new Set),E=(0,B.useRef)(new Set),_=(0,B.useRef)(!1),I=(0,B.useRef)(!1),R=S=>{if(_.current){_.current=!1;return}a?.(S),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},O=S=>{if(Array.isArray(o)&&o?.includes(2)){S.preventDefault();return}l?.(S)},q=c?S=>c(S):void 0,L=S=>{let{resetSelectedElements:k,domNode:A}=p.getState();if(b.current=A?.getBoundingClientRect(),!w||!e||S.button!==0||S.target!==y.current||!b.current)return;S.target?.setPointerCapture?.(S.pointerId),I.current=!0,_.current=!1;let{x:D,y:F}=Et(S.nativeEvent,b.current);k(),p.setState({userSelectionRect:{width:0,height:0,startX:D,startY:F,x:D,y:F}}),i?.(S)},U=S=>{let{userSelectionRect:k,transform:A,nodeLookup:D,edgeLookup:F,connectionLookup:z,triggerNodeChanges:W,triggerEdgeChanges:P,defaultEdgeOptions:H}=p.getState();if(!b.current||!k)return;_.current=!0;let{x:V,y:K}=Et(S.nativeEvent,b.current),{startX:$,startY:G}=k,Y={startX:$,startY:G,x:V<$?V:$,y:K<G?K:G,width:Math.abs(V-$),height:Math.abs(K-G)},oe=C.current,le=E.current;C.current=new Set(vs(D,Y,A,n===hn.Partial,!0).map(ee=>ee.id)),E.current=new Set;let j=H?.selectable??!0;for(let ee of C.current){let de=z.get(ee);if(de)for(let{edgeId:we}of de.values()){let nt=F.get(we);nt&&(nt.selectable??j)&&E.current.add(we)}}if(!Ts(oe,C.current)){let ee=jn(D,C.current,!0);W(ee)}if(!Ts(le,E.current)){let ee=jn(F,E.current);P(ee)}p.setState({userSelectionRect:Y,userSelectionActive:!0,nodesSelectionActive:!1})},v=S=>{if(S.button!==0||!I.current)return;S.target?.releasePointerCapture?.(S.pointerId);let{userSelectionRect:k}=p.getState();!g&&k&&S.target===y.current&&R?.(S),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:C.current.size>0}),s?.(S),(t||r)&&(_.current=!1),I.current=!1},N=o===!0||Array.isArray(o)&&o.includes(0);return(0,M.jsxs)("div",{className:Se(["react-flow__pane",{draggable:N,dragging:m,selection:e}]),onClick:x?void 0:$s(R,y),onContextMenu:$s(O,y),onWheel:$s(q,y),onPointerEnter:x?void 0:u,onPointerDown:x?L:d,onPointerMove:x?U:d,onPointerUp:x?v:void 0,onPointerLeave:f,ref:y,style:gi,children:[h,(0,M.jsx)(Aw,{})]})}function Hs({id:e,store:t,unselect:n=!1,nodeRef:o}){let{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:l}=t.getState(),c=a.get(e);if(!c){l?.("012",Ze.error012(e));return}t.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&s)&&(i({nodes:[c],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):r([e])}function hf({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,nodeClickDistance:s}){let a=be(),[l,c]=(0,B.useState)(!1),u=(0,B.useRef)();return(0,B.useEffect)(()=>{u.current=cd({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{Hs({id:d,store:a,nodeRef:e})},onDragStart:()=>{c(!0)},onDragStop:()=>{c(!1)}})},[]),(0,B.useEffect)(()=>{if(t)u.current?.destroy();else if(e.current)return u.current?.update({noDragClassName:n,handleSelector:o,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:s}),()=>{u.current?.destroy()}},[n,o,t,i,e,r]),l}var $w=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function pf(){let e=be();return(0,B.useCallback)(n=>{let{nodeExtent:o,snapToGrid:r,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:l,nodeLookup:c,nodeOrigin:u}=e.getState(),d=new Map,f=$w(s),h=r?i[0]:5,p=r?i[1]:5,g=n.direction.x*h*n.factor,w=n.direction.y*p*n.factor;for(let[,m]of c){if(!f(m))continue;let x={x:m.internals.positionAbsolute.x+g,y:m.internals.positionAbsolute.y+w};r&&(x=zo(x,i));let{position:y,positionAbsolute:b}=Ss({nodeId:m.id,nextPosition:x,nodeLookup:c,nodeExtent:o,nodeOrigin:u,onError:a});m.position=y,m.internals.positionAbsolute=b,d.set(m.id,m)}l(d)},[])}var Vs=(0,B.createContext)(null),Bw=Vs.Provider;Vs.Consumer;var mf=()=>(0,B.useContext)(Vs),Hw=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),Vw=(e,t,n)=>o=>{let{connectionClickStartHandle:r,connectionMode:i,connection:s}=o,{fromHandle:a,toHandle:l,isValid:c}=s,u=l?.nodeId===e&&l?.id===t&&l?.type===n;return{connectingFrom:a?.nodeId===e&&a?.id===t&&a?.type===n,connectingTo:u,clickConnecting:r?.nodeId===e&&r?.id===t&&r?.type===n,isPossibleEndHandle:i===Ct.Strict?a?.type!==n:e!==a?.nodeId||t!==a?.id,connectionInProcess:!!a,clickConnectionInProcess:!!r,valid:u&&c}};function Ww({type:e="source",position:t=J.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:l,className:c,onMouseDown:u,onTouchStart:d,...f},h){let p=s||null,g=e==="target",w=be(),m=mf(),{connectOnClick:x,noPanClassName:y,rfId:b}=fe(Hw,xe),{connectingFrom:C,connectingTo:E,clickConnecting:_,isPossibleEndHandle:I,connectionInProcess:R,clickConnectionInProcess:O,valid:q}=fe(Vw(m,p,e),xe);m||w.getState().onError?.("010",Ze.error010());let L=N=>{let{defaultEdgeOptions:S,onConnect:k,hasDefaultEdges:A}=w.getState(),D={...S,...N};if(A){let{edges:F,setEdges:z}=w.getState();z(Lo(D,F))}k?.(D),a?.(D)},U=N=>{if(!m)return;let S=Ps(N.nativeEvent);if(r&&(S&&N.button===0||!S)){let k=w.getState();li.onPointerDown(N.nativeEvent,{autoPanOnConnect:k.autoPanOnConnect,connectionMode:k.connectionMode,connectionRadius:k.connectionRadius,domNode:k.domNode,nodeLookup:k.nodeLookup,lib:k.lib,isTarget:g,handleId:p,nodeId:m,flowId:k.rfId,panBy:k.panBy,cancelConnection:k.cancelConnection,onConnectStart:k.onConnectStart,onConnectEnd:k.onConnectEnd,updateConnection:k.updateConnection,onConnect:L,isValidConnection:n||k.isValidConnection,getTransform:()=>w.getState().transform,getFromHandle:()=>w.getState().connection.fromHandle,autoPanSpeed:k.autoPanSpeed})}S?u?.(N):d?.(N)},v=N=>{let{onClickConnectStart:S,onClickConnectEnd:k,connectionClickStartHandle:A,connectionMode:D,isValidConnection:F,lib:z,rfId:W,nodeLookup:P,connection:H}=w.getState();if(!m||!A&&!r)return;if(!A){S?.(N.nativeEvent,{nodeId:m,handleId:p,handleType:e}),w.setState({connectionClickStartHandle:{nodeId:m,type:e,id:p}});return}let V=Is(N.target),K=n||F,{connection:$,isValid:G}=li.isValid(N.nativeEvent,{handle:{nodeId:m,id:p,type:e},connectionMode:D,fromNodeId:A.nodeId,fromHandleId:A.id||null,fromType:A.type,isValidConnection:K,flowId:W,doc:V,lib:z,nodeLookup:P});G&&$&&L($);let Y=structuredClone(H);delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,k?.(N,Y),w.setState({connectionClickStartHandle:null})};return(0,M.jsx)("div",{"data-handleid":p,"data-nodeid":m,"data-handlepos":t,"data-id":`${b}-${m}-${p}-${e}`,className:Se(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",y,c,{source:!g,target:g,connectable:o,connectablestart:r,connectableend:i,clickconnecting:_,connectingfrom:C,connectingto:E,valid:q,connectionindicator:o&&(!R||I)&&(R||O?i:r)}]),onMouseDown:U,onTouchStart:U,onClick:x?v:void 0,ref:h,...f,children:l})}var Ot=(0,B.memo)(df(Ww));function Kw({data:e,isConnectable:t,sourcePosition:n=J.Bottom}){return(0,M.jsxs)(M.Fragment,{children:[e?.label,(0,M.jsx)(Ot,{type:"source",position:n,isConnectable:t})]})}function qw({data:e,isConnectable:t,targetPosition:n=J.Top,sourcePosition:o=J.Bottom}){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Ot,{type:"target",position:n,isConnectable:t}),e?.label,(0,M.jsx)(Ot,{type:"source",position:o,isConnectable:t})]})}function Uw(){return null}function Gw({data:e,isConnectable:t,targetPosition:n=J.Top}){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Ot,{type:"target",position:n,isConnectable:t}),e?.label]})}var hi={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Ud={input:Kw,default:qw,output:Gw,group:Uw};function Yw(e){return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??e.style?.width,height:e.height??e.initialHeight??e.style?.height}:{width:e.width??e.style?.width,height:e.height??e.style?.height}}var Xw=e=>{let{width:t,height:n,x:o,y:r}=Gn(e.nodeLookup,{filter:i=>!!i.selected});return{width:it(t)?t:null,height:it(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${o}px,${r}px)`}};function Zw({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){let o=be(),{width:r,height:i,transformString:s,userSelectionActive:a}=fe(Xw,xe),l=pf(),c=(0,B.useRef)(null);if((0,B.useEffect)(()=>{n||c.current?.focus({preventScroll:!0})},[n]),hf({nodeRef:c}),a||!r||!i)return null;let u=e?f=>{let h=o.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(hi,f.key)&&(f.preventDefault(),l({direction:hi[f.key],factor:f.shiftKey?4:1}))};return(0,M.jsx)("div",{className:Se(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:(0,M.jsx)("div",{ref:c,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:r,height:i}})})}var Gd=typeof window<"u"?window:void 0,jw=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function gf({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:l,selectionKeyCode:c,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:g,zoomActivationKeyCode:w,elementsSelectable:m,zoomOnScroll:x,zoomOnPinch:y,panOnScroll:b,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:_,panOnDrag:I,defaultViewport:R,translateExtent:O,minZoom:q,maxZoom:L,preventScrolling:U,onSelectionContextMenu:v,noWheelClassName:N,noPanClassName:S,disableKeyboardA11y:k,onViewportChange:A,isControlledViewport:D}){let{nodesSelectionActive:F,userSelectionActive:z}=fe(jw),W=$o(c,{target:Gd}),P=$o(g,{target:Gd}),H=P||I,V=P||b,K=u&&H!==!0,$=W||z||K;return Pw({deleteKeyCode:l,multiSelectionKeyCode:p}),(0,M.jsx)(zw,{onPaneContextMenu:i,elementsSelectable:m,zoomOnScroll:x,zoomOnPinch:y,panOnScroll:V,panOnScrollSpeed:C,panOnScrollMode:E,zoomOnDoubleClick:_,panOnDrag:!W&&H,defaultViewport:R,translateExtent:O,minZoom:q,maxZoom:L,zoomActivationKeyCode:w,preventScrolling:U,noWheelClassName:N,noPanClassName:S,onViewportChange:A,isControlledViewport:D,paneClickDistance:a,children:(0,M.jsxs)(Fw,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:H,isSelecting:!!$,selectionMode:d,selectionKeyPressed:W,selectionOnDrag:K,children:[e,F&&(0,M.jsx)(Zw,{onSelectionContextMenu:v,noPanClassName:S,disableKeyboardA11y:k})]})})}gf.displayName="FlowRenderer";var Qw=(0,B.memo)(gf),Jw=e=>t=>e?vs(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function ev(e){return fe((0,B.useCallback)(Jw(e),[e]),xe)}var tv=e=>e.updateNodeInternals;function nv(){let e=fe(tv),[t]=(0,B.useState)(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{let o=new Map;n.forEach(r=>{let i=r.target.getAttribute("data-id");o.set(i,{id:i,nodeElement:r.target,force:!0})}),e(o)}));return(0,B.useEffect)(()=>()=>{t?.disconnect()},[t]),t}function ov({node:e,nodeType:t,hasDimensions:n,resizeObserver:o}){let r=be(),i=(0,B.useRef)(null),s=(0,B.useRef)(null),a=(0,B.useRef)(e.sourcePosition),l=(0,B.useRef)(e.targetPosition),c=(0,B.useRef)(t),u=n&&!!e.internals.handleBounds;return(0,B.useEffect)(()=>{i.current&&!e.hidden&&(!u||s.current!==i.current)&&(s.current&&o?.unobserve(s.current),o?.observe(i.current),s.current=i.current)},[u,e.hidden]),(0,B.useEffect)(()=>()=>{s.current&&(o?.unobserve(s.current),s.current=null)},[]),(0,B.useEffect)(()=>{if(i.current){let d=c.current!==t,f=a.current!==e.sourcePosition,h=l.current!==e.targetPosition;(d||f||h)&&(c.current=t,a.current=e.sourcePosition,l.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function rv({id:e,onClick:t,onMouseEnter:n,onMouseMove:o,onMouseLeave:r,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:l,nodesConnectable:c,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:g,nodeTypes:w,nodeClickDistance:m,onError:x}){let{node:y,internals:b,isParent:C}=fe($=>{let G=$.nodeLookup.get(e),Y=$.parentLookup.has(e);return{node:G,internals:G.internals,isParent:Y}},xe),E=y.type||"default",_=w?.[E]||Ud[E];_===void 0&&(x?.("003",Ze.error003(E)),E="default",_=Ud.default);let I=!!(y.draggable||a&&typeof y.draggable>"u"),R=!!(y.selectable||l&&typeof y.selectable>"u"),O=!!(y.connectable||c&&typeof y.connectable>"u"),q=!!(y.focusable||u&&typeof y.focusable>"u"),L=be(),U=Ds(y),v=ov({node:y,nodeType:E,hasDimensions:U,resizeObserver:d}),N=hf({nodeRef:v,disabled:y.hidden||!I,noDragClassName:f,handleSelector:y.dragHandle,nodeId:e,isSelectable:R,nodeClickDistance:m}),S=pf();if(y.hidden)return null;let k=_t(y),A=Yw(y),D=R||I||t||n||o||r,F=n?$=>n($,{...b.userNode}):void 0,z=o?$=>o($,{...b.userNode}):void 0,W=r?$=>r($,{...b.userNode}):void 0,P=i?$=>i($,{...b.userNode}):void 0,H=s?$=>s($,{...b.userNode}):void 0,V=$=>{let{selectNodesOnDrag:G,nodeDragThreshold:Y}=L.getState();R&&(!G||!I||Y>0)&&Hs({id:e,store:L,nodeRef:v}),t&&t($,{...b.userNode})},K=$=>{if(!(ti($.nativeEvent)||p))if(gs.includes($.key)&&R){let G=$.key==="Escape";Hs({id:e,store:L,unselect:G,nodeRef:v})}else I&&y.selected&&Object.prototype.hasOwnProperty.call(hi,$.key)&&($.preventDefault(),L.setState({ariaLiveMessage:`Moved selected node ${$.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~b.positionAbsolute.x}, y: ${~~b.positionAbsolute.y}`}),S({direction:hi[$.key],factor:$.shiftKey?4:1}))};return(0,M.jsx)("div",{className:Se(["react-flow__node",`react-flow__node-${E}`,{[h]:I},y.className,{selected:y.selected,selectable:R,parent:C,draggable:I,dragging:N}]),ref:v,style:{zIndex:b.z,transform:`translate(${b.positionAbsolute.x}px,${b.positionAbsolute.y}px)`,pointerEvents:D?"all":"none",visibility:U?"visible":"hidden",...y.style,...A},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:F,onMouseMove:z,onMouseLeave:W,onContextMenu:P,onClick:V,onDoubleClick:H,onKeyDown:q?K:void 0,tabIndex:q?0:void 0,role:q?"button":void 0,"aria-describedby":p?void 0:`${rf}-${g}`,"aria-label":y.ariaLabel,children:(0,M.jsx)(Bw,{value:e,children:(0,M.jsx)(_,{id:e,data:y.data,type:E,positionAbsoluteX:b.positionAbsolute.x,positionAbsoluteY:b.positionAbsolute.y,selected:y.selected??!1,selectable:R,draggable:I,deletable:y.deletable??!0,isConnectable:O,sourcePosition:y.sourcePosition,targetPosition:y.targetPosition,dragging:N,dragHandle:y.dragHandle,zIndex:b.z,parentId:y.parentId,...k})})})}var iv=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function yf(e){let{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,onError:i}=fe(iv,xe),s=ev(e.onlyRenderVisibleElements),a=nv();return(0,M.jsx)("div",{className:"react-flow__nodes",style:gi,children:s.map(l=>(0,M.jsx)(rv,{id:l,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},l))})}yf.displayName="NodeRenderer";var sv=(0,B.memo)(yf);function av(e){return fe((0,B.useCallback)(n=>{if(!e)return n.edges.map(r=>r.id);let o=[];if(n.width&&n.height)for(let r of n.edges){let i=n.nodeLookup.get(r.source),s=n.nodeLookup.get(r.target);i&&s&&td({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&o.push(r.id)}return o},[e]),xe)}var lv=({color:e="none",strokeWidth:t=1})=>(0,M.jsx)("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),cv=({color:e="none",strokeWidth:t=1})=>(0,M.jsx)("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Yd={[st.Arrow]:lv,[st.ArrowClosed]:cv};function uv(e){let t=be();return(0,B.useMemo)(()=>Object.prototype.hasOwnProperty.call(Yd,e)?Yd[e]:(t.getState().onError?.("009",Ze.error009(e)),null),[e])}var dv=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{let l=uv(t);return l?(0,M.jsx)("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:(0,M.jsx)(l,{color:n,strokeWidth:s})}):null},bf=({defaultColor:e,rfId:t})=>{let n=fe(i=>i.edges),o=fe(i=>i.defaultEdgeOptions),r=(0,B.useMemo)(()=>od(n,{id:t,defaultColor:e,defaultMarkerStart:o?.markerStart,defaultMarkerEnd:o?.markerEnd}),[n,o,t,e]);return r.length?(0,M.jsx)("svg",{className:"react-flow__marker",children:(0,M.jsx)("defs",{children:r.map(i=>(0,M.jsx)(dv,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};bf.displayName="MarkerDefinitions";var fv=(0,B.memo)(bf);function xf({x:e,y:t,label:n,labelStyle:o={},labelShowBg:r=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...u}){let[d,f]=(0,B.useState)({x:1,y:0,width:0,height:0}),h=Se(["react-flow__edge-textwrapper",c]),p=(0,B.useRef)(null);return(0,B.useEffect)(()=>{if(p.current){let g=p.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:(0,M.jsxs)("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[r&&(0,M.jsx)("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),(0,M.jsx)("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:o,children:n}),l]})}xf.displayName="EdgeText";var hv=(0,B.memo)(xf);function yi({path:e,labelX:t,labelY:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l,interactionWidth:c=20,...u}){return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("path",{...u,d:e,fill:"none",className:Se(["react-flow__edge-path",u.className])}),c&&(0,M.jsx)("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:c,className:"react-flow__edge-interaction"}),o&&it(t)&&it(n)?(0,M.jsx)(hv,{x:t,y:n,label:o,labelStyle:r,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:l}):null]})}function Xd({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===J.Left||e===J.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function wf({sourceX:e,sourceY:t,sourcePosition:n=J.Bottom,targetX:o,targetY:r,targetPosition:i=J.Top}){let[s,a]=Xd({pos:n,x1:e,y1:t,x2:o,y2:r}),[l,c]=Xd({pos:i,x1:o,y1:r,x2:e,y2:t}),[u,d,f,h]=ni({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${e},${t} C${s},${a} ${l},${c} ${o},${r}`,u,d,f,h]}function vf(e){return(0,B.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=J.Bottom,targetPosition:a=J.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:w,interactionWidth:m})=>{let[x,y,b]=wf({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a}),C=e.isInternal?void 0:t;return(0,M.jsx)(yi,{id:C,path:x,labelX:y,labelY:b,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:w,interactionWidth:m})})}var pv=vf({isInternal:!1}),Sf=vf({isInternal:!0});pv.displayName="SimpleBezierEdge";Sf.displayName="SimpleBezierEdgeInternal";function Ef(e){return(0,B.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:h=J.Bottom,targetPosition:p=J.Top,markerEnd:g,markerStart:w,pathOptions:m,interactionWidth:x})=>{let[y,b,C]=Fo({sourceX:n,sourceY:o,sourcePosition:h,targetX:r,targetY:i,targetPosition:p,borderRadius:m?.borderRadius,offset:m?.offset}),E=e.isInternal?void 0:t;return(0,M.jsx)(yi,{id:E,path:y,labelX:b,labelY:C,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:g,markerStart:w,interactionWidth:x})})}var Cf=Ef({isInternal:!1}),_f=Ef({isInternal:!0});Cf.displayName="SmoothStepEdge";_f.displayName="SmoothStepEdgeInternal";function Nf(e){return(0,B.memo)(({id:t,...n})=>{let o=e.isInternal?void 0:t;return(0,M.jsx)(Cf,{...n,id:o,pathOptions:(0,B.useMemo)(()=>({borderRadius:0,offset:n.pathOptions?.offset}),[n.pathOptions?.offset])})})}var mv=Nf({isInternal:!1}),Df=Nf({isInternal:!0});mv.displayName="StepEdge";Df.displayName="StepEdgeInternal";function kf(e){return(0,B.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:g})=>{let[w,m,x]=ri({sourceX:n,sourceY:o,targetX:r,targetY:i}),y=e.isInternal?void 0:t;return(0,M.jsx)(yi,{id:y,path:w,labelX:m,labelY:x,label:s,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:g})})}var gv=kf({isInternal:!1}),Tf=kf({isInternal:!0});gv.displayName="StraightEdge";Tf.displayName="StraightEdgeInternal";function If(e){return(0,B.memo)(({id:t,sourceX:n,sourceY:o,targetX:r,targetY:i,sourcePosition:s=J.Bottom,targetPosition:a=J.Top,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:w,pathOptions:m,interactionWidth:x})=>{let[y,b,C]=oi({sourceX:n,sourceY:o,sourcePosition:s,targetX:r,targetY:i,targetPosition:a,curvature:m?.curvature}),E=e.isInternal?void 0:t;return(0,M.jsx)(yi,{id:E,path:y,labelX:b,labelY:C,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:w,interactionWidth:x})})}var yv=If({isInternal:!1}),Pf=If({isInternal:!0});yv.displayName="BezierEdge";Pf.displayName="BezierEdgeInternal";var Zd={default:Pf,straight:Tf,step:Df,smoothstep:_f,simplebezier:Sf},jd={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},bv=(e,t,n)=>n===J.Left?e-t:n===J.Right?e+t:e,xv=(e,t,n)=>n===J.Top?e-t:n===J.Bottom?e+t:e,Qd="react-flow__edgeupdater";function Jd({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a}){return(0,M.jsx)("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:Se([Qd,`${Qd}-${a}`]),cx:bv(t,o,e),cy:xv(n,o,e),r:o,stroke:"transparent",fill:"transparent"})}function wv({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:o,sourceY:r,targetX:i,targetY:s,sourcePosition:a,targetPosition:l,onReconnect:c,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){let p=be(),g=(b,C)=>{if(b.button!==0)return;let{autoPanOnConnect:E,domNode:_,isValidConnection:I,connectionMode:R,connectionRadius:O,lib:q,onConnectStart:L,onConnectEnd:U,cancelConnection:v,nodeLookup:N,rfId:S,panBy:k,updateConnection:A}=p.getState(),D=C.type==="target";f(!0),u?.(b,n,C.type);let F=(W,P)=>{f(!1),d?.(W,n,C.type,P)},z=W=>c?.(n,W);li.onPointerDown(b.nativeEvent,{autoPanOnConnect:E,connectionMode:R,connectionRadius:O,domNode:_,handleId:C.id,nodeId:C.nodeId,nodeLookup:N,isTarget:D,edgeUpdaterType:C.type,lib:q,flowId:S,cancelConnection:v,panBy:k,isValidConnection:I,onConnect:z,onConnectStart:L,onConnectEnd:U,onReconnectEnd:F,updateConnection:A,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle})},w=b=>g(b,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),m=b=>g(b,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),x=()=>h(!0),y=()=>h(!1);return(0,M.jsxs)(M.Fragment,{children:[(e===!0||e==="source")&&(0,M.jsx)(Jd,{position:a,centerX:o,centerY:r,radius:t,onMouseDown:w,onMouseEnter:x,onMouseOut:y,type:"source"}),(e===!0||e==="target")&&(0,M.jsx)(Jd,{position:l,centerX:i,centerY:s,radius:t,onMouseDown:m,onMouseEnter:x,onMouseOut:y,type:"target"})]})}function vv({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:o,onClick:r,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:g,noPanClassName:w,onError:m,disableKeyboardA11y:x}){let y=fe(j=>j.edgeLookup.get(e)),b=fe(j=>j.defaultEdgeOptions);y=b?{...b,...y}:y;let C=y.type||"default",E=g?.[C]||Zd[C];E===void 0&&(m?.("011",Ze.error011(C)),C="default",E=Zd.default);let _=!!(y.focusable||t&&typeof y.focusable>"u"),I=typeof d<"u"&&(y.reconnectable||n&&typeof y.reconnectable>"u"),R=!!(y.selectable||o&&typeof y.selectable>"u"),O=(0,B.useRef)(null),[q,L]=(0,B.useState)(!1),[U,v]=(0,B.useState)(!1),N=be(),{zIndex:S,sourceX:k,sourceY:A,targetX:D,targetY:F,sourcePosition:z,targetPosition:W}=fe((0,B.useCallback)(j=>{let ee=j.nodeLookup.get(y.source),de=j.nodeLookup.get(y.target);if(!ee||!de)return{zIndex:y.zIndex,...jd};let we=nd({id:e,sourceNode:ee,targetNode:de,sourceHandle:y.sourceHandle||null,targetHandle:y.targetHandle||null,connectionMode:j.connectionMode,onError:m});return{zIndex:ed({selected:y.selected,zIndex:y.zIndex,sourceNode:ee,targetNode:de,elevateOnSelect:j.elevateEdgesOnSelect}),...we||jd}},[y.source,y.target,y.sourceHandle,y.targetHandle,y.selected,y.zIndex]),xe),P=(0,B.useMemo)(()=>y.markerStart?`url('#${ii(y.markerStart,p)}')`:void 0,[y.markerStart,p]),H=(0,B.useMemo)(()=>y.markerEnd?`url('#${ii(y.markerEnd,p)}')`:void 0,[y.markerEnd,p]);if(y.hidden||k===null||A===null||D===null||F===null)return null;let V=j=>{let{addSelectedEdges:ee,unselectNodesAndEdges:de,multiSelectionActive:we}=N.getState();R&&(N.setState({nodesSelectionActive:!1}),y.selected&&we?(de({nodes:[],edges:[y]}),O.current?.blur()):ee([e])),r&&r(j,y)},K=i?j=>{i(j,{...y})}:void 0,$=s?j=>{s(j,{...y})}:void 0,G=a?j=>{a(j,{...y})}:void 0,Y=l?j=>{l(j,{...y})}:void 0,oe=c?j=>{c(j,{...y})}:void 0,le=j=>{if(!x&&gs.includes(j.key)&&R){let{unselectNodesAndEdges:ee,addSelectedEdges:de}=N.getState();j.key==="Escape"?(O.current?.blur(),ee({edges:[y]})):de([e])}};return(0,M.jsx)("svg",{style:{zIndex:S},children:(0,M.jsxs)("g",{className:Se(["react-flow__edge",`react-flow__edge-${C}`,y.className,w,{selected:y.selected,animated:y.animated,inactive:!R&&!r,updating:q,selectable:R}]),onClick:V,onDoubleClick:K,onContextMenu:$,onMouseEnter:G,onMouseMove:Y,onMouseLeave:oe,onKeyDown:_?le:void 0,tabIndex:_?0:void 0,role:_?"button":"img","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":y.ariaLabel===null?void 0:y.ariaLabel||`Edge from ${y.source} to ${y.target}`,"aria-describedby":_?`${sf}-${p}`:void 0,ref:O,children:[!U&&(0,M.jsx)(E,{id:e,source:y.source,target:y.target,type:y.type,selected:y.selected,animated:y.animated,selectable:R,deletable:y.deletable??!0,label:y.label,labelStyle:y.labelStyle,labelShowBg:y.labelShowBg,labelBgStyle:y.labelBgStyle,labelBgPadding:y.labelBgPadding,labelBgBorderRadius:y.labelBgBorderRadius,sourceX:k,sourceY:A,targetX:D,targetY:F,sourcePosition:z,targetPosition:W,data:y.data,style:y.style,sourceHandleId:y.sourceHandle,targetHandleId:y.targetHandle,markerStart:P,markerEnd:H,pathOptions:"pathOptions"in y?y.pathOptions:void 0,interactionWidth:y.interactionWidth}),I&&(0,M.jsx)(wv,{edge:y,isReconnectable:I,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:k,sourceY:A,targetX:D,targetY:F,sourcePosition:z,targetPosition:W,setUpdateHover:L,setReconnecting:v})]})})}var Sv=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Rf({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:o,noPanClassName:r,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:g}){let{edgesFocusable:w,edgesReconnectable:m,elementsSelectable:x,onError:y}=fe(Sv,xe),b=av(t);return(0,M.jsxs)("div",{className:"react-flow__edges",children:[(0,M.jsx)(fv,{defaultColor:e,rfId:n}),b.map(C=>(0,M.jsx)(vv,{id:C,edgesFocusable:w,edgesReconnectable:m,elementsSelectable:x,noPanClassName:r,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:y,edgeTypes:o,disableKeyboardA11y:g},C))]})}Rf.displayName="EdgeRenderer";var Ev=(0,B.memo)(Rf),Cv=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function _v({children:e}){let t=fe(Cv);return(0,M.jsx)("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Nv(e){let t=je(),n=(0,B.useRef)(!1);(0,B.useEffect)(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}var Dv=e=>e.panZoom?.syncViewport;function kv(e){let t=fe(Dv),n=be();return(0,B.useEffect)(()=>{e&&(t?.(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function ef(e){return e.connection.inProgress?{...e.connection,to:Xn(e.connection.to,e.transform)}:{...e.connection}}function Tv(e){return e?n=>{let o=ef(n);return e(o)}:ef}function Iv(e){let t=Tv(e);return fe(t,xe)}var Pv=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Rv({containerStyle:e,style:t,type:n,component:o}){let{nodesConnectable:r,width:i,height:s,isValid:a,inProgress:l}=fe(Pv,xe);return!(i&&r&&l)?null:(0,M.jsx)("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:(0,M.jsx)("g",{className:Se(["react-flow__connection",bs(a)]),children:(0,M.jsx)(Mf,{style:t,type:n,CustomComponent:o,isValid:a})})})}var Mf=({style:e,type:t=Ge.Bezier,CustomComponent:n,isValid:o})=>{let{inProgress:r,from:i,fromNode:s,fromHandle:a,fromPosition:l,to:c,toNode:u,toHandle:d,toPosition:f}=Iv();if(!r)return;if(n)return(0,M.jsx)(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:c.x,toY:c.y,fromPosition:l,toPosition:f,connectionStatus:bs(o),toNode:u,toHandle:d});let h="",p={sourceX:i.x,sourceY:i.y,sourcePosition:l,targetX:c.x,targetY:c.y,targetPosition:f};switch(t){case Ge.Bezier:[h]=oi(p);break;case Ge.SimpleBezier:[h]=wf(p);break;case Ge.Step:[h]=Fo({...p,borderRadius:0});break;case Ge.SmoothStep:[h]=Fo(p);break;default:[h]=ri(p)}return(0,M.jsx)("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Mf.displayName="ConnectionLine";var Mv={};function tf(e=Mv){let t=(0,B.useRef)(e),n=be();(0,B.useEffect)(()=>{},[e])}function zv(){let e=be(),t=(0,B.useRef)(!1);(0,B.useEffect)(()=>{},[])}function zf({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:o,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:g,connectionLineComponent:w,connectionLineContainerStyle:m,selectionKeyCode:x,selectionOnDrag:y,selectionMode:b,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:_,deleteKeyCode:I,onlyRenderVisibleElements:R,elementsSelectable:O,defaultViewport:q,translateExtent:L,minZoom:U,maxZoom:v,preventScrolling:N,defaultMarkerColor:S,zoomOnScroll:k,zoomOnPinch:A,panOnScroll:D,panOnScrollSpeed:F,panOnScrollMode:z,zoomOnDoubleClick:W,panOnDrag:P,onPaneClick:H,onPaneMouseEnter:V,onPaneMouseMove:K,onPaneMouseLeave:$,onPaneScroll:G,onPaneContextMenu:Y,paneClickDistance:oe,nodeClickDistance:le,onEdgeContextMenu:j,onEdgeMouseEnter:ee,onEdgeMouseMove:de,onEdgeMouseLeave:we,reconnectRadius:nt,onReconnect:jt,onReconnectStart:Me,onReconnectEnd:_n,noDragClassName:Qt,noWheelClassName:It,noPanClassName:Bt,disableKeyboardA11y:Jt,nodeExtent:Li,rfId:so,viewport:ao,onViewportChange:rr}){return tf(e),tf(t),zv(),Nv(n),kv(ao),(0,M.jsx)(Qw,{onPaneClick:H,onPaneMouseEnter:V,onPaneMouseMove:K,onPaneMouseLeave:$,onPaneContextMenu:Y,onPaneScroll:G,paneClickDistance:oe,deleteKeyCode:I,selectionKeyCode:x,selectionOnDrag:y,selectionMode:b,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:C,panActivationKeyCode:E,zoomActivationKeyCode:_,elementsSelectable:O,zoomOnScroll:k,zoomOnPinch:A,zoomOnDoubleClick:W,panOnScroll:D,panOnScrollSpeed:F,panOnScrollMode:z,panOnDrag:P,defaultViewport:q,translateExtent:L,minZoom:U,maxZoom:v,onSelectionContextMenu:d,preventScrolling:N,noDragClassName:Qt,noWheelClassName:It,noPanClassName:Bt,disableKeyboardA11y:Jt,onViewportChange:rr,isControlledViewport:!!ao,children:(0,M.jsxs)(_v,{children:[(0,M.jsx)(Ev,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:s,onReconnect:jt,onReconnectStart:Me,onReconnectEnd:_n,onlyRenderVisibleElements:R,onEdgeContextMenu:j,onEdgeMouseEnter:ee,onEdgeMouseMove:de,onEdgeMouseLeave:we,reconnectRadius:nt,defaultMarkerColor:S,noPanClassName:Bt,disableKeyboardA11y:Jt,rfId:so}),(0,M.jsx)(Rv,{style:g,type:p,component:w,containerStyle:m}),(0,M.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,M.jsx)(sv,{nodeTypes:e,onNodeClick:o,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:l,onNodeMouseLeave:c,onNodeContextMenu:u,nodeClickDistance:le,onlyRenderVisibleElements:R,noPanClassName:Bt,noDragClassName:Qt,disableKeyboardA11y:Jt,nodeExtent:Li,rfId:so}),(0,M.jsx)("div",{className:"react-flow__viewport-portal"})]})})}zf.displayName="GraphView";var Ov=(0,B.memo)(zf),nf=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l}={})=>{let c=new Map,u=new Map,d=new Map,f=new Map,h=o??t??[],p=n??e??[],g=a??[0,0],w=l??Un;As(d,f,h),si(p,c,u,{nodeOrigin:g,nodeExtent:w,elevateNodesOnSelect:!1});let m=[0,0,1];if(s&&r&&i){let x=Gn(c,{filter:E=>!!((E.width||E.initialWidth)&&(E.height||E.initialHeight))}),{x:y,y:b,zoom:C}=yn(x,r,i,.5,2,.1);m=[y,b,C]}return{rfId:"1",width:0,height:0,transform:m,nodes:p,nodeLookup:c,parentLookup:u,edges:h,edgeLookup:f,connectionLookup:d,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:o!==void 0,panZoom:null,minZoom:.5,maxZoom:2,translateExtent:Un,nodeExtent:w,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Ct.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:g,nodeDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,fitViewOnInit:!1,fitViewDone:!1,fitViewOnInitOptions:void 0,selectNodesOnDrag:!0,multiSelectionActive:!1,connection:{...ys},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanSpeed:15,connectionRadius:20,onError:_s,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1}},Av=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l})=>Md((c,u)=>({...nf({nodes:e,edges:t,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l,defaultNodes:n,defaultEdges:o}),setNodes:d=>{let{nodeLookup:f,parentLookup:h,nodeOrigin:p,elevateNodesOnSelect:g}=u();si(d,f,h,{nodeOrigin:p,nodeExtent:l,elevateNodesOnSelect:g,checkEquality:!0}),c({nodes:d})},setEdges:d=>{let{connectionLookup:f,edgeLookup:h}=u();As(f,h,d),c({edges:d})},setDefaultNodesAndEdges:(d,f)=>{if(d){let{setNodes:h}=u();h(d),c({hasDefaultNodes:!0})}if(f){let{setEdges:h}=u();h(f),c({hasDefaultEdges:!0})}},updateNodeInternals:(d,f={triggerFitView:!0})=>{let{triggerNodeChanges:h,nodeLookup:p,parentLookup:g,fitViewOnInit:w,fitViewDone:m,fitViewOnInitOptions:x,domNode:y,nodeOrigin:b,nodeExtent:C,debug:E,fitViewSync:_}=u(),{changes:I,updatedInternals:R}=sd(d,p,g,y,b,C);if(R){if(rd(p,g,{nodeOrigin:b,nodeExtent:C}),f.triggerFitView){let O=m;!m&&w&&(O=_({...x,nodes:x?.nodes})),c({fitViewDone:O})}else c({});I?.length>0&&(E&&console.log("React Flow: trigger node changes",I),h?.(I))}},updateNodePositions:(d,f=!1)=>{let h=[],p=[],{nodeLookup:g,triggerNodeChanges:w}=u();for(let[m,x]of d){let y=g.get(m),b=!!(y?.expandParent&&y?.parentId&&x?.position),C={id:m,type:"position",position:b?{x:Math.max(0,x.position.x),y:Math.max(0,x.position.y)}:x.position,dragging:f};b&&y.parentId&&h.push({id:m,parentId:y.parentId,rect:{...x.internals.positionAbsolute,width:x.measured.width??0,height:x.measured.height??0}}),p.push(C)}if(h.length>0){let{parentLookup:m,nodeOrigin:x}=u(),y=ai(h,g,m,x);p.push(...y)}w(p)},triggerNodeChanges:d=>{let{onNodesChange:f,setNodes:h,nodes:p,hasDefaultNodes:g,debug:w}=u();if(d?.length){if(g){let m=cf(d,p);h(m)}w&&console.log("React Flow: trigger node changes",d),f?.(d)}},triggerEdgeChanges:d=>{let{onEdgesChange:f,setEdges:h,edges:p,hasDefaultEdges:g,debug:w}=u();if(d?.length){if(g){let m=uf(d,p);h(m)}w&&console.log("React Flow: trigger edge changes",d),f?.(d)}},addSelectedNodes:d=>{let{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:w}=u();if(f){let m=d.map(x=>bn(x,!0));g(m);return}g(jn(p,new Set([...d]),!0)),w(jn(h))},addSelectedEdges:d=>{let{multiSelectionActive:f,edgeLookup:h,nodeLookup:p,triggerNodeChanges:g,triggerEdgeChanges:w}=u();if(f){let m=d.map(x=>bn(x,!0));w(m);return}w(jn(h,new Set([...d]))),g(jn(p,new Set,!0))},unselectNodesAndEdges:({nodes:d,edges:f}={})=>{let{edges:h,nodes:p,nodeLookup:g,triggerNodeChanges:w,triggerEdgeChanges:m}=u(),x=d||p,y=f||h,b=x.map(E=>{let _=g.get(E.id);return _&&(_.selected=!1),bn(E.id,!1)}),C=y.map(E=>bn(E.id,!1));w(b),m(C)},setMinZoom:d=>{let{panZoom:f,maxZoom:h}=u();f?.setScaleExtent([d,h]),c({minZoom:d})},setMaxZoom:d=>{let{panZoom:f,minZoom:h}=u();f?.setScaleExtent([h,d]),c({maxZoom:d})},setTranslateExtent:d=>{u().panZoom?.setTranslateExtent(d),c({translateExtent:d})},setPaneClickDistance:d=>{u().panZoom?.setClickDistance(d)},resetSelectedElements:()=>{let{edges:d,nodes:f,triggerNodeChanges:h,triggerEdgeChanges:p}=u(),g=f.reduce((m,x)=>x.selected?[...m,bn(x.id,!1)]:m,[]),w=d.reduce((m,x)=>x.selected?[...m,bn(x.id,!1)]:m,[]);h(g),p(w)},setNodeExtent:d=>{let{nodes:f,nodeLookup:h,parentLookup:p,nodeOrigin:g,elevateNodesOnSelect:w,nodeExtent:m}=u();d[0][0]===m[0][0]&&d[0][1]===m[0][1]&&d[1][0]===m[1][0]&&d[1][1]===m[1][1]||(si(f,h,p,{nodeOrigin:g,nodeExtent:d,elevateNodesOnSelect:w,checkEquality:!1}),c({nodeExtent:d}))},panBy:d=>{let{transform:f,width:h,height:p,panZoom:g,translateExtent:w}=u();return ad({delta:d,panZoom:g,transform:f,translateExtent:w,width:h,height:p})},fitView:d=>{let{panZoom:f,width:h,height:p,minZoom:g,maxZoom:w,nodeLookup:m}=u();if(!f)return Promise.resolve(!1);let x=jr(m,d);return Qr({nodes:x,width:h,height:p,panZoom:f,minZoom:g,maxZoom:w},d)},fitViewSync:d=>{let{panZoom:f,width:h,height:p,minZoom:g,maxZoom:w,nodeLookup:m}=u();if(!f)return!1;let x=jr(m,d);return Qr({nodes:x,width:h,height:p,panZoom:f,minZoom:g,maxZoom:w},d),x.size>0},cancelConnection:()=>{c({connection:{...ys}})},updateConnection:d=>{c({connection:d})},reset:()=>c({...nf()})}),Object.is);function Ws({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:o,initialWidth:r,initialHeight:i,fitView:s,nodeOrigin:a,nodeExtent:l,children:c}){let[u]=(0,B.useState)(()=>Av({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,width:r,height:i,fitView:s,nodeOrigin:a,nodeExtent:l}));return(0,M.jsx)(ow,{value:u,children:(0,M.jsx)(Nw,{children:c})})}function Lv({children:e,nodes:t,edges:n,defaultNodes:o,defaultEdges:r,width:i,height:s,fitView:a,nodeOrigin:l,nodeExtent:c}){return(0,B.useContext)(pi)?(0,M.jsx)(M.Fragment,{children:e}):(0,M.jsx)(Ws,{initialNodes:t,initialEdges:n,defaultNodes:o,defaultEdges:r,initialWidth:i,initialHeight:s,fitView:a,nodeOrigin:l,nodeExtent:c,children:e})}var Fv={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function $v({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:m,onNodeMouseEnter:x,onNodeMouseMove:y,onNodeMouseLeave:b,onNodeContextMenu:C,onNodeDoubleClick:E,onNodeDragStart:_,onNodeDrag:I,onNodeDragStop:R,onNodesDelete:O,onEdgesDelete:q,onDelete:L,onSelectionChange:U,onSelectionDragStart:v,onSelectionDrag:N,onSelectionDragStop:S,onSelectionContextMenu:k,onSelectionStart:A,onSelectionEnd:D,onBeforeDelete:F,connectionMode:z,connectionLineType:W=Ge.Bezier,connectionLineStyle:P,connectionLineComponent:H,connectionLineContainerStyle:V,deleteKeyCode:K="Backspace",selectionKeyCode:$="Shift",selectionOnDrag:G=!1,selectionMode:Y=hn.Full,panActivationKeyCode:oe="Space",multiSelectionKeyCode:le=Oo()?"Meta":"Control",zoomActivationKeyCode:j=Oo()?"Meta":"Control",snapToGrid:ee,snapGrid:de,onlyRenderVisibleElements:we=!1,selectNodesOnDrag:nt,nodesDraggable:jt,nodesConnectable:Me,nodesFocusable:_n,nodeOrigin:Qt=af,edgesFocusable:It,edgesReconnectable:Bt,elementsSelectable:Jt=!0,defaultViewport:Li=gw,minZoom:so=.5,maxZoom:ao=2,translateExtent:rr=Un,preventScrolling:Wg=!0,nodeExtent:Fi,defaultMarkerColor:Kg="#b1b1b7",zoomOnScroll:qg=!0,zoomOnPinch:Ug=!0,panOnScroll:Gg=!1,panOnScrollSpeed:Yg=.5,panOnScrollMode:Xg=zt.Free,zoomOnDoubleClick:Zg=!0,panOnDrag:jg=!0,onPaneClick:Qg,onPaneMouseEnter:Jg,onPaneMouseMove:ey,onPaneMouseLeave:ty,onPaneScroll:ny,onPaneContextMenu:oy,paneClickDistance:Ba=0,nodeClickDistance:ry=0,children:iy,onReconnect:sy,onReconnectStart:ay,onReconnectEnd:ly,onEdgeContextMenu:cy,onEdgeDoubleClick:uy,onEdgeMouseEnter:dy,onEdgeMouseMove:fy,onEdgeMouseLeave:hy,reconnectRadius:py=10,onNodesChange:my,onEdgesChange:gy,noDragClassName:yy="nodrag",noWheelClassName:by="nowheel",noPanClassName:Ha="nopan",fitView:Va,fitViewOptions:xy,connectOnClick:wy,attributionPosition:vy,proOptions:Sy,defaultEdgeOptions:Ey,elevateNodesOnSelect:Cy,elevateEdgesOnSelect:_y,disableKeyboardA11y:Wa=!1,autoPanOnConnect:Ny,autoPanOnNodeDrag:Dy,autoPanSpeed:ky,connectionRadius:Ty,isValidConnection:Iy,onError:Py,style:Ry,id:Ka,nodeDragThreshold:My,viewport:zy,onViewportChange:Oy,width:Ay,height:Ly,colorMode:Fy="light",debug:$y,onScroll:qa,...By},Hy){let $i=Ka||"1",Vy=ww(Fy),Wy=(0,B.useCallback)(Ua=>{Ua.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),qa?.(Ua)},[qa]);return(0,M.jsx)("div",{"data-testid":"rf__wrapper",...By,onScroll:Wy,style:{...Ry,...Fv},ref:Hy,className:Se(["react-flow",r,Vy]),id:Ka,children:(0,M.jsxs)(Lv,{nodes:e,edges:t,width:Ay,height:Ly,fitView:Va,nodeOrigin:Qt,nodeExtent:Fi,children:[(0,M.jsx)(Ov,{onInit:c,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:x,onNodeMouseMove:y,onNodeMouseLeave:b,onNodeContextMenu:C,onNodeDoubleClick:E,nodeTypes:i,edgeTypes:s,connectionLineType:W,connectionLineStyle:P,connectionLineComponent:H,connectionLineContainerStyle:V,selectionKeyCode:$,selectionOnDrag:G,selectionMode:Y,deleteKeyCode:K,multiSelectionKeyCode:le,panActivationKeyCode:oe,zoomActivationKeyCode:j,onlyRenderVisibleElements:we,defaultViewport:Li,translateExtent:rr,minZoom:so,maxZoom:ao,preventScrolling:Wg,zoomOnScroll:qg,zoomOnPinch:Ug,zoomOnDoubleClick:Zg,panOnScroll:Gg,panOnScrollSpeed:Yg,panOnScrollMode:Xg,panOnDrag:jg,onPaneClick:Qg,onPaneMouseEnter:Jg,onPaneMouseMove:ey,onPaneMouseLeave:ty,onPaneScroll:ny,onPaneContextMenu:oy,paneClickDistance:Ba,nodeClickDistance:ry,onSelectionContextMenu:k,onSelectionStart:A,onSelectionEnd:D,onReconnect:sy,onReconnectStart:ay,onReconnectEnd:ly,onEdgeContextMenu:cy,onEdgeDoubleClick:uy,onEdgeMouseEnter:dy,onEdgeMouseMove:fy,onEdgeMouseLeave:hy,reconnectRadius:py,defaultMarkerColor:Kg,noDragClassName:yy,noWheelClassName:by,noPanClassName:Ha,rfId:$i,disableKeyboardA11y:Wa,nodeExtent:Fi,viewport:zy,onViewportChange:Oy}),(0,M.jsx)(xw,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:h,onConnectStart:p,onConnectEnd:g,onClickConnectStart:w,onClickConnectEnd:m,nodesDraggable:jt,nodesConnectable:Me,nodesFocusable:_n,edgesFocusable:It,edgesReconnectable:Bt,elementsSelectable:Jt,elevateNodesOnSelect:Cy,elevateEdgesOnSelect:_y,minZoom:so,maxZoom:ao,nodeExtent:Fi,onNodesChange:my,onEdgesChange:gy,snapToGrid:ee,snapGrid:de,connectionMode:z,translateExtent:rr,connectOnClick:wy,defaultEdgeOptions:Ey,fitView:Va,fitViewOptions:xy,onNodesDelete:O,onEdgesDelete:q,onDelete:L,onNodeDragStart:_,onNodeDrag:I,onNodeDragStop:R,onSelectionDrag:N,onSelectionDragStart:v,onSelectionDragStop:S,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Ha,nodeOrigin:Qt,rfId:$i,autoPanOnConnect:Ny,autoPanOnNodeDrag:Dy,autoPanSpeed:ky,onError:Py,connectionRadius:Ty,isValidConnection:Iy,selectNodesOnDrag:nt,nodeDragThreshold:My,onBeforeDelete:F,paneClickDistance:Ba,debug:$y}),(0,M.jsx)(mw,{onSelectionChange:U}),iy,(0,M.jsx)(uw,{proOptions:Sy,position:vy}),(0,M.jsx)(lw,{rfId:$i,disableKeyboardA11y:Wa})]})})}var Of=df($v);function Af(e){let[t,n]=(0,B.useState)(e),o=(0,B.useCallback)(r=>n(i=>cf(r,i)),[]);return[t,n,o]}function Lf(e){let[t,n]=(0,B.useState)(e),o=(0,B.useCallback)(r=>n(i=>uf(r,i)),[]);return[t,n,o]}var YP=Ze.error014();function Bv({dimensions:e,lineWidth:t,variant:n,className:o}){return(0,M.jsx)("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Se(["react-flow__background-pattern",n,o])})}function Hv({radius:e,className:t}){return(0,M.jsx)("circle",{cx:e,cy:e,r:e,className:Se(["react-flow__background-pattern","dots",t])})}var Nt;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Nt||(Nt={}));var Vv={[Nt.Dots]:1,[Nt.Lines]:1,[Nt.Cross]:6},Wv=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Ff({id:e,variant:t=Nt.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=0,color:s,bgColor:a,style:l,className:c,patternClassName:u}){let d=(0,B.useRef)(null),{transform:f,patternId:h}=fe(Wv,xe),p=o||Vv[t],g=t===Nt.Dots,w=t===Nt.Cross,m=Array.isArray(n)?n:[n,n],x=[m[0]*f[2]||1,m[1]*f[2]||1],y=p*f[2],b=Array.isArray(i)?i:[i,i],C=w?[y,y]:x,E=[b[0]*f[2]||1+C[0]/2,b[1]*f[2]||1+C[1]/2],_=`${h}${e||""}`;return(0,M.jsxs)("svg",{className:Se(["react-flow__background",c]),style:{...l,...gi,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:d,"data-testid":"rf__background",children:[(0,M.jsx)("pattern",{id:_,x:f[0]%x[0],y:f[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${E[0]},-${E[1]})`,children:g?(0,M.jsx)(Hv,{radius:y/2,className:u}):(0,M.jsx)(Bv,{dimensions:C,lineWidth:r,variant:t,className:u})}),(0,M.jsx)("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${_})`})]})}Ff.displayName="Background";var $f=(0,B.memo)(Ff);function Kv(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:(0,M.jsx)("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function qv(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:(0,M.jsx)("path",{d:"M0 0h32v4.2H0z"})})}function Uv(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:(0,M.jsx)("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function Gv(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,M.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function Yv(){return(0,M.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:(0,M.jsx)("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function fi({children:e,className:t,...n}){return(0,M.jsx)("button",{type:"button",className:Se(["react-flow__controls-button",t]),...n,children:e})}var Xv=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom});function Bf({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:l,className:c,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":h="React Flow controls"}){let p=be(),{isInteractive:g,minZoomReached:w,maxZoomReached:m}=fe(Xv,xe),{zoomIn:x,zoomOut:y,fitView:b}=je(),C=()=>{x(),i?.()},E=()=>{y(),s?.()},_=()=>{b(r),a?.()},I=()=>{p.setState({nodesDraggable:!g,nodesConnectable:!g,elementsSelectable:!g}),l?.(!g)};return(0,M.jsxs)(mi,{className:Se(["react-flow__controls",f==="horizontal"?"horizontal":"vertical",c]),position:d,style:e,"data-testid":"rf__controls","aria-label":h,children:[t&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(fi,{onClick:C,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:m,children:(0,M.jsx)(Kv,{})}),(0,M.jsx)(fi,{onClick:E,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:w,children:(0,M.jsx)(qv,{})})]}),n&&(0,M.jsx)(fi,{className:"react-flow__controls-fitview",onClick:_,title:"fit view","aria-label":"fit view",children:(0,M.jsx)(Uv,{})}),o&&(0,M.jsx)(fi,{className:"react-flow__controls-interactive",onClick:I,title:"toggle interactivity","aria-label":"toggle interactivity",children:g?(0,M.jsx)(Yv,{}):(0,M.jsx)(Gv,{})}),u]})}Bf.displayName="Controls";var Hf=(0,B.memo)(Bf);function Zv({id:e,x:t,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:l,className:c,borderRadius:u,shapeRendering:d,selected:f,onClick:h}){let{background:p,backgroundColor:g}=i||{},w=s||p||g;return(0,M.jsx)("rect",{className:Se(["react-flow__minimap-node",{selected:f},c]),x:t,y:n,rx:u,ry:u,width:o,height:r,style:{fill:w,stroke:a,strokeWidth:l},shapeRendering:d,onClick:h?m=>h(m,e):void 0})}var jv=(0,B.memo)(Zv),Qv=e=>e.nodes.map(t=>t.id),Bs=e=>e instanceof Function?e:()=>e;function Jv({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r,nodeComponent:i=jv,onClick:s}){let a=fe(Qv,xe),l=Bs(t),c=Bs(e),u=Bs(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return(0,M.jsx)(M.Fragment,{children:a.map(f=>(0,M.jsx)(tS,{id:f,nodeColorFunc:l,nodeStrokeColorFunc:c,nodeClassNameFunc:u,nodeBorderRadius:o,nodeStrokeWidth:r,NodeComponent:i,onClick:s,shapeRendering:d},f))})}function eS({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:o,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:l}){let{node:c,x:u,y:d,width:f,height:h}=fe(p=>{let g=p.nodeLookup.get(e),{x:w,y:m}=g.internals.positionAbsolute,{width:x,height:y}=_t(g);return{node:g,x:w,y:m,width:x,height:y}},xe);return!c||c.hidden||!Ds(c)?null:(0,M.jsx)(a,{x:u,y:d,width:f,height:h,style:c.style,selected:!!c.selected,className:o(c),color:t(c),borderRadius:r,strokeColor:n(c),strokeWidth:i,shapeRendering:s,onClick:l,id:c.id})}var tS=(0,B.memo)(eS),nS=(0,B.memo)(Jv),oS=200,rS=150,iS=e=>{let t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Es(Gn(e.nodeLookup),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height}},sS="react-flow__minimap-desc";function Vf({style:e,className:t,nodeStrokeColor:n,nodeColor:o,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:l,maskColor:c,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:g=!1,zoomable:w=!1,ariaLabel:m="React Flow mini map",inversePan:x,zoomStep:y=10,offsetScale:b=5}){let C=be(),E=(0,B.useRef)(null),{boundingRect:_,viewBB:I,rfId:R,panZoom:O,translateExtent:q,flowWidth:L,flowHeight:U}=fe(iS,xe),v=e?.width??oS,N=e?.height??rS,S=_.width/v,k=_.height/N,A=Math.max(S,k),D=A*v,F=A*N,z=b*A,W=_.x-(D-_.width)/2-z,P=_.y-(F-_.height)/2-z,H=D+z*2,V=F+z*2,K=`${sS}-${R}`,$=(0,B.useRef)(0),G=(0,B.useRef)();$.current=A,(0,B.useEffect)(()=>{if(E.current&&O)return G.current=pd({domNode:E.current,panZoom:O,getTransform:()=>C.getState().transform,getViewScale:()=>$.current}),()=>{G.current?.destroy()}},[O]),(0,B.useEffect)(()=>{G.current?.update({translateExtent:q,width:L,height:U,inversePan:x,pannable:g,zoomStep:y,zoomable:w})},[g,w,x,y,q,L,U]);let Y=h?le=>{let[j,ee]=G.current?.pointer(le)||[0,0];h(le,{x:j,y:ee})}:void 0,oe=p?(0,B.useCallback)((le,j)=>{let ee=C.getState().nodeLookup.get(j);p(le,ee)},[]):void 0;return(0,M.jsx)(mi,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*A:void 0,"--xy-minimap-node-background-color-props":typeof o=="string"?o:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="string"?s:void 0},className:Se(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:(0,M.jsxs)("svg",{width:v,height:N,viewBox:`${W} ${P} ${H} ${V}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":K,ref:E,onClick:Y,children:[m&&(0,M.jsx)("title",{id:K,children:m}),(0,M.jsx)(nS,{onClick:oe,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),(0,M.jsx)("path",{className:"react-flow__minimap-mask",d:`M${W-z},${P-z}h${H+z*2}v${V+z*2}h${-H-z*2}z
        M${I.x},${I.y}h${I.width}v${I.height}h${-I.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}Vf.displayName="MiniMap";var Wf=(0,B.memo)(Vf);function aS({nodeId:e,position:t,variant:n=mn.Handle,className:o,style:r={},children:i,color:s,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,shouldResize:f,onResizeStart:h,onResize:p,onResizeEnd:g}){let w=mf(),m=typeof e=="string"?e:w,x=be(),y=(0,B.useRef)(null),b=n===mn.Line?"right":"bottom-right",C=t??b,E=(0,B.useRef)(null);(0,B.useEffect)(()=>{if(!(!y.current||!m))return E.current||(E.current=xd({domNode:y.current,nodeId:m,getStoreItems:()=>{let{nodeLookup:O,transform:q,snapGrid:L,snapToGrid:U,nodeOrigin:v,domNode:N}=x.getState();return{nodeLookup:O,transform:q,snapGrid:L,snapToGrid:U,nodeOrigin:v,paneDomNode:N}},onChange:(O,q)=>{let{triggerNodeChanges:L,nodeLookup:U,parentLookup:v,nodeOrigin:N}=x.getState(),S=[],k={x:O.x,y:O.y},A=U.get(m);if(A&&A.expandParent&&A.parentId){let D=A.origin??N,F=O.width??A.measured.width??0,z=O.height??A.measured.height??0,W={id:A.id,parentId:A.parentId,rect:{width:F,height:z,...ks({x:O.x??A.position.x,y:O.y??A.position.y},{width:F,height:z},A.parentId,U,D)}},P=ai([W],U,v,N);S.push(...P),k.x=O.x?Math.max(D[0]*F,O.x):void 0,k.y=O.y?Math.max(D[1]*z,O.y):void 0}if(k.x!==void 0&&k.y!==void 0){let D={id:m,type:"position",position:{...k}};S.push(D)}if(O.width!==void 0&&O.height!==void 0){let D={id:m,type:"dimensions",resizing:!0,setAttributes:!0,dimensions:{width:O.width,height:O.height}};S.push(D)}for(let D of q){let F={...D,type:"position"};S.push(F)}L(S)},onEnd:()=>{let O={id:m,type:"dimensions",resizing:!1};x.getState().triggerNodeChanges([O])}})),E.current.update({controlPosition:C,boundaries:{minWidth:a,minHeight:l,maxWidth:c,maxHeight:u},keepAspectRatio:d,onResizeStart:h,onResize:p,onResizeEnd:g,shouldResize:f}),()=>{E.current?.destroy()}},[C,a,l,c,u,d,h,p,g,f]);let _=C.split("-"),I=n===mn.Line?"borderColor":"backgroundColor",R=s?{...r,[I]:s}:r;return(0,M.jsx)("div",{className:Se(["react-flow__resize-control","nodrag",..._,n,o]),ref:y,style:R,children:i})}var XP=(0,B.memo)(aS);var Wo=X(fm());var Fe=[];for(let e=0;e<256;++e)Fe.push((e+256).toString(16).slice(1));function hm(e,t=0){return(Fe[e[t+0]]+Fe[e[t+1]]+Fe[e[t+2]]+Fe[e[t+3]]+"-"+Fe[e[t+4]]+Fe[e[t+5]]+"-"+Fe[e[t+6]]+Fe[e[t+7]]+"-"+Fe[e[t+8]]+Fe[e[t+9]]+"-"+Fe[e[t+10]]+Fe[e[t+11]]+Fe[e[t+12]]+Fe[e[t+13]]+Fe[e[t+14]]+Fe[e[t+15]]).toLowerCase()}var ua,yC=new Uint8Array(16);function da(){if(!ua){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ua=crypto.getRandomValues.bind(crypto)}return ua(yC)}var bC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),fa={randomUUID:bC};function xC(e,t,n){if(fa.randomUUID&&!t&&!e)return fa.randomUUID();e=e||{};let o=e.random??e.rng?.()??da();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,t){if(n=n||0,n<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let r=0;r<16;++r)t[n+r]=o[r];return t}return hm(o)}var yt=xC;var vn={getNextColumnName:e=>{let t=1;for(;e.some(n=>n.name===`column_${t}`);)t++;return`column_${t}`},getNextForeignKeyName:(e,t)=>{let n=new Set;for(let r of t)for(let i of r.foreignKeys)n.add(i.name);for(let r of e)n.add(r.name);let o=1;for(;n.has(`FK_${o}`);)o++;return`FK_${o}`},getNextTableName:e=>{let t=1;for(;e.some(n=>n.name===`table_${t}`);)t++;return`table_${t}`}},Dt={getAllTables:(e,t)=>e.tables.filter(n=>!t||n.schema!==t.schema||n.name!==t.name).sort(),getTableFromDisplayName:(e,t)=>e.tables.find(n=>`${n.schema}.${n.name}`===t),tableNameValidationError:(e,t)=>{if(e.tables.find(o=>o.name.toLowerCase()===t.name.toLowerCase()&&o.schema.toLowerCase()===t.schema.toLowerCase()&&o.id!==t.id))return T.schemaDesigner.tableNameRepeatedError(t.name);if(!t.name)return T.schemaDesigner.tableNameEmptyError},createNewTable:(e,t)=>({name:vn.getNextTableName(e.tables),schema:t[0],columns:[{name:"Id",dataType:"int",maxLength:"",precision:0,scale:0,isNullable:!1,isPrimaryKey:!0,id:yt(),isIdentity:!0,identitySeed:1,identityIncrement:1,defaultValue:"",isComputed:!1,computedFormula:"",computedPersisted:!1}],foreignKeys:[],id:yt()})},De={isColumnValid:(e,t)=>{if(t.find(o=>o.name.toLowerCase()===e.name.toLowerCase()&&o.id!==e.id&&o.dataType===e.dataType))return T.schemaDesigner.columnNameRepeatedError(e.name);if(!e.name)return T.schemaDesigner.columnNameEmptyError;if(e.isPrimaryKey&&e.isNullable)return T.schemaDesigner.columnPKCannotBeNull(e.name);if(De.isLengthBasedType(e.dataType)){if(!e.maxLength)return T.schemaDesigner.columnMaxLengthEmptyError;if(e.maxLength&&e.maxLength!=="MAX"){let o=parseInt(e.maxLength);if(isNaN(o)||o<=0)return T.schemaDesigner.columnMaxLengthInvalid(e.maxLength)}}},isLengthBasedType:e=>["char","varchar","nchar","nvarchar","binary","varbinary","vector"].includes(e),isTimeBasedWithScale:e=>["datetime2","datetimeoffset","time"].includes(e),isPrecisionBasedType:e=>["decimal","numeric"].includes(e),isIdentityBasedType:(e,t)=>e==="decimal"||e==="numeric"?t===0:["int","bigint","smallint","tinyint"].includes(e),getDefaultLength:e=>{switch(e){case"char":case"nchar":case"binary":case"vector":return"1";case"varchar":case"nvarchar":case"varbinary":return"50";default:return"0"}},getDefaultPrecision:e=>{switch(e){case"decimal":case"numeric":return 18;default:return 0}},getDefaultScale:e=>{switch(e){case"decimal":case"numeric":return 0;default:return 0}},fillColumnDefaults:e=>(De.isLengthBasedType(e.dataType)?e.maxLength=De.getDefaultLength(e.dataType):e.maxLength="",De.isPrecisionBasedType(e.dataType)?(e.precision=De.getDefaultPrecision(e.dataType),e.scale=De.getDefaultScale(e.dataType)):(e.precision=0,e.scale=0),De.isTimeBasedWithScale(e.dataType)?e.scale=De.getDefaultScale(e.dataType):e.scale=0,e),getAdvancedOptions:e=>{let t=[];return e.isPrimaryKey||t.push({label:T.schemaDesigner.allowNull,type:"checkbox",value:!1,columnProperty:"isNullable",columnModifier:(n,o)=>(n.isNullable=o,n)}),e.isComputed||(De.isIdentityBasedType(e.dataType,e.scale)&&(!e.isNullable||e.isPrimaryKey)&&t.push({label:T.schemaDesigner.isIdentity,value:"isIdentity",type:"checkbox",columnProperty:"isIdentity",columnModifier:(n,o)=>(n.isIdentity=o,n.identitySeed=o?1:0,n.identityIncrement=o?1:0,n)}),De.isLengthBasedType(e.dataType)&&t.push({label:T.schemaDesigner.maxLength,value:"",type:"input",columnProperty:"maxLength",columnModifier:(n,o)=>(n.maxLength=o,n.maxLength||(n.maxLength="0"),n)}),De.isPrecisionBasedType(e.dataType)&&t.push({label:T.schemaDesigner.precision,value:"",type:"input-number",columnProperty:"precision",columnModifier:(n,o)=>(n.precision=o,n)}),(De.isTimeBasedWithScale(e.dataType)||De.isPrecisionBasedType(e.dataType))&&t.push({label:T.schemaDesigner.scale,value:"",type:"input-number",columnProperty:"scale",columnModifier:(n,o)=>(n.scale=o,n)}),t.push({label:T.schemaDesigner.defaultValue,value:"",type:"textarea",columnProperty:"defaultValue",columnModifier:(n,o)=>(n.defaultValue=o,n)})),t.push({label:T.schemaDesigner.isComputed,value:!1,type:"checkbox",columnProperty:"isComputed",columnModifier:(n,o)=>(n.isComputed=o,n.isPrimaryKey=!1,n.isIdentity=!1,n.identitySeed=0,n.identityIncrement=0,n.isNullable=!0,n.computedFormula=o?"1":"",n.computedPersisted=!1,n.dataType=o?"int":n.dataType,n)}),e.isComputed&&(t.push({label:T.schemaDesigner.computedFormula,value:"",type:"textarea",columnProperty:"computedFormula",columnModifier:(n,o)=>(n.computedFormula=o,n)}),t.push({label:T.schemaDesigner.isPersisted,value:!1,type:"checkbox",columnProperty:"computedPersisted",columnModifier:(n,o)=>(n.computedPersisted=o,n)})),t}},pe={areDataTypesCompatible:(e,t)=>e.dataType!==t.dataType?{isValid:!1,errorMessage:T.schemaDesigner.incompatibleDataTypes(e.dataType,e.name,t.dataType,t.name)}:De.isLengthBasedType(e.dataType)&&e.maxLength!==t.maxLength?{isValid:!1,errorMessage:T.schemaDesigner.incompatibleLength(e.name,t.name,e.maxLength,t.maxLength)}:De.isPrecisionBasedType(e.dataType)&&(e.precision!==t.precision||e.scale!==t.scale)?{isValid:!1,errorMessage:T.schemaDesigner.incompatiblePrecisionOrScale(e.name,t.name)}:De.isTimeBasedWithScale(e.dataType)&&e.scale!==t.scale?{isValid:!1,errorMessage:T.schemaDesigner.incompatibleScale(e.name,t.name)}:{isValid:!0},isCyclicForeignKey:(e,t,n,o=new Set)=>{if(!t||!n||t.id===n.id&&o.size===0)return!1;if(o.has(t.id))return!0;o.add(t.id);for(let r of t.foreignKeys){let i=e.find(s=>s.name===r.referencedTableName&&s.schema===r.referencedSchemaName);if(i&&(i.id===n.id||pe.isCyclicForeignKey(e,i,n,new Set(o))))return!0}return!1},isForeignKeyValid:(e,t,n)=>{let o=e.find(s=>s.name===n.referencedTableName&&s.schema===n.referencedSchemaName);if(!o)return{isValid:!1,errorMessage:T.schemaDesigner.referencedTableNotFound(n.referencedTableName)};let r=t.foreignKeys.filter(s=>s.id!==n.id),i=new Set;for(let s of r)for(let a of s.columns)i.add(a);for(let s of n.columns){if(i.has(s))return{isValid:!1,errorMessage:T.schemaDesigner.duplicateForeignKeyColumns(s)};i.add(s)}for(let s=0;s<n.columns.length;s++){let a=t.columns.find(u=>u.name===n.columns[s]),l=o.columns.find(u=>u.name===n.referencedColumns[s]);if(!a)return{isValid:!1,errorMessage:T.schemaDesigner.columnNotFound(n.columns[s])};if(!l)return{isValid:!1,errorMessage:T.schemaDesigner.referencedColumnNotFound(n.referencedColumns[s])};let c=pe.areDataTypesCompatible(a,l);if(!c.isValid)return c;if(!l.isPrimaryKey)return{isValid:!1,errorMessage:T.schemaDesigner.referencedColumnNotPK(l.name)};if(a.isIdentity&&(n.onUpdateAction!==he.OnAction.NO_ACTION||n.onDeleteAction!==he.OnAction.NO_ACTION))return{isValid:!1,errorMessage:T.schemaDesigner.identityColumnFKConstraint(a.name)}}return{isValid:!0}},getForeignKeyWarnings:(e,t,n)=>{let o=!1,r=[],i=e.find(s=>s.name===n.referencedTableName&&s.schema===n.referencedSchemaName);return i?(n.name||(o=!0,r.push(T.schemaDesigner.foreignKeyNameEmptyWarning)),pe.isCyclicForeignKey(e,i,t)&&(o=!0,r.push(T.schemaDesigner.cyclicForeignKeyDetected(t.name,i.name))),{isValid:!o,errorMessage:o?r.join(", "):void 0}):{isValid:!1,errorMessage:T.schemaDesigner.referencedTableNotFound(n.referencedTableName)}},extractForeignKeysFromEdges:(e,t,n)=>{let o=e.filter(i=>i.source===t),r=new Map;return o.forEach(i=>{let s=n.tables.find(c=>c.id===i.source),a=n.tables.find(c=>c.id===i.target);if(!s||!a||!i.data)return;let l={id:i.data.id,columns:[...i.data.columns],name:i.data.name,onDeleteAction:i.data.onDeleteAction,onUpdateAction:i.data.onUpdateAction,referencedColumns:[...i.data.referencedColumns],referencedSchemaName:i.data.referencedSchemaName,referencedTableName:i.data.referencedTableName};if(r.has(i.data.id)){let c=r.get(i.data.id);c&&(c.columns.push(...l.columns),c.referencedColumns.push(...l.referencedColumns))}else r.set(i.data.id,l)}),Array.from(r.values())},extractColumnNameFromHandle:e=>e.replace("left-","").replace("right-",""),createForeignKeyFromConnection:(e,t,n,o,r,i)=>({id:r||yt(),name:i||`FK_${e.data.name}_${t.data.name}`,columns:[n],referencedSchemaName:t.data.schema,referencedTableName:t.data.name,referencedColumns:[o],onDeleteAction:he.OnAction.NO_ACTION,onUpdateAction:he.OnAction.NO_ACTION}),validateConnection:(e,t,n)=>{let o=t.find(l=>l.id===e.source),r=t.find(l=>l.id===e.target);if(!o||!r)return{isValid:!1,errorMessage:"Source or target table not found"};let i=e.sourceHandle?pe.extractColumnNameFromHandle(e.sourceHandle):"",s=e.targetHandle?pe.extractColumnNameFromHandle(e.targetHandle):"";if(!i||!s)return{isValid:!1,errorMessage:"Source or target column not found"};let a=pe.createForeignKeyFromConnection(o,r,i,s);return pe.isForeignKeyValid(ye.extractSchemaModel(t,n).tables,o.data,a)},getOnActionOptions:()=>[{label:T.schemaDesigner.cascade,value:he.OnAction.CASCADE},{label:T.schemaDesigner.noAction,value:he.OnAction.NO_ACTION},{label:T.schemaDesigner.setNull,value:he.OnAction.SET_NULL},{label:T.schemaDesigner.setDefault,value:he.OnAction.SET_DEFAULT}],convertStringToOnAction:e=>{switch(e){case T.schemaDesigner.cascade:return he.OnAction.CASCADE;case T.schemaDesigner.noAction:return he.OnAction.NO_ACTION;case T.schemaDesigner.setNull:return he.OnAction.SET_NULL;case T.schemaDesigner.setDefault:return he.OnAction.SET_DEFAULT;default:return he.OnAction.NO_ACTION}},convertOnActionToString:e=>{switch(e){case he.OnAction.CASCADE:return T.schemaDesigner.cascade;case he.OnAction.NO_ACTION:return T.schemaDesigner.noAction;case he.OnAction.SET_NULL:return T.schemaDesigner.setNull;case he.OnAction.SET_DEFAULT:return T.schemaDesigner.setDefault;default:return T.schemaDesigner.noAction}}},Yt={NODE_WIDTH:300,NODE_MARGIN:50,BASE_NODE_HEIGHT:70,COLUMN_HEIGHT:30,LAYOUT_OPTIONS:{rankdir:"LR",marginx:50,marginy:50,nodesep:50,ranksep:50}},ye={getTableWidth:()=>Yt.NODE_WIDTH+Yt.NODE_MARGIN,getTableHeight:e=>Yt.BASE_NODE_HEIGHT+e.columns.length*Yt.COLUMN_HEIGHT,generatePositions:(e,t)=>{let n=new Wo.default.graphlib.Graph().setDefaultEdgeLabel(()=>({}));n.setGraph(Yt.LAYOUT_OPTIONS);for(let r of e)r.hidden||n.setNode(r.id,{width:ye.getTableWidth(),height:ye.getTableHeight(r.data)});for(let r of t){if(r.hidden)continue;let i=e.find(a=>a.id===r.source),s=e.find(a=>a.id===r.target);!i?.hidden&&!s?.hidden&&n.setEdge(r.source,r.target)}return Wo.default.layout(n),{nodes:e.map(r=>{if(r.hidden)return r;let i=n.node(r.id);return{...r,position:{x:i.x-ye.getTableWidth()/2,y:i.y-ye.getTableHeight(r.data)/2}}}),edges:t}},generateSchemaDesignerFlowComponents:e=>{if(!e)return{nodes:[],edges:[]};let t=new Wo.default.graphlib.Graph().setDefaultEdgeLabel(()=>({}));t.setGraph(Yt.LAYOUT_OPTIONS);let n=e.tables.map(i=>({id:i.id,type:"tableNode",data:{...i}}));n.forEach(i=>{t.setNode(i.id,{width:ye.getTableWidth(),height:ye.getTableHeight(i.data)}),i.data.foreignKeys.forEach(s=>{let a=e.tables.find(l=>l.name===s.referencedTableName&&l.schema===s.referencedSchemaName);a&&t.setEdge(i.id,a.id)})}),Wo.default.layout(t);let o=n.map(i=>{let s=t.node(i.id);return{...i,position:{x:s.x-ye.getTableWidth()/2,y:s.y-ye.getTableHeight(i.data)/2}}}),r=[];for(let i of e.tables)for(let s of i.foreignKeys){let a=e.tables.find(l=>l.name===s.referencedTableName&&l.schema===s.referencedSchemaName);a&&s.columns.forEach((l,c)=>{let u=s.referencedColumns[c];r.push({id:`${i.name}-${a.name}-${l}-${u}`,source:i.id,target:a.id,sourceHandle:`right-${l}`,targetHandle:`left-${u}`,markerEnd:{type:st.ArrowClosed},data:{name:s.name,id:s.id,columns:[l],referencedSchemaName:s.referencedSchemaName,referencedTableName:s.referencedTableName,referencedColumns:[u],onDeleteAction:s.onDeleteAction,onUpdateAction:s.onUpdateAction},type:i.id===a.id?Ge.SmoothStep:void 0})})}return{nodes:o,edges:r}},extractSchemaModel:(e,t)=>{let n=e.map(o=>({...o.data,foreignKeys:[]}));return t.forEach(o=>{let r=e.find(c=>c.id===o.source),i=e.find(c=>c.id===o.target);if(!r||!i||!o.data){console.warn(`Edge ${o.id} references non-existent nodes or has no data`);return}let s={id:o.data.id,name:o.data.name,columns:[...o.data.columns],referencedSchemaName:o.data.referencedSchemaName,referencedTableName:o.data.referencedTableName,referencedColumns:[...o.data.referencedColumns],onDeleteAction:o.data.onDeleteAction,onUpdateAction:o.data.onUpdateAction},a=n.find(c=>c.id===o.source);if(!a){console.warn(`Source table ${o.source} not found`);return}let l=a.foreignKeys.find(c=>c.id===s.id);l?(l.columns.push(s.columns[0]),l.referencedColumns.push(s.referencedColumns[0])):a.foreignKeys.push(s)}),{tables:n}}};var Ei=class{listeners={};on(t,n){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(n)}off(t,n){this.listeners[t]=this.listeners[t]?.filter(o=>o!==n)}emit(t,...n){this.listeners[t]?.forEach(o=>o(...n))}once(t,n){let o=(...r)=>{this.off(t,o),n(...r)};this.on(t,o)}};var wC=new Ei,se=wC;var Ci=class{undoStack=[];redoStack=[];maxSize;currentState=null;constructor(t=100){this.maxSize=t}getCurrentState(){return this.currentState}setInitialState(t){this.currentState=t,this.clearHistory()}pushState(t,n){let o=this.currentState;JSON.stringify(o)!==JSON.stringify(t)&&(this.undoStack.push({undo:n||(()=>o),redo:()=>t}),this.currentState=t,this.redoStack=[],this.undoStack.length>this.maxSize&&this.undoStack.shift())}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}undo(){if(!this.canUndo())return null;let t=this.undoStack.pop(),n=t.undo(),o=this.currentState;return this.redoStack.push({undo:()=>o,redo:t.redo}),this.currentState=n,n}redo(){if(!this.canRedo())return null;let n=this.redoStack.pop().redo(),o=this.currentState;return this.undoStack.push({undo:()=>o,redo:()=>n}),this.currentState=n,n}clearHistory(){this.undoStack=[],this.redoStack=[]}getStackSizes(){return{undoSize:this.undoStack.length,redoSize:this.redoStack.length}}};var mm=X(ie()),ge=(0,bt.createContext)(void 0),We=new Ci,pm=({children:e})=>{let t=Ul(),{state:n,extensionRpc:o,themeKind:r}=t,[i,s]=(0,bt.useState)([]),[a,l]=(0,bt.useState)([]),c=je(),[u,d]=(0,bt.useState)(!1),[f,h]=(0,bt.useState)(""),[p,g]=(0,bt.useState)(!0),[w,m]=(0,bt.useState)(!1);(0,bt.useEffect)(()=>{let z=()=>{setTimeout(()=>{let H=c.toObject();We.pushState(H),se.emit("updateUndoRedoState",We.canUndo(),We.canRedo())},100)};se.on("pushState",z);let W=()=>{if(!We.canUndo())return;let H=We.undo();H&&(c.setNodes(H.nodes),c.setEdges(H.edges),se.emit("updateUndoRedoState",We.canUndo(),We.canRedo()))};se.on("undo",W);let P=()=>{if(!We.canRedo())return;let H=We.redo();H&&(c.setNodes(H.nodes),c.setEdges(H.edges),se.emit("updateUndoRedoState",We.canUndo(),We.canRedo()))};return se.on("redo",P),()=>{se.off("pushState",z),se.off("undo",W),se.off("redo",P)}},[]);let x=async()=>{let z=await o.sendRequest(he.InitializeSchemaDesignerRequest.type),{nodes:W,edges:P}=ye.generateSchemaDesignerFlowComponents(z.schema);return s(z.dataTypes),l(z.schemaNames),d(!0),setTimeout(()=>{We.setInitialState(c.toObject())}),{nodes:W,edges:P}},y=async()=>{let z=ye.extractSchemaModel(c.getNodes(),c.getEdges());return(await o.sendRequest(he.GetDefinitionRequest.type,{updatedSchema:z})).script},b=z=>{o.sendNotification(he.ExportToFileNotification.type,z)},C=async()=>{let z=ye.extractSchemaModel(c.getNodes(),c.getEdges());return z?await o.sendRequest(he.GetReportWebviewRequest.type,{updatedSchema:z}):void 0},E=z=>{o.sendNotification(he.CopyToClipboardNotification.type,{text:z})},_=()=>{o.sendNotification(he.OpenInEditorNotification.type)},I=()=>{o.sendNotification(he.OpenInEditorWithConnectionNotification.type)},R=()=>ye.extractSchemaModel(c.getNodes(),c.getEdges()),O=async z=>{let W=c.getNodes(),P=c.getEdges(),H=ye.extractSchemaModel(W,P);H.tables.push(z);let V=ye.generateSchemaDesignerFlowComponents(H),K=V.nodes.find(Y=>Y.id===z.id);if(!K)return console.error("Node with position not found for table:",z),!1;let $=V.edges.filter(Y=>Y.source===z.id||Y.target===z.id),G=W.filter(Y=>Y.hidden!==!0);if(G.length===0)K.position={x:100,y:100};else{let Y=G.filter(oe=>oe.hidden!==!0).reduce((oe,le)=>{let j=le.position.y+ye.getTableHeight(le.data),ee=oe.position.y+ye.getTableHeight(oe.data);return j>ee?le:oe});K.position={x:Y.position.x,y:Y.position.y+ye.getTableHeight(Y.data)+50}}return K?(W.push(K),P.push(...$),c.setNodes(W),c.setEdges(P),requestAnimationFrame(async()=>{S(K.id,!0)}),se.emit("getScript"),!0):!1},q=async z=>{let W=c.getNodes(),P=c.getEdges(),H=W.find(V=>V.id===z.id);return H?(P.forEach(V=>{V?.data?.referencedSchemaName===H?.data?.schema&&V?.data?.referencedTableName===H?.data?.name&&(V.data.referencedSchemaName=z.schema,V.data.referencedTableName=z.name)}),H.data=z,P=P.filter(V=>V.source!==z.id),z.foreignKeys.forEach(V=>{let K=W.find($=>$.data.schema===V.referencedSchemaName&&$.data.name===V.referencedTableName);K&&V.columns.forEach(($,G)=>{let Y=V.referencedColumns[G];P.push({id:V.id,source:z.id,target:K.id,sourceHandle:`right-${$}`,targetHandle:`left-${Y}`,markerEnd:{type:st.ArrowClosed},data:{...V,referencedColumns:[Y],columns:[$]}})})}),c.setNodes(W),c.setEdges(P),requestAnimationFrame(()=>{S(z.id,!0)}),!0):!1},L=async z=>{let W=c.getNode(z.id);return W?(c.deleteElements({nodes:[W]}),se.emit("pushState"),!0):!1},U=z=>{let W=R(),P=W.tables.find(H=>H.id===z);if(P)return P.foreignKeys=pe.extractForeignKeysFromEdges(c.getEdges(),z,W),P},v=()=>{let z=c.getNodes().filter(W=>W.selected);if(z.length>0)c.deleteElements({nodes:z});else{let W=c.getEdges().filter(P=>P.selected);c.deleteElements({nodes:[],edges:W})}},N=z=>{c.getNodes().forEach(W=>{c.updateNode(W.id,{selected:z.includes(W.id)})})},S=(z,W=!1)=>{let P=c.getNode(z);P&&c.setCenter(P.position.x+ye.getTableWidth()/2,P.position.y+ye.getTableHeight(P.data)/2,{zoom:W?1:c.getZoom(),duration:500})},k=async()=>{let z=ye.extractSchemaModel(c.getNodes(),c.getEdges());return await o.sendRequest(he.PublishSessionRequest.type,{schema:z})},A=()=>{o.sendNotification(he.CloseSchemaDesignerNotification.type)},D=()=>{We.clearHistory(),se.emit("updateUndoRedoState",We.canUndo(),We.canRedo())};function F(){setTimeout(async()=>{await c.fitView({nodes:c.getNodes().filter(z=>z.hidden!==!0)})},10)}return(0,mm.jsx)(ge.Provider,{value:{...Kl(t),extensionRpc:o,state:n,themeKind:r,schemaNames:a,datatypes:i,findTableText:f,setFindTableText:h,getDefinition:y,initializeSchemaDesigner:x,saveAsFile:b,getReport:C,openInEditor:_,openInEditorWithConnection:I,copyToClipboard:E,extractSchema:R,getTableWithForeignKeys:U,updateTable:q,addTable:O,deleteTable:L,deleteSelectedNodes:v,updateSelectedNodes:N,setCenter:S,publishSession:k,isInitialized:u,closeDesigner:A,resetUndoRedoState:D,resetView:F,renderOnlyVisibleTables:p,setRenderOnlyVisibleTables:g,isExporting:w,setIsExporting:m},children:e})};var Ai=X(me());var ha=X(ie());function gm(){return(0,ha.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,ha.jsx)(fl,{}),title:T.schemaDesigner.definition,onClick:()=>{se.emit("openCodeDrawer")},children:T.schemaDesigner.definition})}function ym(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;let n=document.implementation.createHTMLDocument(),o=n.createElement("base"),r=n.createElement("a");return n.head.appendChild(o),n.body.appendChild(r),t&&(o.href=t),r.href=e,r.href}var bm=(()=>{let e=0,t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function et(e){let t=[];for(let n=0,o=e.length;n<o;n++)t.push(e[n]);return t}function _i(e,t){let o=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return o?parseFloat(o.replace("px","")):0}function vC(e){let t=_i(e,"border-left-width"),n=_i(e,"border-right-width");return e.clientWidth+t+n}function SC(e){let t=_i(e,"border-top-width"),n=_i(e,"border-bottom-width");return e.clientHeight+t+n}function pa(e,t={}){let n=t.width||vC(e),o=t.height||SC(e);return{width:n,height:o}}function xm(){let e,t;try{t=process}catch{}let n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}var Je=16384;function wm(e){(e.width>Je||e.height>Je)&&(e.width>Je&&e.height>Je?e.width>e.height?(e.height*=Je/e.width,e.width=Je):(e.width*=Je/e.height,e.height=Je):e.width>Je?(e.height*=Je/e.width,e.width=Je):(e.width*=Je/e.height,e.height=Je))}function Qn(e){return new Promise((t,n)=>{let o=new Image;o.decode=()=>t(o),o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.decoding="async",o.src=e})}async function EC(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function vm(e,t,n){let o="http://www.w3.org/2000/svg",r=document.createElementNS(o,"svg"),i=document.createElementNS(o,"foreignObject");return r.setAttribute("width",`${t}`),r.setAttribute("height",`${n}`),r.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),r.appendChild(i),i.appendChild(e),EC(r)}var Be=(e,t)=>{if(e instanceof t)return!0;let n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||Be(n,t)};function CC(e){let t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function _C(e){return et(e).map(t=>{let n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return`${t}: ${n}${o?" !important":""};`}).join(" ")}function NC(e,t,n){let o=`.${e}:${t}`,r=n.cssText?CC(n):_C(n);return document.createTextNode(`${o}{${r}}`)}function Sm(e,t,n){let o=window.getComputedStyle(e,n),r=o.getPropertyValue("content");if(r===""||r==="none")return;let i=bm();try{t.className=`${t.className} ${i}`}catch{return}let s=document.createElement("style");s.appendChild(NC(i,n,o)),t.appendChild(s)}function Em(e,t){Sm(e,t,":before"),Sm(e,t,":after")}var Cm="application/font-woff",_m="image/jpeg",DC={woff:Cm,woff2:Cm,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:_m,jpeg:_m,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function kC(e){let t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Jn(e){let t=kC(e).toLowerCase();return DC[t]||""}function TC(e){return e.split(/,/)[1]}function Ko(e){return e.search(/^(data:)/)!==-1}function ga(e,t){return`data:${t};base64,${e}`}async function ya(e,t,n){let o=await fetch(e,t);if(o.status===404)throw new Error(`Resource "${o.url}" not found`);let r=await o.blob();return new Promise((i,s)=>{let a=new FileReader;a.onerror=s,a.onloadend=()=>{try{i(n({res:o,result:a.result}))}catch(l){s(l)}},a.readAsDataURL(r)})}var ma={};function IC(e,t,n){let o=e.replace(/\?.*/,"");return n&&(o=e),/ttf|otf|eot|woff2?/i.test(o)&&(o=o.replace(/.*\//,"")),t?`[${t}]${o}`:o}async function eo(e,t,n){let o=IC(e,t,n.includeQueryParams);if(ma[o]!=null)return ma[o];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let r;try{let i=await ya(e,n.fetchRequestInit,({res:s,result:a})=>(t||(t=s.headers.get("Content-Type")||""),TC(a)));r=ga(i,t)}catch(i){r=n.imagePlaceholder||"";let s=`Failed to fetch resource: ${e}`;i&&(s=typeof i=="string"?i:i.message),s&&console.warn(s)}return ma[o]=r,r}async function PC(e){let t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Qn(t)}async function RC(e,t){if(e.currentSrc){let i=document.createElement("canvas"),s=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,s?.drawImage(e,0,0,i.width,i.height);let a=i.toDataURL();return Qn(a)}let n=e.poster,o=Jn(n),r=await eo(n,o,t);return Qn(r)}async function MC(e){var t;try{if(!((t=e?.contentDocument)===null||t===void 0)&&t.body)return await qo(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function zC(e,t){return Be(e,HTMLCanvasElement)?PC(e):Be(e,HTMLVideoElement)?RC(e,t):Be(e,HTMLIFrameElement)?MC(e):e.cloneNode(!1)}var OC=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function AC(e,t,n){var o,r;let i=[];return OC(e)&&e.assignedNodes?i=et(e.assignedNodes()):Be(e,HTMLIFrameElement)&&(!((o=e.contentDocument)===null||o===void 0)&&o.body)?i=et(e.contentDocument.body.childNodes):i=et(((r=e.shadowRoot)!==null&&r!==void 0?r:e).childNodes),i.length===0||Be(e,HTMLVideoElement)||await i.reduce((s,a)=>s.then(()=>qo(a,n)).then(l=>{l&&t.appendChild(l)}),Promise.resolve()),t}function LC(e,t){let n=t.style;if(!n)return;let o=window.getComputedStyle(e);o.cssText?(n.cssText=o.cssText,n.transformOrigin=o.transformOrigin):et(o).forEach(r=>{let i=o.getPropertyValue(r);r==="font-size"&&i.endsWith("px")&&(i=`${Math.floor(parseFloat(i.substring(0,i.length-2)))-.1}px`),Be(e,HTMLIFrameElement)&&r==="display"&&i==="inline"&&(i="block"),r==="d"&&t.getAttribute("d")&&(i=`path(${t.getAttribute("d")})`),n.setProperty(r,i,o.getPropertyPriority(r))})}function FC(e,t){Be(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),Be(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function $C(e,t){if(Be(e,HTMLSelectElement)){let n=t,o=Array.from(n.children).find(r=>e.value===r.getAttribute("value"));o&&o.setAttribute("selected","")}}function BC(e,t){return Be(t,Element)&&(LC(e,t),Em(e,t),FC(e,t),$C(e,t)),t}async function HC(e,t){let n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;let o={};for(let i=0;i<n.length;i++){let a=n[i].getAttribute("xlink:href");if(a){let l=e.querySelector(a),c=document.querySelector(a);!l&&c&&!o[a]&&(o[a]=await qo(c,t,!0))}}let r=Object.values(o);if(r.length){let i="http://www.w3.org/1999/xhtml",s=document.createElementNS(i,"svg");s.setAttribute("xmlns",i),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";let a=document.createElementNS(i,"defs");s.appendChild(a);for(let l=0;l<r.length;l++)a.appendChild(r[l]);e.appendChild(s)}return e}async function qo(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(o=>zC(o,t)).then(o=>AC(e,o,t)).then(o=>BC(e,o)).then(o=>HC(o,t))}var Nm=/url\((['"]?)([^'"]+?)\1\)/g,VC=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,WC=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function KC(e){let t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function qC(e){let t=[];return e.replace(Nm,(n,o,r)=>(t.push(r),n)),t.filter(n=>!Ko(n))}async function UC(e,t,n,o,r){try{let i=n?ym(t,n):t,s=Jn(t),a;if(r){let l=await r(i);a=ga(l,s)}else a=await eo(i,s,o);return e.replace(KC(t),`$1${a}$3`)}catch{}return e}function GC(e,{preferredFontFormat:t}){return t?e.replace(WC,n=>{for(;;){let[o,,r]=VC.exec(n)||[];if(!r)return"";if(r===t)return`src: ${o};`}}):e}function ba(e){return e.search(Nm)!==-1}async function Ni(e,t,n){if(!ba(e))return e;let o=GC(e,n);return qC(o).reduce((i,s)=>i.then(a=>UC(a,s,t,n)),Promise.resolve(o))}async function Di(e,t,n){var o;let r=(o=t.style)===null||o===void 0?void 0:o.getPropertyValue(e);if(r){let i=await Ni(r,null,n);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function YC(e,t){await Di("background",e,t)||await Di("background-image",e,t),await Di("mask",e,t)||await Di("mask-image",e,t)}async function XC(e,t){let n=Be(e,HTMLImageElement);if(!(n&&!Ko(e.src))&&!(Be(e,SVGImageElement)&&!Ko(e.href.baseVal)))return;let o=n?e.src:e.href.baseVal,r=await eo(o,Jn(o),t);await new Promise((i,s)=>{e.onload=i,e.onerror=s;let a=e;a.decode&&(a.decode=i),a.loading==="lazy"&&(a.loading="eager"),n?(e.srcset="",e.src=r):e.href.baseVal=r})}async function ZC(e,t){let o=et(e.childNodes).map(r=>xa(r,t));await Promise.all(o).then(()=>e)}async function xa(e,t){Be(e,Element)&&(await YC(e,t),await XC(e,t),await ZC(e,t))}function Dm(e,t){let{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);let o=t.style;return o!=null&&Object.keys(o).forEach(r=>{n[r]=o[r]}),e}var km={};async function Tm(e){let t=km[e];if(t!=null)return t;let o=await(await fetch(e)).text();return t={url:e,cssText:o},km[e]=t,t}async function Im(e,t){let n=e.cssText,o=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async s=>{let a=s.replace(o,"$1");return a.startsWith("https://")||(a=new URL(a,e.url).href),ya(a,t.fetchRequestInit,({result:l})=>(n=n.replace(s,`url(${l})`),[s,l]))});return Promise.all(i).then(()=>n)}function Pm(e){if(e==null)return[];let t=[],n=/(\/\*[\s\S]*?\*\/)/gi,o=e.replace(n,""),r=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){let l=r.exec(o);if(l===null)break;t.push(l[0])}o=o.replace(r,"");let i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(s,"gi");for(;;){let l=i.exec(o);if(l===null){if(l=a.exec(o),l===null)break;i.lastIndex=a.lastIndex}else a.lastIndex=i.lastIndex;t.push(l[0])}return t}async function jC(e,t){let n=[],o=[];return e.forEach(r=>{if("cssRules"in r)try{et(r.cssRules||[]).forEach((i,s)=>{if(i.type===CSSRule.IMPORT_RULE){let a=s+1,l=i.href,c=Tm(l).then(u=>Im(u,t)).then(u=>Pm(u).forEach(d=>{try{r.insertRule(d,d.startsWith("@import")?a+=1:r.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:d,error:f})}})).catch(u=>{console.error("Error loading remote css",u.toString())});o.push(c)}})}catch(i){let s=e.find(a=>a.href==null)||document.styleSheets[0];r.href!=null&&o.push(Tm(r.href).then(a=>Im(a,t)).then(a=>Pm(a).forEach(l=>{s.insertRule(l,r.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",i)}}),Promise.all(o).then(()=>(e.forEach(r=>{if("cssRules"in r)try{et(r.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${r.href}`,i)}}),n))}function QC(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>ba(t.style.getPropertyValue("src")))}async function JC(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");let n=et(e.ownerDocument.styleSheets),o=await jC(n,t);return QC(o)}async function Rm(e,t){let n=await JC(e,t);return(await Promise.all(n.map(r=>{let i=r.parentStyleSheet?r.parentStyleSheet.href:null;return Ni(r.cssText,i,t)}))).join(`
`)}async function Mm(e,t){let n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Rm(e,t);if(n){let o=document.createElement("style"),r=document.createTextNode(n);o.appendChild(r),e.firstChild?e.insertBefore(o,e.firstChild):e.appendChild(o)}}async function wa(e,t={}){let{width:n,height:o}=pa(e,t),r=await qo(e,t,!0);return await Mm(r,t),await xa(r,t),Dm(r,t),await vm(r,n,o)}async function zm(e,t={}){let{width:n,height:o}=pa(e,t),r=await wa(e,t),i=await Qn(r),s=document.createElement("canvas"),a=s.getContext("2d"),l=t.pixelRatio||xm(),c=t.canvasWidth||n,u=t.canvasHeight||o;return s.width=c*l,s.height=u*l,t.skipAutoScale||wm(s),s.style.width=`${c}`,s.style.height=`${u}`,t.backgroundColor&&(a.fillStyle=t.backgroundColor,a.fillRect(0,0,s.width,s.height)),a.drawImage(i,0,0,s.width,s.height),s}async function Om(e,t={}){return(await zm(e,t)).toDataURL()}async function Am(e,t={}){return(await zm(e,t)).toDataURL("image/jpeg",t.quality||1)}var Lm=X(me()),xt=X(ie());function Fm(){let{getNodes:e}=je(),t=(0,Lm.useContext)(ge);async function n(o){let r=document.querySelector(".react-flow__viewport"),s=getComputedStyle(r).getPropertyValue("--vscode-editor-background");if(!t)return;t.setRenderOnlyVisibleTables(!1),t.setIsExporting(!0),await new Promise(d=>setTimeout(d,100));let a=Mo(e().filter(d=>!d.hidden)),l=yn(a,a.width,a.height,.5,2,50),c=a.width+100,u=a.height+100;switch(o){case"png":Om(r,{width:c,height:u,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${u}px`}}).then(d=>{t.saveAsFile({format:o,fileContents:d,width:c,height:u})});break;case"jpeg":Am(r,{width:c,height:u,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${u}px`}}).then(d=>{t.saveAsFile({format:o,fileContents:d,width:c,height:u})});break;case"svg":wa(r,{width:c,height:u,backgroundColor:s,style:{transform:`translate(${l.x}px, ${l.y}px) scale(${l.zoom})`,width:`${c}px`,height:`${u}px`}}).then(d=>{t.saveAsFile({format:o,fileContents:d,width:c,height:u})});break}t.setRenderOnlyVisibleTables(!0),t.setIsExporting(!1)}return(0,xt.jsxs)(Dn,{children:[(0,xt.jsx)(Tn,{disableButtonEnhancement:!0,children:(0,xt.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,xt.jsx)(al,{}),title:T.schemaDesigner.export,children:T.schemaDesigner.export})}),(0,xt.jsx)(kn,{children:(0,xt.jsxs)(sr,{children:[(0,xt.jsx)(nn,{onClick:()=>n("svg"),children:T.schemaDesigner.svg}),(0,xt.jsx)(nn,{onClick:()=>n("png"),children:T.schemaDesigner.png}),(0,xt.jsx)(nn,{onClick:()=>n("jpeg"),children:T.schemaDesigner.jpeg})]})})]})}var kt=X(me());var Ce=X(ie());function $m(){let e=(0,kt.useContext)(ge),t=je();if(!e)return;let[n,o]=(0,kt.useState)(""),[r,i]=(0,kt.useState)([]),[s,a]=(0,kt.useState)(!1),[l,c]=(0,kt.useState)(!1);function u(){let p=t.getNodes();if(p.filter(w=>w.hidden!==!0).length===p.length)i([]);else{let w=p.filter(m=>!m.hidden&&m.data.dimmed!==!0).map(m=>`${m.data.schema}.${m.data.name}`);i(w)}o("")}function d(p){if(!l||p.length===0)return[];let g=t.getEdges(),w=t.getNodes(),m=new Set;return g.forEach(x=>{let y=w.find(C=>C.id===x.source),b=w.find(C=>C.id===x.target);if(y&&b){let C=`${y.data.schema}.${y.data.name}`,E=`${b.data.schema}.${b.data.name}`;p.includes(C)&&m.add(E),p.includes(E)&&m.add(C)}}),Array.from(m)}(0,kt.useEffect)(()=>{let p=t.getNodes(),g=t.getEdges();if(r.length===0)p.forEach(w=>{t.updateNode(w.id,{...w,hidden:!1,style:{...w.style,opacity:1},data:{...w.data,dimmed:!1}})}),g.forEach(w=>{t.updateEdge(w.id,{...w,hidden:!1})});else{let w=d(r),m=[...r,...w];p.forEach(x=>{let y=`${x.data.schema}.${x.data.name}`;if(m.includes(y)){let b=r.includes(y),C=w.includes(y),E=!b&&C;t.updateNode(x.id,{...x,hidden:!1,data:{...x.data,dimmed:E}})}else t.updateNode(x.id,{...x,hidden:!0,data:{...x.data,dimmed:!1}})}),g.forEach(x=>{let y=t.getNode(x.source),b=t.getNode(x.target);y&&b&&m.includes(`${y.data.schema}.${y.data.name}`)&&m.includes(`${b.data.schema}.${b.data.name}`)?t.updateEdge(x.id,{...x,hidden:!1}):t.updateEdge(x.id,{...x,hidden:!0})})}},[r,l]),(0,kt.useEffect)(()=>{se.on("getScript",()=>requestAnimationFrame(()=>{u()}))},[]);let f=(p,g)=>{if(!g||g.trim()==="")return(0,Ce.jsx)("span",{children:p});let w=new RegExp(`(${g.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),m=p.split(w);return(0,Ce.jsx)(Ce.Fragment,{children:m.map((x,y)=>x.toLowerCase()===g.toLowerCase()?(0,Ce.jsx)("span",{style:{backgroundColor:"var(--vscode-editor-findMatchBackground)",color:"var(--vscode-editor-background)",padding:"0 2px",borderRadius:"3px"},children:x},y):(0,Ce.jsx)("span",{children:x},y))})};function h(){let g=t.getNodes().map(m=>`${m.data.schema}.${m.data.name}`);g.sort();let w=[];return g.forEach(m=>{let x=(0,Ce.jsx)(Vl,{style:{lineHeight:"30px",alignItems:"center",padding:"2px",overflow:"hidden"},value:m,children:(0,Ce.jsx)(ve,{title:m,style:{overflow:"hidden",textOverflow:"ellipsis"},children:f(m,n)})},m);n?m.toLowerCase().includes(n.toLowerCase())&&w.push(x):w.push(x)}),w}return(0,Ce.jsxs)(Dn,{open:s,onOpenChange:(p,g)=>a(g.open),children:[(0,Ce.jsx)(Tn,{children:(0,Ce.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,Ce.jsx)(xl,{}),onClick:()=>{u(),a(!s)},children:T.schemaDesigner.filter(r.length)})}),(0,Ce.jsxs)(kn,{style:{width:"250px",padding:"10px"},onKeyDown:p=>{p.key==="Escape"&&a(!1)},children:[(0,Ce.jsx)(yr,{size:"small",placeholder:T.schemaDesigner.searchTables,style:{marginBottom:"10px",width:"100%"},value:n,onChange:(p,g)=>{o(g.value)},onAbort:()=>{o("")}}),(0,Ce.jsx)(Hl,{selectionMode:"multiselect",style:{maxHeight:"150px",overflowY:"auto",padding:"5px"},selectedItems:r,onSelectionChange:(p,g)=>{i(g.selectedItems),e&&e.resetView()},children:h()}),(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"5px",justifyContent:"flex-end",padding:"5px",borderTop:"1px solid var(--vscode-editorWidget-border)",borderBottom:"1px solid var(--vscode-editorWidget-border)"},children:(0,Ce.jsx)(ne,{size:"small",style:{},onClick:async()=>{i([]),e&&e.resetView()},appearance:"subtle",icon:(0,Ce.jsx)(Qa,{}),children:T.schemaDesigner.clearFilter})}),(0,Ce.jsx)("div",{style:{display:"flex",flexDirection:"row",gap:"5px",alignItems:"center",paddingTop:"5px"},children:(0,Ce.jsx)(Nl,{checked:l,label:T.schemaDesigner.showTableRelationships,onChange:()=>c(!l)})})]})]})}var Bm=X(me());var va=X(ie());function Hm(){let e=(0,Bm.useContext)(ge);if(e)return(0,va.jsx)(ne,{appearance:"subtle",icon:(0,va.jsx)(Sl,{}),onClick:()=>{se.emit("newTable",e.extractSchema())},size:"small",title:T.schemaDesigner.addTable,children:T.schemaDesigner.addTable})}var to=X(me());var ce=X(ie());var t_=ze({errorSection:{marginBottom:"15px",lineHeight:1.5},sectionNumber:{fontWeight:"bold",marginRight:"5px"}});function Vm(){let e=t_(),t=(0,to.useContext)(ge),[n,o]=(0,to.useState)(!1),[r,i]=(0,to.useState)(!1);if(!t)return;let[s,a]=(0,to.useState)({report:void 0,reportError:void 0,isConfirmationChecked:!1,reportTab:"report",publishError:void 0,currentStage:"notStarted"}),l=()=>(0,ce.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,ce.jsx)(pl,{}),title:T.schemaDesigner.publishChanges,disabled:r,onClick:async()=>{a({...s,currentStage:"reportLoading",reportError:void 0,isConfirmationChecked:!1}),i(!0);let m=await t.getReport();m?.error?a({...s,currentStage:"reportError",reportError:m.error}):m?.report.hasSchemaChanged?a({...s,currentStage:"reportSuccessWithChanges",reportError:void 0,report:m.report,isConfirmationChecked:!1}):a({...s,currentStage:"reportSuccessNoChanges",reportError:void 0,report:m?.report}),o(!0),i(!1)},children:T.schemaDesigner.publishChanges}),c=m=>(0,ce.jsx)(ar,{size:"large",style:{marginBottom:"10px",marginTop:"10px"},label:m,labelPosition:"below"}),u=m=>(0,ce.jsxs)("div",{className:"error-container",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ce.jsx)(el,{style:{marginRight:"10px",width:"50px",height:"50px"}}),(0,ce.jsx)("div",{className:"error-body",children:(y=>{let b=y.split(/(\d+\.\s)/g),C=[];for(let E=0;E<b.length;E++)if(b[E].match(/^\d+\.\s$/)){let _=b[E],I=b[E+1]||"";C.push((0,ce.jsxs)("div",{className:e.errorSection,children:[(0,ce.jsx)("strong",{className:e.sectionNumber,children:_}),(0,ce.jsx)("span",{children:I})]},E)),E++}else b[E].trim()&&C.push((0,ce.jsx)("div",{className:e.errorSection,children:(0,ce.jsx)("span",{children:b[E]})},E));return C})(m)})]}),d=()=>(0,ce.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ce.jsx)(Xa,{style:{marginRight:"10px",width:"50px",height:"50px"}}),T.schemaDesigner.changesPublishedSuccessfully]}),f=()=>(0,ce.jsx)(ce.Fragment,{children:(0,ce.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[s.report?.dacReport?.possibleDataLoss&&(0,ce.jsx)(Ln,{intent:"warning",style:{marginBottom:"10px",marginTop:"10px"},children:T.schemaDesigner.possibleDataLoss}),s.report?.dacReport?.hasWarnings&&(0,ce.jsx)(Ln,{intent:"warning",style:{marginBottom:"10px",marginTop:"10px"},children:T.schemaDesigner.hasWarnings}),(0,ce.jsx)("div",{style:{width:"100%",height:"500px",maxHeight:"100%",overflow:"auto"},children:(0,ce.jsx)(Gl,{children:s?.report?.dacReport?.report??""})}),(0,ce.jsx)(lo,{label:T.tableDesigner.designerPreviewConfirmation,style:{margin:"5px"},required:!0,checked:s.isConfirmationChecked,onChange:(m,x)=>{a({...s,isConfirmationChecked:x.checked})},autoFocus:!0,onFocus:m=>{m.target.parentElement&&(m.target.parentElement.style.outlineStyle="solid",m.target.parentElement.style.outlineColor="var(--vscode-focusBorder)")},onBlur:m=>{m.target.parentElement&&(m.target.parentElement.style.outline="none",m.target.parentElement.style.outlineColor="")}})]})}),h=()=>{if(s.currentStage==="reportLoading")return c(T.schemaDesigner.generatingReport);if(s.currentStage==="reportError")return u(s.reportError??"");if(s.currentStage==="reportSuccessNoChanges")return(0,ce.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"200px"},children:[(0,ce.jsx)(Ya,{style:{marginRight:"10px",width:"50px",height:"50px"}}),T.schemaDesigner.noChangesDetected]});if(s.currentStage==="reportSuccessWithChanges")return f();if(s.currentStage==="publishLoading")return c(T.schemaDesigner.publishingChanges);if(s.currentStage==="publishError")return u(s.publishError??"");if(s.currentStage==="publishSuccess")return d()},p=()=>s.currentStage==="reportSuccessWithChanges",g=()=>s.currentStage==="reportSuccessWithChanges"&&s.isConfirmationChecked,w=()=>(0,ce.jsxs)(ce.Fragment,{children:[p()&&(0,ce.jsxs)(ce.Fragment,{children:[(0,ce.jsx)(ne,{appearance:"primary",disabled:!g(),onClick:async()=>{a({...s,currentStage:"publishLoading",publishError:void 0});let m=await t.publishSession();m.error?a({...s,currentStage:"publishError",publishError:m.error}):a({...s,currentStage:"publishSuccess"})},children:T.schemaDesigner.publish}),(0,ce.jsx)(ne,{appearance:"secondary",disabled:!g(),onClick:()=>{t.openInEditorWithConnection()},children:T.schemaDesigner.openPublishScript})]}),s.currentStage==="publishSuccess"&&(0,ce.jsx)(vt,{disableButtonEnhancement:!0,children:(0,ce.jsx)(ne,{appearance:"secondary",onClick:()=>{a({...s,currentStage:"notStarted"}),t.resetUndoRedoState()},children:T.schemaDesigner.continueEditing})}),s.currentStage!=="publishLoading"&&(0,ce.jsx)(vt,{disableButtonEnhancement:!0,children:(0,ce.jsx)(ne,{appearance:"secondary",onClick:()=>{a({...s,isConfirmationChecked:!1}),s.currentStage==="publishSuccess"&&t.closeDesigner()},children:T.schemaDesigner.Close})})]});return(0,ce.jsxs)(In,{open:n,onOpenChange:(m,x)=>o(x.open),children:[l(),(0,ce.jsx)(zn,{style:{width:"100%",maxWidth:"800px"},children:(0,ce.jsxs)(Rn,{children:[(0,ce.jsx)(Mn,{children:T.schemaDesigner.publishChanges}),(0,ce.jsx)(On,{children:h()}),(0,ce.jsx)(Pn,{children:w()})]})})]})}var Wm=X(me());var Ke=X(ie());function Km(){let e=(0,Wm.useContext)(ge),t=je(),n=()=>{se.emit("pushState");let o=t.getNodes(),r=t.getEdges(),i=ye.generatePositions(o,r);t.setNodes(i.nodes),t.setEdges(i.edges),e.resetView()};if(e)return(0,Ke.jsxs)(In,{children:[(0,Ke.jsx)(vt,{children:(0,Ke.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,Ke.jsx)(wl,{}),title:T.schemaDesigner.autoArrange,children:T.schemaDesigner.autoArrange})}),(0,Ke.jsx)(zn,{children:(0,Ke.jsxs)(Rn,{children:[(0,Ke.jsx)(Mn,{children:T.schemaDesigner.autoArrangeConfirmation}),(0,Ke.jsx)(On,{children:T.schemaDesigner.autoArrangeConfirmationContent}),(0,Ke.jsxs)(Pn,{children:[(0,Ke.jsx)(vt,{children:(0,Ke.jsx)(ne,{appearance:"primary",onClick:()=>n(),children:T.schemaDesigner.autoArrange})}),(0,Ke.jsx)(vt,{children:(0,Ke.jsx)(ne,{appearance:"secondary",onClick:()=>{},children:T.schemaDesigner.cancel})})]})]})})]})}var qm=X(me()),Sa=X(ie());function Um(){let e=(0,qm.useContext)(ge);return(0,Sa.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,Sa.jsx)(ml,{}),title:T.schemaDesigner.delete,onClick:()=>e.deleteSelectedNodes(),children:T.schemaDesigner.delete})}var Uo=X(me());var Lt=X(ie());function Gm(){let[e,t]=(0,Uo.useState)(!1),[n,o]=(0,Uo.useState)(!1);return(0,Uo.useEffect)(()=>{let r=(i,s)=>{t(i),o(s)};return se.on("updateUndoRedoState",r),()=>{se.off("updateUndoRedoState",r)}},[]),(0,Lt.jsxs)(Lt.Fragment,{children:[(0,Lt.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,Lt.jsx)(cl,{}),onClick:()=>{se.emit("undo")},disabled:!e,title:T.schemaDesigner.undo,children:T.schemaDesigner.undo}),(0,Lt.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,Lt.jsx)(ll,{}),onClick:()=>{se.emit("redo")},disabled:!n,title:T.schemaDesigner.redo,children:T.schemaDesigner.redo})]})}var Ye=X(ie());function Ym(){return(0,Ye.jsx)("div",{style:{width:"100%",height:"30px",padding:"5px 0px"},children:(0,Ye.jsxs)(lr,{size:"small",style:{width:"100%",overflow:"hidden",overflowX:"auto",gap:"3px",alignItems:"center"},children:[(0,Ye.jsx)(Vm,{}),(0,Ye.jsx)(gm,{}),(0,Ye.jsx)(Fm,{}),(0,Ye.jsx)(Yi,{}),(0,Ye.jsx)(Hm,{}),(0,Ye.jsx)(Gm,{}),(0,Ye.jsx)(Km,{}),(0,Ye.jsx)(Um,{}),(0,Ye.jsx)(Yi,{}),(0,Ye.jsx)($m,{})]})})}var tg=X(me());var Xm=X(me());var Go=X(ie()),n_=ze({editorFooter:{display:"flex",flexDirection:"row",gap:"10px",borderTop:"1px solid var(--vscode-badge-background)",padding:"10px"}});function Zm(){let e=(0,Xm.useContext)(ct);if(!e)return;let t=n_(),n=()=>{let o=0;for(let r in e.errors)e.errors[r]&&o++;return o};return(0,Go.jsxs)("div",{className:t.editorFooter,children:[(0,Go.jsx)(ne,{appearance:"primary",onClick:()=>{e.save(),se.emit("getScript")},disabled:n()>0,children:e.isNewTable?T.schemaDesigner.add:T.schemaDesigner.save}),(0,Go.jsx)(ne,{appearance:"secondary",onClick:()=>{e.cancel()},children:T.schemaDesigner.cancel})]})}var qe=X(me());var Q=X(ie()),Ea=X(me()),jm=ze({panel:{height:"100%",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",padding:"5px",gap:"10px"},scrollContainer:{flex:"1",overflowY:"auto",overflowX:"hidden"},newColumnButton:{width:"fit-content"},advancedOptionsContainer:{display:"flex",flexDirection:"column",gap:"5px"},fullWidthDivider:{width:"100vh"},columnInput:{minWidth:"150px",maxWidth:"150px",textOverflow:"ellipsis"}}),o_=({columns:e,updateColumn:t,deleteColumn:n,columnNameInputRefs:o,datatypes:r,isColumnDeletable:i})=>{let s=jm(),a=ir({axis:"grid"}),l=(0,qe.useContext)(ct),c=[ht({columnId:"name",renderHeaderCell:()=>(0,Q.jsx)(ve,{children:T.schemaDesigner.name})}),ht({columnId:"type",renderHeaderCell:()=>(0,Q.jsx)(ve,{children:T.schemaDesigner.dataType})}),ht({columnId:"primaryKey",renderHeaderCell:()=>(0,Q.jsx)(ve,{children:T.schemaDesigner.primaryKey})}),ht({columnId:"delete",renderHeaderCell:()=>(0,Q.jsx)(ve,{})}),ht({columnId:"menu",renderHeaderCell:()=>(0,Q.jsx)(ve,{})}),ht({columnId:"error",renderHeaderCell:()=>(0,Q.jsx)(Q.Fragment,{})})],[u]=(0,qe.useState)({error:{defaultWidth:18,minWidth:18,idealWidth:18},name:{defaultWidth:150,minWidth:150,idealWidth:150},type:{defaultWidth:150,minWidth:150,idealWidth:150},primaryKey:{defaultWidth:70,minWidth:70,idealWidth:70},delete:{defaultWidth:20,minWidth:20,idealWidth:20},menu:{defaultWidth:20,minWidth:20,idealWidth:20}}),[d]=(0,qe.useState)(c),{getRows:f,columnSizing_unstable:h,tableRef:p}=ur({columns:d,items:e},[cr({columnSizingOptions:u,autoFitColumns:!1,containerWidthOffset:20})]),g=(m,x)=>{let y=De.getAdvancedOptions(m);return(0,Q.jsx)("div",{className:s.advancedOptionsContainer,children:y.map(b=>{switch(b.type){case"checkbox":return(0,Q.jsx)(ot,{children:(0,Q.jsx)(lo,{size:"medium",checked:m[b.columnProperty],onChange:(C,E)=>{t(x,b.columnModifier(m,E.checked))},label:b.label})},b.label);case"input":return(0,Q.jsx)(ot,{label:{children:(0,Q.jsx)(gr,{size:"small",info:b.hint,children:b.label})},children:(0,Q.jsx)(tn,{size:"small",value:m[b.columnProperty]?.toString(),onChange:(C,E)=>{t(x,b.columnModifier(m,E.value))}})},b.label);case"input-number":return(0,Q.jsx)(ot,{label:{children:(0,Q.jsx)(gr,{size:"small",info:b.hint,children:b.label})},children:(0,Q.jsx)(tn,{size:"small",type:"number",value:m[b.columnProperty]?.toString(),onChange:(C,E)=>{t(x,b.columnModifier(m,parseInt(E.value)))}})},b.label);case"textarea":return(0,Q.jsx)(ot,{label:{children:(0,Q.jsx)(gr,{size:"small",info:b.hint,children:b.label})},children:(0,Q.jsx)(Tl,{size:"small",value:m[b.columnProperty],onChange:(C,E)=>{t(x,b.columnModifier(m,E.value))}})},b.label)}return(0,Q.jsx)(Q.Fragment,{})})})},w=(m,x,y)=>{switch(x){case"error":return(0,Q.jsx)(Q.Fragment,{children:l.errors[`columns_${m.id}`]&&(0,Q.jsxs)(Ki,{children:[(0,Q.jsx)(qi,{disableButtonEnhancement:!0,children:(0,Q.jsx)(ne,{icon:(0,Q.jsx)(tl,{style:{color:"var(--vscode-errorForeground)"},title:l.errors[m.name]}),appearance:"transparent"})}),(0,Q.jsx)(Wi,{tabIndex:-1,children:(0,Q.jsx)("div",{children:l.errors[`columns_${m.id}`]})})]})});case"name":return(0,Q.jsx)(tn,{size:"small",className:s.columnInput,ref:C=>{o.current&&(o.current[y]=C)},value:m.name,onChange:(C,E)=>{t(y,{...m,name:E.value})}});case"type":return(0,Q.jsx)(on,{placeholder:"Search Schema",options:r.map(C=>({displayName:C,value:C})),selectedOption:m.isComputed?{text:"Computed",value:"Computed"}:{text:m.dataType,value:m.dataType},onSelect:C=>{let E={...m,dataType:C.value,defaultValue:""};t(y,De.fillColumnDefaults(E))},style:{minWidth:"150px",maxWidth:"150px"},size:"small",disabled:m.isComputed});case"primaryKey":return(0,Q.jsx)(lo,{size:"medium",checked:m.isPrimaryKey,onChange:(C,E)=>{t(y,{...m,isPrimaryKey:E.checked,isNullable:E.checked?!1:m.isNullable})},disabled:m.isComputed});case"delete":return(0,Q.jsx)(ne,{size:"small",appearance:"subtle",disabled:!i(m),icon:(0,Q.jsx)(en,{}),onClick:()=>n(y)});case"menu":let b="schema-designer-menu-"+m.id;return(0,Q.jsxs)(Ki,{positioning:{position:"below"},children:[(0,Q.jsx)(qi,{disableButtonEnhancement:!0,children:(0,Q.jsx)(ne,{size:"small",appearance:"subtle",icon:(0,Q.jsx)(ol,{})})}),(0,Q.jsxs)(Wi,{"aria-labelledby":b,children:[(0,Q.jsx)("div",{children:(0,Q.jsx)("h3",{id:b,children:"Advanced options"})}),g(m,y)]})]});default:return(0,Q.jsx)(ve,{children:x})}};return(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsxs)(hr,{...a,as:"table",size:"extra-small",...h.getTableProps(),ref:p,children:[(0,Q.jsx)(pr,{children:(0,Q.jsx)(An,{children:c.map(m=>(0,Ea.createElement)(mr,{...h.getTableHeaderCellProps(m.columnId),key:m.columnId},m.renderHeaderCell()))})}),(0,Q.jsx)(fr,{children:f().map((m,x)=>(0,Q.jsx)(An,{children:d.map(y=>(0,Ea.createElement)(dr,{...h.getTableCellProps(y.columnId),key:y.columnId},w(e[x],y.columnId,x)))},x))})]})})},Qm=()=>{let e=jm(),t=(0,qe.useContext)(ct),n=(0,qe.useRef)([]),[o,r]=(0,qe.useState)(-1),i=(0,qe.useMemo)(()=>t.dataTypes,[t.dataTypes]),s=(0,qe.useMemo)(()=>Dt.getAllTables(t.schema,t.table),[t.schema,t.table]);(0,qe.useEffect)(()=>{r(-1)},[t.table]),(0,qe.useEffect)(()=>{o>=0&&n.current[o]?.focus()},[o]);let a=h=>{let p=t.table.foreignKeys.some(w=>w.columns.includes(h.name)),g=s.some(w=>w.foreignKeys.some(m=>m.referencedColumns.includes(h.name)));return!p&&!g},l=()=>{let h=[...t.table.columns];h.push({id:yt(),name:vn.getNextColumnName(h),dataType:"int",isPrimaryKey:h.length===0,isIdentity:!1,isNullable:!0,maxLength:"",precision:0,scale:0,identitySeed:1,identityIncrement:1,defaultValue:"",isComputed:!1,computedFormula:"",computedPersisted:!1}),t.setTable({...t.table,columns:h}),r(h.length-1)},c=(h,p)=>{let g=[...t.table.columns];g[h]=p,t.setTable({...t.table,columns:g})},u=h=>{let p=[...t.table.columns];p.splice(h,1),t.setTable({...t.table,columns:p})},d=h=>{t.setTable({...t.table,schema:h})},f=h=>{t.setTable({...t.table,name:h})};if(t.table)return(0,Q.jsxs)("div",{className:e.panel,children:[(0,Q.jsxs)(ot,{children:[(0,Q.jsx)(Ht,{children:T.schemaDesigner.schema}),(0,Q.jsx)(on,{placeholder:"Search Schema",options:t.schemas.map(h=>({displayName:h,value:h})),selectedOption:{text:t.table.schema,value:t.table.schema},onSelect:h=>d(h.value)})]}),(0,Q.jsxs)(ot,{validationMessage:t.errors[Ca],children:[(0,Q.jsx)(Ht,{children:T.schemaDesigner.name}),(0,Q.jsx)(tn,{autoFocus:!0,value:t.table.name,onChange:(h,p)=>f(p.value)})]}),(0,Q.jsx)(ne,{appearance:"secondary",icon:(0,Q.jsx)(Nn,{}),className:e.newColumnButton,onClick:l,children:T.schemaDesigner.newColumn}),(0,Q.jsx)("div",{className:e.scrollContainer,children:(0,Q.jsx)(o_,{columns:t.table.columns,updateColumn:c,deleteColumn:u,columnNameInputRefs:n,datatypes:i,isColumnDeletable:a})})]})};var ke=X(me());var ae=X(ie()),_a=X(me()),Jm=ze({panel:{height:"100%",display:"flex",flexDirection:"column",overflowY:"auto",overflowX:"hidden",padding:"10px",gap:"10px"},row:{display:"flex",flexDirection:"row",flex:"1",gap:"5px",padding:"0px 5px"},cardStyle:{marginBottom:"10px"},actionButton:{width:"fit-content"},scrollContainer:{flex:"1",overflow:"auto",padding:"5px"},newForeignKeyButton:{width:"200px"},mappingTableContainer:{backgroundColor:"var(--vscode-editorGroupHeader-tabsBackground)",padding:"10px"}}),r_=({foreignKey:e,foreignKeyIndex:t,selectedTable:n,updateForeignKey:o})=>{let r=ir({axis:"grid"}),i=[ht({columnId:"columnName",renderHeaderCell:()=>(0,ae.jsx)(ve,{children:T.schemaDesigner.columnName})}),ht({columnId:"foreignKeyColumnName",renderHeaderCell:()=>(0,ae.jsx)(ve,{children:T.schemaDesigner.foreignColumn})}),ht({columnId:"delete",renderHeaderCell:()=>(0,ae.jsx)(ve,{})})],[s]=(0,ke.useState)({columnName:{defaultWidth:150,minWidth:150,idealWidth:150},foreignKeyColumnName:{defaultWidth:150,minWidth:150,idealWidth:150},delete:{defaultWidth:30,minWidth:30,idealWidth:30}}),a=e.columns.map((g,w)=>({columnName:g,foreignKeyColumnName:e.referencedColumns[w]})),[l]=(0,ke.useState)(i),{getRows:c,columnSizing_unstable:u,tableRef:d}=ur({columns:l,items:a},[cr({columnSizingOptions:s,autoFitColumns:!1,containerWidthOffset:20})]),f=(0,ke.useContext)(ct),h=(0,ke.useMemo)(()=>f.schema?Dt.getTableFromDisplayName(f.schema,`${e.referencedSchemaName}.${e.referencedTableName}`):{columns:[]},[f.schema,e.referencedSchemaName,e.referencedTableName]),p=(g,w)=>{switch(g){case"columnName":return(0,ae.jsx)(on,{placeholder:"Search Schema",options:n.columns.map(m=>({displayName:m.name,value:m.name})),selectedOption:{text:e.columns[w],value:e.columns[w]},onSelect:m=>{let x=[...e.columns];x[w]=m.value,o(t,{...e,columns:x})},style:{minWidth:"150px",maxWidth:"150px"},size:"small"});case"foreignKeyColumnName":return(0,ae.jsx)(on,{placeholder:"Search Schema",options:h.columns.map(m=>({displayName:m.name,value:m.name})),selectedOption:{text:e.referencedColumns[w],value:e.referencedColumns[w]},onSelect:m=>{let x=[...e.referencedColumns];x[w]=m.value,o(t,{...e,referencedColumns:x})},style:{minWidth:"150px",maxWidth:"150px"},size:"small"});case"delete":return(0,ae.jsx)(ne,{appearance:"subtle",icon:(0,ae.jsx)(en,{}),onClick:()=>{let m=[...e.columns],x=[...e.referencedColumns];m.splice(w,1),x.splice(w,1),o(t,{...e,columns:m,referencedColumns:x})}});default:return null}};return(0,ae.jsxs)(hr,{...r,as:"table",size:"extra-small",...u.getTableProps(),ref:d,children:[(0,ae.jsx)(pr,{children:(0,ae.jsx)(An,{children:i.map(g=>(0,_a.createElement)(mr,{...u.getTableHeaderCellProps(g.columnId),key:g.columnId},g.renderHeaderCell()))})}),(0,ae.jsx)(fr,{children:c().map((g,w)=>(0,ae.jsx)(An,{children:i.map(m=>(0,_a.createElement)(dr,{...u.getTableCellProps(m.columnId),key:m.columnId},p(m.columnId,w)))},`mapping-${w}`))})]})},i_=({foreignKey:e,index:t,allTables:n,onDelete:o,onUpdate:r,lastAddedForeignKeyIndex:i})=>{let s=Jm(),a=(0,ke.useContext)(ct),l=(0,ke.useRef)(null),[c,u]=(0,ke.useState)(""),[d,f]=(0,ke.useState)("");(0,ke.useEffect)(()=>{t===i&&l.current?.focus()},[t,i]);let h=()=>{if(!a.schema)return;let p={...e},g=a.table.columns[0]?.name||"",m=Dt.getTableFromDisplayName(a.schema,`${e.referencedSchemaName}.${e.referencedTableName}`).columns[0]?.name||"";p.columns.push(g),p.referencedColumns.push(m),r(t,p)};return(0,ke.useEffect)(()=>{let p=a.errors[`${Yo}${e.id}`];u(p||"");let g=a.warnings[`${Yo}${e.id}`];f(g||"")},[a.errors]),(0,ae.jsxs)(Il,{className:s.cardStyle,children:[(0,ae.jsx)(Pl,{header:(0,ae.jsx)(ve,{children:T.schemaDesigner.foreignKeyIndex(t+1)}),action:(0,ae.jsx)(ne,{appearance:"subtle",icon:(0,ae.jsx)(en,{}),onClick:()=>o(t)})}),c&&(0,ae.jsx)(Ln,{intent:"error",children:c}),d&&(0,ae.jsx)(Ln,{intent:"warning",children:d}),(0,ae.jsx)("div",{className:s.row,children:(0,ae.jsxs)(ot,{style:{flex:1},size:"small",children:[(0,ae.jsx)(Ht,{children:T.schemaDesigner.name}),(0,ae.jsx)(tn,{size:"small",value:e.name,ref:l,onChange:(p,g)=>{r(t,{...e,name:g.value})}})]})}),(0,ae.jsx)("div",{className:s.row,children:(0,ae.jsxs)(ot,{style:{flex:1},size:"small",children:[(0,ae.jsx)(Ht,{children:T.schemaDesigner.targetTable}),(0,ae.jsx)(on,{options:n.sort((p,g)=>{let w=`${p.schema}.${p.name}`,m=`${g.schema}.${g.name}`;return w.toLowerCase().localeCompare(m.toLowerCase())}).map(p=>({displayName:`${p.schema}.${p.name}`,value:`${p.schema}.${p.name}`})),selectedOption:{text:`${e.referencedSchemaName}.${e.referencedTableName}`,value:`${e.referencedSchemaName}.${e.referencedTableName}`},onSelect:p=>{if(!p.value||!a.schema)return;let g=Dt.getTableFromDisplayName(a.schema,p.value),w=g.columns[0]?.name||"";r(t,{...e,referencedTableName:g.name,referencedSchemaName:g.schema,referencedColumns:[w],columns:[a.table.columns[0]?.name||""]})},style:{minWidth:"auto"},size:"small"})]})}),(0,ae.jsxs)("div",{className:s.row,children:[(0,ae.jsxs)(ot,{style:{flex:1},size:"small",children:[(0,ae.jsx)(Ht,{children:T.schemaDesigner.onDelete}),(0,ae.jsx)(Gi,{size:"small",value:pe.convertOnActionToString(e.onDeleteAction),selectedOptions:[pe.convertOnActionToString(e.onDeleteAction)],multiselect:!1,onOptionSelect:(p,g)=>{r(t,{...e,onDeleteAction:pe.convertStringToOnAction(g.optionValue)})},style:{minWidth:"auto"},children:pe.getOnActionOptions().map((p,g)=>(0,ae.jsx)(Ui,{value:p.label,children:p.label},`on-delete-option-${g}-${e.id}`))})]}),(0,ae.jsxs)(ot,{style:{flex:1},size:"small",children:[(0,ae.jsx)(Ht,{children:T.schemaDesigner.onUpdate}),(0,ae.jsx)(Gi,{size:"small",value:pe.convertOnActionToString(e.onUpdateAction),selectedOptions:[pe.convertOnActionToString(e.onUpdateAction)],multiselect:!1,onOptionSelect:(p,g)=>{r(t,{...e,onUpdateAction:pe.convertStringToOnAction(g.optionValue)})},style:{minWidth:"auto"},children:pe.getOnActionOptions().map((p,g)=>(0,ae.jsx)(Ui,{value:p.label,children:p.label},`on-update-option--${g}-${e.id}`))})]})]}),(0,ae.jsxs)("div",{className:s.mappingTableContainer,children:[(0,ae.jsx)(ne,{icon:(0,ae.jsx)(Nn,{}),className:s.actionButton,onClick:h,size:"small",children:T.schemaDesigner.newColumnMapping}),(0,ae.jsx)(r_,{foreignKey:e,foreignKeyIndex:t,selectedTable:a.table,updateForeignKey:r})]})]},`fk-card-${t}`)},eg=()=>{let e=Jm(),t=(0,ke.useContext)(ct),n=(0,ke.useRef)([]),[o,r]=(0,ke.useState)(-1),i=(0,ke.useMemo)(()=>t.schema?Dt.getAllTables(t.schema):[],[t.table]);if((0,ke.useEffect)(()=>{t.table&&r(-1)},[t.table]),(0,ke.useEffect)(()=>{o>=0&&n.current[o]?.focus()},[o]),!t.table)return;let s=()=>{if(!i.length)return;let c=i[0],u={id:yt(),name:vn.getNextForeignKeyName(t.table.foreignKeys,t.schema.tables),columns:[t.table.columns[0]?.name||""],referencedSchemaName:c.schema,referencedTableName:c.name,referencedColumns:[c.columns[0]?.name||""],onDeleteAction:he.OnAction.CASCADE,onUpdateAction:he.OnAction.CASCADE},d=[...t.table.foreignKeys,u];t.setTable({...t.table,foreignKeys:d}),r(d.length-1)},a=c=>{let u=[...t.table.foreignKeys];u.splice(c,1),t.setTable({...t.table,foreignKeys:u})},l=(c,u)=>{let d=[...t.table.foreignKeys];d[c]=u,t.setTable({...t.table,foreignKeys:d})};return(0,ae.jsxs)("div",{className:e.panel,children:[(0,ae.jsx)(ne,{icon:(0,ae.jsx)(Nn,{}),className:e.newForeignKeyButton,onClick:s,children:T.schemaDesigner.newForeignKey}),(0,ae.jsx)("div",{className:e.scrollContainer,children:t.table.foreignKeys.map((c,u)=>(0,ae.jsx)(i_,{foreignKey:c,index:u,allTables:i,onDelete:a,onUpdate:l,lastAddedForeignKeyIndex:o},`foreign-key-${c.id}`))})]})};var ut=X(ie()),s_=ze({editor:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},editorPanel:{flex:"1",overflow:"hidden"},tablePanel:{display:"flex",flexDirection:"column",padding:"5px 0px",gap:"5px",overflow:"hidden",maxHeight:"calc(100% - 10px)"},tablePanelRow:{display:"flex",flexDirection:"row",flex:"1",gap:"5px",padding:"0px 5px"},dataTypeDropdown:{minWidth:"110px",maxWidth:"110px","> button":{textOverflow:"ellipsis"}},foreignKeyContainer:{display:"flex",flexDirection:"column",gap:"5px",padding:"5px",borderTop:"1px solid"}}),ng=()=>{let e=s_(),t=(0,tg.useContext)(ct);if(!t)return;let n=i=>Object.keys(t.errors).filter(s=>s.includes(`${i}_`)&&t.errors[s]).length,o=i=>Object.keys(t.warnings).filter(s=>s.includes(`${i}_`)&&t.warnings[s]).length;if(!t.table)return;let r=i=>(0,ut.jsx)(Dl,{value:i,children:(0,ut.jsxs)("div",{style:{display:"flex",gap:"5px",alignItems:"center"},children:[T.schemaDesigner[i],(0,ut.jsx)(Vi,{size:"small",count:n(i),style:{backgroundColor:"var(--vscode-inputValidation-errorBackground)",color:"var(--vscode-problemsErrorIcon-foreground)",border:"1px solid var(--vscode-inputValidation-errorBorder)"},title:T.schemaDesigner.nErrors(n(i))}),(0,ut.jsx)(Vi,{size:"small",count:o(i),style:{backgroundColor:"var(--vscode-inputValidation-warningBackground)",color:"var(--vscode-problemsWarningIcon-foreground)",border:"1px solid var(--vscode-inputValidation-warningBorder)"},title:T.schemaDesigner.nWarnings(o(i))})]})});return(0,ut.jsxs)("div",{className:e.editor,children:[(0,ut.jsxs)(kl,{selectedValue:t.selectedTabValue,onTabSelect:(i,s)=>t.setSelectedTabValue(s.value),children:[r("table"),r("foreignKeys")]}),(0,ut.jsxs)("div",{className:e.editorPanel,children:[t.selectedTabValue==="table"&&(0,ut.jsx)(Qm,{}),t.selectedTabValue==="foreignKeys"&&(0,ut.jsx)(eg,{})]}),(0,ut.jsx)(Zm,{})]})};var Ae=X(me());var Tt=X(ie()),ct=(0,Ae.createContext)(void 0);var Ca="table_name",Yo="foreignKeys_fk_",og=()=>{let e=(0,Ae.useContext)(ge);if(!e)return;let[t,n]=(0,Ae.useState)(!1),[o,r]=(0,Ae.useState)({tables:[]}),[i,s]=(0,Ae.useState)({name:"",columns:[],schema:"",foreignKeys:[],id:""}),[a,l]=(0,Ae.useState)(!1),[c,u]=(0,Ae.useState)({}),[d,f]=(0,Ae.useState)({}),[h,p]=(0,Ae.useState)([]),[g,w]=(0,Ae.useState)([]),[m,x]=(0,Ae.useState)("table");(0,Ae.useEffect)(()=>{p(e.schemaNames),w(e.datatypes)},[e]),(0,Ae.useEffect)(()=>{let b=(E,_,I)=>{let R=e.getTableWithForeignKeys(E.id)||E;n(!0),r(_),s(R),l(!1),x(I?"foreignKeys":"table")},C=E=>{r(E),s(Dt.createNewTable(E,h)),l(!0),n(!0),x("table")};return se.on("editTable",b),se.on("newTable",C),()=>{se.off("editTable",b),se.off("newTable",C)}},[h,g]);let y=async()=>{let b=!1;a?b=await e.addTable(i):b=await e.updateTable(i),b&&(n(!1),se.emit("getScript"),se.emit("pushState"))};return(0,Ae.useEffect)(()=>{(()=>{let C={},E={},_=Dt.tableNameValidationError(o,i);C[Ca]=_??"";for(let I of i.columns){let R=De.isColumnValid(I,i.columns);R&&(C[`columns_${I.id}`]=R??"")}i.foreignKeys.forEach(I=>{let R=pe.isForeignKeyValid(o.tables,i,I);R&&(C[`${Yo}${I.id}`]=R.errorMessage??"");let O=pe.getForeignKeyWarnings(o.tables,i,I);O&&(E[`${Yo}${I.id}`]=O.errorMessage??"")}),u(C),f(E)})()},[i]),(0,Tt.jsx)(Ll,{position:"end",open:t,onOpenChange:(b,{open:C})=>n(C),onKeyDown:b=>{b.key==="Backspace"&&b.stopPropagation()},style:{width:"600px"},children:(0,Tt.jsxs)(ct.Provider,{value:{schemas:h,dataTypes:g,schema:o,table:i,setTable:s,isEditDrawerOpen:t,setIsEditDrawerOpen:n,save:y,cancel:()=>n(!1),isNewTable:a,errors:c,warnings:d,selectedTabValue:m,setSelectedTabValue:x},children:[(0,Tt.jsx)($l,{children:(0,Tt.jsx)(Bl,{action:(0,Tt.jsx)(ne,{appearance:"subtle","aria-label":"Close",icon:(0,Tt.jsx)(bl,{}),onClick:()=>n(!1)}),children:a?T.schemaDesigner.addTable:T.schemaDesigner.editTable})}),(0,Tt.jsx)(Fl,{children:(0,Tt.jsx)(ng,{})})]})})};var dt=X(me());var fg=X(me(),1),Z=X(me(),1),Ri=(0,Z.createContext)(null);Ri.displayName="PanelGroupContext";var _e={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Ra=10,En=Z.useLayoutEffect,rg=fg.useId,a_=typeof rg=="function"?rg:()=>null,l_=0;function Ma(e=null){let t=a_(),n=(0,Z.useRef)(e||t||null);return n.current===null&&(n.current=""+l_++),e??n.current}function hg({children:e,className:t="",collapsedSize:n,collapsible:o,defaultSize:r,forwardedRef:i,id:s,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:d,order:f,style:h,tagName:p="div",...g}){let w=(0,Z.useContext)(Ri);if(w===null)throw Error("Panel components must be rendered within a PanelGroup container");let{collapsePanel:m,expandPanel:x,getPanelSize:y,getPanelStyle:b,groupId:C,isPanelCollapsed:E,reevaluatePanelConstraints:_,registerPanel:I,resizePanel:R,unregisterPanel:O}=w,q=Ma(s),L=(0,Z.useRef)({callbacks:{onCollapse:c,onExpand:u,onResize:d},constraints:{collapsedSize:n,collapsible:o,defaultSize:r,maxSize:a,minSize:l},id:q,idIsFromProps:s!==void 0,order:f});(0,Z.useRef)({didLogMissingDefaultSizeWarning:!1}),En(()=>{let{callbacks:v,constraints:N}=L.current,S={...N};L.current.id=q,L.current.idIsFromProps=s!==void 0,L.current.order=f,v.onCollapse=c,v.onExpand=u,v.onResize=d,N.collapsedSize=n,N.collapsible=o,N.defaultSize=r,N.maxSize=a,N.minSize=l,(S.collapsedSize!==N.collapsedSize||S.collapsible!==N.collapsible||S.maxSize!==N.maxSize||S.minSize!==N.minSize)&&_(L.current,S)}),En(()=>{let v=L.current;return I(v),()=>{O(v)}},[f,q,I,O]),(0,Z.useImperativeHandle)(i,()=>({collapse:()=>{m(L.current)},expand:v=>{x(L.current,v)},getId(){return q},getSize(){return y(L.current)},isCollapsed(){return E(L.current)},isExpanded(){return!E(L.current)},resize:v=>{R(L.current,v)}}),[m,x,y,E,q,R]);let U=b(L.current,r);return(0,Z.createElement)(p,{...g,children:e,className:t,id:q,style:{...U,...h},[_e.groupId]:C,[_e.panel]:"",[_e.panelCollapsible]:o||void 0,[_e.panelId]:q,[_e.panelSize]:parseFloat(""+U.flexGrow).toFixed(1)})}var Jo=(0,Z.forwardRef)((e,t)=>(0,Z.createElement)(hg,{...e,forwardedRef:t}));hg.displayName="Panel";Jo.displayName="forwardRef(Panel)";var c_;function u_(){return c_}var Pa=null,d_=!0,Ti=-1,Ft=null;function f_(e,t){if(t){let n=(t&bg)!==0,o=(t&xg)!==0,r=(t&wg)!==0,i=(t&vg)!==0;if(n)return r?"se-resize":i?"ne-resize":"e-resize";if(o)return r?"sw-resize":i?"nw-resize":"w-resize";if(r)return"s-resize";if(i)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function h_(){Ft!==null&&(document.head.removeChild(Ft),Pa=null,Ft=null,Ti=-1)}function Na(e,t){var n,o;if(!d_)return;let r=f_(e,t);if(Pa!==r){if(Pa=r,Ft===null){Ft=document.createElement("style");let s=u_();s&&Ft.setAttribute("nonce",s),document.head.appendChild(Ft)}if(Ti>=0){var i;(i=Ft.sheet)===null||i===void 0||i.removeRule(Ti)}Ti=(n=(o=Ft.sheet)===null||o===void 0?void 0:o.insertRule(`*{cursor: ${r} !important;}`))!==null&&n!==void 0?n:-1}}function pg(e){return e.type==="keydown"}function mg(e){return e.type.startsWith("pointer")}function gg(e){return e.type.startsWith("mouse")}function Mi(e){if(mg(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(gg(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function p_(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function m_(e,t,n){return n?e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y:e.x<=t.x+t.width&&e.x+e.width>=t.x&&e.y<=t.y+t.height&&e.y+e.height>=t.y}function g_(e,t){if(e===t)throw new Error("Cannot compare node with itself");let n={a:ag(e),b:ag(t)},o;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),o=e;ue(o,"Stacking order can only be calculated for elements with a common ancestor");let r={a:sg(ig(n.a)),b:sg(ig(n.b))};if(r.a===r.b){let i=o.childNodes,s={a:n.a.at(-1),b:n.b.at(-1)},a=i.length;for(;a--;){let l=i[a];if(l===s.a)return 1;if(l===s.b)return-1}}return Math.sign(r.a-r.b)}var y_=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function b_(e){var t;let n=getComputedStyle((t=yg(e))!==null&&t!==void 0?t:e).display;return n==="flex"||n==="inline-flex"}function x_(e){let t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||b_(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||y_.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function ig(e){let t=e.length;for(;t--;){let n=e[t];if(ue(n,"Missing node"),x_(n))return n}return null}function sg(e){return e&&Number(getComputedStyle(e).zIndex)||0}function ag(e){let t=[];for(;e;)t.push(e),e=yg(e);return t}function yg(e){let{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}var bg=1,xg=2,wg=4,vg=8,w_=p_()==="coarse",wt=[],io=!1,Xt=new Map,zi=new Map,jo=new Set;function v_(e,t,n,o,r){var i;let{ownerDocument:s}=t,a={direction:n,element:t,hitAreaMargins:o,setResizeHandlerState:r},l=(i=Xt.get(s))!==null&&i!==void 0?i:0;return Xt.set(s,l+1),jo.add(a),Ii(),function(){var u;zi.delete(e),jo.delete(a);let d=(u=Xt.get(s))!==null&&u!==void 0?u:1;if(Xt.set(s,d-1),Ii(),d===1&&Xt.delete(s),wt.includes(a)){let f=wt.indexOf(a);f>=0&&wt.splice(f,1),Oa(),r("up",!0,null)}}}function S_(e){let{target:t}=e,{x:n,y:o}=Mi(e);io=!0,za({target:t,x:n,y:o}),Ii(),wt.length>0&&(Pi("down",e),e.preventDefault(),Sg(t)||e.stopImmediatePropagation())}function Da(e){let{x:t,y:n}=Mi(e);if(io&&e.buttons===0&&(io=!1,Pi("up",e)),!io){let{target:o}=e;za({target:o,x:t,y:n})}Pi("move",e),Oa(),wt.length>0&&e.preventDefault()}function ka(e){let{target:t}=e,{x:n,y:o}=Mi(e);zi.clear(),io=!1,wt.length>0&&(e.preventDefault(),Sg(t)||e.stopImmediatePropagation()),Pi("up",e),za({target:t,x:n,y:o}),Oa(),Ii()}function Sg(e){let t=e;for(;t;){if(t.hasAttribute(_e.resizeHandle))return!0;t=t.parentElement}return!1}function za({target:e,x:t,y:n}){wt.splice(0);let o=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(o=e),jo.forEach(r=>{let{element:i,hitAreaMargins:s}=r,a=i.getBoundingClientRect(),{bottom:l,left:c,right:u,top:d}=a,f=w_?s.coarse:s.fine;if(t>=c-f&&t<=u+f&&n>=d-f&&n<=l+f){if(o!==null&&document.contains(o)&&i!==o&&!i.contains(o)&&!o.contains(i)&&g_(o,i)>0){let p=o,g=!1;for(;p&&!p.contains(i);){if(m_(p.getBoundingClientRect(),a,!0)){g=!0;break}p=p.parentElement}if(g)return}wt.push(r)}})}function Ta(e,t){zi.set(e,t)}function Oa(){let e=!1,t=!1;wt.forEach(o=>{let{direction:r}=o;r==="horizontal"?e=!0:t=!0});let n=0;zi.forEach(o=>{n|=o}),e&&t?Na("intersection",n):e?Na("horizontal",n):t?Na("vertical",n):h_()}var Ia=new AbortController;function Ii(){Ia.abort(),Ia=new AbortController;let e={capture:!0,signal:Ia.signal};jo.size&&(io?(wt.length>0&&Xt.forEach((t,n)=>{let{body:o}=n;t>0&&(o.addEventListener("contextmenu",ka,e),o.addEventListener("pointerleave",Da,e),o.addEventListener("pointermove",Da,e))}),Xt.forEach((t,n)=>{let{body:o}=n;o.addEventListener("pointerup",ka,e),o.addEventListener("pointercancel",ka,e)})):Xt.forEach((t,n)=>{let{body:o}=n;t>0&&(o.addEventListener("pointerdown",S_,e),o.addEventListener("pointermove",Da,e))}))}function Pi(e,t){jo.forEach(n=>{let{setResizeHandlerState:o}=n,r=wt.includes(n);o(e,r,t)})}function E_(){let[e,t]=(0,Z.useState)(0);return(0,Z.useCallback)(()=>t(n=>n+1),[])}function ue(e,t){if(!e)throw console.error(t),Error(t)}function Cn(e,t,n=Ra){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function $t(e,t,n=Ra){return Cn(e,t,n)===0}function tt(e,t,n){return Cn(e,t,n)===0}function C_(e,t,n){if(e.length!==t.length)return!1;for(let o=0;o<e.length;o++){let r=e[o],i=t[o];if(!tt(r,i,n))return!1}return!0}function ro({panelConstraints:e,panelIndex:t,size:n}){let o=e[t];ue(o!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:r=0,collapsible:i,maxSize:s=100,minSize:a=0}=o;if(Cn(n,a)<0)if(i){let l=(r+a)/2;Cn(n,l)<0?n=r:n=a}else n=a;return n=Math.min(s,n),n=parseFloat(n.toFixed(Ra)),n}function Xo({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:o,prevLayout:r,trigger:i}){if(tt(e,0))return t;let s=[...t],[a,l]=o;ue(a!=null,"Invalid first pivot index"),ue(l!=null,"Invalid second pivot index");let c=0;if(i==="keyboard"){{let d=e<0?l:a,f=n[d];ue(f,`Panel constraints not found for index ${d}`);let{collapsedSize:h=0,collapsible:p,minSize:g=0}=f;if(p){let w=t[d];if(ue(w!=null,`Previous layout not found for panel index ${d}`),tt(w,h)){let m=g-w;Cn(m,Math.abs(e))>0&&(e=e<0?0-m:m)}}}{let d=e<0?a:l,f=n[d];ue(f,`No panel constraints found for index ${d}`);let{collapsedSize:h=0,collapsible:p,minSize:g=0}=f;if(p){let w=t[d];if(ue(w!=null,`Previous layout not found for panel index ${d}`),tt(w,g)){let m=w-h;Cn(m,Math.abs(e))>0&&(e=e<0?0-m:m)}}}}{let d=e<0?1:-1,f=e<0?l:a,h=0;for(;;){let g=t[f];ue(g!=null,`Previous layout not found for panel index ${f}`);let m=ro({panelConstraints:n,panelIndex:f,size:100})-g;if(h+=m,f+=d,f<0||f>=n.length)break}let p=Math.min(Math.abs(e),Math.abs(h));e=e<0?0-p:p}{let f=e<0?a:l;for(;f>=0&&f<n.length;){let h=Math.abs(e)-Math.abs(c),p=t[f];ue(p!=null,`Previous layout not found for panel index ${f}`);let g=p-h,w=ro({panelConstraints:n,panelIndex:f,size:g});if(!tt(p,w)&&(c+=p-w,s[f]=w,c.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?f--:f++}}if(C_(r,s))return r;{let d=e<0?l:a,f=t[d];ue(f!=null,`Previous layout not found for panel index ${d}`);let h=f+c,p=ro({panelConstraints:n,panelIndex:d,size:h});if(s[d]=p,!tt(p,h)){let g=h-p,m=e<0?l:a;for(;m>=0&&m<n.length;){let x=s[m];ue(x!=null,`Previous layout not found for panel index ${m}`);let y=x+g,b=ro({panelConstraints:n,panelIndex:m,size:y});if(tt(x,b)||(g-=b-x,s[m]=b),tt(g,0))break;e>0?m--:m++}}}let u=s.reduce((d,f)=>f+d,0);return tt(u,100)?s:r}function __({layout:e,panelsArray:t,pivotIndices:n}){let o=0,r=100,i=0,s=0,a=n[0];ue(a!=null,"No pivot index found"),t.forEach((d,f)=>{let{constraints:h}=d,{maxSize:p=100,minSize:g=0}=h;f===a?(o=g,r=p):(i+=g,s+=p)});let l=Math.min(r,100-i),c=Math.max(o,100-s),u=e[a];return{valueMax:l,valueMin:c,valueNow:u}}function Qo(e,t=document){return Array.from(t.querySelectorAll(`[${_e.resizeHandleId}][data-panel-group-id="${e}"]`))}function Eg(e,t,n=document){let r=Qo(e,n).findIndex(i=>i.getAttribute(_e.resizeHandleId)===t);return r??null}function Cg(e,t,n){let o=Eg(e,t,n);return o!=null?[o,o+1]:[-1,-1]}function N_(e){return e instanceof HTMLElement?!0:typeof e=="object"&&e!==null&&"tagName"in e&&"getAttribute"in e}function _g(e,t=document){if(N_(t)&&t.dataset.panelGroupId==e)return t;let n=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return n||null}function Oi(e,t=document){let n=t.querySelector(`[${_e.resizeHandleId}="${e}"]`);return n||null}function D_(e,t,n,o=document){var r,i,s,a;let l=Oi(t,o),c=Qo(e,o),u=l?c.indexOf(l):-1,d=(r=(i=n[u])===null||i===void 0?void 0:i.id)!==null&&r!==void 0?r:null,f=(s=(a=n[u+1])===null||a===void 0?void 0:a.id)!==null&&s!==void 0?s:null;return[d,f]}function k_({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:o,panelDataArray:r,panelGroupElement:i,setLayout:s}){(0,Z.useRef)({didWarnAboutMissingResizeHandle:!1}),En(()=>{if(!i)return;let a=Qo(n,i);for(let l=0;l<r.length-1;l++){let{valueMax:c,valueMin:u,valueNow:d}=__({layout:o,panelsArray:r,pivotIndices:[l,l+1]}),f=a[l];if(f!=null){let h=r[l];ue(h,`No panel data found for index "${l}"`),f.setAttribute("aria-controls",h.id),f.setAttribute("aria-valuemax",""+Math.round(c)),f.setAttribute("aria-valuemin",""+Math.round(u)),f.setAttribute("aria-valuenow",d!=null?""+Math.round(d):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[n,o,r,i]),(0,Z.useEffect)(()=>{if(!i)return;let a=t.current;ue(a,"Eager values not found");let{panelDataArray:l}=a,c=_g(n,i);ue(c!=null,`No group found for id "${n}"`);let u=Qo(n,i);ue(u,`No resize handles found for group id "${n}"`);let d=u.map(f=>{let h=f.getAttribute(_e.resizeHandleId);ue(h,"Resize handle element has no handle id attribute");let[p,g]=D_(n,h,l,i);if(p==null||g==null)return()=>{};let w=m=>{if(!m.defaultPrevented)switch(m.key){case"Enter":{m.preventDefault();let x=l.findIndex(y=>y.id===p);if(x>=0){let y=l[x];ue(y,`No panel data found for index ${x}`);let b=o[x],{collapsedSize:C=0,collapsible:E,minSize:_=0}=y.constraints;if(b!=null&&E){let I=Xo({delta:tt(b,C)?_-C:C-b,initialLayout:o,panelConstraints:l.map(R=>R.constraints),pivotIndices:Cg(n,h,i),prevLayout:o,trigger:"keyboard"});o!==I&&s(I)}}break}}};return f.addEventListener("keydown",w),()=>{f.removeEventListener("keydown",w)}});return()=>{d.forEach(f=>f())}},[i,e,t,n,o,r,s])}function lg(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ng(e,t){let n=e==="horizontal",{x:o,y:r}=Mi(t);return n?o:r}function T_(e,t,n,o,r){let i=n==="horizontal",s=Oi(t,r);ue(s,`No resize handle element found for id "${t}"`);let a=s.getAttribute(_e.groupId);ue(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=o,c=Ng(n,e),u=_g(a,r);ue(u,`No group element found for id "${a}"`);let d=u.getBoundingClientRect(),f=i?d.width:d.height;return(c-l)/f*100}function I_(e,t,n,o,r,i){if(pg(e)){let s=n==="horizontal",a=0;e.shiftKey?a=100:r!=null?a=r:a=10;let l=0;switch(e.key){case"ArrowDown":l=s?0:a;break;case"ArrowLeft":l=s?-a:0;break;case"ArrowRight":l=s?a:0;break;case"ArrowUp":l=s?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return o==null?0:T_(e,t,n,o,i)}function P_({panelDataArray:e}){let t=Array(e.length),n=e.map(i=>i.constraints),o=0,r=100;for(let i=0;i<e.length;i++){let s=n[i];ue(s,`Panel constraints not found for index ${i}`);let{defaultSize:a}=s;a!=null&&(o++,t[i]=a,r-=a)}for(let i=0;i<e.length;i++){let s=n[i];ue(s,`Panel constraints not found for index ${i}`);let{defaultSize:a}=s;if(a!=null)continue;let l=e.length-o,c=r/l;o++,t[i]=c,r-=c}return t}function no(e,t,n){t.forEach((o,r)=>{let i=e[r];ue(i,`Panel data not found for index ${r}`);let{callbacks:s,constraints:a,id:l}=i,{collapsedSize:c=0,collapsible:u}=a,d=n[l];if(d==null||o!==d){n[l]=o;let{onCollapse:f,onExpand:h,onResize:p}=s;p&&p(o,d),u&&(f||h)&&(h&&(d==null||$t(d,c))&&!$t(o,c)&&h(),f&&(d==null||!$t(d,c))&&$t(o,c)&&f())}})}function ki(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function R_({defaultSize:e,dragState:t,layout:n,panelData:o,panelIndex:r,precision:i=3}){let s=n[r],a;return s==null?a=e!=null?e.toPrecision(i):"1":o.length===1?a="1":a=s.toPrecision(i),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function M_(e,t=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{e(...r)},t)}}function cg(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,n)=>{localStorage.setItem(t,n)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function Dg(e){return`react-resizable-panels:${e}`}function kg(e){return e.map(t=>{let{constraints:n,id:o,idIsFromProps:r,order:i}=t;return r?o:i?`${i}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((t,n)=>t.localeCompare(n)).join(",")}function Tg(e,t){try{let n=Dg(e),o=t.getItem(n);if(o){let r=JSON.parse(o);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function z_(e,t,n){var o,r;let i=(o=Tg(e,n))!==null&&o!==void 0?o:{},s=kg(t);return(r=i[s])!==null&&r!==void 0?r:null}function O_(e,t,n,o,r){var i;let s=Dg(e),a=kg(t),l=(i=Tg(e,r))!==null&&i!==void 0?i:{};l[a]={expandToSizes:Object.fromEntries(n.entries()),layout:o};try{r.setItem(s,JSON.stringify(l))}catch(c){console.error(c)}}function ug({layout:e,panelConstraints:t}){let n=[...e],o=n.reduce((i,s)=>i+s,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(i=>`${i}%`).join(", ")}`);if(!tt(o,100)&&n.length>0)for(let i=0;i<t.length;i++){let s=n[i];ue(s!=null,`No layout data found for index ${i}`);let a=100/o*s;n[i]=a}let r=0;for(let i=0;i<t.length;i++){let s=n[i];ue(s!=null,`No layout data found for index ${i}`);let a=ro({panelConstraints:t,panelIndex:i,size:s});s!=a&&(r+=s-a,n[i]=a)}if(!tt(r,0))for(let i=0;i<t.length;i++){let s=n[i];ue(s!=null,`No layout data found for index ${i}`);let a=s+r,l=ro({panelConstraints:t,panelIndex:i,size:a});if(s!==l&&(r-=l-s,n[i]=l,tt(r,0)))break}return n}var A_=100,Zo={getItem:e=>(cg(Zo),Zo.getItem(e)),setItem:(e,t)=>{cg(Zo),Zo.setItem(e,t)}},dg={};function Ig({autoSaveId:e=null,children:t,className:n="",direction:o,forwardedRef:r,id:i=null,onLayout:s=null,keyboardResizeBy:a=null,storage:l=Zo,style:c,tagName:u="div",...d}){let f=Ma(i),h=(0,Z.useRef)(null),[p,g]=(0,Z.useState)(null),[w,m]=(0,Z.useState)([]),x=E_(),y=(0,Z.useRef)({}),b=(0,Z.useRef)(new Map),C=(0,Z.useRef)(0),E=(0,Z.useRef)({autoSaveId:e,direction:o,dragState:p,id:f,keyboardResizeBy:a,onLayout:s,storage:l}),_=(0,Z.useRef)({layout:w,panelDataArray:[],panelDataArrayChanged:!1});(0,Z.useRef)({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),(0,Z.useImperativeHandle)(r,()=>({getId:()=>E.current.id,getLayout:()=>{let{layout:P}=_.current;return P},setLayout:P=>{let{onLayout:H}=E.current,{layout:V,panelDataArray:K}=_.current,$=ug({layout:P,panelConstraints:K.map(G=>G.constraints)});lg(V,$)||(m($),_.current.layout=$,H&&H($),no(K,$,y.current))}}),[]),En(()=>{E.current.autoSaveId=e,E.current.direction=o,E.current.dragState=p,E.current.id=f,E.current.onLayout=s,E.current.storage=l}),k_({committedValuesRef:E,eagerValuesRef:_,groupId:f,layout:w,panelDataArray:_.current.panelDataArray,setLayout:m,panelGroupElement:h.current}),(0,Z.useEffect)(()=>{let{panelDataArray:P}=_.current;if(e){if(w.length===0||w.length!==P.length)return;let H=dg[e];H==null&&(H=M_(O_,A_),dg[e]=H);let V=[...P],K=new Map(b.current);H(e,V,K,w,l)}},[e,w,l]),(0,Z.useEffect)(()=>{});let I=(0,Z.useCallback)(P=>{let{onLayout:H}=E.current,{layout:V,panelDataArray:K}=_.current;if(P.constraints.collapsible){let $=K.map(le=>le.constraints),{collapsedSize:G=0,panelSize:Y,pivotIndices:oe}=Sn(K,P,V);if(ue(Y!=null,`Panel size not found for panel "${P.id}"`),!$t(Y,G)){b.current.set(P.id,Y);let j=oo(K,P)===K.length-1?Y-G:G-Y,ee=Xo({delta:j,initialLayout:V,panelConstraints:$,pivotIndices:oe,prevLayout:V,trigger:"imperative-api"});ki(V,ee)||(m(ee),_.current.layout=ee,H&&H(ee),no(K,ee,y.current))}}},[]),R=(0,Z.useCallback)((P,H)=>{let{onLayout:V}=E.current,{layout:K,panelDataArray:$}=_.current;if(P.constraints.collapsible){let G=$.map(de=>de.constraints),{collapsedSize:Y=0,panelSize:oe=0,minSize:le=0,pivotIndices:j}=Sn($,P,K),ee=H??le;if($t(oe,Y)){let de=b.current.get(P.id),we=de!=null&&de>=ee?de:ee,jt=oo($,P)===$.length-1?oe-we:we-oe,Me=Xo({delta:jt,initialLayout:K,panelConstraints:G,pivotIndices:j,prevLayout:K,trigger:"imperative-api"});ki(K,Me)||(m(Me),_.current.layout=Me,V&&V(Me),no($,Me,y.current))}}},[]),O=(0,Z.useCallback)(P=>{let{layout:H,panelDataArray:V}=_.current,{panelSize:K}=Sn(V,P,H);return ue(K!=null,`Panel size not found for panel "${P.id}"`),K},[]),q=(0,Z.useCallback)((P,H)=>{let{panelDataArray:V}=_.current,K=oo(V,P);return R_({defaultSize:H,dragState:p,layout:w,panelData:V,panelIndex:K})},[p,w]),L=(0,Z.useCallback)(P=>{let{layout:H,panelDataArray:V}=_.current,{collapsedSize:K=0,collapsible:$,panelSize:G}=Sn(V,P,H);return ue(G!=null,`Panel size not found for panel "${P.id}"`),$===!0&&$t(G,K)},[]),U=(0,Z.useCallback)(P=>{let{layout:H,panelDataArray:V}=_.current,{collapsedSize:K=0,collapsible:$,panelSize:G}=Sn(V,P,H);return ue(G!=null,`Panel size not found for panel "${P.id}"`),!$||Cn(G,K)>0},[]),v=(0,Z.useCallback)(P=>{let{panelDataArray:H}=_.current;H.push(P),H.sort((V,K)=>{let $=V.order,G=K.order;return $==null&&G==null?0:$==null?-1:G==null?1:$-G}),_.current.panelDataArrayChanged=!0,x()},[x]);En(()=>{if(_.current.panelDataArrayChanged){_.current.panelDataArrayChanged=!1;let{autoSaveId:P,onLayout:H,storage:V}=E.current,{layout:K,panelDataArray:$}=_.current,G=null;if(P){let oe=z_(P,$,V);oe&&(b.current=new Map(Object.entries(oe.expandToSizes)),G=oe.layout)}G==null&&(G=P_({panelDataArray:$}));let Y=ug({layout:G,panelConstraints:$.map(oe=>oe.constraints)});lg(K,Y)||(m(Y),_.current.layout=Y,H&&H(Y),no($,Y,y.current))}}),En(()=>{let P=_.current;return()=>{P.layout=[]}},[]);let N=(0,Z.useCallback)(P=>{let H=!1,V=h.current;return V&&window.getComputedStyle(V,null).getPropertyValue("direction")==="rtl"&&(H=!0),function($){$.preventDefault();let G=h.current;if(!G)return()=>null;let{direction:Y,dragState:oe,id:le,keyboardResizeBy:j,onLayout:ee}=E.current,{layout:de,panelDataArray:we}=_.current,{initialLayout:nt}=oe??{},jt=Cg(le,P,G),Me=I_($,P,Y,oe,j,G),_n=Y==="horizontal";_n&&H&&(Me=-Me);let Qt=we.map(Jt=>Jt.constraints),It=Xo({delta:Me,initialLayout:nt??de,panelConstraints:Qt,pivotIndices:jt,prevLayout:de,trigger:pg($)?"keyboard":"mouse-or-touch"}),Bt=!ki(de,It);(mg($)||gg($))&&C.current!=Me&&(C.current=Me,!Bt&&Me!==0?_n?Ta(P,Me<0?bg:xg):Ta(P,Me<0?wg:vg):Ta(P,0)),Bt&&(m(It),_.current.layout=It,ee&&ee(It),no(we,It,y.current))}},[]),S=(0,Z.useCallback)((P,H)=>{let{onLayout:V}=E.current,{layout:K,panelDataArray:$}=_.current,G=$.map(de=>de.constraints),{panelSize:Y,pivotIndices:oe}=Sn($,P,K);ue(Y!=null,`Panel size not found for panel "${P.id}"`);let j=oo($,P)===$.length-1?Y-H:H-Y,ee=Xo({delta:j,initialLayout:K,panelConstraints:G,pivotIndices:oe,prevLayout:K,trigger:"imperative-api"});ki(K,ee)||(m(ee),_.current.layout=ee,V&&V(ee),no($,ee,y.current))},[]),k=(0,Z.useCallback)((P,H)=>{let{layout:V,panelDataArray:K}=_.current,{collapsedSize:$=0,collapsible:G}=H,{collapsedSize:Y=0,collapsible:oe,maxSize:le=100,minSize:j=0}=P.constraints,{panelSize:ee}=Sn(K,P,V);ee!=null&&(G&&oe&&$t(ee,$)?$t($,Y)||S(P,Y):ee<j?S(P,j):ee>le&&S(P,le))},[S]),A=(0,Z.useCallback)((P,H)=>{let{direction:V}=E.current,{layout:K}=_.current;if(!h.current)return;let $=Oi(P,h.current);ue($,`Drag handle element not found for id "${P}"`);let G=Ng(V,H);g({dragHandleId:P,dragHandleRect:$.getBoundingClientRect(),initialCursorPosition:G,initialLayout:K})},[]),D=(0,Z.useCallback)(()=>{g(null)},[]),F=(0,Z.useCallback)(P=>{let{panelDataArray:H}=_.current,V=oo(H,P);V>=0&&(H.splice(V,1),delete y.current[P.id],_.current.panelDataArrayChanged=!0,x())},[x]),z=(0,Z.useMemo)(()=>({collapsePanel:I,direction:o,dragState:p,expandPanel:R,getPanelSize:O,getPanelStyle:q,groupId:f,isPanelCollapsed:L,isPanelExpanded:U,reevaluatePanelConstraints:k,registerPanel:v,registerResizeHandle:N,resizePanel:S,startDragging:A,stopDragging:D,unregisterPanel:F,panelGroupElement:h.current}),[I,p,o,R,O,q,f,L,U,k,v,N,S,A,D,F]),W={display:"flex",flexDirection:o==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return(0,Z.createElement)(Ri.Provider,{value:z},(0,Z.createElement)(u,{...d,children:t,className:n,id:i,ref:h,style:{...W,...c},[_e.group]:"",[_e.groupDirection]:o,[_e.groupId]:f}))}var Aa=(0,Z.forwardRef)((e,t)=>(0,Z.createElement)(Ig,{...e,forwardedRef:t}));Ig.displayName="PanelGroup";Aa.displayName="forwardRef(PanelGroup)";function oo(e,t){return e.findIndex(n=>n===t||n.id===t.id)}function Sn(e,t,n){let o=oo(e,t),i=o===e.length-1?[o-1,o]:[o,o+1],s=n[o];return{...t.constraints,panelSize:s,pivotIndices:i}}function L_({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:o}){(0,Z.useEffect)(()=>{if(e||n==null||o==null)return;let r=Oi(t,o);if(r==null)return;let i=s=>{if(!s.defaultPrevented)switch(s.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{s.preventDefault(),n(s);break}case"F6":{s.preventDefault();let a=r.getAttribute(_e.groupId);ue(a,`No group element found for id "${a}"`);let l=Qo(a,o),c=Eg(a,t,o);ue(c!==null,`No resize element found for id "${t}"`);let u=s.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return r.addEventListener("keydown",i),()=>{r.removeEventListener("keydown",i)}},[o,e,t,n])}function La({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:o,id:r,onBlur:i,onClick:s,onDragging:a,onFocus:l,onPointerDown:c,onPointerUp:u,style:d={},tabIndex:f=0,tagName:h="div",...p}){var g,w;let m=(0,Z.useRef)(null),x=(0,Z.useRef)({onClick:s,onDragging:a,onPointerDown:c,onPointerUp:u});(0,Z.useEffect)(()=>{x.current.onClick=s,x.current.onDragging=a,x.current.onPointerDown=c,x.current.onPointerUp=u});let y=(0,Z.useContext)(Ri);if(y===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");let{direction:b,groupId:C,registerResizeHandle:E,startDragging:_,stopDragging:I,panelGroupElement:R}=y,O=Ma(r),[q,L]=(0,Z.useState)("inactive"),[U,v]=(0,Z.useState)(!1),[N,S]=(0,Z.useState)(null),k=(0,Z.useRef)({state:q});En(()=>{k.current.state=q}),(0,Z.useEffect)(()=>{if(n)S(null);else{let z=E(O);S(()=>z)}},[n,O,E]);let A=(g=o?.coarse)!==null&&g!==void 0?g:15,D=(w=o?.fine)!==null&&w!==void 0?w:5;return(0,Z.useEffect)(()=>{if(n||N==null)return;let z=m.current;ue(z,"Element ref not attached");let W=!1;return v_(O,z,b,{coarse:A,fine:D},(H,V,K)=>{if(!V){L("inactive");return}switch(H){case"down":{L("drag"),W=!1,ue(K,'Expected event to be defined for "down" action'),_(O,K);let{onDragging:$,onPointerDown:G}=x.current;$?.(!0),G?.();break}case"move":{let{state:$}=k.current;W=!0,$!=="drag"&&L("hover"),ue(K,'Expected event to be defined for "move" action'),N(K);break}case"up":{L("hover"),I();let{onClick:$,onDragging:G,onPointerUp:Y}=x.current;G?.(!1),Y?.(),W||$?.();break}}})},[A,b,n,D,E,O,N,_,I]),L_({disabled:n,handleId:O,resizeHandler:N,panelGroupElement:R}),(0,Z.createElement)(h,{...p,children:e,className:t,id:r,onBlur:()=>{v(!1),i?.()},onFocus:()=>{v(!0),l?.()},ref:m,role:"separator",style:{...{touchAction:"none",userSelect:"none"},...d},tabIndex:f,[_e.groupDirection]:b,[_e.groupId]:C,[_e.resizeHandle]:"",[_e.resizeHandleActive]:q==="drag"?"pointer":U?"keyboard":void 0,[_e.resizeHandleEnabled]:!n,[_e.resizeHandleId]:O,[_e.resizeHandleState]:q})}La.displayName="PanelResizeHandle";var $e=X(ie()),F_=ze({resizeHandle:{position:"absolute",top:"0",right:"0",width:"100%",height:"10px",cursor:"ns-resize",zIndex:1,boxShadow:"0px -1px 1px  var(--vscode-editorWidget-border)"},resizePaneContainer:{width:"100%",position:"relative"},header:{display:"flex",justifyContent:"space-between",alignItems:"center"}}),$_=40,B_=10,Fa=100,Pg=()=>{let e=(0,dt.useContext)(ge),t=F_(),[n,o]=(0,dt.useState)(""),r=(0,dt.useRef)(null),[i,s]=(0,dt.useState)(0),[a,l]=(0,dt.useState)(T.tableDesigner.maximizePanelSize),[c,u]=(0,dt.useState)((0,$e.jsx)(Hi,{}));return(0,dt.useEffect)(()=>{se.on("getScript",()=>{setTimeout(async()=>{let d=await e.getDefinition();o(d)},0)}),se.on("openCodeDrawer",()=>{setTimeout(async()=>{let d=await e.getDefinition();o(d)},0),r.current&&(r.current.isCollapsed()?r.current.expand(25):r.current.collapse())})},[]),(0,dt.useEffect)(()=>{},[i]),(0,$e.jsxs)(Jo,{collapsible:!0,minSize:B_,ref:r,onResize:d=>{s(d),d===Fa?(l(T.tableDesigner.maximizePanelSize),u((0,$e.jsx)(dl,{}))):(l(T.tableDesigner.maximizePanelSize),u((0,$e.jsx)(Hi,{})))},children:[(0,$e.jsxs)("div",{className:t.header,children:[(0,$e.jsx)(ve,{weight:"medium",style:{marginLeft:"10px"},children:T.schemaDesigner.definition}),(0,$e.jsxs)(lr,{style:{gap:"3px"},children:[(0,$e.jsx)(ne,{size:"small",appearance:"subtle",title:T.schemaDesigner.openInEditor,icon:(0,$e.jsx)(vl,{}),onClick:()=>e.openInEditor(n),children:T.schemaDesigner.openInEditor}),(0,$e.jsx)(ne,{size:"small",appearance:"subtle",title:T.schemaDesigner.copy,icon:(0,$e.jsx)(hl,{}),onClick:()=>e.copyToClipboard(n)}),(0,$e.jsx)(ne,{size:"small",appearance:"subtle",onClick:()=>{r.current?.getSize()===Fa?r.current?.resize($_):r.current?.resize(Fa)},title:a,icon:c}),(0,$e.jsx)(ne,{size:"small",appearance:"subtle",title:T.schemaDesigner.close,icon:(0,$e.jsx)(gl,{}),onClick:()=>{r.current&&r.current.collapse()}})]})]}),(0,$e.jsx)(Yl,{height:"100%",width:"100%",language:"sql",theme:Wl(e?.themeKind),value:n,options:{readOnly:!0}},n)]})};var Zt=X(me());var Xe=X(me());var er=X(ie()),Rg=({className:e})=>(0,er.jsxs)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,er.jsx)("path",{d:"M2.75 7.5C2.75 7.08579 3.08579 6.75 3.5 6.75C3.91421 6.75 4.25 7.08579 4.25 7.5C4.25 7.91421 3.91421 8.25 3.5 8.25C3.08579 8.25 2.75 7.91421 2.75 7.5Z",fill:"currentColor"}),(0,er.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.68364 10.4942C3.23159 10.8262 3.86023 11.0011 4.50089 11C5.22295 10.9987 5.92683 10.7735 6.51552 10.3554C7.00557 10.0073 7.39571 9.53989 7.6506 8.99999L13.5 9C13.6326 9 13.7598 8.94732 13.8536 8.85355L14.8536 7.85355C15.0488 7.65829 15.0488 7.3417 14.8536 7.14644L12.8536 5.14644C12.6583 4.95118 12.3417 4.95118 12.1464 5.14644L11.5 5.79289L10.8536 5.14644C10.6583 4.95118 10.3417 4.95118 10.1464 5.14644L9.5 5.79289L8.85355 5.14644C8.65829 4.95118 8.34171 4.95118 8.14645 5.14644L7.52652 5.76637C7.3135 5.39491 7.03313 5.06418 6.69799 4.792C6.20067 4.38811 5.60191 4.12869 4.96713 4.04208C4.33236 3.95547 3.68598 4.04501 3.09865 4.30091C2.51132 4.55681 2.00562 4.96922 1.63682 5.49308C1.26802 6.01695 1.05031 6.6321 1.00748 7.27133C0.964642 7.91055 1.09833 8.54925 1.39394 9.11764C1.68955 9.68602 2.1357 10.1622 2.68364 10.4942ZM4.49911 10C4.04176 10.0008 3.59298 9.8759 3.20182 9.63891C2.81065 9.40193 2.49216 9.06198 2.28113 8.65623C2.0701 8.25047 1.97466 7.79451 2.00524 7.33819C2.03582 6.88186 2.19123 6.44271 2.45451 6.06874C2.71779 5.69477 3.07879 5.40035 3.49808 5.21767C3.91736 5.03499 4.37879 4.97107 4.83195 5.0329C5.2851 5.09473 5.71254 5.27993 6.06756 5.56825C6.42258 5.85658 6.69152 6.23694 6.84499 6.66777C6.91595 6.86697 7.10454 6.99999 7.316 6.99999L7.5 6.99999C7.63261 6.99999 7.75979 6.94732 7.85355 6.85355L8.5 6.2071L9.14645 6.85355C9.34171 7.04881 9.65829 7.04881 9.85355 6.85355L10.5 6.2071L11.1464 6.85355C11.3417 7.04881 11.6583 7.04881 11.8536 6.85355L12.5 6.2071L13.7929 7.5L13.2929 8L7.316 7.99999C7.10367 7.99999 6.9145 8.13409 6.8442 8.33444C6.67363 8.82055 6.35648 9.24178 5.93647 9.54008C5.51646 9.83839 5.01427 9.99907 4.49911 10Z",fill:"currentColor"})]});var tr=X(ie()),Mg=({className:e})=>(0,tr.jsxs)("svg",{className:e,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,tr.jsx)("path",{d:"M11 6C11.5523 6 12 5.55228 12 5C12 4.44772 11.5523 4 11 4C10.4477 4 10 4.44772 10 5C10 5.55228 10.4477 6 11 6Z",fill:"currentColor"}),(0,tr.jsx)("path",{d:"M7.5 12V11.5H8.5C8.77614 11.5 9 11.2761 9 11V10H10C12.2091 10 14 8.20914 14 6C14 3.79086 12.2091 2 10 2C7.79086 2 6 3.79086 6 6C6 6.39211 6.05656 6.77171 6.16219 7.13071L2.29289 11C2.10536 11.1875 2 11.4419 2 11.7071V13C2 13.5523 2.44772 14 3 14H5C5.55229 14 6 13.5523 6 13V12.5H7C7.27614 12.5 7.5 12.2761 7.5 12ZM7 6C7 4.34315 8.34315 3 10 3C11.6569 3 13 4.34315 13 6C13 7.65685 11.6569 9 10 9H8.5C8.22386 9 8 9.22386 8 9.5V10.5H7C6.72386 10.5 6.5 10.7239 6.5 11V11.5H5.5C5.22386 11.5 5 11.7239 5 12V13H3V11.7071L7.08898 7.61813C7.22904 7.47807 7.27321 7.26854 7.20163 7.08386C7.07157 6.74835 7 6.38313 7 6Z",fill:"currentColor"})]});var te=X(ie()),H_=e=>{let[t,n]=(0,Xe.useState)(!1),o=(0,Xe.useRef)(null);return(0,Xe.useEffect)(()=>{let r=()=>{if(o.current){let s=o.current.scrollWidth>o.current.clientWidth;n(s)}},i=setTimeout(r,0);return window.addEventListener("resize",r),()=>{clearTimeout(i),window.removeEventListener("resize",r)}},[e]),{isOverflowing:t,textRef:o}},zg=({content:e,children:t,...n})=>{let{isOverflowing:o,textRef:r}=H_(e),i=(0,Xe.cloneElement)(t,{ref:r,...t.props});return o?(0,te.jsx)(El,{relationship:"label",content:e,...n,children:i}):i},nr=ze({tableNodeContainer:{width:`${Yt.NODE_WIDTH}px`,backgroundColor:"var(--vscode-editor-background)",borderRadius:"5px",display:"flex",flexDirection:"column",gap:"5px"},tableHeader:{width:"100%",display:"flex",minHeight:"50px",flexDirection:"column"},tableHeaderRow:{width:"100%",display:"flex",height:"30px",flexDirection:"row",alignItems:"center",gap:"5px",paddingTop:"10px"},tableIcon:{padding:"0 5px",width:"20px",height:"20px"},tableTitle:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis",fontWeight:"600"},tableTitleExporting:{flexGrow:1,fontWeight:"600",overflowWrap:"anywhere",whiteSpace:"normal",hyphens:"auto"},tableSubtitle:{fontSize:"11px",paddingLeft:"35px"},columnName:{flexGrow:1,overflow:"hidden",textOverflow:"ellipsis"},columnNameExporting:{flexGrow:1},columnType:{fontSize:"12px",color:"var(--vscode-descriptionForeground)"},handleLeft:{marginLeft:"2px"},handleRight:{marginRight:"2px"},keyIcon:{padding:"0 5px",width:"16px",height:"16px"},actionButton:{marginLeft:"auto"},collapseButton:{width:"100%"},tableOverlay:{position:"absolute",inset:0,backgroundColor:"var(--vscode-editor-background)",opacity:.4,pointerEvents:"none",zIndex:10}}),V_=({table:e})=>{let t=(0,Xe.useContext)(ge),n=nr(),o=()=>{let s=t.extractSchema();if(!s.tables.find(c=>c.id===e.id))return;let l={...e};se.emit("editTable",l,s)},r=()=>{t.deleteTable(e)},i=()=>{let s=t.extractSchema();if(!s.tables.find(c=>c.id===e.id))return;let l={...e};se.emit("editTable",l,s,!0)};return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ne,{appearance:"subtle",icon:(0,te.jsx)(Ja,{}),onClick:o,className:n.actionButton,size:"small"}),(0,te.jsxs)(Dn,{children:[(0,te.jsx)(Tn,{disableButtonEnhancement:!0,children:(0,te.jsx)(Cl,{icon:(0,te.jsx)(rl,{}),className:n.actionButton,size:"small",appearance:"subtle"})}),(0,te.jsx)(kn,{children:(0,te.jsxs)(sr,{children:[(0,te.jsx)(nn,{icon:(0,te.jsx)(nl,{}),onClick:i,children:T.schemaDesigner.manageRelationships}),(0,te.jsx)(nn,{icon:(0,te.jsx)(en,{}),onClick:r,children:T.schemaDesigner.delete})]})})]})]})},W_=({table:e})=>{let t=nr(),n=(0,Xe.useContext)(ge),o=r=>{if(!n.findTableText||n.findTableText.trim()==="")return(0,te.jsx)("span",{children:r});let i=new RegExp(`(${n.findTableText.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi"),s=r.split(i);return(0,te.jsx)(te.Fragment,{children:s.map((a,l)=>a.toLowerCase()===n.findTableText.toLowerCase()?(0,te.jsx)("span",{style:{backgroundColor:"var(--vscode-editor-findMatchBackground)",color:"var(--vscode-editor-background)",padding:"0 2px",borderRadius:"3px"},children:a},l):(0,te.jsx)("span",{children:a},l))})};return(0,te.jsxs)("div",{className:t.tableHeader,children:[(0,te.jsxs)("div",{className:t.tableHeaderRow,children:[(0,te.jsx)(il,{className:t.tableIcon}),(0,te.jsx)(zg,{content:`${e.schema}.${e.name}`,relationship:"label",children:(0,te.jsx)(ve,{className:n.isExporting?t.tableTitleExporting:t.tableTitle,children:n.isExporting?`${e.schema}.${e.name}`:o(`${e.schema}.${e.name}`)})}),!n.isExporting&&(0,te.jsx)(V_,{table:e})]}),(0,te.jsx)("div",{className:t.tableSubtitle,children:T.schemaDesigner.tableNodeSubText(e.columns.length)})]})},K_=({column:e,table:t})=>{let n=nr(),o=(0,Xe.useContext)(ge),r=t.foreignKeys.some(i=>i.columns.includes(e.name));return(0,te.jsxs)("div",{className:"column",children:[(0,te.jsx)(Ot,{type:"source",position:J.Left,id:`left-${e.name}`,isConnectable:!0,className:n.handleLeft}),e.isPrimaryKey&&(0,te.jsx)(Mg,{className:n.keyIcon}),!e.isPrimaryKey&&r&&(0,te.jsx)(Rg,{className:n.keyIcon}),(0,te.jsx)(zg,{content:e.name,relationship:"label",children:(0,te.jsx)(ve,{className:o.isExporting?n.columnNameExporting:n.columnName,style:{paddingLeft:e.isPrimaryKey||r?"0px":"30px"},children:e.name})}),(0,te.jsx)(ve,{className:n.columnType,children:e.isComputed?"COMPUTED":e.dataType?.toUpperCase()}),(0,te.jsx)(Ot,{type:"source",position:J.Right,id:`right-${e.name}`,isConnectable:!0,className:n.handleRight})]},e.name)},q_=({hiddenColumns:e})=>(0,te.jsx)("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:"32px",pointerEvents:"none",zIndex:1},children:e.map(t=>(0,te.jsxs)("div",{children:[(0,te.jsx)(Ot,{type:"source",position:J.Left,id:`left-${t.name}`,isConnectable:!0,style:{visibility:"hidden",position:"absolute",left:0,top:"50%",transform:"translateY(-50%)"}}),(0,te.jsx)(Ot,{type:"source",position:J.Right,id:`right-${t.name}`,isConnectable:!0,style:{visibility:"hidden",position:"absolute",right:0,top:"50%",transform:"translateY(-50%)"}})]},t.name))}),U_=({columns:e,table:t,isCollapsed:n,onToggleCollapse:o})=>{let r=nr(),a=((0,Xe.useContext)(ge).state?.enableExpandCollapseButtons??!0)&&e.length>10,l=a&&n?e.slice(0,10):e,c=a&&n?e.slice(10):[],u=Bi("Expand"),d=Bi("Collapse");return(0,te.jsxs)("div",{style:{position:"relative"},children:[c.length>0&&(0,te.jsx)(q_,{hiddenColumns:c}),l.map((f,h)=>(0,te.jsx)(K_,{column:f,table:t},`${h}-${f.name}`)),a&&(0,te.jsx)(ne,{className:r.collapseButton,onClick:o,appearance:"subtle",icon:n?(0,te.jsx)(Za,{}):(0,te.jsx)(ja,{}),tabIndex:0,children:n?(0,te.jsx)("span",{children:u}):(0,te.jsx)("span",{children:d})})]})},Og=e=>{let t=nr(),n=e.data,[o,r]=(0,Xe.useState)(n.columns.length>10),i=()=>{r(!o)};return(0,te.jsxs)("div",{className:t.tableNodeContainer,children:[e.data?.dimmed&&(0,te.jsx)("div",{className:t.tableOverlay}),(0,te.jsx)(W_,{table:n}),(0,te.jsx)(_l,{}),(0,te.jsx)(U_,{columns:n.columns,table:n,isCollapsed:o,onToggleCollapse:i})]})};var Te=X(ie()),G_={tableNode:Og},Ag=()=>{let e=Ga("toaster"),{dispatchToast:t}=Rl(e),n=(0,Zt.useContext)(ge),[o,r,i]=Af([]),[s,a,l]=Lf([]),c=(0,Zt.useRef)(void 0),[u,d]=(0,Zt.useState)(!1);(0,Zt.useEffect)(()=>{(async()=>{let{nodes:x,edges:y}=await n.initializeSchemaDesigner();r(x),a(y)})()},[]);let f=m=>t((0,Te.jsxs)(zl,{appearance:"inverted",children:[(0,Te.jsx)(Ol,{children:"Failed to create foreign key"}),(0,Te.jsx)(Al,{children:m})]}),{pauseOnHover:!0,intent:"error"}),h=m=>{let x=o.find(L=>L.id===m.source),y=o.find(L=>L.id===m.target);if(!x||!y||!m.sourceHandle||!m.targetHandle)return;let b=pe.extractColumnNameFromHandle(m.sourceHandle),C=pe.extractColumnNameFromHandle(m.targetHandle),E=x.data.columns.find(L=>L.name===b),_=y.data.columns.find(L=>L.name===C);if(!E||!_)return;let I=ye.extractSchemaModel(o,s),R=pe.extractForeignKeysFromEdges(s,x.data.id,I),O=pe.createForeignKeyFromConnection(x,y,E.name,_.name,yt(),vn.getNextForeignKeyName(R,I.tables)),q={id:`${x.id}-${y.id}-${E.name}-${_.name}`,source:x.id,target:y.id,sourceHandle:m.sourceHandle,targetHandle:m.targetHandle,markerEnd:{type:st.ArrowClosed},data:O,type:x.id===y.id?Ge.SmoothStep:void 0};a(L=>Lo(q,L)),se.emit("getScript"),se.emit("pushState")},p=(m,x)=>{if(!x.isValid){if(!x.fromHandle||!x.toHandle||!x.fromNode||!x.toNode||!x.fromHandle.id||!x.toHandle.id)return;let y=pe.extractColumnNameFromHandle(x.fromHandle.id),b=pe.extractColumnNameFromHandle(x.toHandle.id),C=pe.createForeignKeyFromConnection(x.fromNode,x.toNode,y,b),E=pe.isForeignKeyValid(ye.extractSchemaModel(o,s).tables,x.fromNode.data,C);E.errorMessage&&f(E.errorMessage)}},g=m=>pe.validateConnection(m,o,s).isValid,w=async()=>(d(!0),await new Promise(x=>{c.current=x}));return(0,Te.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[(0,Te.jsx)(Ml,{toasterId:e,position:"top-end"}),(0,Te.jsxs)(Of,{nodes:o,edges:s,nodeTypes:G_,onNodesChange:i,onEdgesChange:l,onConnect:h,onConnectEnd:p,onlyRenderVisibleElements:n.renderOnlyVisibleTables,proOptions:{hideAttribution:!0},isValidConnection:g,connectionMode:Ct.Loose,onDelete:()=>{se.emit("getScript"),se.emit("pushState")},onNodeDragStop:()=>{se.emit("pushState")},onBeforeDelete:async m=>m.nodes.length===0&&m.edges.length===0?!0:await w(),minZoom:.05,fitView:!0,children:[(0,Te.jsx)(Hf,{}),(0,Te.jsx)(Wf,{pannable:!0,zoomable:!0}),(0,Te.jsx)($f,{variant:Nt.Dots,gap:12,size:1})]}),(0,Te.jsx)(In,{open:u,onOpenChange:(m,x)=>{d(x.open)},children:(0,Te.jsx)(zn,{children:(0,Te.jsxs)(Rn,{children:[(0,Te.jsx)(Mn,{children:T.schemaDesigner.deleteConfirmation}),(0,Te.jsx)(On,{children:T.schemaDesigner.deleteConfirmationContent}),(0,Te.jsxs)(Pn,{children:[(0,Te.jsx)(vt,{disableButtonEnhancement:!0,children:(0,Te.jsx)(ne,{appearance:"primary",onClick:()=>{c.current&&c.current(!0)},children:T.schemaDesigner.delete})}),(0,Te.jsx)(vt,{disableButtonEnhancement:!0,children:(0,Te.jsx)(ne,{appearance:"secondary",onClick:()=>{c.current&&c.current(!1)},children:T.schemaDesigner.cancel})})]})]})})})]})};var Fg=X(me());var Ie=X(me());var ft=X(ie()),Y_=ze({floatingContainer:{position:"absolute",right:"16px",top:"0px",display:"flex",flexDirection:"row",alignItems:"center",backgroundColor:"var(--vscode-editorWidget-background)",boxShadow:"0 0 8px 2px var(--vscode-widget-shadow)",borderBottomLeftRadius:"4px",borderBottomRightRadius:"4px",paddingLeft:"4px",paddingRight:"4px",paddingTop:"0px",paddingBottom:"0px",zIndex:"35",transform:"translateY(-10px)",opacity:"0",transition:"opacity 0.2s ease, transform 0.2s ease",overflow:"hidden",borderLeft:"3px solid var(--vscode-editorWidget-border)",height:"33px",gap:"3px"},visible:{opacity:"1",transform:"translateY(0)"},invisible:{display:"none"},srOnly:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"}});function Lg({getItems:e,onItemSelected:t,onSearch:n,placeholder:o=T.common.find,searchLabel:r="Search items",nextLabel:i=T.common.findNext,previousLabel:s=T.common.findPrevious,width:a="200px",emitSearchEvent:l,disabled:c=!1,parentRef:u,zIndex:d=1e3}){let[f,h]=(0,Ie.useState)(e()),[p,g]=(0,Ie.useState)(""),[w,m]=(0,Ie.useState)(T.common.noResults),[x,y]=(0,Ie.useState)([]),[b,C]=(0,Ie.useState)(0),[E,_]=(0,Ie.useState)(!1),I=(0,Ie.useRef)(null),R=(0,Ie.useRef)(null),O=(0,Ie.useRef)(null),q=(0,Ie.useRef)(null),L=Y_(),U=D=>D.trim()?f.filter(F=>F.getSearchableText().toLowerCase().includes(D.toLowerCase())):[];(0,Ie.useEffect)(()=>{let D=T.common.noResults;x.length>0&&(D=T.common.searchResultSummary(b+1,x.length)),m(D),O.current&&(O.current.textContent=p?`${D}${x.length>0?`. Found "${p}" in ${x[b]?.getDisplayText()}`:""}`:"Search cleared"),x.length>0&&t&&t(x[b]),l&&l(p)},[x,b,p,t,l]);let v=D=>{if(g(D),D.trim().length===0)m(T.common.noResults),y([]),C(0);else{let F=U(D);y(F),C((F.length>0,0))}n&&n(D)},N=()=>{if(x.length===0)return;let D=(b+1)%x.length;C(D)},S=()=>{if(x.length===0)return;let D=(b-1+x.length)%x.length;C(D)},k=(0,Ie.useCallback)(()=>{q.current=document.activeElement,_(!0),requestAnimationFrame(()=>{I.current&&I.current.focus()})},[]),A=(0,Ie.useCallback)(()=>{_(!1),g(""),y([]),q.current?.focus()},[]);return(0,Ie.useEffect)(()=>{if(c)return;let D=F=>{if(!u?.current?.contains(document.activeElement))return;let z=F.ctrlKey&&F.key==="f";if(navigator.userAgent.includes("Macintosh")&&(z=F.metaKey&&F.key==="f"),z)if(F.preventDefault(),E)I.current&&I.current.focus();else{k();let P=window.getSelection()?.toString();P&&v(P)}else F.key==="Escape"&&E&&(A(),u?.current&&u.current.focus(),F.preventDefault())};return document.addEventListener("keydown",F=>{D(F)}),()=>{document.removeEventListener("keydown",F=>{D(F)})}},[c,E,k,A,u]),(0,Ie.useEffect)(()=>{h(e())},[e,E]),(0,Ie.useEffect)(()=>{if(p){let D=U(p);y(D),C((D.length>0,0))}},[f,p]),(0,ft.jsxs)("div",{ref:R,role:"search","aria-label":r,className:`${L.floatingContainer} ${E?L.visible:L.invisible}`,style:{zIndex:d},children:[(0,ft.jsx)(yr,{size:"small",placeholder:o,value:p,onChange:(D,F)=>v(F.value),style:{width:a,maxWidth:a,marginLeft:"17px"},ref:I,"aria-label":r,"aria-controls":"search-results-status",onKeyDown:D=>{D.key==="Enter"?D.shiftKey?(S(),D.preventDefault()):(N(),D.preventDefault()):D.key==="Escape"&&(A(),D.preventDefault())}}),(0,ft.jsx)(ve,{size:200,style:{marginLeft:"5px",color:x.length===0&&p?"var(--vscode-errorForeground)":"",minWidth:"70px"},id:"search-results-count","aria-live":"polite",children:w}),(0,ft.jsx)("div",{ref:O,id:"search-results-status","aria-live":"polite",className:L.srOnly}),(0,ft.jsx)(ne,{size:"small",icon:(0,ft.jsx)(sl,{}),appearance:"subtle",disabled:x.length===0,onClick:N,title:i,"aria-label":i}),(0,ft.jsx)(ne,{size:"small",icon:(0,ft.jsx)(ul,{}),appearance:"subtle",disabled:x.length===0,onClick:S,title:s,"aria-label":s}),(0,ft.jsx)(ne,{size:"small",icon:(0,ft.jsx)(yl,{}),appearance:"subtle",onClick:A,title:T.common.closeFind,"aria-label":T.common.closeFind})]})}var Bg=X(ie()),$a=class{node;constructor(t){this.node=t}get id(){return this.node.id}getDisplayText(){return`${this.node.data.schema||""}.${this.node.data.name}`}getSearchableText(){return this.getDisplayText()}getNode(){return this.node}},$g=({parentRef:e})=>{let t=je(),n=(0,Fg.useContext)(ge);return(0,Bg.jsx)(Lg,{getItems:()=>t.getNodes().filter(s=>!s.hidden&&s.data&&s.data.name).map(s=>new $a(s)),onItemSelected:i=>{n.updateSelectedNodes([i.id]),n.setCenter(i.id,!0)},searchLabel:T.common.find,width:"200px",emitSearchEvent:i=>{n.setFindTableText(i)},parentRef:e})};var Pe=X(ie()),X_=ze({resizeHandle:{height:"2px",backgroundColor:"var(--vscode-editorWidget-border)"}}),Hg=()=>{let e=(0,Ai.useContext)(ge),t=X_();if(e)return(0,Pe.jsxs)(Pe.Fragment,{children:[(0,Pe.jsx)(og,{}),(0,Pe.jsxs)(Z_,{children:[(0,Pe.jsxs)(Aa,{direction:"vertical",children:[(0,Pe.jsx)(Jo,{defaultSize:100,children:(0,Pe.jsxs)(j_,{children:[(0,Pe.jsx)(Ym,{}),(0,Pe.jsx)(Ag,{})]})}),(0,Pe.jsx)(La,{className:t.resizeHandle}),(0,Pe.jsx)(Pg,{})]}),!e.isInitialized&&(0,Pe.jsx)(Q_,{})]})]})},Z_=({children:e})=>{let t=(0,Ai.useRef)(null);return(0,Pe.jsxs)("div",{tabIndex:0,ref:t,style:{height:"100%",width:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[(0,Pe.jsx)($g,{parentRef:t}),e]})},j_=({children:e})=>(0,Pe.jsx)("div",{style:{flex:1,width:"100%",height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:e}),Q_=()=>(0,Pe.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.4)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},children:(0,Pe.jsx)(ar,{label:T.schemaDesigner.loadingSchemaDesigner,labelPosition:"below"})});var or=X(ie());Vg.default.createRoot(document.getElementById("root")).render((0,or.jsx)(ql,{children:(0,or.jsx)(Ws,{children:(0,or.jsx)(pm,{children:(0,or.jsx)(Hg,{})})})}));
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)
*/
