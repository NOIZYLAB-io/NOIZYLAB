import{a as Ue,b as Ye}from"./chunk-OJNDYEPL.js";import{a as $e,b as Qe,c as xe}from"./chunk-L7S3JX2N.js";import{a as Je}from"./chunk-ZULDP422.js";import{$b as ne,$c as Ke,Ab as Se,Ac as We,Bb as Me,Cb as Q,Cc as ue,Dc as fe,Ec as he,Fc as ge,Gc as Ce,Hc as _e,K as Re,Nb as qe,Ob as _,Oc as o,Pb as ye,Q as ke,R as Te,Ra as se,Sb as oe,_ as Ne,c as p,d as q,eb as j,f as ht,fa as Pe,ga as je,gb as W,hb as He,i as ee,ia as Fe,ib as K,j as Ee,jb as ce,k as P,la as Le,lb as le,ma as Be,mb as ze,mc as Ge,n as te,nb as de,nc as Ve,p as x,r as Ie,wb as Ae,xb as me,yb as pe,z as Oe}from"./chunk-V3XRZIHQ.js";var ft=p(ht());var z=p(q());var G=p(q());var Xe=p(q());var et=p(x()),N=(0,Xe.createContext)({}),Ze=({children:a})=>{let e=Ye(),r=e?.state;return(0,et.jsx)(N.Provider,{value:{state:r,themeKind:e?.themeKind,isSqlProjectExtensionInstalled:function(){e?.extensionRpc.action("isSqlProjectExtensionInstalled",{})},listActiveServers:function(){e?.extensionRpc.action("listActiveServers",{})},listDatabasesForActiveServer:function(t){e?.extensionRpc.action("listDatabasesForActiveServer",{connectionUri:t})},openAddNewConnectionDialog:function(t){e?.extensionRpc.action("openAddNewConnectionDialog",{endpointType:t})},selectFile:function(t,n,c){e?.extensionRpc.action("selectFile",{endpoint:t,endpointType:n,fileType:c})},confirmSelectedSchema:function(t,n){e?.extensionRpc.action("confirmSelectedSchema",{endpointType:t,folderStructure:n})},confirmSelectedDatabase:function(t,n,c){e?.extensionRpc.action("confirmSelectedDatabase",{endpointType:t,serverConnectionUri:n,databaseName:c})},setIntermediarySchemaOptions:function(){e?.extensionRpc.action("setIntermediarySchemaOptions",{})},intermediaryGeneralOptionsChanged(t){e?.extensionRpc.action("intermediaryGeneralOptionsChanged",{key:t})},intermediaryGeneralOptionsBulkChanged(t,n){e?.extensionRpc.action("intermediaryGeneralOptionsBulkChanged",{keys:t,checked:n})},intermediaryIncludeObjectTypesOptionsChanged(t){e?.extensionRpc.action("intermediaryIncludeObjectTypesOptionsChanged",{key:t})},intermediaryIncludeObjectTypesBulkChanged(t,n){e?.extensionRpc.action("intermediaryIncludeObjectTypesBulkChanged",{keys:t,checked:n})},confirmSchemaOptions:function(t){e?.extensionRpc.action("confirmSchemaOptions",{optionsChanged:t})},switchEndpoints:function(t,n){e?.extensionRpc.action("switchEndpoints",{newSourceEndpointInfo:t,newTargetEndpointInfo:n})},compare:function(t,n,c){e?.extensionRpc.action("compare",{sourceEndpointInfo:t,targetEndpointInfo:n,deploymentOptions:c})},generateScript:function(t,n){e?.extensionRpc.action("generateScript",{targetServerName:t,targetDatabaseName:n})},publishChanges:function(t,n){e?.extensionRpc.action("publishChanges",{targetServerName:n,targetDatabaseName:t})},publishDatabaseChanges:function(t,n){e?.extensionRpc.action("publishDatabaseChanges",{targetServerName:t,targetDatabaseName:n})},publishProjectChanges:function(t,n,c){e?.extensionRpc.action("publishProjectChanges",{targetProjectPath:t,targetFolderStructure:n,taskExecutionMode:c})},resetOptions:function(){e?.extensionRpc.action("resetOptions",{})},includeExcludeNode:function(t,n,c){e?.extensionRpc.action("includeExcludeNode",{id:t,diffEntry:n,includeRequest:c})},includeExcludeAllNodes:function(t){e?.extensionRpc.action("includeExcludeAllNodes",{includeRequest:t})},openScmp:function(){e?.extensionRpc.action("openScmp",{})},saveScmp:function(){e?.extensionRpc.action("saveScmp",{})},cancel:function(){e?.extensionRpc.action("cancel",{})}},children:a})};var F=p(q()),tt=(a={})=>{let{minHeight:e=100,maxHeight:r,initialHeight:t=200,onResize:n,siblingRef:c}=a,[v,g]=(0,F.useState)(t),S=(0,F.useRef)(null),E=(0,F.useRef)(0),f=(0,F.useRef)(0),h=(0,F.useRef)(!1),D=(0,F.useCallback)(R=>{R.preventDefault(),h.current=!0,E.current=R.clientY,f.current=v,document.addEventListener("mousemove",O),document.addEventListener("mouseup",C)},[v]),O=(0,F.useCallback)(R=>{if(!h.current)return;let A=R.clientY-E.current,k=f.current+A;e&&(k=Math.max(k,e)),r&&(k=Math.min(k,r)),g(k)},[e,r]);(0,F.useEffect)(()=>{if(n&&n(v),c?.current&&S.current){let k=(S.current.parentElement?.clientHeight||0)-v-8;c.current.style.height=`${Math.max(k,e)}px`}let R=new Event("resize");window.dispatchEvent(R)},[v,n,c,e]);let C=(0,F.useCallback)(()=>{h.current&&(h.current=!1,document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",C))},[O]);return(0,F.useEffect)(()=>()=>{document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",C)},[O,C]),{ref:S,height:v,resizerProps:{onMouseDown:D,style:{cursor:"ns-resize",height:"8px",width:"100%",backgroundColor:"transparent",position:"absolute",bottom:0,left:0,zIndex:10}}}};var b=p(x()),gt=P({HeaderCellPadding:{padding:"0 8px"},selectedRow:{backgroundColor:"var(--vscode-list-activeSelectionBackground)",color:"var(--vscode-list-activeSelectionForeground)","& td":{backgroundColor:"var(--vscode-list-activeSelectionBackground)",color:"var(--vscode-list-activeSelectionForeground)"}},resizableContainer:{position:"relative",width:"100%",overflow:"hidden"},resizer:{position:"absolute",bottom:0,left:0,width:"100%",height:"8px",cursor:"ns-resize",backgroundColor:"transparent",zIndex:10,"&:hover":{backgroundColor:"var(--vscode-scrollbarSlider-hoverBackground)",opacity:.5},"&:active":{backgroundColor:"var(--vscode-scrollbarSlider-activeBackground)",opacity:.7}},resizerHandle:{height:"3px",width:"40px",margin:"2px auto",borderRadius:"1px",backgroundColor:"var(--vscode-scrollbarSlider-background)",opacity:.5},hideTextOverflow:{overflow:"hidden",whiteSpace:"nowrap"},alignSpinner:{marginLeft:"8px"},dataGridHeader:{backgroundColor:"var(--vscode-keybindingTable-headerBackground)"}}),Ct=G.forwardRef(({onDiffSelected:a,selectedDiffId:e,siblingRef:r},t)=>{let n=gt(),c=G.useContext(N),v=c.state.schemaCompareResult,[g,S]=G.useState("allIncluded"),{ref:E,height:f,resizerProps:h}=tt({initialHeight:300,minHeight:150,maxHeight:800,siblingRef:r});G.useImperativeHandle(t,()=>E.current),G.useEffect(()=>{let i=!0,I=!0,V=!1;for(let M of v.differences)M.included||(i=!1),M.included&&(I=!1);!i&&!I&&(V=!0),S(V?"mixed":i?"allIncluded":"allExcluded")},[c.state.schemaCompareResult]);let D=i=>!i||i.length===0?"":i.join("."),O=(i,I)=>{i.position!==void 0&&c.includeExcludeNode(i.position,i,I)},C=()=>{g==="allExcluded"||g==="mixed"?c.includeExcludeAllNodes(!0):c.includeExcludeAllNodes(!1)},R=i=>{let I="";switch(i){case 2:I=o.schemaCompare.add;break;case 1:I=o.schemaCompare.change;break;case 0:I=o.schemaCompare.delete;break}return I},A=[oe({columnId:"type",renderHeaderCell:()=>o.schemaCompare.type,renderCell:i=>(0,b.jsx)(ne,{children:(0,b.jsx)(Q,{truncate:!0,className:n.hideTextOverflow,children:i.name})})}),oe({columnId:"sourceName",renderHeaderCell:()=>o.schemaCompare.sourceName,renderCell:i=>(0,b.jsx)(ne,{children:(0,b.jsx)(Q,{truncate:!0,className:n.hideTextOverflow,children:D(i.sourceValue)})})}),oe({columnId:"include",renderHeaderCell:()=>c.state.isIncludeExcludeAllOperationInProgress?(0,b.jsx)("div",{children:(0,b.jsx)(pe,{size:"extra-tiny","aria-label":o.schemaCompare.includeExcludeAllOperationInProgress,className:n.alignSpinner})}):(0,b.jsx)(K,{checked:g==="allIncluded"?!0:g==="mixed"?"mixed":!1,onClick:()=>C(),onKeyDown:L}),renderCell:i=>(0,b.jsx)(ne,{children:(0,b.jsx)(K,{checked:i.included,onClick:()=>O(i,!i.included),disabled:c.state.isIncludeExcludeAllOperationInProgress})})}),oe({columnId:"action",renderHeaderCell:()=>o.schemaCompare.action,renderCell:i=>(0,b.jsx)(ne,{children:(0,b.jsx)(Q,{truncate:!0,className:n.hideTextOverflow,children:R(i.updateAction)})})}),oe({columnId:"targetName",renderHeaderCell:()=>o.schemaCompare.targetName,renderCell:i=>(0,b.jsx)(ne,{children:(0,b.jsx)(Q,{truncate:!0,className:n.hideTextOverflow,children:D(i.targetValue)})})})],k=[];v?.success&&(k=v.differences.map((i,I)=>({position:I,...i})));let L=i=>{i.key===" "&&(C(),i.preventDefault())},X=(i,I)=>{i.key==="Enter"&&(I.position!==void 0&&a(I.position),i.preventDefault())},Z=({item:i,rowId:I},V)=>(0,b.jsx)(xe,{className:i.position===e?n.selectedRow:void 0,style:V,onClick:()=>{i.position!==void 0&&a(i.position)},onKeyDown:M=>X(M,i),children:({renderCell:M})=>(0,b.jsx)(b.Fragment,{children:M(i)})},I),ie={type:{minWidth:100},sourceName:{minWidth:200,defaultWidth:350},include:{minWidth:60,defaultWidth:60},action:{minWidth:100},targetName:{minWidth:200}};return(0,b.jsxs)("div",{className:n.resizableContainer,ref:E,style:{height:`${f}px`},children:[(0,b.jsxs)(Qe,{items:k,columns:A,focusMode:"composite",resizableColumns:!0,columnSizingOptions:ie,getRowId:i=>i.position?.toString()??"",size:"extra-small",children:[(0,b.jsx)(Ge,{className:n.dataGridHeader,children:(0,b.jsx)(xe,{children:({renderHeaderCell:i})=>(0,b.jsx)(Ve,{children:i()})})}),(0,b.jsx)($e,{itemSize:30,height:f-40,width:"100%",children:Z})]}),(0,b.jsx)("div",{...h,className:n.resizer,children:(0,b.jsx)("div",{className:n.resizerHandle})})]})}),ot=Ct;var at=p(q());var J=p(x()),bt=P({layoutVertically:{display:"flex",flexDirection:"column",gap:"2px"},layoutHorizontally:{display:"flex",flexDirection:"row"},inputWidth:{width:"100%",maxWidth:"745px",minwidth:"300px"},buttonLeftSmallMargin:{marginLeft:"8px"}}),vt=a=>{let e=bt();return(0,J.jsxs)("div",{className:ee(e.layoutVertically,e.inputWidth),children:[(0,J.jsx)(W,{htmlFor:a.id,size:a.size,disabled:a.disabled,children:a.label}),(0,J.jsxs)("div",{className:ee(e.layoutHorizontally,a.className??""),children:[(0,J.jsx)(de,{id:a.id,className:e.inputWidth,value:a.value,readOnly:!0}),(0,J.jsx)(j,{size:"small",className:e.buttonLeftSmallMargin,disabled:a.disableBrowseButton,onClick:a.selectFile,"aria-label":a.buttonAriaLabel,children:"..."})]})]})},De=vt;var ae=p(x()),St=P({topMargin:{...Ee.margin("32px","32px","0")},marginRight:{marginRight:"32px"},layoutHorizontally:{display:"flex",flexDirection:"row"},center:{justifyContent:"center"},button:{height:"32px",position:"relative",top:"20px"},buttonLeftMargin:{marginLeft:"32px"}});function nt(a){return(a?.serverName&&a?.databaseName?`${a?.connectionName||a?.serverName}.${a?.databaseName}`:"")||a?.packageFilePath||a?.projectFilePath||""}var yt=({onSelectSchemaClicked:a})=>{let e=te("source"),r=te("target"),t=St(),n=(0,at.useContext)(N),c=n.state.sourceEndpointInfo,v=nt(c),g=n.state.targetEndpointInfo,S=nt(g),E=()=>{n.compare(n.state.sourceEndpointInfo,n.state.targetEndpointInfo,n.state.defaultDeploymentOptionsResult.defaultDeploymentOptions)},f=h=>!(h&&(h.serverDisplayName||h.packageFilePath||h.projectFilePath));return(0,ae.jsxs)("div",{className:ee(t.layoutHorizontally,t.center,t.topMargin),children:[(0,ae.jsx)(De,{id:e,label:o.schemaCompare.source,buttonAriaLabel:o.schemaCompare.selectSourceSchema,value:v,disableBrowseButton:n.state.isComparisonInProgress,selectFile:()=>a("source"),className:t.marginRight}),(0,ae.jsx)(De,{id:r,label:o.schemaCompare.target,buttonAriaLabel:o.schemaCompare.selectTargetSchema,value:S,disableBrowseButton:n.state.isComparisonInProgress,selectFile:()=>a("target")}),(0,ae.jsx)(j,{className:ee(t.button,t.buttonLeftMargin),size:"medium",onClick:E,disabled:f(n.state.sourceEndpointInfo)||f(n.state.targetEndpointInfo)||n.state.isComparisonInProgress,children:o.schemaCompare.compare})]})},rt=yt;var U=p(q());var re=p(x()),xt=P({dividerContainer:{display:"flex",flexDirection:"column",alignItems:"center",justifyItems:"center",minHeight:"36px",backgroundColor:Ie.colorNeutralBackground1},dividerFont:{fontSize:"14px",fontWeight:"bold"},editorContainer:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"}}),we=(a,e)=>{let r="";if(a!==null){let t=it(e?a.sourceScript:a.targetScript);t&&(r+=t+`

`),a.children.forEach(n=>{let c=we(n,e);r+=c})}return r},it=a=>a||"",Dt=(0,U.forwardRef)(({selectedDiffId:a,renderSideBySide:e},r)=>{let t=xt(),n=(0,U.useContext)(N),v=n.state.schemaCompareResult?.differences[a],g=(0,U.useRef)(null),S=v?.sourceScript?we(v,!0):"",E=v?.targetScript?we(v,!1):"",f=h=>{g.current=h};return(0,U.useEffect)(()=>{let h=()=>{g.current&&g.current.layout()};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),(0,re.jsxs)("div",{ref:r,className:t.editorContainer,children:[(0,re.jsx)("div",{className:t.dividerContainer,children:(0,re.jsx)(ze,{className:t.dividerFont,alignContent:"start",children:o.schemaCompare.compareDetails})}),(0,re.jsx)(Je,{height:"100%",language:"sql",original:E,modified:S,theme:Ke(n.themeKind),options:{renderSideBySide:e??!0,renderOverviewRuler:!0,OverviewRulerLane:0,readOnly:!0},onMount:f})]})}),st=Dt;var B=p(q());var s=p(x()),Et=P({drawerWidth:{width:"400px"},fileInputWidth:{width:"300px"},positionItemsHorizontally:{display:"flex",flexDirection:"row"},buttonLeftMargin:{marginLeft:"8px"},footer:{display:"flex",justifyContent:"flex-end"}});function It(a){if(a===void 0)return"";switch(a){case 0:return"database";case 1:return"dacpac";case 2:return"sqlproj";default:return""}}function Ot(a){if(a===void 0)return"";switch(a){case 1:return"File";case 2:return"Flat";case 3:return"Object Type";case 4:return"Schema";case 5:default:return"Schema/Object Type"}}var Rt=a=>{let e=Et(),r=(0,B.useContext)(N),t=a.endpointType==="source"?r.state.sourceEndpointInfo:r.state.targetEndpointInfo,[n,c]=(0,B.useState)(It(t?.endpointType||0)),[v,g]=(0,B.useState)(!0),[S,E]=(0,B.useState)(t?.ownerUri||""),[f,h]=(0,B.useState)(t?.connectionName||t?.serverName||""),[D,O]=(0,B.useState)(t?.databaseName||""),[C,R]=(0,B.useState)(Ot(t?.extractTarget||5)),A=te("file"),k=te("folderStructure"),L=[{value:"File",display:o.schemaCompare.file},{value:"Flat",display:o.schemaCompare.flat},{value:"Object Type",display:o.schemaCompare.objectType},{value:"Schema",display:o.schemaCompare.schema},{value:"Schema/Object Type",display:o.schemaCompare.schemaObjectType}];(0,B.useEffect)(()=>{r.listActiveServers(),t?.ownerUri&&r.listDatabasesForActiveServer(t?.ownerUri)},[]),(0,B.useEffect)(()=>{Z(n)},[r.state.auxiliaryEndpointInfo,S,D]),(0,B.useEffect)(()=>{t?.ownerUri&&t?.databaseName&&(S!==t.ownerUri&&(E(t.ownerUri),h(t.connectionName||t.serverName||"")),D!==t.databaseName&&O(t.databaseName))},[t?.ownerUri,t?.databaseName,t?.connectionName,t?.serverName]);let X=a.endpointType==="source"?o.schemaCompare.selectSource:o.schemaCompare.selectTarget,Z=d=>{d==="database"&&S&&D||d==="dacpac"&&(r.state.auxiliaryEndpointInfo?.packageFilePath||t?.packageFilePath)||d==="sqlproj"&&(r.state.auxiliaryEndpointInfo?.projectFilePath||t?.projectFilePath)?g(!1):g(!0)},ie=()=>{if(n==="dacpac")return r.state.auxiliaryEndpointInfo?.packageFilePath||t?.packageFilePath||"";if(n==="sqlproj")return r.state.auxiliaryEndpointInfo?.projectFilePath||t?.projectFilePath||""},i=d=>{c(d),Z(d)},I=(d,y)=>{y.optionValue&&(E(y.optionValue),h(y.optionText??""),O(""),r.listDatabasesForActiveServer(y.optionValue))},V=(d,y)=>{y.optionValue&&O(y.optionValue)},M=d=>{let y=a.endpointType==="source"?r.state.sourceEndpointInfo:r.state.targetEndpointInfo;r.selectFile(y,a.endpointType,d)},m=(d,y)=>{y.optionValue&&R(y.optionValue)},l=()=>{n==="database"?r.confirmSelectedDatabase(a.endpointType,S,D):r.confirmSelectedSchema(a.endpointType,C),a.showDrawer(!1)},T=r.state.isSqlProjectExtensionInstalled;return(0,s.jsxs)(ue,{separator:!0,open:a.show,onOpenChange:(d,{open:y})=>a.showDrawer(y),position:"end",size:"medium",children:[(0,s.jsx)(he,{children:(0,s.jsx)(ge,{action:(0,s.jsx)(j,{appearance:"subtle","aria-label":o.schemaCompare.close,icon:(0,s.jsx)(se,{}),onClick:()=>a.showDrawer(!1)}),children:X})}),(0,s.jsxs)(fe,{children:[(0,s.jsx)(He,{label:o.schemaCompare.type,children:(0,s.jsxs)(Ae,{value:n,onChange:(d,y)=>i(y.value),children:[(0,s.jsx)(me,{value:"database",label:o.schemaCompare.database}),(0,s.jsx)(me,{value:"dacpac",label:o.schemaCompare.dataTierApplicationFile}),T&&(0,s.jsx)(me,{value:"sqlproj",label:o.schemaCompare.databaseProject})]})}),n==="database"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{children:o.schemaCompare.server}),(0,s.jsxs)("div",{className:e.positionItemsHorizontally,children:[(0,s.jsx)(le,{className:e.fileInputWidth,value:f,selectedOptions:[S],onOptionSelect:(d,y)=>I(d,y),children:Object.keys(r.state.activeServers).map(d=>(0,s.jsx)(ce,{value:d,children:r.state.activeServers[d].profileName||r.state.activeServers[d].server},d))}),(0,s.jsx)(j,{className:e.buttonLeftMargin,size:"large","aria-label":o.schemaCompare.addServerConnection,icon:(0,s.jsx)(je,{}),onClick:()=>{r.openAddNewConnectionDialog(a.endpointType)}})]}),(0,s.jsx)(W,{children:o.schemaCompare.database}),(0,s.jsx)("div",{children:(0,s.jsx)(le,{className:e.fileInputWidth,value:D,selectedOptions:[D],onOptionSelect:(d,y)=>V(d,y),children:r.state.databases.map(d=>(0,s.jsx)(ce,{value:d,children:d},d))})})]}),(n==="dacpac"||n==="sqlproj")&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{htmlFor:A,children:o.schemaCompare.file}),(0,s.jsxs)("div",{className:e.positionItemsHorizontally,children:[(0,s.jsx)(de,{id:A,size:a.size,disabled:a.disabled,className:e.fileInputWidth,value:ie(),readOnly:!0}),(0,s.jsx)(j,{className:e.buttonLeftMargin,size:"large",icon:(0,s.jsx)(Ne,{}),onClick:()=>M(n)})]}),a.endpointType==="target"&&n==="sqlproj"&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{htmlFor:k,children:o.schemaCompare.folderStructure}),(0,s.jsx)("div",{children:(0,s.jsx)(le,{id:k,className:e.fileInputWidth,value:C,selectedOptions:[C],onOptionSelect:(d,y)=>m(d,y),children:L.map(d=>(0,s.jsx)(ce,{children:d.display},d.value))})})]})]})]}),(0,s.jsxs)(Ce,{children:[(0,s.jsx)(j,{disabled:v,appearance:"primary",onClick:()=>l(),children:o.schemaCompare.ok}),(0,s.jsx)(j,{appearance:"secondary",onClick:()=>a.showDrawer(!1),children:o.schemaCompare.cancel})]})]})},ct=Rt;var be=p(q());var w=p(x()),kt=a=>{let e=(0,be.useContext)(N);(0,be.useEffect)(()=>{e.state.endpointsSwitched&&e.state.sourceEndpointInfo&&e.state.targetEndpointInfo&&r()},[e.state.endpointsSwitched]);let r=()=>{e.compare(e.state.sourceEndpointInfo,e.state.targetEndpointInfo,e.state.defaultDeploymentOptionsResult.defaultDeploymentOptions)},t=()=>{e.cancel()},n=()=>{e.generateScript(e.state.targetEndpointInfo.serverName,e.state.targetEndpointInfo.databaseName)},c=()=>{e.publishChanges(e.state.targetEndpointInfo.serverName,e.state.targetEndpointInfo.databaseName)},v=()=>{a.onOptionsClicked()},g=()=>{e.switchEndpoints(e.state.targetEndpointInfo,e.state.sourceEndpointInfo)},S=()=>{e.openScmp()},E=()=>{e.saveScmp()},f=C=>!(C&&(C.serverDisplayName||C.packageFilePath||C.projectFilePath)),h=()=>e.state.schemaCompareResult.differences.some(C=>C.included),D=()=>{if(e.state.targetEndpointInfo&&Number(e.state.targetEndpointInfo.endpointType)===0){if(e.state.isComparisonInProgress)return!0;if(e.state.schemaCompareResult===void 0||e.state.schemaCompareResult.differences.length===0)return!0}else return!0;return!h()},O=()=>e.state.schemaCompareResult&&e.state.schemaCompareResult.differences&&e.state.schemaCompareResult.differences.length>0&&Number(e.state.targetEndpointInfo.endpointType)!==1?!h():!0;return(0,w.jsxs)(qe,{children:[(0,w.jsx)(_,{"aria-label":o.schemaCompare.compare,title:o.schemaCompare.compare,icon:(0,w.jsx)(Re,{}),onClick:r,disabled:f(e.state.sourceEndpointInfo)||f(e.state.targetEndpointInfo)||e.state.isComparisonInProgress,children:o.schemaCompare.compare}),(0,w.jsx)(_,{"area-label":o.schemaCompare.stop,title:o.schemaCompare.stop,icon:(0,w.jsx)(Be,{}),onClick:t,disabled:!e.state.isComparisonInProgress,children:o.schemaCompare.stop}),(0,w.jsx)(_,{"aria-label":o.schemaCompare.generateScript,title:o.schemaCompare.generateScriptToDeployChangesToTarget,icon:(0,w.jsx)(Te,{}),onClick:n,disabled:D(),children:o.schemaCompare.generateScript}),(0,w.jsx)(_,{"aria-label":o.schemaCompare.apply,title:o.schemaCompare.applyChangesToTarget,icon:(0,w.jsx)(Pe,{}),onClick:c,disabled:e.state.isComparisonInProgress||O(),children:o.schemaCompare.apply}),(0,w.jsx)(_,{"aria-label":o.schemaCompare.options,title:o.schemaCompare.options,icon:(0,w.jsx)(Le,{}),onClick:v,disabled:e.state.isComparisonInProgress||f(e.state.sourceEndpointInfo)||f(e.state.targetEndpointInfo),children:o.schemaCompare.options}),(0,w.jsx)(ye,{}),(0,w.jsx)(_,{"aria-label":o.schemaCompare.switchDirection,title:o.schemaCompare.switchSourceAndTarget,icon:(0,w.jsx)(Oe,{}),onClick:g,disabled:e.state.isComparisonInProgress||f(e.state.sourceEndpointInfo)&&f(e.state.targetEndpointInfo),children:o.schemaCompare.switchDirection}),(0,w.jsx)(ye,{}),(0,w.jsx)(_,{"aria-label":o.schemaCompare.openScmpFile,title:o.schemaCompare.loadSourceTargetAndOptionsSavedInAnScmpFile,icon:(0,w.jsx)(ke,{}),onClick:S,disabled:e.state.isComparisonInProgress,children:o.schemaCompare.openScmpFile}),(0,w.jsx)(_,{"aria-label":o.schemaCompare.saveScmpFile,title:o.schemaCompare.saveSourceAndTargetOptionsAndExcludedElements,icon:(0,w.jsx)(Fe,{}),onClick:E,disabled:e.state.isComparisonInProgress||f(e.state.sourceEndpointInfo)||f(e.state.targetEndpointInfo),children:o.schemaCompare.saveScmpFile})]})},lt=kt;var Y=p(q());var u=p(x()),Tt=P({drawerBody:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},searchContainer:{margin:"10px 0",width:"100%"},tabContainer:{flexShrink:0},tabContentContainer:{display:"flex",flexDirection:"column",flex:1,minHeight:0,overflow:"hidden"},masterCheckboxContainer:{margin:"10px 0",borderBottom:"1px solid var(--colorNeutralStroke2)",marginBottom:"0px",backgroundColor:"var(--colorNeutralBackground2)",position:"sticky",top:0,zIndex:1,flexShrink:0},masterCheckbox:{fontWeight:"600",fontSize:"14px"},scrollableList:{flex:1,overflowY:"auto",minHeight:0,paddingTop:"8px",width:"100%"},listItemContainer:{display:"flex",alignItems:"center"}}),Nt=a=>{let e=Tt(),r=(0,Y.useContext)(N),[t,n]=(0,Y.useState)(!1),[c,v]=(0,Y.useState)("generalOptions"),[g,S]=(0,Y.useState)("");(0,Y.useEffect)(()=>{r.setIntermediarySchemaOptions()},[]);let E=r.state.intermediaryOptionsResult?.defaultDeploymentOptions,f=E?.booleanOptionsDictionary,h=[];f&&(h=Object.entries(f),h.sort(([m,l],[T,d])=>l.displayName.toLowerCase().localeCompare(d.displayName.toLowerCase())));let D=E?.objectTypesDictionary,O=[];D&&(O=Object.entries(D),O.sort(([m,l],[T,d])=>m.toLowerCase().localeCompare(T.toLowerCase())));let C=h.filter(([m,l])=>g===""||l.displayName.toLowerCase().includes(g.toLowerCase())),R=O.filter(([m,l])=>g===""||l.toLowerCase().includes(g.toLowerCase())),A=(m,l)=>{v(l.value)},k=m=>{r.intermediaryGeneralOptionsChanged(m),n(!0)},L=m=>{r.intermediaryIncludeObjectTypesOptionsChanged(m),n(!0)},X=m=>E.excludeObjectTypes.value?.find(T=>T.toLowerCase()===m.toLowerCase())===void 0,Z=()=>{if(!f||C.length===0)return{checked:!1,indeterminate:!1};let m=C.filter(([l,T])=>T.value).length;return m===0?{checked:!1,indeterminate:!1}:m===C.length?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}},ie=()=>{if(!D||R.length===0)return{checked:!1,indeterminate:!1};let m=R.filter(([l,T])=>X(l)).length;return m===0?{checked:!1,indeterminate:!1}:m===R.length?{checked:!0,indeterminate:!1}:{checked:!1,indeterminate:!0}},i=m=>{let l=C.map(([T,d])=>T);r.intermediaryGeneralOptionsBulkChanged(l,m),n(!0)},I=m=>{let l=R.map(([T,d])=>T);r.intermediaryIncludeObjectTypesBulkChanged(l,m),n(!0)},V=Z(),M=ie();return(0,u.jsxs)(ue,{separator:!0,open:a.show,onOpenChange:(m,{open:l})=>a.showDrawer(l),position:"end",size:"medium",children:[(0,u.jsx)(he,{children:(0,u.jsx)(ge,{action:(0,u.jsx)(j,{appearance:"subtle","aria-label":o.schemaCompare.close,icon:(0,u.jsx)(se,{}),onClick:()=>a.showDrawer(!1)}),children:o.schemaCompare.schemaCompareOptions})}),(0,u.jsxs)(fe,{className:e.drawerBody,children:[(0,u.jsx)(_e,{className:e.searchContainer,placeholder:o.schemaCompare.searchOptions,value:g,onChange:(m,l)=>S(l.value)}),(0,u.jsxs)(Me,{className:e.tabContainer,selectedValue:c,onTabSelect:A,children:[(0,u.jsx)(Se,{id:"GeneralOptions",value:"generalOptions",children:o.schemaCompare.generalOptions}),(0,u.jsx)(Se,{id:"IncludeObjectTypes",value:"includeObjectTypes",children:o.schemaCompare.includeObjectTypes})]}),c==="generalOptions"&&(0,u.jsxs)("div",{className:e.tabContentContainer,children:[f&&C.length>0&&(0,u.jsx)("div",{className:e.masterCheckboxContainer,children:(0,u.jsx)(K,{className:e.masterCheckbox,checked:V.indeterminate?"mixed":V.checked,onChange:(m,l)=>{let T=l.checked==="mixed"?!0:!!l.checked;i(T)},label:o.schemaCompare.selectAllOptions})}),(0,u.jsx)("div",{className:e.scrollableList,children:f&&C.map(([m,l])=>(0,u.jsx)("div",{className:e.listItemContainer,children:(0,u.jsx)(K,{checked:l.value,onChange:()=>k(m),label:(0,u.jsx)(We,{"aria-label":l.displayName,info:(0,u.jsx)(u.Fragment,{children:l.description}),children:l.displayName})})},m))})]}),c==="includeObjectTypes"&&(0,u.jsxs)("div",{className:e.tabContentContainer,children:[D&&R.length>0&&(0,u.jsx)("div",{className:e.masterCheckboxContainer,children:(0,u.jsx)(K,{className:e.masterCheckbox,checked:M.indeterminate?"mixed":M.checked,onChange:(m,l)=>{let T=l.checked==="mixed"?!0:!!l.checked;I(T)},label:o.schemaCompare.includeAllObjectTypes})}),(0,u.jsx)("div",{className:e.scrollableList,children:D&&R.map(([m,l])=>(0,u.jsx)("div",{className:e.listItemContainer,children:(0,u.jsx)(K,{checked:X(m),onChange:()=>L(m),label:(0,u.jsx)(W,{"aria-label":l,children:l})})},m))})]})]}),(0,u.jsxs)(Ce,{children:[(0,u.jsx)(j,{appearance:"secondary",onClick:()=>r.resetOptions(),children:o.schemaCompare.reset}),(0,u.jsx)(j,{appearance:"primary",onClick:()=>{r.confirmSchemaOptions(t),a.showDrawer(!1)},children:o.schemaCompare.ok}),(0,u.jsx)(j,{appearance:"secondary",onClick:()=>a.showDrawer(!1),children:o.schemaCompare.cancel})]})]})},dt=Nt;var mt=p(q());var $=p(x()),Pt=P({container:{marginTop:"32px",display:"flex",gap:"16px",flexDirection:"column",alignItems:"stretch"}}),jt=()=>{let e=(0,mt.useContext)(N).state,r=Pt(),t="";return!e.isComparisonInProgress&&e.schemaCompareResult&&e.schemaCompareResult.areEqual?t=o.schemaCompare.noDifferences:e.isComparisonInProgress?t=o.schemaCompare.initializingComparison:!e.isComparisonInProgress&&!e.schemaCompareResult&&(t=o.schemaCompare.intro),t?(0,$.jsxs)("div",{className:r.container,children:[e.isComparisonInProgress&&(0,$.jsx)(pe,{labelPosition:"below",label:t}),!e.isComparisonInProgress&&(0,$.jsx)(Q,{size:400,align:"center",children:t})]}):(0,$.jsx)($.Fragment,{})},pt=jt;var H=p(x()),Ft=P({container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},contentContainer:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden",position:"relative"},resizableContainer:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden",position:"relative"}}),ut=()=>{let a=Ft(),e=(0,z.useContext)(N),[r,t]=(0,z.useState)(0),[n,c]=(0,z.useState)(!1),[v,g]=(0,z.useState)(!1),[S,E]=(0,z.useState)("source"),f=(0,z.useRef)(null),h=(0,z.useRef)(null);(0,z.useEffect)(()=>{e.isSqlProjectExtensionInstalled()},[]);let D=L=>{c(!0),E(L)},O=L=>{t(L)},C=L=>{c(L)},R=()=>{g(!0)},A=L=>{g(L)},k=()=>!!(!e.state.schemaCompareResult||e.state.schemaCompareResult.areEqual||e.state.isComparisonInProgress);return(0,H.jsxs)("div",{className:a.container,children:[(0,H.jsx)(lt,{onOptionsClicked:R}),(0,H.jsx)(rt,{onSelectSchemaClicked:D}),k()&&(0,H.jsx)(pt,{}),!k()&&(0,H.jsx)("div",{className:a.contentContainer,children:(0,H.jsxs)("div",{className:a.resizableContainer,children:[(0,H.jsx)(ot,{ref:f,selectedDiffId:r,onDiffSelected:O,siblingRef:h}),r!==-1&&(0,H.jsx)(st,{ref:h,selectedDiffId:r})]})}),n&&(0,H.jsx)(ct,{show:n,endpointType:S,showDrawer:C}),v&&(0,H.jsx)(dt,{show:v,showDrawer:A})]})};var ve=p(x());ft.default.createRoot(document.getElementById("root")).render((0,ve.jsx)(Ue,{children:(0,ve.jsx)(Ze,{children:(0,ve.jsx)(ut,{})})}));
