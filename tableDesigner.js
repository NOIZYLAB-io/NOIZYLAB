import{a as Bt}from"./chunk-5FDIEALQ.js";import{a as ve,b as ke,c as Ne,d as kt}from"./chunk-EKO4BB2A.js";import"./chunk-2F3NDXUU.js";import{a as Rt,b as St}from"./chunk-FOF4SQ2Y.js";import{a as De}from"./chunk-FFE62TXH.js";import{a as yt,b as It}from"./chunk-W5RJDKNB.js";import{$b as j,A as Ke,Bb as st,Cb as be,E as $e,Ea as Je,Ga as Qe,Lc as xt,Ma as Ze,Nb as Z,Nc as Ct,Oc as wt,P as je,Pb as at,Pc as he,Q as Xe,Qa as et,Qb as lt,Rb as ee,Ub as pt,Va as tt,Vb as dt,Wb as te,Xb as ce,Y as $,Yb as ct,Zb as ut,_b as mt,ac as fe,bd as m,c as u,cd as Jt,d as N,dc as gt,ec as bt,f as Yt,fc as ue,gc as ft,h as L,hc as Be,ia as qe,ic as ht,j as A,jc as Dt,k as z,kc as vt,lc as Pt,ma as Ye,mb as rt,n as He,nb as ot,ob as nt,p as C,q as Fe,sd as Tt,t as Oe,tb as w,u as Ue,vb as it,w as _e,wb as H,xb as ge,z as Ge}from"./chunk-M3U674VW.js";var Kt=u(Yt());var re=u(Jt());var ze;(e=>e.type=new re.NotificationType("scriptAsCreate"))(ze||={});var Ee;(e=>e.type=new re.NotificationType("copyScriptAsCreateToClipboard"))(Ee||={});var Ae;(e=>e.type=new re.NotificationType("closeDesigner"))(Ae||={});var Me;(e=>e.type=new re.NotificationType("copyPublishErrorToClipboard"))(Me||={});var We;(e=>e.type=new re.NotificationType("initializeTableDesigner"))(We||={});var M=u(N()),zt=u(C()),I=(0,M.createContext)(void 0),Nt=({children:t})=>{let e=It(),[r,l]=(0,M.useState)(300),[v,o]=(0,M.useState)(!1),[a,i]=(0,M.useState)(300),[P,x]=(0,M.useState)(450),[b,s]=(0,M.useState)(!1),[f,y]=(0,M.useState)(450),d=(0,M.useRef)({}),c=e?.state,h=(0,M.useRef)(null);function E(B){return`${c.tableInfo?.id}_${B.join("_")}`}return(0,zt.jsx)(I.Provider,{value:{...Tt(e),processTableEdit:function(B){e?.extensionRpc.action("processTableEdit",{table:c.tableInfo,tableChangeInfo:B})},publishChanges:function(){e?.extensionRpc.action("publishChanges",{table:c.tableInfo})},generateScript:function(){e?.extensionRpc.action("generateScript",{table:c.tableInfo})},generatePreviewReport:function(){e?.extensionRpc.action("generatePreviewReport",{table:c.tableInfo})},initializeTableDesigner:function(){e?.extensionRpc.sendNotification(We.type)},scriptAsCreate:function(){e?.extensionRpc.sendNotification(ze.type,{script:c.model.script.value??""})},copyScriptAsCreateToClipboard:function(){e?.extensionRpc.sendNotification(Ee.type,{script:c.model.script.value??""})},setTab:function(B){e?.extensionRpc.action("setTab",{tabId:B})},getComponentId:E,getErrorMessage:function(B){let G=B.join("."),K=[];for(let F of c.issues??[])F.propertyPath&&F.propertyPath?.join(".")===G&&K.push(F.description);if(K.length!==0)return K.join(`
`)??""},setPropertiesComponents:function(B){e?.extensionRpc.action("setPropertiesComponents",{components:B})},setResultTab:function(B){e?.extensionRpc.action("setResultTab",{tabId:B})},closeDesigner:function(){e?.extensionRpc.sendNotification(Ae.type)},continueEditing:function(){e?.extensionRpc.action("continueEditing",{})},copyPublishErrorToClipboard:function(){e?.extensionRpc.sendNotification(Me.type,{error:c.publishingError??""})},state:e?.state,themeKind:e?.themeKind,keyBindings:e?.keyBindings,resultPaneResizeInfo:{originalHeight:a,setOriginalHeight:i,isMaximized:v,setIsMaximized:o,currentHeight:r,setCurrentHeight:l},propertiesPaneResizeInfo:{originalWidth:f,setOriginalWidth:y,isMaximized:b,setIsMaximized:s,currentWidth:P,setCurrentWidth:x},elementRefs:d,addElementRef:function(B,G,K){let F=E(B);if(!(K==="PropertiesView"&&d.current[F]))return d.current[F]=G},toggleDefinitionPane:function(){h.current&&(h.current.isCollapsed()?h.current.openPanel(25):h.current.closePanel())},definitionPaneRef:h},children:t})};var J=u(N());var At=u(N());var Pe=u(N());var n=u(C()),Zt=z({dialogSurface:{width:"800px",maxWidth:"800px"},errorIcon:{fontSize:"100px",opacity:.5,color:"var(--vscode-errorForeground)"},dialogFooterButtons:{marginTop:"10px"}}),Et=()=>{let t=(0,Pe.useContext)(I),e=St(),r=Zt();if(!t)return null;let[l,v]=(0,Pe.useState)(!1),o=t.state,a=()=>{switch(o?.apiState?.generateScriptState){case"Loading":return(0,n.jsx)(Z,{size:"extra-small"});case"Error":return(0,n.jsx)($,{});default:return}},i=()=>(0,n.jsx)(te,{disableButtonEnhancement:!0,children:(0,n.jsx)(w,{appearance:"secondary",onClick:()=>v(!1),children:m.common.close})}),P=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(j,{children:(0,n.jsx)(Z,{label:m.tableDesigner.publishingChanges,labelPosition:"below"})})}),x=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j,{children:(0,n.jsxs)(xt,{intent:"error",style:{paddingRight:"12px"},children:[(0,n.jsx)(wt,{style:{textAlign:"justify"},children:o?.publishingError??""}),(0,n.jsx)(Ct,{children:(0,n.jsx)(w,{onClick:()=>t.copyPublishErrorToClipboard(),icon:(0,n.jsx)(je,{}),children:m.tableDesigner.copy})})]})}),(0,n.jsxs)(ce,{children:[(0,n.jsx)(w,{appearance:"primary",onClick:()=>{t.publishChanges()},children:m.tableDesigner.retry}),(0,n.jsx)(w,{onClick:()=>{v(!1),t.generatePreviewReport()},style:{width:"150px"},children:m.tableDesigner.backToPreview}),i()]})]}),b=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(j,{children:[(0,n.jsx)($e,{style:{width:"50px",height:"50px",marginBottom:8}}),(0,n.jsx)("div",{children:m.tableDesigner.changesPublishedSuccessfully})]}),(0,n.jsxs)(ce,{children:[(0,n.jsx)(te,{action:"close",children:(0,n.jsx)(w,{size:"medium",appearance:"secondary",onClick:()=>{v(!1),t.continueEditing()},children:m.tableDesigner.continueEditing})}),(0,n.jsx)(w,{size:"medium",appearance:"secondary",onClick:t.closeDesigner,children:m.common.close})]})]}),s=()=>(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(j,{children:(0,n.jsx)(Z,{label:m.tableDesigner.loadingPreviewReport,labelPosition:"below"})})}),f=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(j,{children:[(0,n.jsx)($,{className:r.errorIcon}),(0,n.jsx)("div",{children:t.state.generatePreviewReportResult?.schemaValidationError??m.tableDesigner.errorLoadingPreview})]}),(0,n.jsxs)(ce,{children:[(0,n.jsx)(te,{action:"close",children:(0,n.jsx)(w,{className:r.dialogFooterButtons,children:m.common.close})}),(0,n.jsx)(w,{className:r.dialogFooterButtons,onClick:()=>{t.generatePreviewReport()},children:m.tableDesigner.retry})]})]}),y=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(j,{children:(0,n.jsxs)("div",{style:{width:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[(0,n.jsx)("div",{className:e.markdownPage,children:(0,n.jsx)(Bt,{children:o?.generatePreviewReportResult?.report})}),(0,n.jsx)(ge,{style:{margin:"5px"},label:m.publishDialog.confirmationText,required:!0,checked:l,onChange:(c,h)=>{v(h.checked)},autoFocus:!0,onFocus:c=>{c.target.parentElement&&(c.target.parentElement.style.outlineStyle="solid",c.target.parentElement.style.outlineColor="var(--vscode-focusBorder)")},onBlur:c=>{c.target.parentElement&&(c.target.parentElement.style.outline="none",c.target.parentElement.style.outlineColor="")}})]})}),(0,n.jsxs)(ce,{children:[(0,n.jsx)(w,{disabled:!l,title:l?m.publishDialog.publish:m.tableDesigner.youMustReviewAndAccept,appearance:"primary",onClick:()=>{t.publishChanges()},children:m.publishDialog.publish}),(0,n.jsx)(te,{action:"close",children:(0,n.jsx)(w,{icon:a(),iconPosition:"after",disabled:o.apiState?.previewState!=="Loaded",appearance:"secondary",onClick:t.generateScript,children:m.publishDialog.openPublishScript})}),i()]})]}),d=()=>{if(o?.apiState?.publishState==="Loading")return P();if(o?.apiState?.publishState==="Loaded")return b();if(o?.apiState?.publishState==="Error")return x();if(o?.apiState?.previewState==="Loading")return s();if(o?.apiState?.previewState==="Error")return f();if(o?.apiState?.previewState==="Loaded")return y()};return(0,n.jsxs)(dt,{inertTrapFocus:!0,children:[(0,n.jsx)(te,{disableButtonEnhancement:!0,children:(0,n.jsx)(w,{size:"small",appearance:"subtle","aria-label":m.tableDesigner.publish,title:m.tableDesigner.publish,icon:(0,n.jsx)(et,{}),onClick:()=>{t.generatePreviewReport()},disabled:(o?.issues?.length??0)>0,children:m.publishDialog.publishChanges})}),(0,n.jsx)(mt,{className:r.dialogSurface,children:(0,n.jsxs)(ct,{children:[(0,n.jsx)(ut,{children:m.publishDialog.publishChanges}),d()]})})]})};var U=u(C()),er=z({separator:{...A.margin("0px","-20px","0px","0px"),...A.padding("0px"),fontSize:"5px"}}),Mt=()=>{let t=(0,At.useContext)(I),e=er();if(t)return(0,U.jsxs)("div",{children:[(0,U.jsxs)(fe,{size:"small",style:{paddingTop:"5px",paddingBottom:"5px"},children:[(0,U.jsx)(Et,{}),(0,U.jsx)(w,{size:"small",appearance:"subtle",icon:(0,U.jsx)(Ze,{}),title:m.schemaDesigner.definition,onClick:()=>t.toggleDefinitionPane(),children:m.schemaDesigner.definition})]}),(0,U.jsx)(st,{className:e.separator})]})};var Y=u(N());var Vt=u(N());var oe=u(N());var xe=u(C()),ne=({component:t,model:e,componentPath:r,UiArea:l,showLabel:v=!0})=>{let[o,a]=(0,oe.useState)(e.checked),i=(0,oe.useContext)(I);if(i)return(0,oe.useEffect)(()=>{a(e.checked)},[e]),(0,xe.jsx)(H,{size:"small",label:v?(0,xe.jsx)(it,{size:"small",style:{lineHeight:"16px"},children:t.componentProperties.title}):void 0,orientation:"horizontal",style:{width:t.componentProperties.width??l==="PropertiesView"?"100%":"400px"},children:(0,xe.jsx)(ge,{ref:P=>i.addElementRef(r,P,l),checked:o,onChange:async(P,x)=>{e.enabled!==!1&&await i.processTableEdit({path:r,value:x.checked,type:2,source:l})},size:"medium",disabled:e.enabled===void 0?!1:!e.enabled})})};var se=u(N());var ie=u(C()),X=({component:t,model:e,componentPath:r,UiArea:l,multiline:v=!1,showLabel:o=!0,showError:a=!0,horizontal:i=!1})=>{let[P,x]=(0,se.useState)(e.value),b=(0,se.useContext)(I);if(!b)return;let s=He(b.getComponentId(r)??""),f=l==="PropertiesView"?"100%":t.componentProperties.width??"400px";return(0,se.useEffect)(()=>{x(e.value)},[e]),(0,ie.jsx)(H,{label:o?{children:(0,ie.jsx)(he,{size:"small",info:t.description,children:t.componentProperties.title})}:void 0,validationState:b.getErrorMessage(r)?"error":void 0,validationMessage:a?b.getErrorMessage(r):void 0,validationMessageIcon:a&&b.getErrorMessage(r)?(0,ie.jsx)($,{}):void 0,style:{width:f},size:"small",orientation:i?"horizontal":"vertical",children:v?(0,ie.jsx)(pt,{"aria-labelledby":s,ref:y=>b.addElementRef(r,y,l),value:P??"",onChange:(y,d)=>{x(d.value??"")},onBlur:async()=>{P!==e.value&&await b?.processTableEdit({path:r,value:P,type:2,source:l})},disabled:e.enabled===void 0?!1:!e.enabled,size:"small"}):(0,ie.jsx)(be,{"aria-labelledby":s,ref:y=>b.addElementRef(r,y,l),value:P??"",onChange:(y,d)=>{x(d.value??"")},onBlur:async()=>{P!==e.value&&await b.processTableEdit({path:r,value:P,type:2,source:l})},disabled:e.enabled===void 0?!1:!e.enabled,type:e.inputType,size:"small"})})};var ae=u(N());var we=u(C()),le=({component:t,model:e,componentPath:r,UiArea:l,showLabel:v=!0,showError:o=!0,horizontal:a=!1})=>{let[i,P]=(0,ae.useState)([]),x=(0,ae.useContext)(I);if(!x)return;let b=l==="PropertiesView"?"100%":t.componentProperties.width??"350px";return(0,ae.useEffect)(()=>{P([e.value])},[e]),(0,we.jsx)(H,{label:v?{children:(0,we.jsx)(he,{size:"small",info:t.description,children:t.componentProperties.title})}:void 0,validationState:o&&x.getErrorMessage(r)?"error":void 0,validationMessage:o?x.getErrorMessage(r):"",style:{width:b},size:"small",orientation:a?"horizontal":"vertical",children:(0,we.jsx)(De,{style:{width:b,minWidth:b,maxWidth:b,height:"100%",border:x.getErrorMessage(r)?"1px solid var(--vscode-errorForeground)":void 0},options:e.values.sort((s,f)=>s.localeCompare(f)).map(s=>({text:s,value:s})),onSelect:s=>{e.enabled!==!1&&x.processTableEdit({path:r,value:s.value.toString(),type:2,source:l})},size:"small",selectedOption:{value:i[0]},ariaLabel:t.componentProperties.title})})};var _=u(N());var g=u(C()),Wt=u(N()),rr=z({tableCell:{display:"flex",flexDirection:"row"},tableCellContent:{width:"100%","& > *":{width:"100% !important"},"& input, & [role='combobox'], & textarea":{width:"100% !important",minWidth:"auto !important",maxWidth:"none !important"}},tableActionIcon:{height:"14px",width:"14px"},tableHeaderCellText:{textAlign:"center",width:"100%"},tableCellButton:{height:"100%"},table:{border:"1px solid var(--vscode-panel-border)",borderCollapse:"collapse"},tableHeaderCell:{borderRight:"1px solid var(--vscode-panel-border)",borderBottom:"1px solid var(--vscode-panel-border)","&:last-child":{borderRight:"none"}},tableCellWithBorder:{borderRight:"1px solid var(--vscode-panel-border)",borderBottom:"1px solid var(--vscode-panel-border)","&:last-child":{borderRight:"none"}},tableCellWithErrorFirst:{borderLeft:"1px solid var(--vscode-errorForeground) !important",borderBottom:"1px solid var(--vscode-errorForeground) !important",borderRight:"1px solid var(--vscode-panel-border)",boxShadow:"inset 0 1px 0 0 var(--vscode-errorForeground)","&:last-child":{borderRight:"1px solid var(--vscode-errorForeground) !important"}},tableCellWithErrorMiddle:{borderBottom:"1px solid var(--vscode-errorForeground) !important",borderRight:"1px solid var(--vscode-panel-border)",boxShadow:"inset 0 1px 0 0 var(--vscode-errorForeground)","&:last-child":{borderRight:"1px solid var(--vscode-errorForeground) !important"}},tableCellWithErrorLast:{borderBottom:"1px solid var(--vscode-errorForeground) !important",borderRight:"1px solid var(--vscode-errorForeground) !important",boxShadow:"inset 0 1px 0 0 var(--vscode-errorForeground)"}}),Te=({component:t,model:e,componentPath:r,UiArea:l})=>{let v=Fe({axis:"grid"}),o=t.componentProperties,a=(0,_.useContext)(I);if(!a)return;let i=rr(),P=L("Move Up"),x=L("Move Down"),b=o.columns.map(p=>{let D=o.itemProperties?.find(S=>S.propertyName===p);return ue({columnId:p,renderHeaderCell:()=>(0,g.jsx)(ee,{className:i.tableHeaderCellText,children:D?.componentProperties.title??p})})});l!=="PropertiesView"&&b.push(ue({columnId:"properties",renderHeaderCell:()=>(0,g.jsx)(g.Fragment,{})})),o.canMoveRows&&b.unshift(ue({columnId:"dragHandle",renderHeaderCell:()=>(0,g.jsx)(g.Fragment,{})})),o.canRemoveRows&&b.push(ue({columnId:"remove",renderHeaderCell:()=>{let p=L("Delete");return(0,g.jsx)(g.Fragment,{children:p})}}));let s=e.data?.map(p=>p)??[],[f]=(0,_.useState)(b),y=()=>{let p={};return o.columns.forEach(D=>{let S=o.itemProperties?.find(W=>W.propertyName===D);S&&(p[D]={minWidth:S?.componentProperties.width??70,idealWidth:S?.componentProperties.width??70,defaultWidth:S?.componentProperties.width??70})}),l!=="PropertiesView"&&(p.properties={minWidth:24,idealWidth:24,defaultWidth:24}),o.canMoveRows&&(p.dragHandle={minWidth:15,idealWidth:15,defaultWidth:15}),o.canRemoveRows&&(p.remove={minWidth:35,idealWidth:35,defaultWidth:35}),p},[d]=(0,_.useState)(y()),{getRows:c,columnSizing_unstable:h,tableRef:E}=bt({columns:f,items:s},[gt({columnSizingOptions:d,autoFitColumns:!1,containerWidthOffset:20})]),B=c(),G=(p,D)=>{a.processTableEdit({type:3,path:[...r,p],value:D,source:l});let S=a?.getComponentId([...r,D,f[1].columnId]);a.elementRefs.current[S]?.focus()},K=p=>a?.state.issues?.find(S=>S.propertyPath?S.propertyPath.join(".")===[...r,p].join("."):!1)?.description??void 0,F=(p,D,S)=>{if(!p)return i.tableCellWithBorder;let W=D===0,O=D===S-1;return W?i.tableCellWithErrorFirst:O?i.tableCellWithErrorLast:i.tableCellWithErrorMiddle},$t=p=>(0,g.jsx)(w,{appearance:"subtle",size:"small",className:i.tableCellButton,icon:(0,g.jsx)(qe,{}),draggable:!0,onDragEnter:()=>{Re(p)},onDragEnd:()=>{Q===-1||me===-1||(G(Q,me),Ie(-1),Re(-1))},onDrag:()=>{Ie(p)},onDragStart:()=>{Re(-1),Ie(p)}}),jt=p=>(0,g.jsx)(w,{disabled:p.item.canBeDeleted?!p.item.canBeDeleted:!1,appearance:"subtle",size:"small",className:i.tableCellButton,icon:(0,g.jsx)(Xe,{}),onClick:async()=>{a.processTableEdit({path:[...r,p.rowId],source:l,type:1,value:void 0})},title:m.tableDesigner.remove(o.objectTypeDisplayName)}),Xt=(p,D)=>(0,g.jsx)(w,{appearance:"subtle",size:"small",className:i.tableCellButton,icon:(0,g.jsx)(Ye,{}),title:m.tableDesigner.propertiesPaneTitle(o.objectTypeDisplayName??""),onClick:()=>{a?.setPropertiesComponents({componentPath:[...r,p.rowId],component:t,model:e}),Le(D)}}),qt=(p,D,S)=>{let W=o.itemProperties?.find(de=>de.propertyName===D),O=p.item[D];switch(D){case"dragHandle":return $t(S);case"remove":return jt(p);case"properties":return Xt(p,S);default:switch(W?.componentType){case"input":return(0,g.jsx)("div",{className:i.tableCell,style:{width:"100%"},children:(0,g.jsx)("div",{className:i.tableCellContent,children:(0,g.jsx)(X,{component:W,model:O,componentPath:[...r,p.rowId,D],UiArea:l,showLabel:!1,showError:!1})})});case"dropdown":return(0,g.jsx)("div",{className:i.tableCell,style:{width:"100%"},children:(0,g.jsx)("div",{className:i.tableCellContent,children:(0,g.jsx)(le,{component:W,model:O,componentPath:[...r,p.rowId,D],UiArea:"TabsView",showLabel:!1,showError:!1})})});case"checkbox":return(0,g.jsx)("div",{className:i.tableCell,style:{width:"100%"},children:(0,g.jsx)("div",{className:i.tableCellContent,children:(0,g.jsx)(ne,{component:W,model:O,componentPath:[...r,p.rowId,D],UiArea:l,showLabel:!1})})});default:return"Unknown component type"}}},[Q,Ie]=(0,_.useState)(-1),[me,Re]=(0,_.useState)(-1),[V,Le]=(0,_.useState)(void 0);return(0,g.jsxs)("div",{children:[(0,g.jsxs)(fe,{size:"small",children:[o.canAddRows&&(0,g.jsx)(w,{appearance:"transparent",icon:(0,g.jsx)(_e,{className:i.tableActionIcon}),onClick:()=>{a.processTableEdit({path:[...r,B.length],source:l,type:0,value:void 0})},size:"small",children:o.labelForAddNewButton}),o.canMoveRows&&(0,g.jsx)(w,{icon:(0,g.jsx)(Ke,{className:i.tableActionIcon}),onClick:p=>{p.target.focus(),G(V,V-1)},disabled:V===void 0||V===0,size:"small",appearance:"transparent",children:P}),o.canMoveRows&&(0,g.jsx)(w,{icon:(0,g.jsx)(Ge,{className:i.tableActionIcon}),onClick:p=>{p.target.focus(),G(V,V+1)},disabled:V===void 0||V===B.length-1,size:"small",appearance:"transparent",children:x})]}),(0,g.jsx)("div",{children:(0,g.jsxs)(Dt,{...v,as:"table",size:"extra-small",...h.getTableProps(),ref:E,className:i.table,style:{width:Object.keys(d).reduce((p,D)=>p+d[D].idealWidth+22,0)-20},children:[(0,g.jsx)(vt,{style:{backgroundColor:"var(--vscode-keybindingTable-headerBackground)"},children:(0,g.jsx)(Be,{children:b.map(p=>(0,Wt.createElement)(Pt,{...h.getTableHeaderCellProps(p.columnId),className:i.tableHeaderCell,key:p.columnId},p.renderHeaderCell()))})}),(0,g.jsx)(ht,{children:B.map((p,D)=>{let S=K(D),W=V===D?"var(--vscode-list-hoverBackground)":"var(--vscode-editor-background)",O="3px solid var(--vscode-focusBorder)";return(0,g.jsx)(Be,{style:{backgroundColor:W,width:"calc(100% - 10px)",borderTop:me===D&&Q!==D&&Q>D?O:"",borderBottom:me===D&&Q!==D&&Q<D?O:""},onFocus:de=>{Le(D),a.state.propertiesPaneData&&l!=="PropertiesView"&&a?.setPropertiesComponents({componentPath:[...r,D],component:t,model:e})},children:b.map((de,Se)=>(0,g.jsx)(ft,{...h.getTableCellProps(de.columnId),className:F(!!S,Se,b.length),id:`table-cell-${a?.state.tableInfo?.id}-${r.join("-")}_${D}-${Se}`,style:{height:"30px",maxHeight:"30px"},children:qt(p,de.columnId,D)},r.join(".")+D+Se))},r.join(".")+D)})})]})})]})};var q=u(C()),or=z({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column",gap:"10px"}}),Lt=({tabId:t})=>{let e=or(),l=(0,Vt.useContext)(I)?.state;if(!l)return null;let v=l.view?.tabs.find(o=>o.id===t)?.components;return(0,q.jsx)("div",{className:e.root,children:v?.filter(o=>o.componentProperties.enabled===void 0||o.componentProperties.enabled).map(o=>{switch(o.componentType){case"input":{let a=l.model[o.propertyName];return(0,q.jsx)(X,{component:o,model:a,componentPath:[o.propertyName],UiArea:"TabsView"},o.propertyName)}case"textarea":{let a=l.model[o.propertyName];return(0,q.jsx)(X,{component:o,model:a,componentPath:[o.propertyName],UiArea:"TabsView",multiline:!0,autoAdjustHeight:!0},o.propertyName)}case"dropdown":{let a=l.model[o.propertyName];return(0,q.jsx)(le,{component:o,model:a,componentPath:[o.propertyName],UiArea:"TabsView"},o.propertyName)}case"checkbox":{let a=l.model[o.propertyName];return(0,q.jsx)(ne,{component:o,model:a,componentPath:[o.propertyName],UiArea:"TabsView"},o.propertyName)}case"table":{let a=l.model[o.propertyName];return(0,q.jsx)(Te,{component:o,model:a,componentPath:[o.propertyName],UiArea:"TabsView"},o.propertyName)}default:return null}})})};var k=u(C()),nr=z({root:{width:"100%",height:"100%",paddingTop:"10px",paddingLeft:"10px",paddingRight:"10px",boxSizing:"border-box",overflow:"auto"},content:{display:"flex",flexDirection:"column",overflow:"auto",flex:1,gap:"10px"},title:{width:"400px",maxWidth:"100%",padding:"10px"},tabButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}}),Ht=()=>{let t=nr(),e=(0,Y.useContext)(I),r=e?.state;if(!r)return null;let[l,v]=(0,Y.useState)(r.model.name.value),[o,a]=(0,Y.useState)(r.model.schema.value);(0,Y.useEffect)(()=>{v(r.model.name.value),a(r.model.schema.value)},[r.model]);let i=s=>{let f=r.view?.tabs.find(d=>d.id===s)?.components;if(!f||r.issues?.length===0)return 0;let y=0;for(let d=0;d<r?.issues.length;d++){let c=r.issues[d];c.propertyPath&&c.propertyPath.length>0&&f.find(h=>h.propertyName===c.propertyPath[0])&&y++}return y};function P(s){let f=i(s);if(f===1)return L({message:"{0} issue",args:[f],comment:["{0} is the number of issues"]});if(f>1||f===0)return L({message:"{0} issues",args:[f],comment:["{0} is the number of issues"]})}function x(s){let f=i(s);return f===0?s:f===1?L({message:"{0} {1} issue",args:[s,f],comment:["{0} is the tab name","{1} is the number of issues"]}):L({message:"{0} {1} issues",args:[s,f],comment:["{0} is the tab name","{1} is the number of issues"]})}function b(){let s=(r?.model?.schema).values,f=new Set(["db_accessadmin","db_backupoperator","db_datareader","db_datawriter","db_ddladmin","db_denydatareader","db_denydatawriter","db_owner","db_securityadmin"]),y=[],d=[];for(let c of s)f.has(c)?d.push(c):y.push(c);return y.sort((c,h)=>c.localeCompare(h)),d.sort((c,h)=>c.localeCompare(h)),[...y,...d]}return(0,k.jsx)("div",{className:t.root,children:(0,k.jsxs)("div",{className:t.content,children:[(0,k.jsx)(H,{size:"small",label:m.tableDesigner.tableName,orientation:"horizontal",style:{width:"300px"},children:(0,k.jsx)(be,{size:"small",value:l,onChange:(s,f)=>{v(f.value)},autoFocus:!0,onBlur:s=>{e.processTableEdit({source:"TabsView",type:2,path:["name"],value:l})}})}),(0,k.jsx)(H,{size:"small",label:m.tableDesigner.schema,orientation:"horizontal",style:{width:"300px"},children:(0,k.jsx)(De,{size:"small",options:b().map(s=>({value:s})),onSelect:s=>{e.processTableEdit({source:"TabsView",type:2,path:["schema"],value:s.value})},selectedOption:{value:o},ariaLabel:m.tableDesigner.schema})}),(0,k.jsx)(lt,{size:"small",selectedValue:r.tabStates?.mainPaneTab,onTabSelect:(s,f)=>{e.setTab(f.value),e.setPropertiesComponents(void 0)},children:r.view?.tabs.map(s=>{let f=x(s.id);return(0,k.jsx)(at,{title:f,value:s.id,children:(0,k.jsxs)("div",{className:t.tabButtonContainer,children:[(0,k.jsx)(ee,{children:s.title}),i(s.id)>0&&(0,k.jsx)(nt,{color:"important",size:"small",title:P(s.id),count:i(s.id),style:{marginLeft:"6px"}})]})},s.id)})}),r.view?.tabs.map(s=>(0,k.jsx)("div",{style:{display:r.tabStates?.mainPaneTab===s.id?"":"none",width:"100%",height:"100%"},children:(0,k.jsx)(Lt,{tabId:s.id})},s.id))]})})};var Ft=u(N());var R=u(C()),ir=z({root:{display:"flex",flexDirection:"column",height:"100%",overflowX:"hidden",...A.overflow("hidden")},title:{display:"flex",alignItems:"center",gap:"8px",padding:"6px 8px",borderBottom:"1px solid var(--vscode-editorWidget-border)",backgroundColor:"var(--vscode-editorWidget-background)",boxShadow:"0 1px 0 var(--vscode-editorWidget-border), 0 2px 6px rgba(0, 0, 0, 0.2)",position:"relative",zIndex:1},stack:{marginBottom:"10px",flexDirection:"column","> *":{marginBottom:"10px"},...A.flex(1),overflowY:"auto",backgroundColor:"var(--vscode-editor-background)"},group:{overflowX:"auto",overflowY:"hidden","> *":{marginBottom:"10px"}}}),Ot=()=>{let t=ir(),e=Rt(),r=(0,Ft.useContext)(I);if(!r)return null;let l=r.state.propertiesPaneData,v=l.componentPath,o=v[0],a=v[v.length-1],i=r.state.propertiesPaneData?.component.componentProperties,x=r.state.model[o].data[a],b=Array.from(new Set(i.itemProperties?.filter(d=>d.group).map(d=>d.group)));if(b?.unshift("General"),!x)return;let s=(d,c)=>{if(d)return(0,R.jsxs)(Ue,{value:d,className:e.accordionItem,children:[(0,R.jsx)(rt,{children:d}),(0,R.jsx)(ot,{children:(0,R.jsx)("div",{className:t.group,children:c.map(h=>{if(!x)return;let E=x[h.propertyName];switch(h.componentType){case"checkbox":return(0,R.jsx)(ne,{UiArea:"PropertiesView",component:h,model:E,componentPath:[...l.componentPath,h.propertyName]},`${d}-${h.propertyName}`);case"input":return(0,R.jsx)(X,{UiArea:"PropertiesView",component:h,model:E,componentPath:[...l.componentPath,h.propertyName],horizontal:!0},`${d}-${h.propertyName}`);case"dropdown":return(0,R.jsx)(le,{UiArea:"PropertiesView",component:h,model:E,componentPath:[...l.componentPath,h.propertyName],horizontal:!0},`${d}-${h.propertyName}`);case"table":return(0,R.jsx)(Te,{UiArea:"PropertiesView",component:h,model:E,componentPath:[...l.componentPath,h.propertyName]},`${d}-${h.propertyName}`)}})})})]},d)},f=()=>b?.sort((d,c)=>!d||!c?0:i.expandedGroups?.includes(d)&&!i.expandedGroups?.includes(c)?-1:i.expandedGroups?.includes(c)&&!i.expandedGroups?.includes(d)?1:0).map(d=>{let c=i.itemProperties.filter(h=>d==="General"&&!h.group||d===h.group).filter(h=>{if(h.showInPropertiesView===!1)return!1;let E=x[h.propertyName];return!(!E||E?.enabled===!1)});if(c.length!==0)return s(d,c)}),y=()=>i.expandedGroups?i.expandedGroups:f().length>0?[b[0]]:[];return(0,R.jsxs)("div",{className:t.root,children:[(0,R.jsxs)("div",{className:t.title,children:[(0,R.jsx)(w,{appearance:"subtle",onClick:()=>{r.propertiesPaneResizeInfo.isMaximized&&r.propertiesPaneResizeInfo.setCurrentWidth(r.propertiesPaneResizeInfo.originalWidth),r.propertiesPaneResizeInfo.setIsMaximized(!r.propertiesPaneResizeInfo.isMaximized)},title:r.propertiesPaneResizeInfo.isMaximized?m.tableDesigner.restorePropertiesPane:m.tableDesigner.expandPropertiesPane,icon:r.propertiesPaneResizeInfo.isMaximized?(0,R.jsx)(Qe,{}):(0,R.jsx)(Je,{}),style:{marginRight:"0px"}}),(0,R.jsx)(ee,{size:400,weight:"semibold",style:{flex:1,lineHeight:"28px"},children:m.tableDesigner.propertiesPaneTitle(i.objectTypeDisplayName??"")}),(0,R.jsx)(w,{appearance:"subtle",onClick:()=>{r.setPropertiesComponents(void 0)},title:m.common.close,icon:(0,R.jsx)(tt,{})})]}),(0,R.jsx)("div",{className:t.stack,children:(0,R.jsx)(Oe,{multiple:!0,collapsible:!0,defaultOpenItems:y(),children:x&&f()})})]})};var pe=u(N());var _t=u(C()),Ut=()=>{let t=(0,pe.useContext)(I),e=t?.state;if(!e)return;let r=async o=>{let a=o.propertyPath??[];if(t?.log(`focusing on ${a}`),!e?.view?.tabs)return;let i=e.view.tabs.find(s=>s.components.find(f=>f.propertyName===a[0]));if(i)t.setTab(i.id),await new Promise(s=>setTimeout(s,100));else return;let P,x;if(a.length>1){if(P=i.components.find(s=>s.propertyName===a[0]),!P||(x=e.model[P.propertyName],!x))return;t.setPropertiesComponents({componentPath:[a[0],a[1]],component:P,model:x})}let b;switch(a.length){case 1:case 3:case 5:b=t.elementRefs.current[t.getComponentId(a)];break;case 2:if(!P)return;let s=P.componentProperties.itemProperties[0].propertyName;b=t.elementRefs.current[t.getComponentId([...a,s])];break;case 4:if(!P)return;let f=a[2],y=P.componentProperties.itemProperties.find(c=>c.propertyName===f);if(!y)return;let d=y.componentProperties.itemProperties[0].propertyName;b=t.elementRefs.current[t.getComponentId([...a,d])];break;default:break}b&&(b.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),b.focus())},[l,v]=(0,pe.useState)("script");return(0,pe.useEffect)(()=>{v(e.tabStates.resultPaneTab==="script"?"script":"issues")},[e.tabStates.resultPaneTab]),(0,_t.jsx)(kt,{ref:t?.definitionPaneRef,copyToClipboard:t?.copyScriptAsCreateToClipboard,themeKind:t?.themeKind,openInEditor:t?.scriptAsCreate,script:(e?.model.script).value??"",issues:e?.issues,activeTab:l,setActiveTab:v,onIssueClick:r})};var T=u(C()),sr=z({root:{display:"flex",flexDirection:"column",height:"100%",width:"100%",maxWidth:"100%",maxHeight:"100%"},pageContext:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",flexDirection:"column"},errorIcon:{fontSize:"100px",opacity:.5},retryButton:{marginTop:"10px"},resultPaneHandle:{position:"absolute",top:"0",right:"0",width:"100%",height:"10px",cursor:"ns-resize",zIndex:1,boxShadow:"0px -1px 1px  var(--vscode-editorWidget-border)"},propertiesPaneHandle:{position:"absolute",top:"0",left:"0",width:"10px",height:"100%",cursor:"ew-resize",zIndex:1,boxShadow:"-1px 0px 1px  var(--vscode-editorWidget-border)"},designerRibbon:{width:"100%"},mainContent:{height:"100%",width:"100%",minHeight:"100%",display:"flex",...A.flex(1),flexDirection:"column",...A.overflow("hidden")},editor:{...A.overflow("hidden"),...A.flex(1),width:"100%",display:"flex",flexDirection:"row"},topPanelContent:{display:"flex",flexDirection:"column",width:"100%",height:"100%",maxHeight:"100%"},resultPaneContainer:{width:"100%",position:"relative"},propertiesPaneContainer:{position:"relative",height:"100%",width:"100%",...A.overflow("hidden")},resizeHandle:{height:"2px",backgroundColor:"var(--vscode-editorWidget-border)"},verticalResizeHandle:{width:"2px",backgroundColor:"var(--vscode-editorWidget-border)"}}),Gt=()=>{let t=sr(),e=(0,J.useContext)(I),r=e?.state,l=(0,J.useRef)(null),v=(0,J.useRef)(null);return r?((0,J.useEffect)(()=>{if(!(!e||!e.state.propertiesPaneData))if(e.propertiesPaneResizeInfo.isMaximized)v.current?.resize(100);else{let o=l.current?.offsetWidth??0;if(o>0){let a=e.propertiesPaneResizeInfo.currentWidth||450,i=Math.max(10,Math.min(90,a/o*100));v.current?.resize(i)}else v.current?.resize(30)}},[e?.state.propertiesPaneData,e?.propertiesPaneResizeInfo.isMaximized]),(0,T.jsxs)("div",{className:t.root,children:[r.apiState?.initializeState==="Loading"&&(0,T.jsx)("div",{className:t.pageContext,children:(0,T.jsx)(Z,{label:m.tableDesigner.loadingTableDesigner,labelPosition:"below"})}),r.apiState?.initializeState==="Error"&&(0,T.jsxs)("div",{className:t.pageContext,children:[(0,T.jsx)($,{className:t.errorIcon}),(0,T.jsx)("div",{children:m.tableDesigner.errorLoadingDesigner}),(0,T.jsx)(w,{className:t.retryButton,children:m.tableDesigner.retry})]}),r.apiState?.initializeState==="Loaded"&&(0,T.jsx)("div",{className:t.mainContent,children:(0,T.jsxs)(ke,{direction:"vertical",children:[(0,T.jsx)(ve,{defaultSize:75,children:(0,T.jsxs)("div",{className:t.topPanelContent,children:[(0,T.jsx)(Mt,{}),(0,T.jsx)("div",{className:t.editor,ref:l,children:(0,T.jsxs)(ke,{direction:"horizontal",children:[(0,T.jsx)(ve,{defaultSize:100,minSize:10,collapsible:!0,children:(0,T.jsx)(Ht,{})}),(0,T.jsx)(Ne,{className:t.verticalResizeHandle}),e.state.propertiesPaneData&&(0,T.jsx)(ve,{defaultSize:0,minSize:10,collapsible:!0,ref:v,onResize:o=>{let a=l.current?.offsetWidth??0;if(a>0){let i=o/100*a;e.propertiesPaneResizeInfo.setCurrentWidth(i),e.propertiesPaneResizeInfo.isMaximized||e.propertiesPaneResizeInfo.setOriginalWidth(i)}},children:(0,T.jsx)("div",{className:t.propertiesPaneContainer,children:(0,T.jsx)(Ot,{})})})]})})]})}),(0,T.jsx)(Ne,{className:t.resizeHandle}),(0,T.jsx)(Ut,{})]})})]})):null};var ye=u(C());Kt.default.createRoot(document.getElementById("root")).render((0,ye.jsx)(yt,{children:(0,ye.jsx)(Nt,{children:(0,ye.jsx)(Gt,{})})}));
