"use strict";(self.webpackChunkechoapi_for_vscode=self.webpackChunkechoapi_for_vscode||[]).push([[8492],{58492:(e,n,t)=>{t.r(n),t.d(n,{default:()=>V});var r=t(364467),i=t(3453),l=t(296540),o=t(778291),s=t(811721),a=t(614869),u=t(123328),c=t(302543),d=t(445448),v=t(600594),f=t(110563),p=t(833581),m=t(273904),g=t(166166),b=t(164394),h=t(960864),y=t(531400),O=t(892911),j=t(779888),w=t(236492),A=t(362611),x=t(827659),S=t(474848);function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const k=function(e){var n=(0,o.Bd)().t,t=e||{},i=t.filterValue,l=t.setFilterValue,s=t.filterType,a=t.setFilterType,u=t.target_id,c=(0,h.A)((function(e){return e.websocket2ConnectionPool})),d=(0,h.A)((function(e){return e.updateWebsocket2ConnectionPool}));return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(O.A,{justify:"space-between",className:"ws-header",children:(0,S.jsxs)(O.A,{align:"center",gap:8,style:{wordBreak:"keep-all"},children:[(0,S.jsx)(j.A,{prefix:(0,S.jsx)(x.A,{type:"icon-search-line",className:"icon-color"}),placeholder:n("ws.response.search_tip"),value:i,onChange:function(e){var n;return l((null==e||null===(n=e.target)||void 0===n?void 0:n.value)||"")},size:"small"}),(0,S.jsxs)(w.A,{getPopupContainer:function(e){return e.parentNode},value:s,onChange:a,size:"small",children:[(0,S.jsx)(w.A.Option,{value:"all",children:n("ws.response.all_message")}),(0,S.jsx)(w.A.Option,{value:"send",children:n("ws.response.sent")}),(0,S.jsx)(w.A.Option,{value:"message",children:n("ws.response.received")})]}),(0,S.jsx)(A.A,{style:{height:32,borderColor:"var(--color-table-border)"},size:"small",icon:(0,S.jsx)(x.A,{type:"icon-delete"}),onClick:function(){return d(_(_({},c),{},(0,r.A)({},u,_(_({},c[u]),{},{socketRes:[]}))))},children:n("ws.response.clear")})]})})})};function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function E(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var D=function(e){return(0,c.isString)(e)?e:(0,c.isPlainObject)(e)?JSON.stringify(e):(0,c.toString)(e)},z=t(7380);function F(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?F(Object(t),!0).forEach((function(n){(0,r.A)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):F(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}const V=function(e){var n,t,r,O,j,w,A,x=e.value,P=(e.onChange,(0,o.Bd)().t),_=(0,h.A)((function(e){return e.websocket2ConnectionPool})),T=(0,y.A)().updatePool,F=(0,b.XX)((function(e){return e.apisActiveData})).target_id,V=(0,a.A)("text"),M=(0,i.A)(V,2),q=(M[0],M[1]),I=(0,a.A)({}),L=(0,i.A)(I,2),R=L[0],H=L[1],J=(0,a.A)(""),B=(0,i.A)(J,2),W=B[0],X=B[1],G=(0,a.A)("all"),U=(0,i.A)(G,2),$=U[0],K=U[1],Q=(0,a.A)(!0),Y=(0,i.A)(Q,2),Z=Y[0],ee=Y[1],ne=(0,l.useRef)(0),te=(0,l.useRef)(null),re={defaultSize:50,minSize:5,collapsible:!0,collapsedSize:5},ie={connect:"",disconnect:"".concat(P("ws.response.disconnect")),error:"",send:"",message:""},le=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var t=e||{},r=t.action,i=t.message;if("message"===r){var l,o;if(!(0,c.isString)(i)&&null!=i&&null!==(l=i.data)&&void 0!==l&&l.type&&null!=i&&null!==(o=i.data)&&void 0!==o&&o.data){var s,a=u.Ay.bufferToRaw(null==i||null===(s=i.data)||void 0===s?void 0:s.data,{}).raw;return function(e){try{var n=JSON.parse(e);return(0,c.isObject)(n)&&!(0,c.isArray)(n)}catch(e){return!1}}(a)?a:n?JSON.stringify(a):a}return n?JSON.stringify(i):String(i)}return function(e){var n,t,r,i,l="";switch(null==e?void 0:e.action){case"connect":l=null==e||null===(n=e.message)||void 0===n?void 0:n.message;break;case"send":l=null==e||null===(t=e.message)||void 0===t?void 0:t.data;break;case"message":l=null==e||null===(r=e.message)||void 0===r?void 0:r.data;break;default:l=null==e||null===(i=e.message)||void 0===i?void 0:i.message}return l||""}(e)}catch(e){return""}},oe=(0,l.useMemo)((function(){return le(R)||""}),[R]),se=(0,l.useMemo)((function(){var e;return function(e,n,t){var r,i,l,o,s,a,d,v,f=[],p=function(e){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,n){if(e){if("string"==typeof e)return C(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?C(e,n):void 0}}(e))){n&&(e=n);var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,o=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){o=!0,i=e},f:function(){try{l||null==n.return||n.return()}finally{if(o)throw i}}}}(e||[]);try{for(p.s();!(v=p.n()).done;){var m=v.value;if(!(0,c.isString)(t)||"all"===t||(null==m?void 0:m.action)===t)switch(null==m?void 0:m.action){case"connect":var g,b;if((0,c.isString)(n)&&(0,c.trim)(n).length>0&&(0,c.isString)(null==m||null===(g=m.message)||void 0===g?void 0:g.message)&&-1===(null==m||null===(b=m.message)||void 0===b||null===(b=b.message)||void 0===b?void 0:b.indexOf((0,c.trim)(n))))continue;f.push(E(E({},m),{},{id:(null==m?void 0:m.id)||(0,u.aL)()}));break;case"disconnect":if((0,c.isString)(n)&&(0,c.trim)(n).length>0&&(0,c.isString)(null==m||null===(r=m.data)||void 0===r?void 0:r.message)&&-1===(null==m||null===(i=m.data)||void 0===i||null===(i=i.message)||void 0===i?void 0:i.indexOf((0,c.trim)(n))))continue;f.push(E(E({},m),{},{id:(null==m?void 0:m.id)||(0,u.aL)()}));break;case"error":if((0,c.isString)(n)&&(0,c.trim)(n).length>0&&(0,c.isString)(null==m||null===(l=m.message)||void 0===l?void 0:l.message)&&-1===(null==m||null===(o=m.message)||void 0===o||null===(o=o.message)||void 0===o?void 0:o.indexOf((0,c.trim)(n))))continue;f.push(E(E({},m),{},{id:(null==m?void 0:m.id)||(0,u.aL)()}));break;case"message":if((0,c.isString)(n)&&(0,c.trim)(n).length>0&&(0,c.isString)(null==m||null===(s=m.message)||void 0===s?void 0:s.data)&&-1===(null==m||null===(a=m.message)||void 0===a||null===(a=a.data)||void 0===a?void 0:a.indexOf((0,c.trim)(n))))continue;f.push(E(E({},m),{},{id:(null==m?void 0:m.id)||(0,u.aL)()}));break;case"send":if((0,c.isString)(n)&&(0,c.trim)(n).length>0&&-1===D(null==m||null===(d=m.message)||void 0===d?void 0:d.data).indexOf((0,c.trim)(n)))continue;f.push(E(E({},m),{},{id:(null==m?void 0:m.id)||(0,u.aL)()}))}}}catch(e){p.e(e)}finally{p.f()}return f}(null===(e=_[F])||void 0===e?void 0:e.socketRes,W,$)}),[_,F,W,$]);return(0,l.useMemo)((function(){return(0,c.map)(null==x?void 0:x.message,(function(e){return{label:(0,S.jsx)(z.Wo,{children:(0,S.jsx)("span",{className:"name",children:(0,S.jsx)(m.m_,{title:e.name,children:e.name})})}),key:e.param_id}}))}),[x]),s.A,m.m_,P("api.design.save_response"),m.rP,(0,l.useEffect)((function(){var e,n,t,r;(0,c.isFunction)(null==te||null===(e=te.current)||void 0===e?void 0:e.setTabsValue)&&(!(0,c.isEqual)(null==R||null===(n=R.message)||void 0===n?void 0:n.fitForShow,"Monaco")&&(0,c.isEqual)(null==R?void 0:R.action,"message")?null==te||null===(t=te.current)||void 0===t||t.setTabsValue("preview"):null==te||null===(r=te.current)||void 0===r||r.setTabsValue("beautify"))}),[R]),(0,l.useEffect)((function(){var e=document.querySelector(".ws2");e&&Z&&(e.scrollTop=(null==e?void 0:e.scrollHeight)||0)}),[Z,se]),(0,l.useEffect)((function(){var e=document.querySelector(".ws2");null==e||e.addEventListener("scroll",(function(){var e=document.querySelector(".ws2");null==e||e.addEventListener("scroll",(function(){var n=e.scrollTop;n<ne.current&&ee(!1),ne.current=n}))}))}),[ee]),(0,l.useEffect)((function(){var e;"send"===(null===(e=se[(0,c.size)(se)-1])||void 0===e?void 0:e.action)&&ee(!0)}),[se]),(0,S.jsxs)(S.Fragment,{children:["connecting"===(null===(n=_[F])||void 0===n?void 0:n.status)&&(0,S.jsx)(d.fr,{onCancel:function(){var e;null===(e=window)||void 0===e||e.vscode.postMessage({action:"ws_disconnect",data:null==x?void 0:x.target_id}),T(null==x?void 0:x.target_id,"disconnect",{})}}),(0,S.jsx)("div",{style:{height:"100%"},children:(0,c.size)(se)>-1?(0,S.jsx)(f.A,{panelGroupProps:{autoSaveId:"ws_realtime_container_resize_save_id",direction:"horizontal"},leftPanelProps:N(N({},re),{},{collapseTitle:P("supplement.socket_realtime_msg")}),rightPanelProps:N(N({},re),{},{collapseTitle:P("supplement.socket_realtime_content")}),leftPanel:(0,S.jsxs)(z.io,{children:[(0,S.jsx)(k,{target_id:F,filterValue:W,filterType:$,setFilterType:K,setFilterValue:X}),(0,S.jsx)("div",{className:"ws2",style:{overflow:"auto",maxHeight:"calc(100% - 50px)",border:"1px solid var(--color-border)",borderRadius:"var(--border-radius)"},children:(0,S.jsx)(v.A,{renderTitle:function(e){var n=(e||{}).action;return(0,S.jsxs)("div",{className:"title",style:{whiteSpace:"nowrap",maxWidth:"100%",textOverflow:"ellipsis",overflow:"hidden"},children:[ie[n],le(e)]})},customTipsContent:function(e){var n,t,r;return(0,c.isString)(null==e?void 0:e.message)?{}:{size:null==e||null===(n=e.message)||void 0===n?void 0:n.size,time:null==e||null===(t=e.message)||void 0===t?void 0:t.time,mode:null==e||null===(r=e.message)||void 0===r?void 0:r.dataType}},onItemClick:function(e){H(e)},data:se})})]}),rightPanel:(0,S.jsxs)("div",{style:{height:"100%",padding:8},children:[(0,c.isEqual)(null==R?void 0:R.action,"message")&&(0,S.jsx)(p.A,{ref:te,data:N(N({},R),{},{fit_for_show:null==R||null===(t=R.message)||void 0===t?void 0:t.fitForShow,stream:null==R||null===(r=R.message)||void 0===r?void 0:r.data,mime_type:{ext:null==R||null===(O=R.message)||void 0===O?void 0:O.dataType,mime:""}}),setMode:q,resultIncludesTabs:["beautify","native","preview"],warpVisible:!1,rawHtml:oe}),!(0,c.isEqual)(null==R?void 0:R.action,"message")&&(0,S.jsx)(p.A,{ref:te,data:N(N({},R),{},{fit_for_show:null==R||null===(j=R.message)||void 0===j?void 0:j.fitForShow,stream:null==R||null===(w=R.message)||void 0===w?void 0:w.data,mime_type:{ext:null==R||null===(A=R.message)||void 0===A?void 0:A.dataType,mime:""}}),setMode:q,resultIncludesTabs:["beautify","native"],warpVisible:!1,rawHtml:oe})]})}):(0,S.jsx)(g.A,{})})]})}}}]);