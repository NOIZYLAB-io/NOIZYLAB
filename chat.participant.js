'use strict';const a2_0x5c9b28=a2_0x2751;(function(_0x66957c,_0x541dee){const _0x40b76e=a2_0x2751,_0xa1f671=_0x66957c();while(!![]){try{const _0x15d844=parseInt(_0x40b76e(0x168))/0x1*(-parseInt(_0x40b76e(0x11b))/0x2)+-parseInt(_0x40b76e(0x1ad))/0x3*(-parseInt(_0x40b76e(0x169))/0x4)+parseInt(_0x40b76e(0x181))/0x5+-parseInt(_0x40b76e(0x114))/0x6+-parseInt(_0x40b76e(0x16c))/0x7*(-parseInt(_0x40b76e(0xf2))/0x8)+-parseInt(_0x40b76e(0x15b))/0x9*(parseInt(_0x40b76e(0xf5))/0xa)+parseInt(_0x40b76e(0x1c3))/0xb*(-parseInt(_0x40b76e(0x118))/0xc);if(_0x15d844===_0x541dee)break;else _0xa1f671['push'](_0xa1f671['shift']());}catch(_0x19bf37){_0xa1f671['push'](_0xa1f671['shift']());}}}(a2_0x3ae7,0xdbc58));var __createBinding=this&&this['__createBinding']||(Object[a2_0x5c9b28(0x147)]?function(_0x2413d6,_0x309d3e,_0x2b3d8b,_0xdcf138){const _0x46240f=a2_0x5c9b28;if(_0xdcf138===undefined)_0xdcf138=_0x2b3d8b;var _0x1d4fca=Object[_0x46240f(0x119)](_0x309d3e,_0x2b3d8b);(!_0x1d4fca||(_0x46240f(0xfb)in _0x1d4fca?!_0x309d3e[_0x46240f(0x16d)]:_0x1d4fca[_0x46240f(0x14b)]||_0x1d4fca[_0x46240f(0x1d9)]))&&(_0x1d4fca={'enumerable':!![],'get':function(){return _0x309d3e[_0x2b3d8b];}}),Object['defineProperty'](_0x2413d6,_0xdcf138,_0x1d4fca);}:function(_0x410947,_0x245d4e,_0x375635,_0x42650b){if(_0x42650b===undefined)_0x42650b=_0x375635;_0x410947[_0x42650b]=_0x245d4e[_0x375635];}),__setModuleDefault=this&&this[a2_0x5c9b28(0x172)]||(Object[a2_0x5c9b28(0x147)]?function(_0x1f14ab,_0x11950e){const _0x33940a=a2_0x5c9b28;Object[_0x33940a(0x14f)](_0x1f14ab,_0x33940a(0x1ab),{'enumerable':!![],'value':_0x11950e});}:function(_0xa2713a,_0x301a04){const _0x2128ee=a2_0x5c9b28;_0xa2713a[_0x2128ee(0x1ab)]=_0x301a04;}),__importStar=this&&this[a2_0x5c9b28(0x183)]||(function(){var _0x365e43=function(_0x3214bd){return _0x365e43=Object['getOwnPropertyNames']||function(_0x285222){const _0x22acff=a2_0x2751;var _0x2002b9=[];for(var _0x5b2af4 in _0x285222)if(Object[_0x22acff(0x13f)][_0x22acff(0x1be)][_0x22acff(0x197)](_0x285222,_0x5b2af4))_0x2002b9[_0x2002b9[_0x22acff(0x17a)]]=_0x5b2af4;return _0x2002b9;},_0x365e43(_0x3214bd);};return function(_0x21c53a){const _0x4a937b=a2_0x2751;if(_0x21c53a&&_0x21c53a[_0x4a937b(0x16d)])return _0x21c53a;var _0x230456={};if(_0x21c53a!=null){for(var _0x6ac2b1=_0x365e43(_0x21c53a),_0x383057=0x0;_0x383057<_0x6ac2b1[_0x4a937b(0x17a)];_0x383057++)if(_0x6ac2b1[_0x383057]!==_0x4a937b(0x1ab))__createBinding(_0x230456,_0x21c53a,_0x6ac2b1[_0x383057]);}return __setModuleDefault(_0x230456,_0x21c53a),_0x230456;};}());Object[a2_0x5c9b28(0x14f)](exports,'__esModule',{'value':!![]}),exports[a2_0x5c9b28(0x121)]=exports[a2_0x5c9b28(0xe9)]=exports[a2_0x5c9b28(0x1b1)]=exports['RESULT']=exports[a2_0x5c9b28(0x18f)]=void 0x0;const prompt_tsx_1=require('@vscode/prompt-tsx'),prompt_render_1=require(a2_0x5c9b28(0x1ca)),code_extractor_1=require(a2_0x5c9b28(0x182)),code_decorator_1=require(a2_0x5c9b28(0x140)),documentation_parser_1=require('./documentation.parser'),common_1=require(a2_0x5c9b28(0x167)),localization_1=require('../localization'),runner_1=require('../runner'),telemetry_provider_1=require(a2_0x5c9b28(0x1c9)),docs_1=require(a2_0x5c9b28(0x19d)),logging=__importStar(require(a2_0x5c9b28(0x150))),assert=__importStar(require('assert')),vscode=__importStar(require(a2_0x5c9b28(0x161)));exports['MODEL_SELECTOR']={'vendor':a2_0x5c9b28(0x1a1),'family':a2_0x5c9b28(0x177)};var RESULT;(function(_0x207cd2){const _0x15d91d=a2_0x5c9b28;_0x207cd2[_0x207cd2['SUCCESS']=0x0]=_0x15d91d(0x184),_0x207cd2[_0x207cd2[_0x15d91d(0x1c5)]=0x1]=_0x15d91d(0x1c5),_0x207cd2[_0x207cd2['UNKNOWN_COMMAND']=0x2]=_0x15d91d(0x1c1),_0x207cd2[_0x207cd2[_0x15d91d(0x165)]=0x3]=_0x15d91d(0x165),_0x207cd2[_0x207cd2['VIOLATION_NOT_FOUND']=0x4]=_0x15d91d(0x18e),_0x207cd2[_0x207cd2['MODEL_SELECTION_FAILED']=0x5]=_0x15d91d(0x15f),_0x207cd2[_0x207cd2['CONTEXT_NOT_FOUND']=0x6]=_0x15d91d(0x187),_0x207cd2[_0x207cd2['NO_DOCUMENTATION']=0x7]=_0x15d91d(0x18b),_0x207cd2[_0x207cd2[_0x15d91d(0x108)]=0x8]=_0x15d91d(0x108),_0x207cd2[_0x207cd2['ERROR']=0x9]=_0x15d91d(0x138);}(RESULT||(exports['RESULT']=RESULT={})));var COMMAND;function a2_0x3ae7(){const _0x24d152=['actionEvent','participantId','REQUIREMENT_MISSING','getExtension','selectModel','Last\x20request\x20has\x20unknown\x20command:\x20','string','common.installdir.select','historyToChatMessages','stringify','trim','LICENSED','Models\x20matching\x20model\x20selector:\x20','Error\x20in\x20chat\x20handler:\x20','8973510nyQMuD','ChatResponseMarkdownPart','common.ai.chat.checking_license','the\x20\x27','12ylKdgk','getOwnPropertyDescriptor','Assistant','2564MwnoIK','chat.interaction','violationMessage','sendUserFeedbackTelemetry','code','debugEvent','ParasoftAIChatParticipant','family','violationInfo','metadata','===========\x20Messages\x20end\x20===========','Using\x20AI\x20model:\x20','EXPLAIN','\x0a```\x0a','ViolationPrompt','PARASOFT_VSCODE_DEBUG_CHAT_MESSAGES','addTryAgainButton','The\x20rule\x20violation\x20message\x20is:\x20```','getRuleDocumentation','onDidReceiveFeedback','content','history','workbench.extensions.search','#\x20result.metadata:\x20','log','rulesDocumentation','DocumentationParser','===========\x20Chat\x20history\x20end\x20===========','The\x20annotated\x20code\x20snippet\x20of\x20the\x20method\x20containing\x20supposed\x20violation\x20','ERROR','CodeDecorator','character','env','chat.codeContextMissing','TelemetryReporterProvider','Error\x20getting\x20violation\x20context:\x20','prototype','./code.decorator','Last\x20response\x20result\x20is\x20not\x20a\x20success,\x20not\x20sending\x20conversation\x20history.','common.install.extension','common.ai.chat.command_not_handled','explainViolation','Selected\x20chat\x20model:\x20','checkCopilotChatRequirement','create','extensions','ask','ChatRequestTurn','writable','ChatResponseTurn','Response:\x0a','languageExtension','defineProperty','../logging','common.ai.chat.not_licensed','start','guessWorkspaceFolderOrAskUser','createChatParticipant','chat.requirementMissing','showOpenProblemsViewCommand','push','message','common.ai.chat.model_selection_failed','command','963JswyYo','filter','reverse','addSelectInstallDirButton','MODEL_SELECTION_FAILED','rulesDocsPath','vscode','Error\x20generating\x20prompt:\x20','language','sendRequest','EXPLAIN_SYNTAX_ERROR','range','../common','479UWQlhK','4Isjvhj','isLicensed','===========\x20Messages\x20start\x20===========','4122055PkqFUb','__esModule','prompt','getContextOfViolationRange','common.ai.chat.no.installdir','ruleDoc','__setModuleDefault','explain','workbench.action.problems.focus','rulesDocFolder','split','gpt-4o','common.ai.chat.no.rulesDoc','logHistory','length','common.ai.chat.get.language_ext.question','chat.feedback','promptPlaceholder','You\x20are\x20senior\x20','codeExtractor','uri','5455940OCXrrL','./code.extractor','__importStar','SUCCESS','common.ai.chat.explain.violation_not_found.md','parse','CONTEXT_NOT_FOUND','isNaN','decorateCode','getConfiguration','NO_DOCUMENTATION','Could\x20not\x20access\x20model\x20using\x20selector:\x20','participant','VIOLATION_NOT_FOUND','MODEL_SELECTOR','WORKSPACE_LOCKED','workspace','diagnostic','#\x20result.errorDetails:\x20','checkLicense','line','response','call','common.ai.chat.explain.bad_violation_spec.md','bind','value','debug','getRulesDocFolder','../docs','common.ai.chat.noCopilotChatExtension','handleConversation','progress','copilot','concat','vendor','User\x20confirmed.\x20Showing\x20extensions\x20so\x20user\x20can\x20manually\x20install\x20it.','sections','indexOf','renderPrompt','substring','error','model_not_supported','default','logMessages','4880079veyzMB','conversation','NOT_LICENSED','\x27\x20coding\x20rule\x20violation.\x0a','COMMAND','ChatResultFeedbackKind','handleExplain','pop','getMatchedDiagnostic','Unknown\x20turn:\x20','(annotations\x20are\x20presented\x20as\x20lines\x20enclosed\x20in\x20[]\x20square\x20brackets\x20and\x20annotate\x20the\x20line\x20immediately\x20above)\x20is:\x0a','text','workbench.action.chat.open','Base\x20language\x20support\x20extension\x20is\x20not\x20installed.\x20Asking\x20user\x20if\x20he\x20wants\x20to\x20install\x20it','join','name','window','hasOwnProperty','getViolationContext','errorDetails','UNKNOWN_COMMAND','role','4173147QUVVWg','maxInputTokens','EMPTY_PROMPT','model','analyzerShortName','runLicenseCheck','../telemetry.provider','./Prompt/prompt.render','Error\x20getting\x20available\x20models:\x20','#\x20command:\x20','getDiagnostics','common.ai.chat.generating_fix','LanguageModelChatMessage','Model\x20not\x20supported\x20error:\x20','common.ai.chat.error_in_chat_handler','LicenseCheckStatus','chatHandler','i18n','license','common.ai.chat.explain.help.md','Chat\x20message:\x20','settingsRoot','configurable','sendMissingRequirementTelemetry','common.try_again','No\x20result\x20metadata\x20found\x20in\x20response,\x20not\x20sending\x20conversation\x20history.','common.quickfix.show.documentation','Request:\x0a','kind','includes','ViolationSpecificationParser','button','Helpful','showInformationMessage','result','getTelemetryReporter','```\x0a','participantIcon','selectChatModels','24kcYyjX','CodeExtractor','common.ai.chat.model_not_supported','102360EVmmmR','sourceCode','markdown','commands','codeDecorator','iconPath','get','toolInfo','DESCRIPTION','participantName','Diagnostic\x20URI\x20not\x20found','installLocationSetting','executeCommand','common.ai.chat.error_in_prompt_generator','checkLanguageExtension','common.ai.chat.explain.open_problems_view','licenseChecker'];a2_0x3ae7=function(){return _0x24d152;};return a2_0x3ae7();}(function(_0x5f3fe9){const _0xdbe2e0=a2_0x5c9b28;_0x5f3fe9['EXPLAIN']=_0xdbe2e0(0x173);}(COMMAND||(exports[a2_0x5c9b28(0x1b1)]=COMMAND={})));class ViolationSpecificationParser{static[a2_0x5c9b28(0x186)](_0x4b7fd8){const _0x10788e=a2_0x5c9b28;_0x4b7fd8=_0x4b7fd8[_0x10788e(0x110)]();const _0x29e8f5=_0x4b7fd8[_0x10788e(0x1a6)]('\x20');if(_0x29e8f5===-0x1)return undefined;const _0x5a6c0c=_0x4b7fd8[_0x10788e(0x1a8)](0x0,_0x29e8f5);if(_0x5a6c0c[_0x10788e(0x17a)]===0x0)return undefined;const _0x3b399f=_0x4b7fd8['substring'](_0x29e8f5+0x1),_0x37836b=_0x3b399f[_0x10788e(0x176)](':');if(_0x37836b[_0x10788e(0x17a)]<0x3)return undefined;const _0x378e5=parseInt(_0x37836b[_0x10788e(0x1b4)]()[_0x10788e(0x110)]());if(Number[_0x10788e(0x188)](_0x378e5))return undefined;const _0x145ecd=parseInt(_0x37836b[_0x10788e(0x1b4)]()[_0x10788e(0x110)]());if(Number[_0x10788e(0x188)](_0x145ecd))return undefined;const _0x5d48dc=_0x37836b[_0x10788e(0x1bb)](':');if(_0x5d48dc[_0x10788e(0x17a)]===0x0)return undefined;return{'ruleId':_0x5a6c0c,'fileName':_0x5d48dc,'line':_0x145ecd-0x1,'column':_0x378e5-0x1};}}exports['ViolationSpecificationParser']=ViolationSpecificationParser;function a2_0x2751(_0x4d2699,_0x4f4f3e){const _0x3ae74b=a2_0x3ae7();return a2_0x2751=function(_0x2751d6,_0x2974fa){_0x2751d6=_0x2751d6-0xe5;let _0x57cc49=_0x3ae74b[_0x2751d6];return _0x57cc49;},a2_0x2751(_0x4d2699,_0x4f4f3e);}class ParasoftAIChatParticipant{[a2_0x5c9b28(0x107)];[a2_0x5c9b28(0xfe)];[a2_0x5c9b28(0xf0)];[a2_0x5c9b28(0xfc)];[a2_0x5c9b28(0x163)];[a2_0x5c9b28(0x17d)];[a2_0x5c9b28(0x105)];[a2_0x5c9b28(0x17f)];[a2_0x5c9b28(0xf9)];[a2_0x5c9b28(0x16a)]=![];constructor(_0x34804f,_0x1ba61d,_0x451b65,_0x1c97ff,_0x4d0034,_0x421272,_0x5476f1){const _0x31e6d2=a2_0x5c9b28;this[_0x31e6d2(0x107)]=_0x34804f,this[_0x31e6d2(0xfe)]=_0x1ba61d,this[_0x31e6d2(0xf0)]=_0x451b65,this[_0x31e6d2(0xfc)]=_0x1c97ff,this[_0x31e6d2(0x163)]=_0x4d0034,this[_0x31e6d2(0x17d)]=_0x421272,this['licenseChecker']=_0x5476f1,this['codeExtractor']=new code_extractor_1[(_0x31e6d2(0xf3))](),this[_0x31e6d2(0xf9)]=new code_decorator_1[(_0x31e6d2(0x139))]();}async[a2_0x5c9b28(0x144)](_0x361ad6){const _0x12bb12=a2_0x5c9b28;if(!await this[_0x12bb12(0x146)]())return;const _0x269c58=vscode['languages'][_0x12bb12(0x1cd)]();let _0x4e5a18;for(const [_0x1e60fc,_0x20de3e]of _0x269c58){if(_0x20de3e[_0x12bb12(0xe8)](_0x361ad6)){_0x4e5a18=_0x1e60fc;break;}}if(!_0x4e5a18){logging['error'](_0x12bb12(0xff));return;}const _0x42a4d3=_0x361ad6[_0x12bb12(0x11f)]+'\x20'+(0x0,common_1['getBasename'])(_0x4e5a18)+':'+(_0x361ad6[_0x12bb12(0x166)][_0x12bb12(0x152)][_0x12bb12(0x195)]+0x1)+':'+(_0x361ad6['range'][_0x12bb12(0x152)][_0x12bb12(0x13a)]+0x1);vscode[_0x12bb12(0xf8)][_0x12bb12(0x101)]('workbench.action.chat.open',{'mode':_0x12bb12(0x149),'query':'@'+this[_0x12bb12(0xfe)]+'\x20/'+COMMAND['EXPLAIN']+'\x20'+_0x42a4d3});}[a2_0x5c9b28(0x154)](){const _0x2aa413=a2_0x5c9b28,_0x1dcdbe=vscode['chat'][_0x2aa413(0x154)](this[_0x2aa413(0x107)],this[_0x2aa413(0x1d3)][_0x2aa413(0x199)](this));_0x1dcdbe[_0x2aa413(0x12e)](_0x3f539f=>{const _0x145684=_0x2aa413;this[_0x145684(0x11e)](_0x3f539f);}),_0x1dcdbe[_0x2aa413(0xfa)]=this[_0x2aa413(0xf0)];}async[a2_0x5c9b28(0x1d3)](_0xb03d1d,_0x3e3a2d,_0x3b1755,_0x2c47f6){const _0x3e8bc4=a2_0x5c9b28;try{const _0x477a3a=await this['checkRequirements'](_0xb03d1d,_0x3b1755,_0x2c47f6);if(!_0x477a3a)return{'metadata':{'result':RESULT[_0x3e8bc4(0x108)],'prompt':_0xb03d1d['prompt'],'command':_0xb03d1d[_0x3e8bc4(0x15a)],'model':_0xb03d1d['model']?.[_0x3e8bc4(0x1bc)]}};const _0x3d2da4=_0xb03d1d['model']?_0xb03d1d[_0x3e8bc4(0x1c6)]:await this[_0x3e8bc4(0x10a)](exports[_0x3e8bc4(0x18f)]);if(!_0x3d2da4)return{'errorDetails':{'message':(0x0,localization_1[_0x3e8bc4(0x1d4)])(_0x3e8bc4(0x159),exports[_0x3e8bc4(0x18f)][_0x3e8bc4(0x1a3)],exports[_0x3e8bc4(0x18f)]['family'])},'metadata':{'result':RESULT[_0x3e8bc4(0x15f)],'prompt':_0xb03d1d[_0x3e8bc4(0x16e)],'command':_0xb03d1d[_0x3e8bc4(0x15a)],'model':_0xb03d1d[_0x3e8bc4(0x1c6)]?.[_0x3e8bc4(0x1bc)]}};logging[_0x3e8bc4(0x19b)](_0x3e8bc4(0x126)+JSON[_0x3e8bc4(0x10f)](_0x3d2da4));if(!_0xb03d1d[_0x3e8bc4(0x15a)])return this[_0x3e8bc4(0x19f)](_0x3d2da4,_0xb03d1d,_0x3e3a2d,_0x3b1755,_0x2c47f6);if(_0xb03d1d[_0x3e8bc4(0x15a)]===COMMAND['EXPLAIN'])return this[_0x3e8bc4(0x1b3)](_0x3d2da4,_0xb03d1d,_0x3b1755,_0x2c47f6,_0x477a3a[_0x3e8bc4(0x175)]);return{'errorDetails':{'message':(0x0,localization_1[_0x3e8bc4(0x1d4)])(_0x3e8bc4(0x143),_0xb03d1d['command'])},'metadata':{'result':RESULT[_0x3e8bc4(0x1c1)],'prompt':_0xb03d1d[_0x3e8bc4(0x16e)],'command':_0xb03d1d[_0x3e8bc4(0x15a)],'model':_0x3d2da4['name']}};}catch(_0xca316f){return logging['error'](_0x3e8bc4(0x113)+_0xca316f),{'errorDetails':{'message':(0x0,localization_1[_0x3e8bc4(0x1d4)])(_0x3e8bc4(0x1d1))},'metadata':{'result':RESULT[_0x3e8bc4(0x138)],'prompt':_0xb03d1d[_0x3e8bc4(0x16e)],'command':_0xb03d1d[_0x3e8bc4(0x15a)],'model':_0xb03d1d[_0x3e8bc4(0x1c6)]?.[_0x3e8bc4(0x1bc)]}};}}async[a2_0x5c9b28(0x19f)](_0x3bfedd,_0x1d37da,_0x250e61,_0x583761,_0x485b67){const _0x56df48=a2_0x5c9b28;if(!_0x1d37da['prompt'][_0x56df48(0x110)]())return _0x583761[_0x56df48(0xf7)]((0x0,localization_1[_0x56df48(0x1d4)])('common.ai.chat.empty_prompt.md')),{'metadata':{'result':RESULT[_0x56df48(0x1c5)],'prompt':_0x1d37da[_0x56df48(0x16e)],'command':_0x1d37da[_0x56df48(0x15a)],'model':_0x3bfedd[_0x56df48(0x1bc)]}};const _0x5bd041=this[_0x56df48(0x10e)](_0x250e61[_0x56df48(0x130)]),_0x2d9763=[vscode['LanguageModelChatMessage']['User'](_0x1d37da[_0x56df48(0x16e)])];this[_0x56df48(0x1ac)](_0x5bd041['concat'](_0x2d9763));try{const _0x3dce24=await _0x3bfedd[_0x56df48(0x164)](_0x5bd041[_0x56df48(0x1a2)](_0x2d9763),{},_0x485b67);for await(const _0x11b45d of _0x3dce24[_0x56df48(0x1b8)]){_0x583761['markdown'](_0x11b45d);}}catch(_0x56ca17){return _0x56ca17?.[_0x56df48(0x158)]?.[_0x56df48(0xe8)](_0x56df48(0x1aa))?_0x583761[_0x56df48(0xf7)]((0x0,localization_1[_0x56df48(0x1d4)])(_0x56df48(0xf4),_0x3bfedd[_0x56df48(0x122)],_0x3bfedd[_0x56df48(0x1bc)])):_0x583761[_0x56df48(0xf7)]((0x0,localization_1[_0x56df48(0x1d4)])(_0x56df48(0x1d1))),{'metadata':{'result':RESULT['ERROR'],'prompt':_0x1d37da['prompt'],'command':_0x1d37da[_0x56df48(0x15a)],'model':_0x3bfedd['name']}};}return telemetry_provider_1[_0x56df48(0x13d)][_0x56df48(0xee)]()?.[_0x56df48(0x106)](_0x56df48(0x11c),{'ps.chat.interaction.mode':_0x56df48(0x1ae)}),{'metadata':{'result':RESULT['SUCCESS'],'prompt':_0x1d37da[_0x56df48(0x16e)],'command':_0x1d37da[_0x56df48(0x15a)],'model':_0x3bfedd[_0x56df48(0x1bc)]}};}async[a2_0x5c9b28(0x10a)](_0x460685){const _0x37cadf=a2_0x5c9b28,_0xad1ed7=await vscode['lm'][_0x37cadf(0xf1)](_0x460685);if(_0xad1ed7[_0x37cadf(0x17a)]===0x0){logging[_0x37cadf(0x1a9)](_0x37cadf(0x18c)+_0x460685[_0x37cadf(0x1a3)]+'\x20'+_0x460685[_0x37cadf(0x122)]);try{const _0x1ecef0=await vscode['lm']['selectChatModels']();logging[_0x37cadf(0x19b)]('Available\x20models:\x20'+JSON['stringify'](_0x1ecef0));}catch(_0x2b0043){logging['error'](_0x37cadf(0x1cb)+_0x2b0043);}return undefined;}return logging[_0x37cadf(0x19b)](_0x37cadf(0x112)+JSON['stringify'](_0xad1ed7)),logging['debug'](_0x37cadf(0x145)+JSON[_0x37cadf(0x10f)](_0xad1ed7[0x0])),_0xad1ed7[0x0];}[a2_0x5c9b28(0x10e)](_0x1688b1){const _0x55b7de=a2_0x5c9b28;this[_0x55b7de(0x179)](_0x1688b1);const _0x512453=[],_0x16ce5d=_0x1688b1[_0x55b7de(0x15c)](_0xa378e7=>_0xa378e7[_0x55b7de(0x18d)]==this[_0x55b7de(0x107)])[_0x55b7de(0x15d)]();for(const _0x245f46 of _0x16ce5d){if(_0x245f46 instanceof vscode[_0x55b7de(0x14c)]){if(!_0x245f46['result'][_0x55b7de(0x124)])return console[_0x55b7de(0x19b)](_0x55b7de(0x1dc)),[];if(_0x245f46['result'][_0x55b7de(0x124)][_0x55b7de(0xed)]!==RESULT['SUCCESS'])return console[_0x55b7de(0x19b)](_0x55b7de(0x141)),[];for(const _0x558ef1 of _0x245f46[_0x55b7de(0x196)]){_0x558ef1 instanceof vscode[_0x55b7de(0x115)]&&_0x512453['push'](vscode[_0x55b7de(0x1cf)][_0x55b7de(0x11a)](_0x558ef1[_0x55b7de(0x19a)][_0x55b7de(0x19a)]));}const _0x3754a1=_0x245f46[_0x55b7de(0xed)][_0x55b7de(0x124)][_0x55b7de(0x123)];_0x3754a1&&_0x512453[_0x55b7de(0x157)](vscode[_0x55b7de(0x1cf)][_0x55b7de(0x11a)](_0x55b7de(0x17e)+this[_0x55b7de(0x17d)]['getTechnologyName']()+'\x20programmer\x20tasked\x20with\x20analyzing\x20and\x20fixing\x20'+(_0x55b7de(0x117)+_0x3754a1['ruleId']+_0x55b7de(0x1b0))+'The\x20rule\x20documentation\x20is:\x0a'+('```\x0a'+_0x3754a1['ruleDoc']['header']+'\x0a'+_0x3754a1[_0x55b7de(0x171)][_0x55b7de(0x1a5)][_0x55b7de(0xfd)]+_0x55b7de(0x128))+(_0x55b7de(0x12c)+_0x3754a1[_0x55b7de(0x11d)]+'```\x0a')+_0x55b7de(0x137)+_0x55b7de(0x1b7)+(_0x55b7de(0xef)+_0x3754a1[_0x55b7de(0xf6)]+'\x0a```\x0a')));}if(_0x245f46 instanceof vscode[_0x55b7de(0x14a)]){if(!_0x245f46[_0x55b7de(0x15a)])_0x512453[_0x55b7de(0x157)](vscode[_0x55b7de(0x1cf)][_0x55b7de(0x11a)](_0x245f46[_0x55b7de(0x16e)]));else{if(_0x245f46[_0x55b7de(0x15a)]===COMMAND[_0x55b7de(0x127)]){}else console['debug'](_0x55b7de(0x10b)+_0x245f46[_0x55b7de(0x15a)]),_0x512453[_0x55b7de(0x157)](vscode['LanguageModelChatMessage'][_0x55b7de(0x11a)](_0x245f46[_0x55b7de(0x16e)]));return _0x512453[_0x55b7de(0x15d)]();}}}return _0x512453[_0x55b7de(0x15d)]();}async[a2_0x5c9b28(0x1b3)](_0x355670,_0xb2bc,_0x30b3af,_0x1a7b00,_0x19b9f2){const _0x36a976=a2_0x5c9b28;assert['ok'](_0xb2bc[_0x36a976(0x15a)]===COMMAND[_0x36a976(0x127)]);const _0x5028ea=ViolationSpecificationParser[_0x36a976(0x186)](_0xb2bc[_0x36a976(0x16e)]);if(!_0x5028ea)return _0x30b3af[_0x36a976(0xf7)]((0x0,localization_1[_0x36a976(0x1d4)])(_0x36a976(0x198),_0xb2bc[_0x36a976(0x16e)])),this[_0x36a976(0x156)](_0x30b3af),{'metadata':{'result':RESULT[_0x36a976(0x165)],'prompt':_0xb2bc['prompt'],'command':_0xb2bc[_0x36a976(0x15a)],'model':_0x355670[_0x36a976(0x1bc)]}};const _0x28a317=(0x0,common_1[_0x36a976(0x1b5)])(_0x5028ea);if(!_0x28a317||typeof _0x28a317['diagnostic']['code']!==_0x36a976(0x10c))return _0x30b3af[_0x36a976(0xf7)]((0x0,localization_1[_0x36a976(0x1d4)])(_0x36a976(0x185),_0xb2bc['prompt'])),this[_0x36a976(0x156)](_0x30b3af),{'metadata':{'result':RESULT[_0x36a976(0x18e)],'prompt':_0xb2bc[_0x36a976(0x16e)],'command':_0xb2bc['command'],'model':_0x355670[_0x36a976(0x1bc)]}};const _0x13057a=new documentation_parser_1[(_0x36a976(0x135))](_0x19b9f2),_0x4682c7=await _0x13057a[_0x36a976(0x12d)](_0x28a317['diagnostic'][_0x36a976(0x11f)]);if(!_0x4682c7)return _0x30b3af['markdown']((0x0,localization_1['i18n'])('common.ai.chat.get.rule_documentation.failed',_0x28a317['diagnostic'][_0x36a976(0x11f)])),{'metadata':{'result':RESULT['NO_DOCUMENTATION'],'prompt':_0xb2bc[_0x36a976(0x16e)],'command':_0xb2bc[_0x36a976(0x15a)],'model':_0x355670['name']}};_0x30b3af['progress']((0x0,localization_1[_0x36a976(0x1d4)])(_0x36a976(0x1ce)));const _0x4a5e0f=await this['getViolationContext'](_0x28a317[_0x36a976(0x180)],_0x28a317[_0x36a976(0x192)]);if(_0x4a5e0f===undefined)return _0x30b3af[_0x36a976(0xf7)]((0x0,localization_1[_0x36a976(0x1d4)])('common.ai.chat.explain.violation_context_not_found')),telemetry_provider_1[_0x36a976(0x13d)][_0x36a976(0xee)]()?.[_0x36a976(0x120)](_0x36a976(0x13c)),{'metadata':{'result':RESULT['CONTEXT_NOT_FOUND'],'prompt':_0xb2bc[_0x36a976(0x16e)],'command':_0xb2bc[_0x36a976(0x15a)],'model':_0x355670[_0x36a976(0x1bc)]}};const _0x15261c={'language':this[_0x36a976(0x163)],'violation':_0x28a317['diagnostic'],'ruleDescription':_0x4682c7?.['header']+'\x0a'+_0x4682c7?.[_0x36a976(0x1a5)][_0x36a976(0xfd)],'contextCode':_0x4a5e0f,'promptPlaceholder':this[_0x36a976(0x17d)]};let _0x5b0b6e=[];try{const _0x4fb56f=await(0x0,prompt_tsx_1[_0x36a976(0x1a7)])(prompt_render_1[_0x36a976(0x129)],_0x15261c,{'modelMaxPromptTokens':_0x355670[_0x36a976(0x1c4)]},_0x355670);_0x5b0b6e=_0x4fb56f['messages'];}catch(_0x4fb6a7){_0x30b3af[_0x36a976(0xf7)]((0x0,localization_1[_0x36a976(0x1d4)])(_0x36a976(0x102))),logging[_0x36a976(0x1a9)](_0x36a976(0x162)+_0x4fb6a7);}try{const _0x51141b=await _0x355670[_0x36a976(0x164)](_0x5b0b6e,{},_0x1a7b00);for await(const _0x555888 of _0x51141b[_0x36a976(0x1b8)]){_0x30b3af['markdown'](_0x555888);}}catch(_0x5d87d8){return _0x5d87d8?.['message']?.[_0x36a976(0xe8)](_0x36a976(0x1aa))?(_0x30b3af[_0x36a976(0xf7)]((0x0,localization_1[_0x36a976(0x1d4)])(_0x36a976(0xf4),_0x355670['family'],_0x355670['name'])),logging['error'](_0x36a976(0x1d0)+_0x5d87d8)):(_0x30b3af[_0x36a976(0xf7)]((0x0,localization_1['i18n'])(_0x36a976(0x1d1))),logging[_0x36a976(0x1a9)](_0x36a976(0x113)+_0x5d87d8)),{'metadata':{'result':RESULT[_0x36a976(0x138)],'prompt':_0xb2bc[_0x36a976(0x16e)],'command':_0xb2bc[_0x36a976(0x15a)],'model':_0x355670[_0x36a976(0x1bc)]}};}return _0x30b3af['button']({'title':(0x0,localization_1[_0x36a976(0x1d4)])(_0x36a976(0xe5),_0x28a317[_0x36a976(0x192)][_0x36a976(0x11f)]),'command':this[_0x36a976(0xfc)]['showRuleDocumentationCommandId'],'arguments':[_0x28a317['diagnostic'][_0x36a976(0x11f)]]}),telemetry_provider_1[_0x36a976(0x13d)][_0x36a976(0xee)]()?.[_0x36a976(0x106)](_0x36a976(0x11c),{'ps.chat.interaction.mode':_0x36a976(0x15a),'ps.chat.interaction.command':_0xb2bc[_0x36a976(0x15a)]}),{'metadata':{'result':RESULT[_0x36a976(0x184)],'prompt':_0xb2bc[_0x36a976(0x16e)],'command':_0xb2bc['command'],'model':_0x355670[_0x36a976(0x1bc)],'violationInfo':{'ruleId':_0x28a317[_0x36a976(0x192)]['code'],'ruleDoc':_0x4682c7,'violationMessage':_0x28a317['diagnostic'][_0x36a976(0x158)],'sourceCode':_0x4a5e0f}}};}[a2_0x5c9b28(0x179)](_0x3268b8){const _0x38a567=a2_0x5c9b28;if(!process['env'][_0x38a567(0x12a)])return;console[_0x38a567(0x133)]('===========\x20Chat\x20history\x20start\x20===========');for(const _0x420369 of _0x3268b8){if(_0x420369 instanceof vscode[_0x38a567(0x14a)])console[_0x38a567(0x133)](_0x38a567(0xe6)+('#\x20command:\x20'+_0x420369[_0x38a567(0x15a)]+'\x0a')+('#\x20prompt:\x20'+_0x420369['prompt']+'\x0a$'));else{if(_0x420369 instanceof vscode['ChatResponseTurn']){const _0x41b635=_0x420369[_0x38a567(0x196)][_0x38a567(0x15c)](_0x48f3a5=>_0x48f3a5 instanceof vscode[_0x38a567(0x115)])['map'](_0x2d80ca=>_0x2d80ca[_0x38a567(0x19a)][_0x38a567(0x19a)])[_0x38a567(0x1bb)]('');console['log'](_0x38a567(0x14d)+(_0x38a567(0x1cc)+_0x420369[_0x38a567(0x15a)]+'\x0a')+('#\x20response:\x20'+_0x41b635+'\x0a')+(_0x38a567(0x193)+JSON['stringify'](_0x420369[_0x38a567(0xed)][_0x38a567(0x1c0)])+'\x0a')+(_0x38a567(0x132)+JSON[_0x38a567(0x10f)](_0x420369[_0x38a567(0xed)][_0x38a567(0x124)],undefined,0x2)+'\x0a'));}else console[_0x38a567(0x133)](_0x38a567(0x1b6)+JSON[_0x38a567(0x10f)](_0x420369));}}console[_0x38a567(0x133)](_0x38a567(0x136));}[a2_0x5c9b28(0x1ac)](_0x12c604){const _0x3c689a=a2_0x5c9b28;if(!process[_0x3c689a(0x13b)]['PARASOFT_VSCODE_DEBUG_CHAT_MESSAGES'])return;console[_0x3c689a(0x133)](_0x3c689a(0x16b));for(const _0x50a3fd of _0x12c604){console[_0x3c689a(0x19b)](_0x3c689a(0x1d7)+_0x50a3fd[_0x3c689a(0x1c2)]+'\x20'+JSON[_0x3c689a(0x10f)](_0x50a3fd[_0x3c689a(0x12f)]));}console['log'](_0x3c689a(0x125));}async[a2_0x5c9b28(0x1bf)](_0x39b8d1,_0x2b246e){const _0x55daa2=a2_0x5c9b28;try{const _0x2167ae=await vscode[_0x55daa2(0x191)]['openTextDocument'](_0x39b8d1),_0x2edba9=await this[_0x55daa2(0x17f)][_0x55daa2(0x16f)](_0x2167ae,_0x2b246e),_0x1567ba=this[_0x55daa2(0xf9)][_0x55daa2(0x189)](this['codeExtractor']['getTextFromRange'](_0x2167ae,_0x2edba9),_0x2edba9,_0x2b246e);return _0x1567ba;}catch(_0x136330){return logging[_0x55daa2(0x1a9)](_0x55daa2(0x13e)+_0x136330),undefined;}}[a2_0x5c9b28(0x156)](_0x221773){const _0x5c124f=a2_0x5c9b28;_0x221773[_0x5c124f(0xf7)]((0x0,localization_1[_0x5c124f(0x1d4)])(_0x5c124f(0x1d6))),_0x221773['button']({'title':(0x0,localization_1[_0x5c124f(0x1d4)])(_0x5c124f(0x104)),'command':_0x5c124f(0x174)});}async['checkRequirements'](_0x24d9e3,_0x4f75f8,_0x35bcb9){const _0x2b6dd5=a2_0x5c9b28,_0x27f6f4=await(0x0,common_1[_0x2b6dd5(0x153)])();if(!_0x27f6f4)return _0x4f75f8['markdown']((0x0,localization_1[_0x2b6dd5(0x1d4)])('common.ai.chat.no_workspace_folder',this[_0x2b6dd5(0xfc)][_0x2b6dd5(0x1c7)])),this[_0x2b6dd5(0x12b)](_0x4f75f8,_0x24d9e3),undefined;if(!this[_0x2b6dd5(0x103)](_0x4f75f8,_0x24d9e3))return undefined;const _0x239c25=vscode[_0x2b6dd5(0x191)][_0x2b6dd5(0x18a)](this['toolInfo'][_0x2b6dd5(0x1d8)],_0x27f6f4[_0x2b6dd5(0x180)]),_0x1f2e92=_0x239c25[_0x2b6dd5(0xfb)](this[_0x2b6dd5(0xfc)][_0x2b6dd5(0x100)]);if(!_0x1f2e92)return _0x4f75f8[_0x2b6dd5(0xf7)]((0x0,localization_1['i18n'])(_0x2b6dd5(0x170),this[_0x2b6dd5(0xfc)]['analyzerShortName'])),this['addSelectInstallDirButton'](this[_0x2b6dd5(0xfc)][_0x2b6dd5(0x1c7)],_0x4f75f8),this[_0x2b6dd5(0x12b)](_0x4f75f8,_0x24d9e3),this[_0x2b6dd5(0x1da)]('installLocation'),undefined;const _0x53271a=await(0x0,docs_1[_0x2b6dd5(0x19c)])(_0x1f2e92,this[_0x2b6dd5(0xfc)][_0x2b6dd5(0x160)]);if(!_0x53271a)return _0x4f75f8['markdown']((0x0,localization_1[_0x2b6dd5(0x1d4)])(_0x2b6dd5(0x178),this[_0x2b6dd5(0xfc)][_0x2b6dd5(0x1c7)])),this[_0x2b6dd5(0x15e)](this[_0x2b6dd5(0xfc)][_0x2b6dd5(0x1c7)],_0x4f75f8),this['addTryAgainButton'](_0x4f75f8,_0x24d9e3),this[_0x2b6dd5(0x1da)](_0x2b6dd5(0x134)),undefined;if(!await this[_0x2b6dd5(0x194)](_0x1f2e92,_0x27f6f4,_0x4f75f8,_0x24d9e3,_0x35bcb9))return undefined;return{'rulesDocFolder':_0x53271a};}['checkLanguageExtension'](_0xffa04f,_0x41bf59){const _0x200b94=a2_0x5c9b28;for(const _0x2d00f1 of this['toolInfo']['languageExtensionIds']){const _0x149d4e=vscode['extensions'][_0x200b94(0x109)](_0x2d00f1);if(_0x149d4e)return logging[_0x200b94(0x19b)]('Language\x20support\x20extension\x20'+_0x2d00f1+'\x20is\x20installed.'),!![];}const _0x5c9882=this[_0x200b94(0xfc)]['languageExtensionIds'][0x0];return logging[_0x200b94(0x19b)](_0x200b94(0x1ba)),_0xffa04f[_0x200b94(0xf7)]((0x0,localization_1[_0x200b94(0x1d4)])(_0x200b94(0x17b))),_0xffa04f[_0x200b94(0xea)]({'title':(0x0,localization_1[_0x200b94(0x1d4)])(_0x200b94(0x142)),'command':_0x200b94(0x131),'arguments':[_0x5c9882]}),this['addTryAgainButton'](_0xffa04f,_0x41bf59),this[_0x200b94(0x1da)](_0x200b94(0x14e)),![];}async['checkLicense'](_0x59fce1,_0x44f5ca,_0x377c58,_0x24a348,_0x7edd6b){const _0x15001b=a2_0x5c9b28;if(this[_0x15001b(0x16a)])return!![];_0x377c58[_0x15001b(0x1a0)]((0x0,localization_1[_0x15001b(0x1d4)])(_0x15001b(0x116),this[_0x15001b(0xfc)][_0x15001b(0x1c7)]));const _0x3f1ccd=await(0x0,runner_1[_0x15001b(0x1c8)])(this['licenseChecker'],_0x59fce1,_0x44f5ca,_0x7edd6b);if(_0x3f1ccd===runner_1[_0x15001b(0x1d2)][_0x15001b(0x111)])return this['isLicensed']=!![],!![];return _0x377c58[_0x15001b(0xf7)]((0x0,localization_1[_0x15001b(0x1d4)])(_0x3f1ccd===runner_1['LicenseCheckStatus'][_0x15001b(0x190)]?'common.ai.chat.license_workspace_locked':_0x15001b(0x151),this['toolInfo']['analyzerShortName'])),this['addTryAgainButton'](_0x377c58,_0x24a348),_0x3f1ccd===runner_1[_0x15001b(0x1d2)][_0x15001b(0x1af)]&&this['sendMissingRequirementTelemetry'](_0x15001b(0x1d5)),![];}async[a2_0x5c9b28(0x146)](){const _0x406a48=a2_0x5c9b28,_0x571817='github.copilot-chat',_0x95dd3=vscode[_0x406a48(0x148)]['getExtension'](_0x571817);if(!_0x95dd3){logging[_0x406a48(0x19b)]('GitGub\x20Copilot\x20Chat\x20extension\x20is\x20not\x20installed.\x20Asking\x20user\x20if\x20he\x20wants\x20to\x20install\x20it');const _0x1089eb=(0x0,localization_1['i18n'])('common.install.extension'),_0x551ad5=(0x0,localization_1[_0x406a48(0x1d4)])('common.cancel'),_0x3ce3e0=await vscode[_0x406a48(0x1bd)][_0x406a48(0xec)]((0x0,localization_1[_0x406a48(0x1d4)])(_0x406a48(0x19e)),_0x1089eb,_0x551ad5);return _0x3ce3e0==_0x1089eb&&(logging[_0x406a48(0x19b)](_0x406a48(0x1a4)),vscode[_0x406a48(0xf8)][_0x406a48(0x101)]('workbench.extensions.search',_0x571817)),![];}return!![];}[a2_0x5c9b28(0x15e)](_0x42ac30,_0x3c9b23){const _0x40cab5=a2_0x5c9b28;_0x3c9b23[_0x40cab5(0xea)]({'title':(0x0,localization_1['i18n'])(_0x40cab5(0x10d),_0x42ac30),'command':this[_0x40cab5(0xfc)]['selectInstallLocationCommandId']});}['addTryAgainButton'](_0x2179ed,_0x5e5c69){const _0x1fc947=a2_0x5c9b28,_0x2e1d72=_0x5e5c69[_0x1fc947(0x15a)]?'@'+this[_0x1fc947(0xfe)]+'\x20/'+_0x5e5c69[_0x1fc947(0x15a)]+'\x20'+_0x5e5c69[_0x1fc947(0x16e)]:'@'+this[_0x1fc947(0xfe)]+'\x20'+_0x5e5c69[_0x1fc947(0x16e)];_0x2179ed[_0x1fc947(0xea)]({'title':(0x0,localization_1[_0x1fc947(0x1d4)])(_0x1fc947(0x1db)),'command':_0x1fc947(0x1b9),'arguments':[_0x2e1d72]});}['sendUserFeedbackTelemetry'](_0x1caa6c){const _0x5d2d83=a2_0x5c9b28,_0x5d69ba=_0x1caa6c[_0x5d2d83(0xe7)]===vscode[_0x5d2d83(0x1b2)][_0x5d2d83(0xeb)]?_0x5d2d83(0xeb):'Unhelpful';telemetry_provider_1[_0x5d2d83(0x13d)][_0x5d2d83(0xee)]()?.[_0x5d2d83(0x106)](_0x5d2d83(0x17c),{'ps.chat.feedback.kind':_0x5d69ba});}['sendMissingRequirementTelemetry'](_0x2b7c8f){const _0xe27279=a2_0x5c9b28;telemetry_provider_1[_0xe27279(0x13d)][_0xe27279(0xee)]()?.[_0xe27279(0x120)](_0xe27279(0x155),{'ps.chat.requirementMissing.kind':_0x2b7c8f});}}exports[a2_0x5c9b28(0x121)]=ParasoftAIChatParticipant;