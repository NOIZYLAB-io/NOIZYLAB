import{a as Ct}from"./chunk-KGCYESDM.js";import{a as Kt,b as wt}from"./chunk-4KN7ZFA5.js";import{a as xe}from"./chunk-KR6XSNEV.js";import{a as Pt,b as vt}from"./chunk-OJNDYEPL.js";import{c as Tt}from"./chunk-ZULDP422.js";import{$ as $e,$a as Qe,$c as Dt,Ab as se,Ac as De,Bb as me,Cb as be,E as He,Fb as et,G as Le,Gb as tt,H as We,Hb as Q,I as Oe,Ib as ae,Ic as ft,Jb as nt,Jc as ht,Kb as rt,L as Fe,Lb as it,M as Ue,Mb as $,N as _e,Nb as fe,O as Ge,Ob as ot,Oc as p,P as Ke,Qb as st,Rb as at,Sb as he,Tb as lt,Ub as Se,Vb as pt,W as O,Wb as dt,Xb as ct,Yb as ut,Za as Ye,_a as Je,c,ca as je,d as M,dd as xt,eb as C,f as Gt,gb as Ze,h as W,ha as Xe,hb as F,ib as ce,j as S,k as N,mb as ue,n as ke,nb as ge,oa as qe,p as w,t as Ne,u as Ee,v as Me,wc as gt,x as Ae,y as Ve,yb as J,yc as mt,zc as bt}from"./chunk-V3XRZIHQ.js";var Ft=c(Gt());var A=c(M()),It=c(w()),I=(0,A.createContext)(void 0),yt=({children:r})=>{let e=vt(),[t,l]=(0,A.useState)(300),[s,n]=(0,A.useState)(!1),[u,d]=(0,A.useState)(300),[T,D]=(0,A.useState)(450),[g,a]=(0,A.useState)(!1),[m,R]=(0,A.useState)(450),o=(0,A.useRef)({}),x=e?.state;function h(y){return`${x.tableInfo?.id}_${y.join("_")}`}return(0,It.jsx)(I.Provider,{value:{...xt(e),processTableEdit:function(y){e?.extensionRpc.action("processTableEdit",{table:x.tableInfo,tableChangeInfo:y})},publishChanges:function(){e?.extensionRpc.action("publishChanges",{table:x.tableInfo})},generateScript:function(){e?.extensionRpc.action("generateScript",{table:x.tableInfo})},generatePreviewReport:function(){e?.extensionRpc.action("generatePreviewReport",{table:x.tableInfo})},initializeTableDesigner:function(){e?.extensionRpc.action("initializeTableDesigner",{table:x.tableInfo})},scriptAsCreate:function(){e?.extensionRpc.action("scriptAsCreate",{})},copyScriptAsCreateToClipboard:function(){e?.extensionRpc.action("copyScriptAsCreateToClipboard",{})},setTab:function(y){e?.extensionRpc.action("setTab",{tabId:y})},getComponentId:h,getErrorMessage:function(y){let K=y.join("."),V=[];for(let U of x.issues??[])U.propertyPath&&U.propertyPath?.join(".")===K&&V.push(U.description);if(V.length!==0)return V.join(`
`)??""},setPropertiesComponents:function(y){e?.extensionRpc.action("setPropertiesComponents",{components:y})},setResultTab:function(y){e?.extensionRpc.action("setResultTab",{tabId:y})},closeDesigner:function(){e?.extensionRpc.action("closeDesigner",{})},continueEditing:function(){e?.extensionRpc.action("continueEditing",{})},copyPublishErrorToClipboard:function(){e?.extensionRpc.action("copyPublishErrorToClipboard",{})},state:e?.state,themeKind:e?.themeKind,resultPaneResizeInfo:{originalHeight:u,setOriginalHeight:d,isMaximized:s,setIsMaximized:n,currentHeight:t,setCurrentHeight:l},propertiesPaneResizeInfo:{originalWidth:m,setOriginalWidth:R,isMaximized:g,setIsMaximized:a,currentWidth:T,setCurrentWidth:D},elementRefs:o,addElementRef:function(y,K,V){let U=h(y);if(!(V==="PropertiesView"&&o.current[U]))return o.current[U]=K}},children:r})};var Wt=c(M());var ze=c(Kt());var zt=c(M());var Pe=c(M());var i=c(w()),jt=N({dialogContent:{height:"300px",overflow:"auto",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",flexDirection:"column"},openScript:{width:"150px"},updateDatabase:{width:"150px"},errorIcon:{fontSize:"100px",opacity:.5,color:"var(--vscode-errorForeground)"},dialogFooterButtons:{marginTop:"10px"},markdownContainer:{width:"calc(100% - 40px)",height:"calc(100% - 80px)",alignItems:"center",justifyContent:"center",border:"1px solid #e0e0e0",overflow:"auto",padding:"10px 5px 5px 10px",margin:"5px",backgroundColor:"var(--vscode-editor-background)"}}),St=()=>{let r=(0,Pe.useContext)(I),e=jt();if(!r)return null;let[t,l]=(0,Pe.useState)(!1),s=r.state,n=()=>{switch(s?.apiState?.generateScriptState){case"Loading":return(0,i.jsx)(J,{size:"extra-small"});case"Error":return(0,i.jsx)(O,{});default:return}},u=()=>(0,i.jsx)(Q,{disableButtonEnhancement:!0,children:(0,i.jsx)(C,{appearance:"secondary",onClick:()=>l(!1),children:p.common.close})}),d=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)($,{className:e.dialogContent,children:(0,i.jsx)(J,{label:p.tableDesigner.publishingChanges,labelPosition:"below"})})}),T=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($,{children:(0,i.jsxs)(gt,{intent:"error",style:{paddingRight:"12px"},children:[(0,i.jsx)(bt,{style:{textAlign:"justify"},children:s?.publishingError??""}),(0,i.jsx)(mt,{children:(0,i.jsx)(C,{onClick:()=>r.copyPublishErrorToClipboard(),icon:(0,i.jsx)(Ue,{}),children:p.tableDesigner.copy})})]})}),(0,i.jsxs)(ae,{children:[(0,i.jsx)(C,{appearance:"primary",onClick:()=>{r.publishChanges()},children:p.tableDesigner.retry}),(0,i.jsx)(C,{onClick:()=>{l(!1),r.generatePreviewReport()},style:{width:"150px"},children:p.tableDesigner.backToPreview}),u()]})]}),D=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)($,{className:e.dialogContent,children:(0,i.jsx)("div",{children:p.tableDesigner.changesPublishedSuccessfully})}),(0,i.jsxs)(ae,{children:[(0,i.jsx)(C,{size:"medium",appearance:"primary",onClick:r.closeDesigner,children:p.tableDesigner.closeDesigner}),(0,i.jsx)(Q,{action:"close",children:(0,i.jsx)(C,{size:"medium",appearance:"secondary",onClick:()=>{l(!1),r.continueEditing},children:p.tableDesigner.continueEditing})})]})]}),g=()=>(0,i.jsx)(i.Fragment,{children:(0,i.jsx)($,{className:e.dialogContent,children:(0,i.jsx)(J,{label:p.tableDesigner.loadingPreviewReport,labelPosition:"below"})})}),a=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)($,{className:e.dialogContent,children:[(0,i.jsx)(O,{className:e.errorIcon}),(0,i.jsx)("div",{children:r.state.generatePreviewReportResult?.schemaValidationError??p.tableDesigner.errorLoadingPreview})]}),(0,i.jsxs)(ae,{children:[(0,i.jsx)(Q,{action:"close",children:(0,i.jsx)(C,{className:e.dialogFooterButtons,children:p.common.close})}),(0,i.jsx)(C,{className:e.dialogFooterButtons,onClick:()=>{r.generatePreviewReport()},children:p.tableDesigner.retry})]})]}),m=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)($,{children:[(0,i.jsx)("div",{className:e.markdownContainer,children:(0,i.jsx)(Ct,{children:s?.generatePreviewReportResult?.report})}),(0,i.jsx)(ce,{label:p.tableDesigner.designerPreviewConfirmation,required:!0,checked:t,onChange:(o,x)=>{l(x.checked)},autoFocus:!0,onFocus:o=>{o.target.parentElement&&(o.target.parentElement.style.outlineStyle="solid",o.target.parentElement.style.outlineColor="var(--vscode-focusBorder)")},onBlur:o=>{o.target.parentElement&&(o.target.parentElement.style.outline="none",o.target.parentElement.style.outlineColor="")}})]}),(0,i.jsxs)(ae,{children:[u(),(0,i.jsx)(Q,{action:"close",children:(0,i.jsx)(C,{icon:n(),iconPosition:"after",className:e.openScript,disabled:s.apiState?.previewState!=="Loaded",appearance:"secondary",onClick:r.generateScript,children:p.tableDesigner.generateScript})}),(0,i.jsx)(C,{className:e.updateDatabase,disabled:!t,title:t?p.tableDesigner.updateDatabase:p.tableDesigner.youMustReviewAndAccept,appearance:"primary",onClick:()=>{r.publishChanges()},children:p.tableDesigner.updateDatabase})]})]}),R=()=>{if(s?.apiState?.publishState==="Loading")return d();if(s?.apiState?.publishState==="Loaded")return D();if(s?.apiState?.publishState==="Error")return T();if(s?.apiState?.previewState==="Loading")return g();if(s?.apiState?.previewState==="Error")return a();if(s?.apiState?.previewState==="Loaded")return m()};return(0,i.jsxs)(tt,{inertTrapFocus:!0,children:[(0,i.jsx)(Q,{disableButtonEnhancement:!0,children:(0,i.jsx)(ot,{"aria-label":p.tableDesigner.publish,title:p.tableDesigner.publish,icon:(0,i.jsx)(_e,{}),onClick:()=>{r.generatePreviewReport()},disabled:(s?.issues?.length??0)>0,children:p.tableDesigner.publish})}),(0,i.jsx)(it,{children:(0,i.jsxs)(nt,{children:[(0,i.jsx)(rt,{children:p.tableDesigner.previewDatabaseUpdates}),R()]})})]})};var Z=c(w()),Xt=N({separator:{...S.margin("0px","-20px","0px","0px"),...S.padding("0px"),fontSize:"5px"}}),Bt=()=>{let r=(0,zt.useContext)(I),e=Xt();if(r)return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(fe,{size:"small",children:(0,Z.jsx)(St,{})}),(0,Z.jsx)(ue,{className:e.separator})]})};var q=c(M());var Nt=c(M());var ee=c(M());var ve=c(w()),te=({component:r,model:e,componentPath:t,UiArea:l,showLabel:s=!0})=>{let[n,u]=(0,ee.useState)(e.checked),d=(0,ee.useContext)(I);if(d)return(0,ee.useEffect)(()=>{u(e.checked)},[e]),(0,ve.jsx)(F,{size:"small",label:s?(0,ve.jsx)(Ze,{size:"small",style:{lineHeight:"22px"},children:r.componentProperties.title}):void 0,orientation:"horizontal",style:{width:r.componentProperties.width??l==="PropertiesView"?"100%":"400px"},children:(0,ve.jsx)(ce,{ref:T=>d.addElementRef(t,T,l),checked:n,onChange:async(T,D)=>{e.enabled!==!1&&await d.processTableEdit({path:t,value:D.checked,type:2,source:l})},style:{fontSize:"12px"},size:"medium",disabled:e.enabled===void 0?!1:!e.enabled})})};var re=c(M());var ne=c(w()),j=({component:r,model:e,componentPath:t,UiArea:l,multiline:s=!1,showLabel:n=!0,showError:u=!0,horizontal:d=!1})=>{let[T,D]=(0,re.useState)(e.value),g=(0,re.useContext)(I);if(!g)return;let a=ke(g.getComponentId(t)??""),m=l==="PropertiesView"?"100%":r.componentProperties.width??"400px";return(0,re.useEffect)(()=>{D(e.value)},[e]),(0,ne.jsx)(F,{label:{children:n?(0,ne.jsx)(De,{size:"small",info:r.description,children:n?r.componentProperties.title:void 0}):void 0},validationState:g.getErrorMessage(t)?"error":void 0,validationMessage:u?g.getErrorMessage(t):void 0,validationMessageIcon:u&&g.getErrorMessage(t)?(0,ne.jsx)(O,{}):void 0,style:{width:m},size:"small",orientation:d?"horizontal":"vertical",children:s?(0,ne.jsx)(et,{"aria-labelledby":a,ref:R=>g.addElementRef(t,R,l),value:T??"",onChange:(R,o)=>{D(o.value??"")},onBlur:async()=>{T!==e.value&&await g?.processTableEdit({path:t,value:T,type:2,source:l})},disabled:e.enabled===void 0?!1:!e.enabled,size:"small"}):(0,ne.jsx)(ge,{"aria-labelledby":a,ref:R=>g.addElementRef(t,R,l),value:T??"",onChange:(R,o)=>{D(o.value??"")},onBlur:async()=>{T!==e.value&&await g.processTableEdit({path:t,value:T,type:2,source:l})},disabled:e.enabled===void 0?!1:!e.enabled,type:e.inputType,size:"small"})})};var ie=c(M());var Ce=c(w()),oe=({component:r,model:e,componentPath:t,UiArea:l,showLabel:s=!0,showError:n=!0,horizontal:u=!1})=>{let[d,T]=(0,ie.useState)([]),D=(0,ie.useContext)(I);if(!D)return;let g=l==="PropertiesView"?"100%":r.componentProperties.width??"350px";return(0,ie.useEffect)(()=>{T([e.value])},[e]),(0,Ce.jsx)(F,{label:{children:s?(0,Ce.jsx)(De,{size:"small",info:r.description,children:s?r.componentProperties.title:void 0}):void 0},validationState:n&&D.getErrorMessage(t)?"error":void 0,validationMessage:n?D.getErrorMessage(t):"",style:{width:g},size:"small",orientation:u?"horizontal":"vertical",children:(0,Ce.jsx)(xe,{style:{width:g,minWidth:g,maxWidth:g,border:D.getErrorMessage(t)?"1px solid var(--vscode-errorForeground)":void 0},options:e.values.sort((a,m)=>a.localeCompare(m)).map(a=>({text:a,value:a})),onSelect:a=>{e.enabled!==!1&&D.processTableEdit({path:t,value:a.value.toString(),type:2,source:l})},size:"small",selectedOption:{value:d[0]}})})};var G=c(M());var f=c(w()),kt=c(M()),Yt=N({tableCell:{display:"flex",flexDirection:"row"},tableActionIcon:{height:"14px",width:"14px"}}),Te=({component:r,model:e,componentPath:t,UiArea:l,loadPropertiesTabData:s=!0})=>{let n=r.componentProperties,u=(0,G.useContext)(I);if(!u)return;let d=Yt(),T=W("Move Up"),D=W("Move Down"),g=n.columns.map(b=>{let P=n.itemProperties?.find(k=>k.propertyName===b);return he({columnId:b,renderHeaderCell:()=>(0,f.jsx)(f.Fragment,{children:P?.componentProperties.title??b})})});n.canMoveRows&&g.unshift(he({columnId:"dragHandle",renderHeaderCell:()=>(0,f.jsx)(f.Fragment,{})})),n.canRemoveRows&&g.push(he({columnId:"remove",renderHeaderCell:()=>{let b=W("Delete");return(0,f.jsx)(f.Fragment,{children:b})}}));let a=e.data?.map(b=>b)??[],[m]=(0,G.useState)(g),R=()=>{let b={};return n.columns.forEach(P=>{let k=n.itemProperties?.find(L=>L.propertyName===P);k&&(b[P]={minWidth:k?.componentProperties.width??70,idealWidth:k?.componentProperties.width??70,defaultWidth:k?.componentProperties.width??70})}),n.canMoveRows&&(b.dragHandle={minWidth:15,idealWidth:15,defaultWidth:15}),n.canRemoveRows&&(b.remove={minWidth:35,idealWidth:35,defaultWidth:35}),b},[o]=(0,G.useState)(R()),{getRows:x,columnSizing_unstable:h,tableRef:y}=at({columns:m,items:a},[st({columnSizingOptions:o,autoFitColumns:!1,containerWidthOffset:20})]),K=x(),V=(b,P)=>{u.processTableEdit({type:3,path:[...t,b],value:P,source:l});let k=u?.getComponentId([...t,P,m[1].columnId]);u.elementRefs.current[k]?.focus()},U=b=>u?.state.issues?.find(k=>k.propertyPath?k.propertyPath.join(".")===[...t,b].join("."):!1)?.description??void 0,Ut=(b,P,k)=>{let L=n.itemProperties?.find(pe=>pe.propertyName===P),_=b.item[P];switch(P){case"dragHandle":return(0,f.jsx)("div",{className:d.tableCell,children:n.canMoveRows&&(0,f.jsx)(C,{appearance:"subtle",size:"small",icon:(0,f.jsx)(Xe,{}),draggable:!0,onDragEnter:()=>{Re(k)},onDragEnd:()=>{Y===-1||le===-1||(V(Y,le),Ie(-1),Re(-1))},onDrag:()=>{Ie(k)},onDragStart:()=>{Re(-1),Ie(k)}})});case"remove":return(0,f.jsx)(C,{disabled:b.item.canBeDeleted?!b.item.canBeDeleted:!1,appearance:"subtle",size:"small",icon:(0,f.jsx)(Ge,{}),onClick:async()=>{u.processTableEdit({path:[...t,b.rowId],source:l,type:1,value:void 0})},title:p.tableDesigner.remove(n.objectTypeDisplayName)});default:switch(L?.componentType){case"input":return(0,f.jsx)(j,{component:L,model:_,componentPath:[...t,b.rowId,P],UiArea:l,showLabel:!1,showError:!1});case"dropdown":return(0,f.jsx)("div",{className:d.tableCell,children:(0,f.jsx)(oe,{component:L,model:_,componentPath:[...t,b.rowId,P],UiArea:"TabsView",showLabel:!1,showError:!1})});case"checkbox":return(0,f.jsx)("div",{className:d.tableCell,children:(0,f.jsx)(te,{component:L,model:_,componentPath:[...t,b.rowId,P],UiArea:l,showLabel:!1})});default:return"Unknown component type"}}},[Y,Ie]=(0,G.useState)(-1),[le,Re]=(0,G.useState)(-1),[H,_t]=(0,G.useState)(void 0);return(0,f.jsxs)("div",{children:[(0,f.jsxs)(fe,{size:"small",children:[n.canAddRows&&(0,f.jsx)(C,{appearance:"transparent",icon:(0,f.jsx)(Me,{className:d.tableActionIcon}),onClick:()=>{u.processTableEdit({path:[...t,K.length],source:l,type:0,value:void 0})},size:"small",children:n.labelForAddNewButton}),n.canMoveRows&&(0,f.jsx)(C,{icon:(0,f.jsx)(Ve,{className:d.tableActionIcon}),onClick:b=>{b.target.focus(),V(H,H-1)},disabled:H===void 0||H===0,size:"small",appearance:"transparent",children:T}),n.canMoveRows&&(0,f.jsx)(C,{icon:(0,f.jsx)(Ae,{className:d.tableActionIcon}),onClick:b=>{b.target.focus(),V(H,H+1)},disabled:H===void 0||H===K.length-1,size:"small",appearance:"transparent",children:D})]}),(0,f.jsx)("div",{style:{maxWidth:"calc(100% - 20px)",width:"fit-content",overflowX:"auto",paddingBottom:"5px",paddingRight:"5px",paddingLeft:"5px"},children:(0,f.jsxs)(dt,{as:"table",size:"extra-small",...h.getTableProps(),ref:y,style:{marginRight:"5px",width:Object.keys(o).reduce((b,P)=>b+o[P].idealWidth+22,0)-20},children:[(0,f.jsx)(ct,{style:{marginBottom:"5px",backgroundColor:"var(--vscode-keybindingTable-headerBackground)"},children:(0,f.jsx)(Se,{children:g.map(b=>(0,kt.createElement)(ut,{...h.getTableHeaderCellProps(b.columnId),key:b.columnId},b.renderHeaderCell()))})}),(0,f.jsx)(pt,{children:K.map((b,P)=>{let k=U(P),L=H===P?"var(--vscode-list-hoverBackground)":"var(--vscode-editor-background)",_=k?"1px solid var(--vscode-errorForeground)":"",pe="3px solid var(--vscode-focusBorder)";return(0,f.jsx)(Se,{style:{backgroundColor:L,width:"calc(100% - 10px)",borderTop:le===P&&Y!==P&&Y>P?pe:_,borderBottom:le===P&&Y!==P&&Y<P?pe:_,borderLeft:_,borderRight:_,marginTop:k?"5px":""},onFocus:de=>{!s||n.showItemDetailInPropertiesView===!1||(u?.setPropertiesComponents({componentPath:[...t,b.rowId],component:r,model:e}),_t(P),de.preventDefault())},children:g.map((de,Be)=>(0,f.jsx)(lt,{...h.getTableCellProps(de.columnId),id:`table-cell-${u?.state.tableInfo?.id}-${t.join("-")}_${P}-${Be}`,style:{height:"30px",paddingBottom:"5px"},children:Ut(b,de.columnId,P)},t.join(".")+P+Be))},t.join(".")+P)})})]})})]})};var X=c(w()),Jt=N({root:{width:"100%",height:"100%",overflowX:"auto",display:"flex",flexDirection:"column",paddingTop:"10px",paddingLeft:"10px",...S.gap("10px")}}),Et=({tabId:r})=>{let e=Jt(),l=(0,Nt.useContext)(I)?.state;if(!l)return null;let s=l.view?.tabs.find(n=>n.id===r)?.components;return(0,X.jsx)("div",{className:e.root,children:s?.filter(n=>n.componentProperties.enabled===void 0||n.componentProperties.enabled).map(n=>{switch(n.componentType){case"input":{let u=l.model[n.propertyName];return(0,X.jsx)(j,{component:n,model:u,componentPath:[n.propertyName],UiArea:"TabsView"},n.propertyName)}case"textarea":{let u=l.model[n.propertyName];return(0,X.jsx)(j,{component:n,model:u,componentPath:[n.propertyName],UiArea:"TabsView",multiline:!0,autoAdjustHeight:!0},n.propertyName)}case"dropdown":{let u=l.model[n.propertyName];return(0,X.jsx)(oe,{component:n,model:u,componentPath:[n.propertyName],UiArea:"TabsView"},n.propertyName)}case"checkbox":{let u=l.model[n.propertyName];return(0,X.jsx)(te,{component:n,model:u,componentPath:[n.propertyName],UiArea:"TabsView"},n.propertyName)}case"table":{let u=l.model[n.propertyName];return(0,X.jsx)(Te,{component:n,model:u,componentPath:[n.propertyName],UiArea:"TabsView"},n.propertyName)}default:return null}})})};var E=c(w()),Qt=N({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},title:{...S.margin("10px","5px","5px","5px"),gap:"10px",width:"400px",maxWidth:"100%",padding:"10px","> *":{marginBottom:"10px"}},separator:{...S.margin("0px","-20px","0px","0px"),...S.padding("0px"),fontSize:"5px"},form:{height:"100%",maxWidth:"100%",overflow:"hidden"},tabButtonContainer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center","> *":{marginRight:"5px"}}}),Mt=()=>{let r=Qt(),e=(0,q.useContext)(I),t=e?.state;if(!t)return null;let[l,s]=(0,q.useState)(t.model.name.value),[n,u]=(0,q.useState)(t.model.schema.value);(0,q.useEffect)(()=>{s(t.model.name.value),u(t.model.schema.value)},[t.model]);let d=a=>{let m=t.view?.tabs.find(o=>o.id===a)?.components;if(!m||t.issues?.length===0)return 0;let R=0;for(let o=0;o<t?.issues.length;o++){let x=t.issues[o];x.propertyPath&&x.propertyPath.length>0&&m.find(h=>h.propertyName===x.propertyPath[0])&&R++}return R};function T(a){let m=d(a);if(m===1)return W({message:"{0} issue",args:[m],comment:["{0} is the number of issues"]});if(m>1||m===0)return W({message:"{0} issues",args:[m],comment:["{0} is the number of issues"]})}function D(a){let m=d(a);return m===0?a:m===1?W({message:"{0} {1} issue",args:[a,m],comment:["{0} is the tab name","{1} is the number of issues"]}):W({message:"{0} {1} issues",args:[a,m],comment:["{0} is the tab name","{1} is the number of issues"]})}function g(){let a=(t?.model?.schema).values,m=new Set(["db_accessadmin","db_backupoperator","db_datareader","db_datawriter","db_ddladmin","db_denydatareader","db_denydatawriter","db_owner","db_securityadmin"]),R=[],o=[];for(let x of a)m.has(x)?o.push(x):R.push(x);return R.sort((x,h)=>x.localeCompare(h)),o.sort((x,h)=>x.localeCompare(h)),[...R,...o]}return(0,E.jsxs)("div",{className:r.root,children:[(0,E.jsxs)("div",{className:r.title,children:[(0,E.jsx)(F,{label:p.tableDesigner.tableName,orientation:"horizontal",children:(0,E.jsx)(ge,{size:"medium",value:l,onChange:(a,m)=>{s(m.value)},autoFocus:!0,onBlur:a=>{e.processTableEdit({source:"TabsView",type:2,path:["name"],value:l})}})}),(0,E.jsx)(F,{label:p.tableDesigner.schema,orientation:"horizontal",children:(0,E.jsx)(xe,{size:"medium",options:g().map(a=>({value:a})),onSelect:a=>{e.processTableEdit({source:"TabsView",type:2,path:["schema"],value:a.value})},selectedOption:{value:n}})})]}),(0,E.jsx)(me,{size:"small",selectedValue:t.tabStates?.mainPaneTab,onTabSelect:(a,m)=>{e.setTab(m.value),e.setPropertiesComponents(void 0)},children:t.view?.tabs.map(a=>{let m=D(a.id);return(0,E.jsx)(se,{title:m,value:a.id,children:(0,E.jsxs)("div",{className:r.tabButtonContainer,children:[(0,E.jsx)(be,{children:a.title}),d(a.id)>0&&(0,E.jsx)(Qe,{color:"important",size:"small",title:T(a.id),count:d(a.id)})]})},a.id)})}),(0,E.jsx)("div",{className:r.form,children:t.view?.tabs.map(a=>(0,E.jsx)("div",{style:{display:t.tabStates?.mainPaneTab===a.id?"":"none",width:"100%",height:"100%"},children:(0,E.jsx)(Et,{tabId:a.id})},a.id))})]})};var At=c(M());var B=c(w()),Zt=N({root:{display:"flex",flexDirection:"column",height:"100%",overflowX:"hidden",...S.overflow("hidden")},title:{display:"flex",height:"30px",paddingTop:"10px",paddingBottom:"10px","> *":{marginRight:"10px"},lineHeight:"30px"},stack:{marginBottom:"10px",flexDirection:"column","> *":{marginBottom:"10px"},overflowY:"auto",backgroundColor:"var(--vscode-editor-background)"},group:{overflowX:"auto",overflowY:"hidden","> *":{marginBottom:"10px"}}}),Vt=()=>{let r=Zt(),e=wt(),t=(0,At.useContext)(I);if(!t)return null;let l=t.state.propertiesPaneData,s=l.componentPath,n=s[0],u=s[s.length-1],d=t.state.propertiesPaneData?.component.componentProperties,D=t.state.model[n].data[u],g=Array.from(new Set(d.itemProperties?.filter(o=>o.group).map(o=>o.group)));if(g?.unshift("General"),!D)return;let a=(o,x)=>{if(o)return(0,B.jsxs)(Ee,{value:o,className:e.accordionItem,children:[(0,B.jsx)(Ye,{children:o}),(0,B.jsx)(Je,{children:(0,B.jsx)("div",{className:r.group,children:x.map(h=>{if(!D)return;let y=D[h.propertyName];switch(h.componentType){case"checkbox":return(0,B.jsx)(te,{UiArea:"PropertiesView",component:h,model:y,componentPath:[...l.componentPath,h.propertyName]},`${o}-${h.propertyName}`);case"input":return(0,B.jsx)(j,{UiArea:"PropertiesView",component:h,model:y,componentPath:[...l.componentPath,h.propertyName],horizontal:!0},`${o}-${h.propertyName}`);case"dropdown":return(0,B.jsx)(oe,{UiArea:"PropertiesView",component:h,model:y,componentPath:[...l.componentPath,h.propertyName],horizontal:!0},`${o}-${h.propertyName}`);case"table":return(0,B.jsx)(Te,{UiArea:"PropertiesView",component:h,model:y,componentPath:[...l.componentPath,h.propertyName],loadPropertiesTabData:!1},`${o}-${h.propertyName}`)}})})})]},o)},m=()=>g?.sort((o,x)=>!o||!x?0:d.expandedGroups?.includes(o)&&!d.expandedGroups?.includes(x)?-1:d.expandedGroups?.includes(x)&&!d.expandedGroups?.includes(o)?1:0).map(o=>{let x=d.itemProperties.filter(h=>o==="General"&&!h.group||o===h.group).filter(h=>{if(h.showInPropertiesView===!1)return!1;let y=D[h.propertyName];return!(!y||y?.enabled===!1)});if(x.length!==0)return a(o,x)}),R=()=>d.expandedGroups?d.expandedGroups:m().length>0?[g[0]]:[];return(0,B.jsxs)("div",{className:r.root,children:[(0,B.jsxs)("div",{className:r.title,children:[(0,B.jsx)(C,{appearance:"transparent",onClick:()=>{t.propertiesPaneResizeInfo.isMaximized&&t.propertiesPaneResizeInfo.setCurrentWidth(t.propertiesPaneResizeInfo.originalWidth),t.propertiesPaneResizeInfo.setIsMaximized(!t.propertiesPaneResizeInfo.isMaximized)},title:t.propertiesPaneResizeInfo.isMaximized?p.tableDesigner.restorePanelSize:p.tableDesigner.maximizePanelSize,icon:t.propertiesPaneResizeInfo.isMaximized?(0,B.jsx)(We,{}):(0,B.jsx)(Le,{}),style:{marginRight:"0px"}}),(0,B.jsx)(be,{size:500,weight:"semibold",style:{flex:1,lineHeight:"28px"},children:p.tableDesigner.propertiesPaneTitle(d.objectTypeDisplayName??"")}),(0,B.jsx)(C,{appearance:"transparent",onClick:()=>{t.setPropertiesComponents(void 0)},title:t.propertiesPaneResizeInfo.isMaximized?p.tableDesigner.restorePanelSize:p.tableDesigner.maximizePanelSize,icon:(0,B.jsx)(Ke,{})})]}),(0,B.jsx)("div",{className:r.stack,children:(0,B.jsx)(Ne,{multiple:!0,collapsible:!0,defaultOpenItems:R(),children:D&&m()})})]})};var Ht=c(M()),v=c(w()),en=N({root:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},ribbon:{width:"100%",display:"flex",flexDirection:"row","> *":{marginRight:"10px"},padding:"5px 0px"},designerResultPaneTabs:{flex:1},tabContent:{...S.flex(1),width:"100%",height:"100%",display:"flex",...S.overflow("auto")},designerResultPaneScript:{width:"100%",height:"100%",position:"relative"},designerResultPaneScriptOpenButton:{position:"absolute",top:"0px",right:"0px"},issuesContainer:{width:"100%",height:"calc( 100% - 10px )",flexDirection:"column","> *":{marginBottom:"10px"},backgroundColor:"var(--vscode-editor-background)",padding:"5px",overflow:"hidden auto"},issuesRows:{display:"flex",lineHeight:"20px",padding:"5px","> *":{marginRight:"10px"},":hover":{backgroundColor:"var(--vscode-editor-selectionHighlightBackground)"},width:"100%"}}),Lt=()=>{let r=en(),e=(0,Ht.useContext)(I),t=e?.state;if(!t)return;let l=async s=>{let n=s.propertyPath??[];if(e?.log(`focusing on ${n}`),!t?.view?.tabs)return;let u=t.view.tabs.find(g=>g.components.find(a=>a.propertyName===n[0]));if(u)e.setTab(u.id),await new Promise(g=>setTimeout(g,100));else return;let d,T;if(n.length>1){if(d=u.components.find(g=>g.propertyName===n[0]),!d||(T=t.model[d.propertyName],!T))return;e.setPropertiesComponents({componentPath:[n[0],n[1]],component:d,model:T})}let D;switch(n.length){case 1:case 3:case 5:D=e.elementRefs.current[e.getComponentId(n)];break;case 2:if(!d)return;let g=d.componentProperties.itemProperties[0].propertyName;D=e.elementRefs.current[e.getComponentId([...n,g])];break;case 4:if(!d)return;let a=n[2],m=d.componentProperties.itemProperties.find(o=>o.propertyName===a);if(!m)return;let R=m.componentProperties.itemProperties[0].propertyName;D=e.elementRefs.current[e.getComponentId([...n,R])];break;default:break}D&&(D.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),D.focus())};return(0,v.jsxs)("div",{className:r.root,children:[(0,v.jsxs)("div",{className:r.ribbon,children:[(0,v.jsxs)(me,{size:"small",selectedValue:t.tabStates.resultPaneTab,onTabSelect:(s,n)=>{e.setResultTab(n.value)},className:r.designerResultPaneTabs,children:[(0,v.jsx)(se,{value:"script",children:p.tableDesigner.scriptAsCreate},"script"),t.issues?.length!==0&&(0,v.jsx)(se,{value:"issues",children:p.tableDesigner.issuesTabHeader(t.issues?.length)},"issues")]}),t.tabStates.resultPaneTab==="script"&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(C,{size:"small",appearance:"outline",onClick:()=>e.scriptAsCreate(),title:p.tableDesigner.openInEditor,icon:(0,v.jsx)(je,{}),children:p.tableDesigner.openInEditor}),(0,v.jsx)(C,{size:"small",appearance:"outline",onClick:()=>e.copyScriptAsCreateToClipboard(),title:p.tableDesigner.copyScript,icon:(0,v.jsx)(Fe,{}),children:p.tableDesigner.copyScript})]}),(0,v.jsx)(C,{size:"small",appearance:"transparent",onClick:()=>{e.resultPaneResizeInfo.isMaximized&&e.resultPaneResizeInfo.setCurrentHeight(e.resultPaneResizeInfo.originalHeight),e.resultPaneResizeInfo.setIsMaximized(!e.resultPaneResizeInfo.isMaximized)},title:e.resultPaneResizeInfo.isMaximized?p.tableDesigner.restorePanelSize:p.tableDesigner.maximizePanelSize,icon:e.resultPaneResizeInfo.isMaximized?(0,v.jsx)(He,{}):(0,v.jsx)(Oe,{})})]}),(0,v.jsxs)("div",{className:r.tabContent,children:[t.tabStates.resultPaneTab==="script"&&(0,v.jsx)("div",{className:r.designerResultPaneScript,children:(0,v.jsx)(Tt,{height:"100%",width:"100%",language:"sql",theme:Dt(e?.themeKind),value:(t?.model.script).value??"",options:{readOnly:!0}})}),t.tabStates.resultPaneTab==="issues"&&t.issues?.length!==0&&(0,v.jsx)("div",{className:r.issuesContainer,children:(0,v.jsx)(ft,{navigationMode:"items",children:t.issues.map((s,n)=>(0,v.jsx)(ht,{onAction:async()=>l(s),children:(0,v.jsxs)("div",{className:r.issuesRows,children:[s.severity==="error"&&(0,v.jsx)(O,{fontSize:20,color:"var(--vscode-errorForeground)"}),s.severity==="warning"&&(0,v.jsx)(qe,{fontSize:20,color:"yellow"}),s.severity==="information"&&(0,v.jsx)($e,{fontSize:20,color:"blue"}),s.description]})},`issue-${n}`))})})]})]})};var z=c(w()),tn=N({root:{display:"flex",flexDirection:"column",height:"100%",width:"100%",maxWidth:"100%",maxHeight:"100%"},pageContext:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",flexDirection:"column"},errorIcon:{fontSize:"100px",opacity:.5},retryButton:{marginTop:"10px"},resultPaneHandle:{position:"absolute",top:"0",right:"0",width:"100%",height:"10px",cursor:"ns-resize",zIndex:1,boxShadow:"0px -1px 1px  var(--vscode-editorWidget-border)"},propertiesPaneHandle:{position:"absolute",top:"0",left:"0",width:"10px",height:"100%",cursor:"ew-resize",zIndex:1,boxShadow:"-1px 0px 1px  var(--vscode-editorWidget-border)"},designerRibbon:{width:"100%"},mainContent:{height:"100%",width:"100%",minHeight:"100%",display:"flex",...S.flex(1),flexDirection:"column",...S.overflow("hidden")},editor:{...S.overflow("hidden"),...S.flex(1),width:"100%",display:"flex",flexDirection:"row"},resultPaneContainer:{width:"100%",position:"relative"},mainPaneContainer:{...S.flex(1),height:"100%",...S.overflow("hidden")},propertiesPaneContainer:{position:"relative",height:"100%",width:"300px",...S.overflow("hidden")}}),Ot=()=>{let r=tn(),e=(0,Wt.useContext)(I),t=e?.state;return t?(0,z.jsxs)("div",{className:r.root,children:[t.apiState?.initializeState==="Loading"&&(0,z.jsx)("div",{className:r.pageContext,children:(0,z.jsx)(J,{label:p.tableDesigner.loadingTableDesigner,labelPosition:"below"})}),t.apiState?.initializeState==="Error"&&(0,z.jsxs)("div",{className:r.pageContext,children:[(0,z.jsx)(O,{className:r.errorIcon}),(0,z.jsx)("div",{children:p.tableDesigner.errorLoadingDesigner}),(0,z.jsx)(C,{className:r.retryButton,children:p.tableDesigner.retry})]}),t.apiState?.initializeState==="Loaded"&&(0,z.jsxs)("div",{className:r.mainContent,children:[(0,z.jsx)(Bt,{}),(0,z.jsxs)("div",{className:r.editor,children:[(0,z.jsx)("div",{className:r.mainPaneContainer,children:(0,z.jsx)(Mt,{})}),(0,z.jsx)(ue,{style:{width:"5px",height:"100%",flex:0},vertical:!0}),e.state.propertiesPaneData&&(0,z.jsx)(ze.ResizableBox,{width:e.propertiesPaneResizeInfo.isMaximized?9999999:e.propertiesPaneResizeInfo.currentWidth,onResizeStart:(l,s)=>{e.propertiesPaneResizeInfo.setIsMaximized(!1)},onResizeStop:(l,s)=>{let n=s.node.parentElement.parentElement.offsetWidth;s.size.width>=n-50?(e.propertiesPaneResizeInfo.setIsMaximized(!0),e.propertiesPaneResizeInfo.setCurrentWidth(n)):(e.propertiesPaneResizeInfo.setCurrentWidth(s.size.width),e.propertiesPaneResizeInfo.setOriginalWidth(s.size.width))},height:1/0,maxConstraints:[1/0,1/0],minConstraints:[10,1/0],resizeHandles:["w"],handle:(0,z.jsx)("div",{className:r.propertiesPaneHandle}),className:r.propertiesPaneContainer,children:(0,z.jsx)(Vt,{})})]}),(0,z.jsx)(ze.ResizableBox,{width:1/0,height:e.resultPaneResizeInfo.isMaximized?9999999:e.resultPaneResizeInfo.currentHeight,maxConstraints:[1/0,1/0],minConstraints:[1/0,10],resizeHandles:["n"],handle:(0,z.jsx)("div",{className:r.resultPaneHandle}),className:r.resultPaneContainer,onResizeStart:(l,s)=>{e.resultPaneResizeInfo.setIsMaximized(!1)},onResizeStop:(l,s)=>{let n=s.node.parentElement.parentElement.offsetHeight;s.size.height>=n-50?(e.resultPaneResizeInfo.setIsMaximized(!0),e.resultPaneResizeInfo.setCurrentHeight(n)):(e.resultPaneResizeInfo.setCurrentHeight(s.size.height),e.resultPaneResizeInfo.setOriginalHeight(s.size.height))},children:(0,z.jsx)(Lt,{})})]})]}):null};var ye=c(w());Ft.default.createRoot(document.getElementById("root")).render((0,ye.jsx)(Pt,{children:(0,ye.jsx)(yt,{children:(0,ye.jsx)(Ot,{})})}));
