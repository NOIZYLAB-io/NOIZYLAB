import{a as Q,b as B}from"./chunk-W5RJDKNB.js";import{Bb as T,Eb as F,Lb as g,Mb as i,Rb as v,Ub as R,bd as o,c as u,d as P,f as I,k as h,p as c,pb as k,qb as C,rb as w,sd as U,tb as S,wb as b}from"./chunk-M3U674VW.js";var z=u(I());var N=u(P());var A=u(c()),p=(0,N.createContext)(void 0),D=({children:r})=>{let t=B();return(0,A.jsx)(p.Provider,{value:{state:t.state,...U(t),submit:async d=>{await t.extensionRpc.action("submit",{answers:d})},cancel:async()=>{await t.extensionRpc.action("cancel")},openPrivacyStatement:async()=>{await t.extensionRpc.action("openPrivacyStatement")},themeKind:t.themeKind,keyBindings:t.keyBindings},children:r})};var l=u(P());var e=u(c()),G=h({root:{display:"flex",flexDirection:"column",width:"100%",maxHeight:"100vh",overflowY:"auto",padding:"10px"},formContainer:{display:"flex",flexDirection:"column",width:"800px",maxWidth:"calc(100% - 20px)","> *":{marginBottom:"15px"}},title:{marginBottom:"30px"},footer:{display:"flex",justifyContent:"space-between"},buttonsContainer:{display:"flex","> *":{marginRight:"10px"}},privacyDisclaimer:{marginTop:"30px",marginLeft:"auto"}}),L=()=>{let r=G(),t=(0,l.useContext)(p),[d,m]=(0,l.useState)(!0),[s,W]=(0,l.useState)({}),q=()=>{for(let a=0;a<t.state.questions.length;a++){let n=t.state.questions[a];if(n.type!=="divider"&&n?.required&&s[n.id]===void 0){m(!0);return}}m(!1)},x=(a,n)=>{s[a]=n,W(s),q()};if(t?.state)return(0,e.jsx)("div",{className:r.root,children:(0,e.jsxs)("div",{className:r.formContainer,children:[(0,e.jsx)("h2",{style:{marginBottom:"30px"},children:t.state.title??o.userFeedback.microsoftWouldLikeYourFeedback}),t.state.subtitle&&(0,e.jsx)("p",{children:t.state.subtitle}),t.state.questions.map((a,n)=>{switch(a.type){case"nsat":return(0,e.jsx)(H,{question:a,onChange:f=>x(a.id,f)},n);case"nps":return(0,e.jsx)(V,{question:a,onChange:f=>x(a.id,f)},n);case"textarea":return(0,e.jsx)(Y,{question:a,onChange:f=>x(a.id,f)},n);case"divider":return(0,e.jsx)(T,{},n);default:return}}),(0,e.jsx)("div",{className:r.footer,children:(0,e.jsxs)("div",{className:r.buttonsContainer,children:[(0,e.jsx)(S,{appearance:"primary",disabled:d,onClick:()=>t.submit(s),children:t.state.submitButtonText??o.userFeedback.submit}),(0,e.jsx)(S,{onClick:()=>t.cancel(),children:t.state.cancelButtonText??o.common.cancel})]})}),(0,e.jsxs)("div",{className:r.privacyDisclaimer,children:[(0,e.jsxs)(C,{inline:!0,openOnHover:!0,positioning:{coverTarget:!0},children:[(0,e.jsx)(w,{children:(0,e.jsx)("p",{children:o.userFeedback.feedbackStatementShort})}),(0,e.jsx)(k,{children:(0,e.jsx)("div",{style:{width:"600px"},children:o.userFeedback.feedbackStatementLong})})]}),(0,e.jsx)(F,{onClick:()=>{t.openPrivacyStatement()},children:o.userFeedback.privacyStatement})]})]})})},H=({question:r,onChange:t})=>{if((0,l.useContext)(p))return(0,e.jsx)(b,{label:(0,e.jsx)(v,{weight:"bold",children:r.label??o.userFeedback.overallHowSatisfiedAreYouWithMSSQLExtension}),required:r.required??!1,children:(0,e.jsxs)(g,{layout:"horizontal-stacked",onChange:(m,s)=>t(parseInt(s.value)),children:[(0,e.jsx)(i,{value:"0",label:o.userFeedback.veryDissatisfied}),(0,e.jsx)(i,{value:"1",label:o.userFeedback.dissatisfied}),(0,e.jsx)(i,{value:"2",label:o.userFeedback.satisfied}),(0,e.jsx)(i,{value:"3",label:o.userFeedback.verySatisfied})]})})},V=({question:r,onChange:t})=>{if((0,l.useContext)(p))return(0,e.jsx)(b,{label:(0,e.jsx)(v,{weight:"bold",children:r.label}),required:r.required??!1,style:{marginBottom:"25px"},children:(0,e.jsxs)(g,{layout:"horizontal-stacked",onChange:(m,s)=>t(parseInt(s.value)),children:[(0,e.jsx)(i,{value:"0",label:(0,e.jsxs)("div",{style:{position:"relative",display:"flex",flexDirection:"column"},children:["0",(0,e.jsx)("br",{}),(0,e.jsx)(v,{style:{position:"absolute",width:"100px",top:"30px",left:"0px",fontSize:"10px"},size:200,children:o.userFeedback.notLikelyAtAll})]})}),(0,e.jsx)(i,{value:"1",label:"1"}),(0,e.jsx)(i,{value:"2",label:"2"}),(0,e.jsx)(i,{value:"3",label:"3"}),(0,e.jsx)(i,{value:"4",label:"4"}),(0,e.jsx)(i,{value:"5",label:"5"}),(0,e.jsx)(i,{value:"6",label:"6"}),(0,e.jsx)(i,{value:"7",label:"7"}),(0,e.jsx)(i,{value:"8",label:"8"}),(0,e.jsx)(i,{value:"9",label:"9"}),(0,e.jsx)(i,{value:"10",label:(0,e.jsxs)("div",{style:{position:"relative",display:"flex",flexDirection:"column"},children:["10",(0,e.jsx)("br",{}),(0,e.jsx)(v,{style:{position:"absolute",width:"max-content",top:"30px",right:"0px",fontSize:"10px"},size:200,children:o.userFeedback.extremelyLikely})]})})]})})},Y=({question:r,onChange:t})=>{if((0,l.useContext)(p))return(0,e.jsx)(b,{required:r.required??!1,label:(0,e.jsx)(v,{weight:"bold",children:r.label}),hint:r.placeholder,children:(0,e.jsx)(R,{onChange:(m,s)=>t(s.value),resize:"vertical"})})};var y=u(c());z.default.createRoot(document.getElementById("root")).render((0,y.jsx)(Q,{children:(0,y.jsx)(D,{children:(0,y.jsx)(L,{})})}));
